'use strict';jQuery(document).ready(function(a){return function(b,c){var d=function(){function f(){return'<div class="dm-loading-indicator"><div class="dm-loading-indicator__bar dm-loading-indicator__bar--bar1"></div><div class="dm-loading-indicator__bar dm-loading-indicator__bar--bar2"></div><div class="dm-loading-indicator__bar dm-loading-indicator__bar--bar3"></div></div>'}function g(m){return'<li class="dm-widgetlist__item"><div class="dm-widget__article">\n                                 <div class="dm-widget__article-content-box">\n                                    <div class="dm-widget__article-text">\n                                        <a class="dm-widget__article-title" href="'+m.url+'" title="">'+m.displayName+'</a>\n                                        <div class="dm-widget__article-metadata">By <a class="dm-widget__article-username" href="'+m.author.url+'" title="">'+m.author.displayName+'</a>, '+m.pub+'</div>\n                                    </div>\n                                 </div>\n                            </div></li>'}function h(m){b(m).append(f())}function j(m){b(m).find('.dm-loading-indicator').remove()}function k(m){return'<li class="dm-widgetlist__item"><div class="dm-widget__contentMessage"><p>'+m+'</p></div></li>'}var l='No related content found.';return{loadRelatedContent:function loadRelatedContent(m,_ref){var n=_ref.id,o=_ref.type,p=_ref.title,q=_ref.primary_tag,r=m.find('ul.dm-widgetlist'),s=r.attr('data-types'),t=parseInt(r.attr('data-limit'));b.ajax({url:c.contentServiceUrl,data:{topic:q,topicSwitch:!1,objectTypes:s,text:p,size:t+1},type:'GET',dataType:'json',beforeSend:function beforeSend(){h(m)},complete:function complete(){j(m)},success:function success(u){if('undefined'==typeof u.page||0===u.page.totalElements)return void r.append(k(l));var v='',w=!1;b.each(u._embedded.contents,function(x,y){if(w||x!==t){if(y.objectType===o&&'undefined'!=typeof y.id&&y.id.match('_'+n+'$'))return void(w=!0);y.author.url=c.profileUrl+'/'+y.author.userName,y.pub=new Date(y.published.split('.')[0]).toLocaleString('en-us',{month:'short',day:'2-digit',year:'numeric'});var z=g(y);v+=z}}),v.length?r.append(v):r.append(k(l))},error:function error(){r.append(k('We are sorry but we are currently unable to retrieve related content.'))}})}}}(),e=b(c.widgetSelector);e.each(function(){d.loadRelatedContent(b(this),c.targetContentItem)})}(a,window.relatedContentWidgetSettings)});