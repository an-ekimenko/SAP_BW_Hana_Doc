var Prototype={Version:"1.7.3",Browser:(function(){var b=navigator.userAgent;var a=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!a,Opera:a,WebKit:b.indexOf("AppleWebKit/")>-1,Gecko:b.indexOf("Gecko")>-1&&b.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(b)}})(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:(function(){var a=window.Element||window.HTMLElement;return !!(a&&a.prototype)})(),SpecificElementExtensions:(function(){if(typeof window.HTMLDivElement!=="undefined"){return true}var c=document.createElement("div"),b=document.createElement("form"),a=false;if(c.__proto__&&(c.__proto__!==b.__proto__)){a=true}c=b=null;return a})()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script\\s*>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari){Prototype.BrowserFeatures.SpecificElementExtensions=false}var Class=(function(){var d=(function(){for(var e in {toString:1}){if(e==="toString"){return false}}return true})();function a(){}function b(){var h=null,g=$A(arguments);if(Object.isFunction(g[0])){h=g.shift()}function e(){this.initialize.apply(this,arguments)}Object.extend(e,Class.Methods);e.superclass=h;e.subclasses=[];if(h){a.prototype=h.prototype;e.prototype=new a;h.subclasses.push(e)}for(var f=0,j=g.length;f<j;f++){e.addMethods(g[f])}if(!e.prototype.initialize){e.prototype.initialize=Prototype.emptyFunction}e.prototype.constructor=e;return e}function c(l){var g=this.superclass&&this.superclass.prototype,f=Object.keys(l);if(d){if(l.toString!=Object.prototype.toString){f.push("toString")}if(l.valueOf!=Object.prototype.valueOf){f.push("valueOf")}}for(var e=0,h=f.length;e<h;e++){var k=f[e],j=l[k];if(g&&Object.isFunction(j)&&j.argumentNames()[0]=="$super"){var m=j;j=(function(i){return function(){return g[i].apply(this,arguments)}})(k).wrap(m);j.valueOf=(function(i){return function(){return i.valueOf.call(i)}})(m);j.toString=(function(i){return function(){return i.toString.call(i)}})(m)}this.prototype[k]=j}return this}return{create:b,Methods:{addMethods:c}}})();(function(){var y=Object.prototype.toString,k=Object.prototype.hasOwnProperty,z="Null",B="Undefined",K="Boolean",w="Number",v="String",I="Object",i="[object Function]",d="[object Boolean]",j="[object Number]",f="[object String]",b="[object Array]",H="[object Date]",e=window.JSON&&typeof JSON.stringify==="function"&&JSON.stringify(0)==="0"&&typeof JSON.stringify(Prototype.K)==="undefined";var q=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var a=(function(){for(var L in {toString:1}){if(L==="toString"){return false}}return true})();function D(M){switch(M){case null:return z;case (void 0):return B}var L=typeof M;switch(L){case"boolean":return K;case"number":return w;case"string":return v}return I}function h(L,N){for(var M in N){L[M]=N[M]}return L}function l(L){try{if(o(L)){return"undefined"}if(L===null){return"null"}return L.inspect?L.inspect():String(L)}catch(M){if(M instanceof RangeError){return"..."}throw M}}function A(L){return m("",{"":L},[])}function m(U,R,S){var T=R[U];if(D(T)===I&&typeof T.toJSON==="function"){T=T.toJSON(U)}var N=y.call(T);switch(N){case j:case d:case f:T=T.valueOf()}switch(T){case null:return"null";case true:return"true";case false:return"false"}var Q=typeof T;switch(Q){case"string":return T.inspect(true);case"number":return isFinite(T)?String(T):"null";case"object":for(var M=0,L=S.length;M<L;M++){if(S[M]===T){throw new TypeError("Cyclic reference to '"+T+"' in object")}}S.push(T);var P=[];if(N===b){for(var M=0,L=T.length;M<L;M++){var O=m(M,T,S);P.push(typeof O==="undefined"?"null":O)}P="["+P.join(",")+"]"}else{var V=Object.keys(T);for(var M=0,L=V.length;M<L;M++){var U=V[M],O=m(U,T,S);if(typeof O!=="undefined"){P.push(U.inspect(true)+":"+O)}}P="{"+P.join(",")+"}"}S.pop();return P}}function J(L){return JSON.stringify(L)}function C(L){return $H(L).toQueryString()}function p(L){return L&&L.toHTML?L.toHTML():String.interpret(L)}function x(L){if(D(L)!==I){throw new TypeError()}var N=[];for(var O in L){if(k.call(L,O)){N.push(O)}}if(a){for(var M=0;O=q[M];M++){if(k.call(L,O)){N.push(O)}}}return N}function G(L){var M=[];for(var N in L){M.push(L[N])}return M}function s(L){return h({},L)}function E(L){return !!(L&&L.nodeType==1)}function u(L){return y.call(L)===b}var c=(typeof Array.isArray=="function")&&Array.isArray([])&&!Array.isArray({});if(c){u=Array.isArray}function r(L){return L instanceof Hash}function n(L){return y.call(L)===i}function g(L){return y.call(L)===f}function F(L){return y.call(L)===j}function t(L){return y.call(L)===H}function o(L){return typeof L==="undefined"}h(Object,{extend:h,inspect:l,toJSON:e?J:A,toQueryString:C,toHTML:p,keys:Object.keys||x,values:G,clone:s,isElement:E,isArray:u,isHash:r,isFunction:n,isString:g,isNumber:F,isDate:t,isUndefined:o})})();Object.extend(Function.prototype,(function(){var l=Array.prototype.slice;function d(p,m){var o=p.length,n=m.length;while(n--){p[o+n]=m[n]}return p}function j(n,m){n=l.call(n,0);return d(n,m)}function g(){var m=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return m.length==1&&!m[0]?[]:m}function h(o){if(arguments.length<2&&Object.isUndefined(arguments[0])){return this}if(!Object.isFunction(this)){throw new TypeError("The object is not callable.")}var q=function(){};var m=this,n=l.call(arguments,1);var p=function(){var r=j(n,arguments);var s=this instanceof p?this:o;return m.apply(s,r)};q.prototype=this.prototype;p.prototype=new q();return p}function f(o){var m=this,n=l.call(arguments,1);return function(q){var p=d([q||window.event],n);return m.apply(o,p)}}function k(){if(!arguments.length){return this}var m=this,n=l.call(arguments,0);return function(){var o=j(n,arguments);return m.apply(this,o)}}function e(o){var m=this,n=l.call(arguments,1);o=o*1000;return window.setTimeout(function(){return m.apply(m,n)},o)}function a(){var m=d([0.01],arguments);return this.delay.apply(this,m)}function c(n){var m=this;return function(){var o=d([m.bind(this)],arguments);return n.apply(this,o)}}function b(){if(this._methodized){return this._methodized}var m=this;return this._methodized=function(){var n=d([this],arguments);return m.apply(null,n)}}var i={argumentNames:g,bindAsEventListener:f,curry:k,delay:e,defer:a,wrap:c,methodize:b};if(!Function.prototype.bind){i.bind=h}return i})());(function(c){function b(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function a(){return this.toISOString()}if(!c.toISOString){c.toISOString=b}if(!c.toJSON){c.toJSON=a}})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};var PeriodicalExecuter=Class.create({initialize:function(b,a){this.callback=b;this.frequency=a;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000)},execute:function(){this.callback(this)},stop:function(){if(!this.timer){return}clearInterval(this.timer);this.timer=null},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=false;throw a}}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});Object.extend(String.prototype,(function(){var NATIVE_JSON_PARSE_SUPPORT=window.JSON&&typeof JSON.parse==="function"&&JSON.parse('{"test": true}').test;function prepareReplacement(replacement){if(Object.isFunction(replacement)){return replacement}var template=new Template(replacement);return function(match){return template.evaluate(match)}}function isNonEmptyRegExp(regexp){return regexp.source&&regexp.source!=="(?:)"}function gsub(pattern,replacement){var result="",source=this,match;replacement=prepareReplacement(replacement);if(Object.isString(pattern)){pattern=RegExp.escape(pattern)}if(!(pattern.length||isNonEmptyRegExp(pattern))){replacement=replacement("");return replacement+source.split("").join(replacement)+replacement}while(source.length>0){match=source.match(pattern);if(match&&match[0].length>0){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length)}else{result+=source,source=""}}return result}function sub(pattern,replacement,count){replacement=prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0){return match[0]}return replacement(match)})}function scan(pattern,iterator){this.gsub(pattern,iterator);return String(this)}function truncate(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?"...":truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this)}function strip(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?(\/)?>|<\/\w+>/gi,"")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function extractScripts(){var matchAll=new RegExp(Prototype.ScriptFragment,"img"),matchOne=new RegExp(Prototype.ScriptFragment,"im");return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||["",""])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function unescapeHTML(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function toQueryParams(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match){return{}}return match[1].split(separator||"&").inject({},function(hash,pair){if((pair=pair.split("="))[0]){var key=decodeURIComponent(pair.shift()),value=pair.length>1?pair.join("="):pair[0];if(value!=undefined){value=value.gsub("+"," ");value=decodeURIComponent(value)}if(key in hash){if(!Object.isArray(hash[key])){hash[key]=[hash[key]]}hash[key].push(value)}else{hash[key]=value}}return hash})}function toArray(){return this.split("")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(count){return count<1?"":new Array(count+1).join(this)}function camelize(){return this.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function dasherize(){return this.replace(/_/g,"-")}function inspect(useDoubleQuotes){var escapedString=this.replace(/[\x00-\x1f\\]/g,function(character){if(character in String.specialChar){return String.specialChar[character]}return"\\u00"+character.charCodeAt().toPaddedString(2,16)});if(useDoubleQuotes){return'"'+escapedString.replace(/"/g,'\\"')+'"'}return"'"+escapedString.replace(/'/g,"\\'")+"'"}function unfilterJSON(filter){return this.replace(filter||Prototype.JSONFilter,"$1")}function isJSON(){var str=this;if(str.blank()){return false}str=str.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@");str=str.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");str=str.replace(/(?:^|:|,)(?:\s*\[)+/g,"");return(/^[\],:{}\s]*$/).test(str)}function evalJSON(sanitize){var json=this.unfilterJSON(),cx=/[\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff\u0000]/g;if(cx.test(json)){json=json.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}try{if(!sanitize||json.isJSON()){return eval("("+json+")")}}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())}function parseJSON(){var json=this.unfilterJSON();return JSON.parse(json)}function include(pattern){return this.indexOf(pattern)>-1}function startsWith(pattern,position){position=Object.isNumber(position)?position:0;return this.lastIndexOf(pattern,position)===position}function endsWith(pattern,position){pattern=String(pattern);position=Object.isNumber(position)?position:this.length;if(position<0){position=0}if(position>this.length){position=this.length}var d=position-pattern.length;return d>=0&&this.indexOf(pattern,d)===d}function empty(){return this==""}function blank(){return/^\s*$/.test(this)}function interpolate(object,pattern){return new Template(this,pattern).evaluate(object)}return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim||strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:NATIVE_JSON_PARSE_SUPPORT?parseJSON:evalJSON,include:include,startsWith:String.prototype.startsWith||startsWith,endsWith:String.prototype.endsWith||endsWith,empty:empty,blank:blank,interpolate:interpolate}})());var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements)){a=a.toTemplateReplacements()}return this.template.gsub(this.pattern,function(d){if(a==null){return(d[1]+"")}var f=d[1]||"";if(f=="\\"){return d[2]}var b=a,g=d[3],e=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;d=e.exec(g);if(d==null){return f}while(d!=null){var c=d[1].startsWith("[")?d[2].replace(/\\\\]/g,"]"):d[1];b=b[c];if(null==b||""==d[3]){break}g=g.substring("["==d[3]?d[1].length:d[0].length);d=e.exec(g)}return f+String.interpret(b)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable=(function(){function c(x,w){try{this._each(x,w)}catch(y){if(y!=$break){throw y}}return this}function r(z,y,x){var w=-z,A=[],B=this.toArray();if(z<1){return B}while((w+=z)<B.length){A.push(B.slice(w,w+z))}return A.collect(y,x)}function b(y,x){y=y||Prototype.K;var w=true;this.each(function(A,z){w=w&&!!y.call(x,A,z,this);if(!w){throw $break}},this);return w}function i(y,x){y=y||Prototype.K;var w=false;this.each(function(A,z){if(w=!!y.call(x,A,z,this)){throw $break}},this);return w}function j(y,x){y=y||Prototype.K;var w=[];this.each(function(A,z){w.push(y.call(x,A,z,this))},this);return w}function t(y,x){var w;this.each(function(A,z){if(y.call(x,A,z,this)){w=A;throw $break}},this);return w}function h(y,x){var w=[];this.each(function(A,z){if(y.call(x,A,z,this)){w.push(A)}},this);return w}function g(z,y,x){y=y||Prototype.K;var w=[];if(Object.isString(z)){z=new RegExp(RegExp.escape(z))}this.each(function(B,A){if(z.match(B)){w.push(y.call(x,B,A,this))}},this);return w}function a(w){if(Object.isFunction(this.indexOf)&&this.indexOf(w)!=-1){return true}var x=false;this.each(function(y){if(y==w){x=true;throw $break}});return x}function q(x,w){w=Object.isUndefined(w)?null:w;return this.eachSlice(x,function(y){while(y.length<x){y.push(w)}return y})}function l(w,y,x){this.each(function(A,z){w=y.call(x,w,A,z,this)},this);return w}function v(x){var w=$A(arguments).slice(1);return this.map(function(y){return y[x].apply(y,w)})}function p(y,x){y=y||Prototype.K;var w;this.each(function(A,z){A=y.call(x,A,z,this);if(w==null||A>=w){w=A}},this);return w}function n(y,x){y=y||Prototype.K;var w;this.each(function(A,z){A=y.call(x,A,z,this);if(w==null||A<w){w=A}},this);return w}function e(z,x){z=z||Prototype.K;var y=[],w=[];this.each(function(B,A){(z.call(x,B,A,this)?y:w).push(B)},this);return[y,w]}function f(x){var w=[];this.each(function(y){w.push(y[x])});return w}function d(y,x){var w=[];this.each(function(A,z){if(!y.call(x,A,z,this)){w.push(A)}},this);return w}function m(x,w){return this.map(function(z,y){return{value:z,criteria:x.call(w,z,y,this)}},this).sort(function(B,A){var z=B.criteria,y=A.criteria;return z<y?-1:z>y?1:0}).pluck("value")}function o(){return this.map()}function s(){var x=Prototype.K,w=$A(arguments);if(Object.isFunction(w.last())){x=w.pop()}var y=[this].concat(w).map($A);return this.map(function(A,z){return x(y.pluck(z))})}function k(){return this.toArray().length}function u(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:c,eachSlice:r,all:b,every:b,any:i,some:i,collect:j,map:j,detect:t,findAll:h,select:h,filter:h,grep:g,include:a,member:a,inGroupsOf:q,inject:l,invoke:v,max:p,min:n,partition:e,pluck:f,reject:d,sortBy:m,toArray:o,entries:o,zip:s,size:k,inspect:u,find:t}})();function $A(c){if(!c){return[]}if("toArray" in Object(c)){return c.toArray()}var b=c.length||0,a=new Array(b);while(b--){a[b]=c[b]}return a}function $w(a){if(!Object.isString(a)){return[]}a=a.strip();return a?a.split(/\s+/):[]}Array.from=$A;(function(){var v=Array.prototype,o=v.slice,q=v.forEach;function b(B,A){for(var z=0,C=this.length>>>0;z<C;z++){if(z in this){B.call(A,this[z],z,this)}}}if(!q){q=b}function n(){this.length=0;return this}function d(){return this[0]}function g(){return this[this.length-1]}function k(){return this.select(function(z){return z!=null})}function y(){return this.inject([],function(A,z){if(Object.isArray(z)){return A.concat(z.flatten())}A.push(z);return A})}function j(){var z=o.call(arguments,0);return this.select(function(A){return !z.include(A)})}function f(z){return(z===false?this.toArray():this)._reverse()}function m(z){return this.inject([],function(C,B,A){if(0==A||(z?C.last()!=B:!C.include(B))){C.push(B)}return C})}function r(z){return this.uniq().findAll(function(A){return z.indexOf(A)!==-1})}function t(){return o.call(this,0)}function l(){return this.length}function w(){return"["+this.map(Object.inspect).join(", ")+"]"}function a(C,A){if(this==null){throw new TypeError()}var D=Object(this),B=D.length>>>0;if(B===0){return -1}A=Number(A);if(isNaN(A)){A=0}else{if(A!==0&&isFinite(A)){A=(A>0?1:-1)*Math.floor(Math.abs(A))}}if(A>B){return -1}var z=A>=0?A:Math.max(B-Math.abs(A),0);for(;z<B;z++){if(z in D&&D[z]===C){return z}}return -1}function p(C,A){if(this==null){throw new TypeError()}var D=Object(this),B=D.length>>>0;if(B===0){return -1}if(!Object.isUndefined(A)){A=Number(A);if(isNaN(A)){A=0}else{if(A!==0&&isFinite(A)){A=(A>0?1:-1)*Math.floor(Math.abs(A))}}}else{A=B}var z=A>=0?Math.min(A,B-1):B-Math.abs(A);for(;z>=0;z--){if(z in D&&D[z]===C){return z}}return -1}function c(G){var E=[],F=o.call(arguments,0),H,A=0;F.unshift(this);for(var D=0,z=F.length;D<z;D++){H=F[D];if(Object.isArray(H)&&!("callee" in H)){for(var C=0,B=H.length;C<B;C++){if(C in H){E[A]=H[C]}A++}}else{E[A++]=H}}E.length=A;return E}function s(z){return function(){if(arguments.length===0){return z.call(this,Prototype.K)}else{if(arguments[0]===undefined){var A=o.call(arguments,1);A.unshift(Prototype.K);return z.apply(this,A)}else{return z.apply(this,arguments)}}}}function u(D){if(this==null){throw new TypeError()}D=D||Prototype.K;var z=Object(this);var C=[],B=arguments[1],F=0;for(var A=0,E=z.length>>>0;A<E;A++){if(A in z){C[F]=D.call(B,z[A],A,z)}F++}C.length=F;return C}if(v.map){u=s(Array.prototype.map)}function h(D){if(this==null||!Object.isFunction(D)){throw new TypeError()}var z=Object(this);var C=[],B=arguments[1],F;for(var A=0,E=z.length>>>0;A<E;A++){if(A in z){F=z[A];if(D.call(B,F,A,z)){C.push(F)}}}return C}if(v.filter){h=Array.prototype.filter}function i(C){if(this==null){throw new TypeError()}C=C||Prototype.K;var B=arguments[1];var z=Object(this);for(var A=0,D=z.length>>>0;A<D;A++){if(A in z&&C.call(B,z[A],A,z)){return true}}return false}if(v.some){i=s(Array.prototype.some)}function x(C){if(this==null){throw new TypeError()}C=C||Prototype.K;var B=arguments[1];var z=Object(this);for(var A=0,D=z.length>>>0;A<D;A++){if(A in z&&!C.call(B,z[A],A,z)){return false}}return true}if(v.every){x=s(Array.prototype.every)}Object.extend(v,Enumerable);if(v.entries===Enumerable.entries){delete v.entries}if(!v._reverse){v._reverse=v.reverse}Object.extend(v,{_each:q,map:u,collect:u,select:h,filter:h,findAll:h,some:i,any:i,every:x,all:x,clear:n,first:d,last:g,compact:k,flatten:y,without:j,reverse:f,uniq:m,intersect:r,clone:t,toArray:t,size:l,inspect:w});var e=(function(){return[].concat(arguments)[0][0]!==1})(1,2);if(e){v.concat=c}if(!v.indexOf){v.indexOf=a}if(!v.lastIndexOf){v.lastIndexOf=p}})();function $H(a){return new Hash(a)}var Hash=Class.create(Enumerable,(function(){function e(p){this._object=Object.isHash(p)?p.toObject():Object.clone(p)}function f(s,r){var q=0;for(var p in this._object){var t=this._object[p],u=[p,t];u.key=p;u.value=t;s.call(r,u,q);q++}}function j(p,q){return this._object[p]=q}function c(p){if(this._object[p]!==Object.prototype[p]){return this._object[p]}}function m(p){var q=this._object[p];delete this._object[p];return q}function o(){return Object.clone(this._object)}function n(){return this.pluck("key")}function l(){return this.pluck("value")}function g(q){var p=this.detect(function(r){return r.value===q});return p&&p.key}function i(p){return this.clone().update(p)}function d(p){return new Hash(p).inject(this,function(q,r){q.set(r.key,r.value);return q})}function b(p,q){if(Object.isUndefined(q)){return p}q=String.interpret(q);q=q.gsub(/(\r)?\n/,"\r\n");q=encodeURIComponent(q);q=q.gsub(/%20/,"+");return p+"="+q}function a(){return this.inject([],function(t,w){var s=encodeURIComponent(w.key),q=w.value;if(q&&typeof q=="object"){if(Object.isArray(q)){var v=[];for(var r=0,p=q.length,u;r<p;r++){u=q[r];v.push(b(s,u))}return t.concat(v)}}else{t.push(b(s,q))}return t}).join("&")}function k(){return"#<Hash:{"+this.map(function(p){return p.map(Object.inspect).join(": ")}).join(", ")+"}>"}function h(){return new Hash(this)}return{initialize:e,_each:f,set:j,get:c,unset:m,toObject:o,toTemplateReplacements:o,keys:n,values:l,index:g,merge:i,update:d,toQueryString:a,inspect:k,toJSON:o,clone:h}})());Hash.from=$H;Object.extend(Number.prototype,(function(){function d(){return this.toPaddedString(2,16)}function b(){return this+1}function h(j,i){$R(0,this,true).each(j,i);return this}function g(k,j){var i=this.toString(j||10);return"0".times(k-i.length)+i}function a(){return Math.abs(this)}function c(){return Math.round(this)}function e(){return Math.ceil(this)}function f(){return Math.floor(this)}return{toColorPart:d,succ:b,times:h,toPaddedString:g,abs:a,round:c,ceil:e,floor:f}})());function $R(c,a,b){return new ObjectRange(c,a,b)}var ObjectRange=Class.create(Enumerable,(function(){function b(f,d,e){this.start=f;this.end=d;this.exclusive=e}function c(f,e){var g=this.start,d;for(d=0;this.include(g);d++){f.call(e,g,d);g=g.succ()}}function a(d){if(d<this.start){return false}if(this.exclusive){return d<this.end}return d<=this.end}return{initialize:b,_each:c,include:a}})());var Abstract={};var Try={these:function(){var c;for(var b=0,d=arguments.length;b<d;b++){var a=arguments[b];try{c=a();break}catch(f){}}return c}};(function(a8){var aE;var a1=Array.prototype.slice;var av=document.createElement("div");function aZ(bp){if(arguments.length>1){for(var F=0,br=[],bq=arguments.length;F<bq;F++){br.push(aZ(arguments[F]))}return br}if(Object.isString(bp)){bp=document.getElementById(bp)}return aF.extend(bp)}a8.$=aZ;if(!a8.Node){a8.Node={}}if(!a8.Node.ELEMENT_NODE){Object.extend(a8.Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12})}var r={};function aQ(F,i){if(F==="select"){return false}if("type" in i){return false}return true}var d=(function(){try{var i=document.createElement('<input name="x">');return i.tagName.toLowerCase()==="input"&&i.name==="x"}catch(F){return false}})();var aI=a8.Element;function aF(F,i){i=i||{};F=F.toLowerCase();if(d&&i.name){F="<"+F+' name="'+i.name+'">';delete i.name;return aF.writeAttribute(document.createElement(F),i)}if(!r[F]){r[F]=aF.extend(document.createElement(F))}var bp=aQ(F,i)?r[F].cloneNode(false):document.createElement(F);return aF.writeAttribute(bp,i)}a8.Element=aF;Object.extend(a8.Element,aI||{});if(aI){a8.Element.prototype=aI.prototype}aF.Methods={ByTag:{},Simulated:{}};var a3={};var H={id:"id",className:"class"};function ba(F){F=aZ(F);var i="<"+F.tagName.toLowerCase();var bp,br;for(var bq in H){bp=H[bq];br=(F[bq]||"").toString();if(br){i+=" "+bp+"="+br.inspect(true)}}return i+">"}a3.inspect=ba;function v(i){return aZ(i).getStyle("display")!=="none"}function ax(F,i){F=aZ(F);if(typeof i!=="boolean"){i=!aF.visible(F)}aF[i?"show":"hide"](F);return F}function aH(i){i=aZ(i);i.style.display="none";return i}function j(i){i=aZ(i);i.style.display="";return i}Object.extend(a3,{visible:v,toggle:ax,hide:aH,show:j});function ad(i){i=aZ(i);i.parentNode.removeChild(i);return i}var aT=(function(){var i=document.createElement("select"),F=true;i.innerHTML='<option value="test">test</option>';if(i.options&&i.options[0]){F=i.options[0].nodeName.toUpperCase()!=="OPTION"}i=null;return F})();var I=(function(){try{var i=document.createElement("table");if(i&&i.tBodies){i.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var bp=typeof i.tBodies[0]=="undefined";i=null;return bp}}catch(F){return true}})();var a2=(function(){try{var i=document.createElement("div");i.innerHTML="<link />";var bp=(i.childNodes.length===0);i=null;return bp}catch(F){return true}})();var x=aT||I||a2;var aq=(function(){var i=document.createElement("script"),bp=false;try{i.appendChild(document.createTextNode(""));bp=!i.firstChild||i.firstChild&&i.firstChild.nodeType!==3}catch(F){bp=true}i=null;return bp})();function O(br,bt){br=aZ(br);var bu=br.getElementsByTagName("*"),bq=bu.length;while(bq--){Z(bu[bq])}if(bt&&bt.toElement){bt=bt.toElement()}if(Object.isElement(bt)){return br.update().insert(bt)}bt=Object.toHTML(bt);var bp=br.tagName.toUpperCase();if(bp==="SCRIPT"&&aq){br.text=bt;return br}if(x){if(bp in L.tags){while(br.firstChild){br.removeChild(br.firstChild)}var F=t(bp,bt.stripScripts());for(var bq=0,bs;bs=F[bq];bq++){br.appendChild(bs)}}else{if(a2&&Object.isString(bt)&&bt.indexOf("<link")>-1){while(br.firstChild){br.removeChild(br.firstChild)}var F=t(bp,bt.stripScripts(),true);for(var bq=0,bs;bs=F[bq];bq++){br.appendChild(bs)}}else{br.innerHTML=bt.stripScripts()}}}else{br.innerHTML=bt.stripScripts()}bt.evalScripts.bind(bt).defer();return br}function ah(F,bp){F=aZ(F);if(bp&&bp.toElement){bp=bp.toElement()}else{if(!Object.isElement(bp)){bp=Object.toHTML(bp);var i=F.ownerDocument.createRange();i.selectNode(F);bp.evalScripts.bind(bp).defer();bp=i.createContextualFragment(bp.stripScripts())}}F.parentNode.replaceChild(bp,F);return F}var L={before:function(i,F){i.parentNode.insertBefore(F,i)},top:function(i,F){i.insertBefore(F,i.firstChild)},bottom:function(i,F){i.appendChild(F)},after:function(i,F){i.parentNode.insertBefore(F,i.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};var aJ=L.tags;Object.extend(aJ,{THEAD:aJ.TBODY,TFOOT:aJ.TBODY,TH:aJ.TD});function ao(bp,bs){bp=aZ(bp);if(bs&&bs.toElement){bs=bs.toElement()}if(Object.isElement(bs)){bp.parentNode.replaceChild(bs,bp);return bp}bs=Object.toHTML(bs);var br=bp.parentNode,F=br.tagName.toUpperCase();if(F in L.tags){var bt=aF.next(bp);var i=t(F,bs.stripScripts());br.removeChild(bp);var bq;if(bt){bq=function(bu){br.insertBefore(bu,bt)}}else{bq=function(bu){br.appendChild(bu)}}i.each(bq)}else{bp.outerHTML=bs.stripScripts()}bs.evalScripts.bind(bs).defer();return bp}if("outerHTML" in document.documentElement){ah=ao}function a7(i){if(Object.isUndefined(i)||i===null){return false}if(Object.isString(i)||Object.isNumber(i)){return true}if(Object.isElement(i)){return true}if(i.toElement||i.toHTML){return true}return false}function bn(br,bt,F){F=F.toLowerCase();var bv=L[F];if(bt&&bt.toElement){bt=bt.toElement()}if(Object.isElement(bt)){bv(br,bt);return br}bt=Object.toHTML(bt);var bq=((F==="before"||F==="after")?br.parentNode:br).tagName.toUpperCase();var bu=t(bq,bt.stripScripts());if(F==="top"||F==="after"){bu.reverse()}for(var bp=0,bs;bs=bu[bp];bp++){bv(br,bs)}}function Q(F,bp){F=aZ(F);if(a7(bp)){bp={bottom:bp}}for(var i in bp){bn(F,bp[i],i)}return F}function u(F,bp,i){F=aZ(F);if(Object.isElement(bp)){aZ(bp).writeAttribute(i||{})}else{if(Object.isString(bp)){bp=new aF(bp,i)}else{bp=new aF("div",bp)}}if(F.parentNode){F.parentNode.replaceChild(bp,F)}bp.appendChild(F);return bp}function w(F){F=aZ(F);var bp=F.firstChild;while(bp){var i=bp.nextSibling;if(bp.nodeType===Node.TEXT_NODE&&!/\S/.test(bp.nodeValue)){F.removeChild(bp)}bp=i}return F}function a4(i){return aZ(i).innerHTML.blank()}function t(bs,br,bt){var bq=L.tags[bs],bu=av;var F=!!bq;if(!F&&bt){F=true;bq=["","",0]}if(F){bu.innerHTML="&#160;"+bq[0]+br+bq[1];bu.removeChild(bu.firstChild);for(var bp=bq[2];bp--;){bu=bu.firstChild}}else{bu.innerHTML=br}return $A(bu.childNodes)}function E(bq,F){if(!(bq=aZ(bq))){return}var bs=bq.cloneNode(F);if(!aY){bs._prototypeUID=aE;if(F){var br=aF.select(bs,"*"),bp=br.length;while(bp--){br[bp]._prototypeUID=aE}}}return aF.extend(bs)}function Z(F){var i=M(F);if(i){aF.stopObserving(F);if(!aY){F._prototypeUID=aE}delete aF.Storage[i]}}function bl(bp){var F=bp.length;while(F--){Z(bp[F])}}function at(br){var bq=br.length,bp,F;while(bq--){bp=br[bq];F=M(bp);delete aF.Storage[F];delete Event.cache[F]}}if(aY){bl=at}function m(bp){if(!(bp=aZ(bp))){return}Z(bp);var bq=bp.getElementsByTagName("*"),F=bq.length;while(F--){Z(bq[F])}return null}Object.extend(a3,{remove:ad,update:O,replace:ah,insert:Q,wrap:u,cleanWhitespace:w,empty:a4,clone:E,purge:m});function am(i,bp,bq){i=aZ(i);bq=bq||-1;var F=[];while(i=i[bp]){if(i.nodeType===Node.ELEMENT_NODE){F.push(aF.extend(i))}if(F.length===bq){break}}return F}function aL(i){return am(i,"parentNode")}function bm(i){return aF.select(i,"*")}function X(i){i=aZ(i).firstChild;while(i&&i.nodeType!==Node.ELEMENT_NODE){i=i.nextSibling}return aZ(i)}function bi(F){var i=[],bp=aZ(F).firstChild;while(bp){if(bp.nodeType===Node.ELEMENT_NODE){i.push(aF.extend(bp))}bp=bp.nextSibling}return i}function p(i){return am(i,"previousSibling")}function bh(i){return am(i,"nextSibling")}function aV(i){i=aZ(i);var bp=p(i),F=bh(i);return bp.reverse().concat(F)}function aR(F,i){F=aZ(F);if(Object.isString(i)){return Prototype.Selector.match(F,i)}return i.match(F)}function aW(F,bp,bq,i){F=aZ(F),bq=bq||0,i=i||0;if(Object.isNumber(bq)){i=bq,bq=null}while(F=F[bp]){if(F.nodeType!==1){continue}if(bq&&!Prototype.Selector.match(F,bq)){continue}if(--i>=0){continue}return aF.extend(F)}}function aa(F,bp,i){F=aZ(F);if(arguments.length===1){return aZ(F.parentNode)}return aW(F,"parentNode",bp,i)}function y(F,bq,i){if(arguments.length===1){return X(F)}F=aZ(F),bq=bq||0,i=i||0;if(Object.isNumber(bq)){i=bq,bq="*"}var bp=Prototype.Selector.select(bq,F)[i];return aF.extend(bp)}function h(F,bp,i){return aW(F,"previousSibling",bp,i)}function aB(F,bp,i){return aW(F,"nextSibling",bp,i)}function bb(i){i=aZ(i);var F=a1.call(arguments,1).join(", ");return Prototype.Selector.select(F,i)}function aD(bq){bq=aZ(bq);var bs=a1.call(arguments,1).join(", ");var bt=aF.siblings(bq),bp=[];for(var F=0,br;br=bt[F];F++){if(Prototype.Selector.match(br,bs)){bp.push(br)}}return bp}function D(F,i){F=aZ(F),i=aZ(i);if(!F||!i){return false}while(F=F.parentNode){if(F===i){return true}}return false}function B(F,i){F=aZ(F),i=aZ(i);if(!F||!i){return false}if(!i.contains){return D(F,i)}return i.contains(F)&&i!==F}function J(F,i){F=aZ(F),i=aZ(i);if(!F||!i){return false}return(F.compareDocumentPosition(i)&8)===8}var aM;if(av.compareDocumentPosition){aM=J}else{if(av.contains){aM=B}else{aM=D}}Object.extend(a3,{recursivelyCollect:am,ancestors:aL,descendants:bm,firstDescendant:X,immediateDescendants:bi,previousSiblings:p,nextSiblings:bh,siblings:aV,match:aR,up:aa,down:y,previous:h,next:aB,select:bb,adjacent:aD,descendantOf:aM,getElementsBySelector:bb,childElements:bi});var T=1;function aU(i){i=aZ(i);var F=aF.readAttribute(i,"id");if(F){return F}do{F="anonymous_element_"+T++}while(aZ(F));aF.writeAttribute(i,"id",F);return F}function a9(F,i){return aZ(F).getAttribute(i)}function K(F,i){F=aZ(F);var bp=aG.read;if(bp.values[i]){return bp.values[i](F,i)}if(bp.names[i]){i=bp.names[i]}if(i.include(":")){if(!F.attributes||!F.attributes[i]){return null}return F.attributes[i].value}return F.getAttribute(i)}function e(F,i){if(i==="title"){return F.title}return F.getAttribute(i)}var U=(function(){av.setAttribute("onclick",[]);var i=av.getAttribute("onclick");var F=Object.isArray(i);av.removeAttribute("onclick");return F})();if(U){a9=K}else{if(Prototype.Browser.Opera){a9=e}}function a0(bq,bp,bs){bq=aZ(bq);var F={},br=aG.write;if(typeof bp==="object"){F=bp}else{F[bp]=Object.isUndefined(bs)?true:bs}for(var i in F){bp=br.names[i]||i;bs=F[i];if(br.values[i]){bs=br.values[i](bq,bs);if(Object.isUndefined(bs)){continue}}if(bs===false||bs===null){bq.removeAttribute(bp)}else{if(bs===true){bq.setAttribute(bp,bp)}else{bq.setAttribute(bp,bs)}}}return bq}var a=(function(){if(!d){return false}var F=document.createElement('<input type="checkbox">');F.checked=true;var i=F.getAttributeNode("checked");return !i||!i.specified})();function Y(i,bp){bp=aG.has[bp]||bp;var F=aZ(i).getAttributeNode(bp);return !!(F&&F.specified)}function bg(i,F){if(F==="checked"){return i.checked}return Y(i,F)}a8.Element.Methods.Simulated.hasAttribute=a?bg:Y;function k(i){return new aF.ClassNames(i)}var V={};function f(F){if(V[F]){return V[F]}var i=new RegExp("(^|\\s+)"+F+"(\\s+|$)");V[F]=i;return i}function al(i,F){if(!(i=aZ(i))){return}var bp=i.className;if(bp.length===0){return false}if(bp===F){return true}return f(F).test(bp)}function o(i,F){if(!(i=aZ(i))){return}if(!al(i,F)){i.className+=(i.className?" ":"")+F}return i}function au(i,F){if(!(i=aZ(i))){return}i.className=i.className.replace(f(F)," ").strip();return i}function ae(F,bp,i){if(!(F=aZ(F))){return}if(Object.isUndefined(i)){i=!al(F,bp)}var bq=aF[i?"addClassName":"removeClassName"];return bq(F,bp)}var aG={};var aP="className",ar="for";av.setAttribute(aP,"x");if(av.className!=="x"){av.setAttribute("class","x");if(av.className==="x"){aP="class"}}var aK=document.createElement("label");aK.setAttribute(ar,"x");if(aK.htmlFor!=="x"){aK.setAttribute("htmlFor","x");if(aK.htmlFor==="x"){ar="htmlFor"}}aK=null;function ac(i,F){return i.getAttribute(F)}function g(i,F){return i.getAttribute(F,2)}function A(i,bp){var F=i.getAttributeNode(bp);return F?F.value:""}function bj(i,F){return aZ(i).hasAttribute(F)?F:null}av.onclick=Prototype.emptyFunction;var P=av.getAttribute("onclick");var aw;if(String(P).indexOf("{")>-1){aw=function(i,F){var bp=i.getAttribute(F);if(!bp){return null}bp=bp.toString();bp=bp.split("{")[1];bp=bp.split("}")[0];return bp.strip()}}else{if(P===""){aw=function(i,F){var bp=i.getAttribute(F);if(!bp){return null}return bp.strip()}}}aG.read={names:{"class":aP,className:aP,"for":ar,htmlFor:ar},values:{style:function(i){return i.style.cssText.toLowerCase()},title:function(i){return i.title}}};aG.write={names:{className:"class",htmlFor:"for",cellpadding:"cellPadding",cellspacing:"cellSpacing"},values:{checked:function(i,F){F=!!F;i.checked=F;return F?"checked":null},style:function(i,F){i.style.cssText=F?F:""}}};aG.has={names:{}};Object.extend(aG.write.names,aG.read.names);var a6=$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder");for(var af=0,ag;ag=a6[af];af++){aG.write.names[ag.toLowerCase()]=ag;aG.has.names[ag.toLowerCase()]=ag}Object.extend(aG.read.values,{href:g,src:g,type:ac,action:A,disabled:bj,checked:bj,readonly:bj,multiple:bj,onload:aw,onunload:aw,onclick:aw,ondblclick:aw,onmousedown:aw,onmouseup:aw,onmouseover:aw,onmousemove:aw,onmouseout:aw,onfocus:aw,onblur:aw,onkeypress:aw,onkeydown:aw,onkeyup:aw,onsubmit:aw,onreset:aw,onselect:aw,onchange:aw});Object.extend(a3,{identify:aU,readAttribute:a9,writeAttribute:a0,classNames:k,hasClassName:al,addClassName:o,removeClassName:au,toggleClassName:ae});function W(i){if(i==="float"||i==="styleFloat"){return"cssFloat"}return i.camelize()}function bo(i){if(i==="float"||i==="cssFloat"){return"styleFloat"}return i.camelize()}function C(bp,bq){bp=aZ(bp);var bt=bp.style,F;if(Object.isString(bq)){bt.cssText+=";"+bq;if(bq.include("opacity")){var i=bq.match(/opacity:\s*(\d?\.?\d*)/)[1];aF.setOpacity(bp,i)}return bp}for(var bs in bq){if(bs==="opacity"){aF.setOpacity(bp,bq[bs])}else{var br=bq[bs];if(bs==="float"||bs==="cssFloat"){bs=Object.isUndefined(bt.styleFloat)?"cssFloat":"styleFloat"}bt[bs]=br}}return bp}function aO(F,bp){F=aZ(F);bp=W(bp);var bq=F.style[bp];if(!bq||bq==="auto"){var i=document.defaultView.getComputedStyle(F,null);bq=i?i[bp]:null}if(bp==="opacity"){return bq?parseFloat(bq):1}return bq==="auto"?null:bq}function s(i,F){switch(F){case"height":case"width":if(!aF.visible(i)){return null}var bp=parseInt(aO(i,F),10);if(bp!==i["offset"+F.capitalize()]){return bp+"px"}return aF.measure(i,F);default:return aO(i,F)}}function aj(i,F){i=aZ(i);F=bo(F);var bp=i.style[F];if(!bp&&i.currentStyle){bp=i.currentStyle[F]}if(F==="opacity"){if(!N){return be(i)}else{return bp?parseFloat(bp):1}}if(bp==="auto"){if((F==="width"||F==="height")&&aF.visible(i)){return aF.measure(i,F)+"px"}return null}return bp}function aA(i){return(i||"").replace(/alpha\([^\)]*\)/gi,"")}function ab(i){if(!i.currentStyle||!i.currentStyle.hasLayout){i.style.zoom=1}return i}var N=(function(){av.style.cssText="opacity:.55";return/^0.55/.test(av.style.opacity)})();function z(i,F){i=aZ(i);if(F==1||F===""){F=""}else{if(F<0.00001){F=0}}i.style.opacity=F;return i}function bf(i,bq){if(N){return z(i,bq)}i=ab(aZ(i));var bp=aF.getStyle(i,"filter"),F=i.style;if(bq==1||bq===""){bp=aA(bp);if(bp){F.filter=bp}else{F.removeAttribute("filter")}return i}if(bq<0.00001){bq=0}F.filter=aA(bp)+" alpha(opacity="+(bq*100)+")";return i}function bd(i){return aF.getStyle(i,"opacity")}function be(F){if(N){return bd(F)}var bp=aF.getStyle(F,"filter");if(bp.length===0){return 1}var i=(bp||"").match(/alpha\(opacity=(.*)\)/i);if(i&&i[1]){return parseFloat(i[1])/100}return 1}Object.extend(a3,{setStyle:C,getStyle:aO,setOpacity:z,getOpacity:bd});if("styleFloat" in av.style){a3.getStyle=aj;a3.setOpacity=bf;a3.getOpacity=be}var l=0;a8.Element.Storage={UID:1};function M(i){if(i===window){return 0}if(typeof i._prototypeUID==="undefined"){i._prototypeUID=aF.Storage.UID++}return i._prototypeUID}function c(i){if(i===window){return 0}if(i==document){return 1}return i.uniqueID}var aY=("uniqueID" in av);if(aY){M=c}function b(F){if(!(F=aZ(F))){return}var i=M(F);if(!aF.Storage[i]){aF.Storage[i]=$H()}return aF.Storage[i]}function a5(F,i,bp){if(!(F=aZ(F))){return}var bq=b(F);if(arguments.length===2){bq.update(i)}else{bq.set(i,bp)}return F}function aN(bp,F,i){if(!(bp=aZ(bp))){return}var br=b(bp),bq=br.get(F);if(Object.isUndefined(bq)){br.set(F,i);bq=i}return bq}Object.extend(a3,{getStorage:b,store:a5,retrieve:aN});var an={},aX=aF.Methods.ByTag,aC=Prototype.BrowserFeatures;if(!aC.ElementExtensions&&("__proto__" in av)){a8.HTMLElement={};a8.HTMLElement.prototype=av.__proto__;aC.ElementExtensions=true}function bc(i){if(typeof window.Element==="undefined"){return false}if(!d){return false}var bp=window.Element.prototype;if(bp){var br="_"+(Math.random()+"").slice(2),F=document.createElement(i);bp[br]="x";var bq=(F[br]!=="x");delete bp[br];F=null;return bq}return false}var ap=bc("object");function ak(F,i){for(var bq in i){var bp=i[bq];if(Object.isFunction(bp)&&!(bq in F)){F[bq]=bp.methodize()}}}var bk={};function ay(F){var i=M(F);return(i in bk)}function az(bp){if(!bp||ay(bp)){return bp}if(bp.nodeType!==Node.ELEMENT_NODE||bp==window){return bp}var i=Object.clone(an),F=bp.tagName.toUpperCase();if(aX[F]){Object.extend(i,aX[F])}ak(bp,i);bk[M(bp)]=true;return bp}function aS(F){if(!F||ay(F)){return F}var i=F.tagName;if(i&&(/^(?:object|applet|embed)$/i.test(i))){ak(F,aF.Methods);ak(F,aF.Methods.Simulated);ak(F,aF.Methods.ByTag[i.toUpperCase()])}return F}if(aC.SpecificElementExtensions){az=ap?aS:Prototype.K}function S(F,i){F=F.toUpperCase();if(!aX[F]){aX[F]={}}Object.extend(aX[F],i)}function q(F,bp,i){if(Object.isUndefined(i)){i=false}for(var br in bp){var bq=bp[br];if(!Object.isFunction(bq)){continue}if(!i||!(br in F)){F[br]=bq.methodize()}}}function ai(bq){var i;var bp={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(bp[bq]){i="HTML"+bp[bq]+"Element"}if(window[i]){return window[i]}i="HTML"+bq+"Element";if(window[i]){return window[i]}i="HTML"+bq.capitalize()+"Element";if(window[i]){return window[i]}var F=document.createElement(bq),br=F.__proto__||F.constructor.prototype;F=null;return br}function R(br){if(arguments.length===0){G()}if(arguments.length===2){var bt=br;br=arguments[1]}if(!bt){Object.extend(aF.Methods,br||{})}else{if(Object.isArray(bt)){for(var bs=0,bq;bq=bt[bs];bs++){S(bq,br)}}else{S(bt,br)}}var bp=window.HTMLElement?HTMLElement.prototype:aF.prototype;if(aC.ElementExtensions){q(bp,aF.Methods);q(bp,aF.Methods.Simulated,true)}if(aC.SpecificElementExtensions){for(var bq in aF.Methods.ByTag){var F=ai(bq);if(Object.isUndefined(F)){continue}q(F.prototype,aX[bq])}}Object.extend(aF,aF.Methods);Object.extend(aF,aF.Methods.Simulated);delete aF.ByTag;delete aF.Simulated;aF.extend.refresh();r={}}Object.extend(a8.Element,{extend:az,addMethods:R});if(az===Prototype.K){a8.Element.extend.refresh=Prototype.emptyFunction}else{a8.Element.extend.refresh=function(){if(Prototype.BrowserFeatures.ElementExtensions){return}Object.extend(an,aF.Methods);Object.extend(an,aF.Methods.Simulated);bk={}}}function G(){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(aF.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods),BUTTON:Object.clone(Form.Element.Methods)})}aF.addMethods(a3);function n(){av=null;r=null}if(window.attachEvent){window.attachEvent("onunload",n)}})(this);(function(){function k(G){var F=G.match(/^(\d+)%?$/i);if(!F){return null}return(Number(F[1])/100)}function y(G,H){G=$(G);var I=G.style[H];if(!I||I==="auto"){var F=document.defaultView.getComputedStyle(G,null);I=F?F[H]:null}if(H==="opacity"){return I?parseFloat(I):1}return I==="auto"?null:I}function B(F,G){var H=F.style[G];if(!H&&F.currentStyle){H=F.currentStyle[G]}return H}function r(H,G){var J=H.offsetWidth;var L=u(H,"borderLeftWidth",G)||0;var F=u(H,"borderRightWidth",G)||0;var I=u(H,"paddingLeft",G)||0;var K=u(H,"paddingRight",G)||0;return J-L-F-I-K}if(!Object.isUndefined(document.documentElement.currentStyle)&&!Prototype.Browser.Opera){y=B}function u(P,Q,G){var J=null;if(Object.isElement(P)){J=P;P=y(J,Q)}if(P===null||Object.isUndefined(P)){return null}if((/^(?:-)?\d+(\.\d+)?(px)?$/i).test(P)){return window.parseFloat(P)}var K=P.include("%"),H=(G===document.viewport);if(/\d/.test(P)&&J&&J.runtimeStyle&&!(K&&H)){var F=J.style.left,O=J.runtimeStyle.left;J.runtimeStyle.left=J.currentStyle.left;J.style.left=P||0;P=J.style.pixelLeft;J.style.left=F;J.runtimeStyle.left=O;return P}if(J&&K){G=G||J.parentNode;var I=k(P),L=null;var N=Q.include("left")||Q.include("right")||Q.include("width");var M=Q.include("top")||Q.include("bottom")||Q.include("height");if(G===document.viewport){if(N){L=document.viewport.getWidth()}else{if(M){L=document.viewport.getHeight()}}}else{if(N){L=$(G).measure("width")}else{if(M){L=$(G).measure("height")}}}return(L===null)?0:L*I}return 0}function j(F){if(Object.isString(F)&&F.endsWith("px")){return F}return F+"px"}function m(F){while(F&&F.parentNode){var G=F.getStyle("display");if(G==="none"){return false}F=$(F.parentNode)}return true}var g=Prototype.K;if("currentStyle" in document.documentElement){g=function(F){if(!F.currentStyle.hasLayout){F.style.zoom=1}return F}}function i(F){if(F.include("border")){F=F+"-width"}return F.camelize()}Element.Layout=Class.create(Hash,{initialize:function($super,G,F){$super();this.element=$(G);Element.Layout.PROPERTIES.each(function(H){this._set(H,null)},this);if(F){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(G,F){return Hash.prototype.set.call(this,G,F)},set:function(G,F){throw"Properties of Element.Layout are read-only."},get:function($super,G){var F=$super(G);return F===null?this._compute(G):F},_begin:function(){if(this._isPrepared()){return}var J=this.element;if(m(J)){this._setPrepared(true);return}var L={position:J.style.position||"",width:J.style.width||"",visibility:J.style.visibility||"",display:J.style.display||""};J.store("prototype_original_styles",L);var M=y(J,"position"),F=J.offsetWidth;if(F===0||F===null){J.style.display="block";F=J.offsetWidth}var G=(M==="fixed")?document.viewport:J.parentNode;var N={visibility:"hidden",display:"block"};if(M!=="fixed"){N.position="absolute"}J.setStyle(N);var H=J.offsetWidth,I;if(F&&(H===F)){I=r(J,G)}else{if(M==="absolute"||M==="fixed"){I=r(J,G)}else{var O=J.parentNode,K=$(O).getLayout();I=K.get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right")}}J.setStyle({width:I+"px"});this._setPrepared(true)},_end:function(){var G=this.element;var F=G.retrieve("prototype_original_styles");G.store("prototype_original_styles",null);G.setStyle(F);this._setPrepared(false)},_compute:function(G){var F=Element.Layout.COMPUTATIONS;if(!(G in F)){throw"Property not found."}return this._set(G,F[G].call(this,this.element))},_isPrepared:function(){return this.element.retrieve("prototype_element_layout_prepared",false)},_setPrepared:function(F){return this.element.store("prototype_element_layout_prepared",F)},toObject:function(){var F=$A(arguments);var G=(F.length===0)?Element.Layout.PROPERTIES:F.join(" ").split(" ");var H={};G.each(function(I){if(!Element.Layout.PROPERTIES.include(I)){return}var J=this.get(I);if(J!=null){H[I]=J}},this);return H},toHash:function(){var F=this.toObject.apply(this,arguments);return new Hash(F)},toCSS:function(){var F=$A(arguments);var H=(F.length===0)?Element.Layout.PROPERTIES:F.join(" ").split(" ");var G={};H.each(function(I){if(!Element.Layout.PROPERTIES.include(I)){return}if(Element.Layout.COMPOSITE_PROPERTIES.include(I)){return}var J=this.get(I);if(J!=null){G[i(I)]=J+"px"}},this);return G},inspect:function(){return"#<Element.Layout>"}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(H){if(!this._preComputing){this._begin()}var F=this.get("border-box-height");if(F<=0){if(!this._preComputing){this._end()}return 0}var I=this.get("border-top"),G=this.get("border-bottom");var K=this.get("padding-top"),J=this.get("padding-bottom");if(!this._preComputing){this._end()}return F-I-G-K-J},width:function(H){if(!this._preComputing){this._begin()}var G=this.get("border-box-width");if(G<=0){if(!this._preComputing){this._end()}return 0}var K=this.get("border-left"),F=this.get("border-right");var I=this.get("padding-left"),J=this.get("padding-right");if(!this._preComputing){this._end()}return G-K-F-I-J},"padding-box-height":function(G){var F=this.get("height"),I=this.get("padding-top"),H=this.get("padding-bottom");return F+I+H},"padding-box-width":function(F){var G=this.get("width"),H=this.get("padding-left"),I=this.get("padding-right");return G+H+I},"border-box-height":function(G){if(!this._preComputing){this._begin()}var F=G.offsetHeight;if(!this._preComputing){this._end()}return F},"border-box-width":function(F){if(!this._preComputing){this._begin()}var G=F.offsetWidth;if(!this._preComputing){this._end()}return G},"margin-box-height":function(G){var F=this.get("border-box-height"),H=this.get("margin-top"),I=this.get("margin-bottom");if(F<=0){return 0}return F+H+I},"margin-box-width":function(H){var G=this.get("border-box-width"),I=this.get("margin-left"),F=this.get("margin-right");if(G<=0){return 0}return G+I+F},top:function(F){var G=F.positionedOffset();return G.top},bottom:function(F){var I=F.positionedOffset(),G=F.getOffsetParent(),H=G.measure("height");var J=this.get("border-box-height");return H-J-I.top},left:function(F){var G=F.positionedOffset();return G.left},right:function(H){var J=H.positionedOffset(),I=H.getOffsetParent(),F=I.measure("width");var G=this.get("border-box-width");return F-G-J.left},"padding-top":function(F){return u(F,"paddingTop")},"padding-bottom":function(F){return u(F,"paddingBottom")},"padding-left":function(F){return u(F,"paddingLeft")},"padding-right":function(F){return u(F,"paddingRight")},"border-top":function(F){return u(F,"borderTopWidth")},"border-bottom":function(F){return u(F,"borderBottomWidth")},"border-left":function(F){return u(F,"borderLeftWidth")},"border-right":function(F){return u(F,"borderRightWidth")},"margin-top":function(F){return u(F,"marginTop")},"margin-bottom":function(F){return u(F,"marginBottom")},"margin-left":function(F){return u(F,"marginLeft")},"margin-right":function(F){return u(F,"marginRight")}}});if("getBoundingClientRect" in document.documentElement){Object.extend(Element.Layout.COMPUTATIONS,{right:function(G){var H=g(G.getOffsetParent());var I=G.getBoundingClientRect(),F=H.getBoundingClientRect();return(F.right-I.right).round()},bottom:function(G){var H=g(G.getOffsetParent());var I=G.getBoundingClientRect(),F=H.getBoundingClientRect();return(F.bottom-I.bottom).round()}})}Element.Offset=Class.create({initialize:function(G,F){this.left=G.round();this.top=F.round();this[0]=this.left;this[1]=this.top},relativeTo:function(F){return new Element.Offset(this.left-F.left,this.top-F.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}});function z(G,F){return new Element.Layout(G,F)}function d(F,G){return $(F).getLayout().get(G)}function q(F){return Element.getDimensions(F).height}function c(F){return Element.getDimensions(F).width}function s(G){G=$(G);var K=Element.getStyle(G,"display");if(K&&K!=="none"){return{width:G.offsetWidth,height:G.offsetHeight}}var H=G.style;var F={visibility:H.visibility,position:H.position,display:H.display};var J={visibility:"hidden",display:"block"};if(F.position!=="fixed"){J.position="absolute"}Element.setStyle(G,J);var I={width:G.offsetWidth,height:G.offsetHeight};Element.setStyle(G,F);return I}function p(F){F=$(F);function H(I){return n(I)?$(document.body):$(I)}if(h(F)||f(F)||o(F)||n(F)){return $(document.body)}var G=(Element.getStyle(F,"display")==="inline");if(!G&&F.offsetParent){return H(F.offsetParent)}while((F=F.parentNode)&&F!==document.body){if(Element.getStyle(F,"position")!=="static"){return H(F)}}return $(document.body)}function C(G){G=$(G);var F=0,H=0;if(G.parentNode){do{F+=G.offsetTop||0;H+=G.offsetLeft||0;G=G.offsetParent}while(G)}return new Element.Offset(H,F)}function w(G){G=$(G);var H=G.getLayout();var F=0,J=0;do{F+=G.offsetTop||0;J+=G.offsetLeft||0;G=G.offsetParent;if(G){if(o(G)){break}var I=Element.getStyle(G,"position");if(I!=="static"){break}}}while(G);J-=H.get("margin-left");F-=H.get("margin-top");return new Element.Offset(J,F)}function b(G){var F=0,H=0;do{if(G===document.body){var I=document.documentElement||document.body.parentNode||document.body;F+=!Object.isUndefined(window.pageYOffset)?window.pageYOffset:I.scrollTop||0;H+=!Object.isUndefined(window.pageXOffset)?window.pageXOffset:I.scrollLeft||0;break}else{F+=G.scrollTop||0;H+=G.scrollLeft||0;G=G.parentNode}}while(G);return new Element.Offset(H,F)}function A(J){var F=0,I=0,H=document.body;J=$(J);var G=J;do{F+=G.offsetTop||0;I+=G.offsetLeft||0;if(G.offsetParent==H&&Element.getStyle(G,"position")=="absolute"){break}}while(G=G.offsetParent);G=J;do{if(G!=H){F-=G.scrollTop||0;I-=G.scrollLeft||0}}while(G=G.parentNode);return new Element.Offset(I,F)}function x(F){F=$(F);if(Element.getStyle(F,"position")==="absolute"){return F}var J=p(F);var I=F.viewportOffset(),G=J.viewportOffset();var K=I.relativeTo(G);var H=F.getLayout();F.store("prototype_absolutize_original_styles",{position:F.getStyle("position"),left:F.getStyle("left"),top:F.getStyle("top"),width:F.getStyle("width"),height:F.getStyle("height")});F.setStyle({position:"absolute",top:K.top+"px",left:K.left+"px",width:H.get("width")+"px",height:H.get("height")+"px"});return F}function l(G){G=$(G);if(Element.getStyle(G,"position")==="relative"){return G}var F=G.retrieve("prototype_absolutize_original_styles");if(F){G.setStyle(F)}return G}function a(F){F=$(F);var G=Element.cumulativeOffset(F);window.scrollTo(G.left,G.top);return F}function v(G){G=$(G);var F=Element.getStyle(G,"position"),H={};if(F==="static"||!F){H.position="relative";if(Prototype.Browser.Opera){H.top=0;H.left=0}Element.setStyle(G,H);Element.store(G,"prototype_made_positioned",true)}return G}function t(F){F=$(F);var H=Element.getStorage(F),G=H.get("prototype_made_positioned");if(G){H.unset("prototype_made_positioned");Element.setStyle(F,{position:"",top:"",bottom:"",left:"",right:""})}return F}function e(G){G=$(G);var I=Element.getStorage(G),F=I.get("prototype_made_clipping");if(Object.isUndefined(F)){var H=Element.getStyle(G,"overflow");I.set("prototype_made_clipping",H);if(H!=="hidden"){G.style.overflow="hidden"}}return G}function D(F){F=$(F);var H=Element.getStorage(F),G=H.get("prototype_made_clipping");if(!Object.isUndefined(G)){H.unset("prototype_made_clipping");F.style.overflow=G||""}return F}function E(I,F,Q){Q=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},Q||{});var H=document.documentElement;F=$(F);I=$(I);var G,O,K,P={};if(Q.setLeft||Q.setTop){G=Element.viewportOffset(F);O=[0,0];if(Element.getStyle(I,"position")==="absolute"){var N=Element.getOffsetParent(I);if(N!==document.body){O=Element.viewportOffset(N)}}}function L(){var R=0,S=0;if(Object.isNumber(window.pageXOffset)){R=window.pageXOffset;S=window.pageYOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){R=document.body.scrollLeft;S=document.body.scrollTop}else{if(H&&(H.scrollLeft||H.scrollTop)){R=H.scrollLeft;S=H.scrollTop}}}return{x:R,y:S}}var J=L();if(Q.setWidth||Q.setHeight){K=Element.getLayout(F)}if(Q.setLeft){P.left=(G[0]+J.x-O[0]+Q.offsetLeft)+"px"}if(Q.setTop){P.top=(G[1]+J.y-O[1]+Q.offsetTop)+"px"}var M=I.getLayout();if(Q.setWidth){P.width=K.get("width")+"px"}if(Q.setHeight){P.height=K.get("height")+"px"}return Element.setStyle(I,P)}if(Prototype.Browser.IE){p=p.wrap(function(H,G){G=$(G);if(h(G)||f(G)||o(G)||n(G)){return $(document.body)}var F=G.getStyle("position");if(F!=="static"){return H(G)}G.setStyle({position:"relative"});var I=H(G);G.setStyle({position:F});return I});w=w.wrap(function(I,G){G=$(G);if(!G.parentNode){return new Element.Offset(0,0)}var F=G.getStyle("position");if(F!=="static"){return I(G)}var H=G.getOffsetParent();if(H&&H.getStyle("position")==="fixed"){g(H)}G.setStyle({position:"relative"});var J=I(G);G.setStyle({position:F});return J})}else{if(Prototype.Browser.Webkit){C=function(G){G=$(G);var F=0,H=0;do{F+=G.offsetTop||0;H+=G.offsetLeft||0;if(G.offsetParent==document.body){if(Element.getStyle(G,"position")=="absolute"){break}}G=G.offsetParent}while(G);return new Element.Offset(H,F)}}}Element.addMethods({getLayout:z,measure:d,getWidth:c,getHeight:q,getDimensions:s,getOffsetParent:p,cumulativeOffset:C,positionedOffset:w,cumulativeScrollOffset:b,viewportOffset:A,absolutize:x,relativize:l,scrollTo:a,makePositioned:v,undoPositioned:t,makeClipping:e,undoClipping:D,clonePosition:E});function o(F){return F.nodeName.toUpperCase()==="BODY"}function n(F){return F.nodeName.toUpperCase()==="HTML"}function h(F){return F.nodeType===Node.DOCUMENT_NODE}function f(F){return F!==document.body&&!Element.descendantOf(F,document.body)}if("getBoundingClientRect" in document.documentElement){Element.addMethods({viewportOffset:function(F){F=$(F);if(f(F)){return new Element.Offset(0,0)}var G=F.getBoundingClientRect(),H=document.documentElement;return new Element.Offset(G.left-H.clientLeft,G.top-H.clientTop)}})}})();(function(){var c=Prototype.Browser.Opera&&(window.parseFloat(window.opera.version())<9.5);var f=null;function b(){if(f){return f}f=c?document.body:document.documentElement;return f}function d(){return{width:this.getWidth(),height:this.getHeight()}}function a(){return b().clientWidth}function g(){return b().clientHeight}function e(){var h=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;var i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;return new Element.Offset(h,i)}document.viewport={getDimensions:d,getWidth:a,getHeight:g,getScrollOffsets:e}})();window.$$=function(){var a=$A(arguments).join(", ");return Prototype.Selector.select(a,document)};Prototype.Selector=(function(){function a(){throw new Error('Method "Prototype.Selector.select" must be defined.')}function c(){throw new Error('Method "Prototype.Selector.match" must be defined.')}function d(l,m,h){h=h||0;var g=Prototype.Selector.match,k=l.length,f=0,j;for(j=0;j<k;j++){if(g(l[j],m)&&h==f++){return Element.extend(l[j])}}}function e(h){for(var f=0,g=h.length;f<g;f++){Element.extend(h[f])}return h}var b=Prototype.K;return{select:a,match:c,find:d,extendElements:(Element.extend===b)?b:e,extendElement:Element.extend}})();Prototype._original_property=window.Sizzle;(function(){function a(b){Prototype._actual_sizzle=b()}a.amd=true;if(typeof define!=="undefined"&&define.amd){Prototype._original_define=define;Prototype._actual_sizzle=null;window.define=a}})();
/*!
 * Sizzle CSS Selector Engine v1.10.18
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-02-05
 */
(function(av){var D,ay,t,M,P,ab,ax,aC,N,ac,ae,H,u,an,ai,aw,k,K,ap="sizzle"+-(new Date()),O=av.document,az=0,aj=0,d=F(),ao=F(),L=F(),J=function(i,e){if(i===e){ac=true}return 0},au=typeof undefined,V=1<<31,T=({}).hasOwnProperty,ar=[],at=ar.pop,R=ar.push,b=ar.push,s=ar.slice,j=ar.indexOf||function(aE){var aD=0,e=this.length;for(;aD<e;aD++){if(this[aD]===aE){return aD}}return -1},c="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",v="[\\x20\\t\\r\\n\\f]",a="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Q=a.replace("w","w#"),al="\\["+v+"*("+a+")"+v+"*(?:([*^$|!~]?=)"+v+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+Q+")|)|)"+v+"*\\]",q=":("+a+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+al.replace(3,8)+")*)|.*)\\)|)",x=new RegExp("^"+v+"+|((?:^|[^\\\\])(?:\\\\.)*)"+v+"+$","g"),A=new RegExp("^"+v+"*,"+v+"*"),G=new RegExp("^"+v+"*([>+~]|"+v+")"+v+"*"),z=new RegExp("="+v+"*([^\\]'\"]*?)"+v+"*\\]","g"),X=new RegExp(q),Z=new RegExp("^"+Q+"$"),ah={ID:new RegExp("^#("+a+")"),CLASS:new RegExp("^\\.("+a+")"),TAG:new RegExp("^("+a.replace("w","w*")+")"),ATTR:new RegExp("^"+al),PSEUDO:new RegExp("^"+q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+v+"*(even|odd|(([+-]|)(\\d*)n|)"+v+"*(?:([+-]|)"+v+"*(\\d+)|))"+v+"*\\)|)","i"),bool:new RegExp("^(?:"+c+")$","i"),needsContext:new RegExp("^"+v+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+v+"*((?:-\\d)?\\d*)"+v+"*\\)|)(?=[^-]|$)","i")},h=/^(?:input|select|textarea|button)$/i,r=/^h\d$/i,U=/^[^{]+\{\s*\[native \w/,W=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ag=/[+~]/,S=/'|\\/g,y=new RegExp("\\\\([\\da-f]{1,6}"+v+"?|("+v+")|.)","ig"),ak=function(e,aE,i){var aD="0x"+aE-65536;return aD!==aD||i?aE:aD<0?String.fromCharCode(aD+65536):String.fromCharCode(aD>>10|55296,aD&1023|56320)};try{b.apply((ar=s.call(O.childNodes)),O.childNodes);ar[O.childNodes.length].nodeType}catch(I){b={apply:ar.length?function(i,e){R.apply(i,s.call(e))}:function(aF,aE){var e=aF.length,aD=0;while((aF[e++]=aE[aD++])){}aF.length=e-1}}}function B(aK,aD,aO,aQ){var aP,aH,aI,aM,aN,aG,aF,e,aE,aL;if((aD?aD.ownerDocument||aD:O)!==H){ae(aD)}aD=aD||H;aO=aO||[];if(!aK||typeof aK!=="string"){return aO}if((aM=aD.nodeType)!==1&&aM!==9){return[]}if(an&&!aQ){if((aP=W.exec(aK))){if((aI=aP[1])){if(aM===9){aH=aD.getElementById(aI);if(aH&&aH.parentNode){if(aH.id===aI){aO.push(aH);return aO}}else{return aO}}else{if(aD.ownerDocument&&(aH=aD.ownerDocument.getElementById(aI))&&K(aD,aH)&&aH.id===aI){aO.push(aH);return aO}}}else{if(aP[2]){b.apply(aO,aD.getElementsByTagName(aK));return aO}else{if((aI=aP[3])&&ay.getElementsByClassName&&aD.getElementsByClassName){b.apply(aO,aD.getElementsByClassName(aI));return aO}}}}if(ay.qsa&&(!ai||!ai.test(aK))){e=aF=ap;aE=aD;aL=aM===9&&aK;if(aM===1&&aD.nodeName.toLowerCase()!=="object"){aG=n(aK);if((aF=aD.getAttribute("id"))){e=aF.replace(S,"\\$&")}else{aD.setAttribute("id",e)}e="[id='"+e+"'] ";aN=aG.length;while(aN--){aG[aN]=e+o(aG[aN])}aE=ag.test(aK)&&Y(aD.parentNode)||aD;aL=aG.join(",")}if(aL){try{b.apply(aO,aE.querySelectorAll(aL));return aO}catch(aJ){}finally{if(!aF){aD.removeAttribute("id")}}}}}return ax(aK.replace(x,"$1"),aD,aO,aQ)}function F(){var i=[];function e(aD,aE){if(i.push(aD+" ")>t.cacheLength){delete e[i.shift()]}return(e[aD+" "]=aE)}return e}function p(e){e[ap]=true;return e}function l(i){var aE=H.createElement("div");try{return !!i(aE)}catch(aD){return false}finally{if(aE.parentNode){aE.parentNode.removeChild(aE)}aE=null}}function aA(aD,aF){var e=aD.split("|"),aE=aD.length;while(aE--){t.attrHandle[e[aE]]=aF}}function f(i,e){var aE=e&&i,aD=aE&&i.nodeType===1&&e.nodeType===1&&(~e.sourceIndex||V)-(~i.sourceIndex||V);if(aD){return aD}if(aE){while((aE=aE.nextSibling)){if(aE===e){return -1}}}return i?1:-1}function C(e){return function(aD){var i=aD.nodeName.toLowerCase();return i==="input"&&aD.type===e}}function g(e){return function(aD){var i=aD.nodeName.toLowerCase();return(i==="input"||i==="button")&&aD.type===e}}function am(e){return p(function(i){i=+i;return p(function(aD,aH){var aF,aE=e([],aD.length,i),aG=aE.length;while(aG--){if(aD[(aF=aE[aG])]){aD[aF]=!(aH[aF]=aD[aF])}}})})}function Y(e){return e&&typeof e.getElementsByTagName!==au&&e}ay=B.support={};P=B.isXML=function(e){var i=e&&(e.ownerDocument||e).documentElement;return i?i.nodeName!=="HTML":false};ae=B.setDocument=function(aD){var e,aE=aD?aD.ownerDocument||aD:O,i=aE.defaultView;if(aE===H||aE.nodeType!==9||!aE.documentElement){return H}H=aE;u=aE.documentElement;an=!P(aE);if(i&&i!==i.top){if(i.addEventListener){i.addEventListener("unload",function(){ae()},false)}else{if(i.attachEvent){i.attachEvent("onunload",function(){ae()})}}}ay.attributes=l(function(aF){aF.className="i";return !aF.getAttribute("className")});ay.getElementsByTagName=l(function(aF){aF.appendChild(aE.createComment(""));return !aF.getElementsByTagName("*").length});ay.getElementsByClassName=U.test(aE.getElementsByClassName)&&l(function(aF){aF.innerHTML="<div class='a'></div><div class='a i'></div>";aF.firstChild.className="i";return aF.getElementsByClassName("i").length===2});ay.getById=l(function(aF){u.appendChild(aF).id=ap;return !aE.getElementsByName||!aE.getElementsByName(ap).length});if(ay.getById){t.find.ID=function(aH,aG){if(typeof aG.getElementById!==au&&an){var aF=aG.getElementById(aH);return aF&&aF.parentNode?[aF]:[]}};t.filter.ID=function(aG){var aF=aG.replace(y,ak);return function(aH){return aH.getAttribute("id")===aF}}}else{delete t.find.ID;t.filter.ID=function(aG){var aF=aG.replace(y,ak);return function(aI){var aH=typeof aI.getAttributeNode!==au&&aI.getAttributeNode("id");return aH&&aH.value===aF}}}t.find.TAG=ay.getElementsByTagName?function(aF,aG){if(typeof aG.getElementsByTagName!==au){return aG.getElementsByTagName(aF)}}:function(aF,aJ){var aK,aI=[],aH=0,aG=aJ.getElementsByTagName(aF);if(aF==="*"){while((aK=aG[aH++])){if(aK.nodeType===1){aI.push(aK)}}return aI}return aG};t.find.CLASS=ay.getElementsByClassName&&function(aG,aF){if(typeof aF.getElementsByClassName!==au&&an){return aF.getElementsByClassName(aG)}};aw=[];ai=[];if((ay.qsa=U.test(aE.querySelectorAll))){l(function(aF){aF.innerHTML="<select t=''><option selected=''></option></select>";if(aF.querySelectorAll("[t^='']").length){ai.push("[*^$]="+v+"*(?:''|\"\")")}if(!aF.querySelectorAll("[selected]").length){ai.push("\\["+v+"*(?:value|"+c+")")}if(!aF.querySelectorAll(":checked").length){ai.push(":checked")}});l(function(aG){var aF=aE.createElement("input");aF.setAttribute("type","hidden");aG.appendChild(aF).setAttribute("name","D");if(aG.querySelectorAll("[name=d]").length){ai.push("name"+v+"*[*^$|!~]?=")}if(!aG.querySelectorAll(":enabled").length){ai.push(":enabled",":disabled")}aG.querySelectorAll("*,:x");ai.push(",.*:")})}if((ay.matchesSelector=U.test((k=u.webkitMatchesSelector||u.mozMatchesSelector||u.oMatchesSelector||u.msMatchesSelector)))){l(function(aF){ay.disconnectedMatch=k.call(aF,"div");k.call(aF,"[s!='']:x");aw.push("!=",q)})}ai=ai.length&&new RegExp(ai.join("|"));aw=aw.length&&new RegExp(aw.join("|"));e=U.test(u.compareDocumentPosition);K=e||U.test(u.contains)?function(aG,aF){var aI=aG.nodeType===9?aG.documentElement:aG,aH=aF&&aF.parentNode;return aG===aH||!!(aH&&aH.nodeType===1&&(aI.contains?aI.contains(aH):aG.compareDocumentPosition&&aG.compareDocumentPosition(aH)&16))}:function(aG,aF){if(aF){while((aF=aF.parentNode)){if(aF===aG){return true}}}return false};J=e?function(aG,aF){if(aG===aF){ac=true;return 0}var aH=!aG.compareDocumentPosition-!aF.compareDocumentPosition;if(aH){return aH}aH=(aG.ownerDocument||aG)===(aF.ownerDocument||aF)?aG.compareDocumentPosition(aF):1;if(aH&1||(!ay.sortDetached&&aF.compareDocumentPosition(aG)===aH)){if(aG===aE||aG.ownerDocument===O&&K(O,aG)){return -1}if(aF===aE||aF.ownerDocument===O&&K(O,aF)){return 1}return N?(j.call(N,aG)-j.call(N,aF)):0}return aH&4?-1:1}:function(aG,aF){if(aG===aF){ac=true;return 0}var aM,aJ=0,aL=aG.parentNode,aI=aF.parentNode,aH=[aG],aK=[aF];if(!aL||!aI){return aG===aE?-1:aF===aE?1:aL?-1:aI?1:N?(j.call(N,aG)-j.call(N,aF)):0}else{if(aL===aI){return f(aG,aF)}}aM=aG;while((aM=aM.parentNode)){aH.unshift(aM)}aM=aF;while((aM=aM.parentNode)){aK.unshift(aM)}while(aH[aJ]===aK[aJ]){aJ++}return aJ?f(aH[aJ],aK[aJ]):aH[aJ]===O?-1:aK[aJ]===O?1:0};return aE};B.matches=function(i,e){return B(i,null,null,e)};B.matchesSelector=function(aD,aF){if((aD.ownerDocument||aD)!==H){ae(aD)}aF=aF.replace(z,"='$1']");if(ay.matchesSelector&&an&&(!aw||!aw.test(aF))&&(!ai||!ai.test(aF))){try{var i=k.call(aD,aF);if(i||ay.disconnectedMatch||aD.document&&aD.document.nodeType!==11){return i}}catch(aE){}}return B(aF,H,null,[aD]).length>0};B.contains=function(e,i){if((e.ownerDocument||e)!==H){ae(e)}return K(e,i)};B.attr=function(aD,e){if((aD.ownerDocument||aD)!==H){ae(aD)}var i=t.attrHandle[e.toLowerCase()],aE=i&&T.call(t.attrHandle,e.toLowerCase())?i(aD,e,!an):undefined;return aE!==undefined?aE:ay.attributes||!an?aD.getAttribute(e):(aE=aD.getAttributeNode(e))&&aE.specified?aE.value:null};B.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};B.uniqueSort=function(aE){var aF,aG=[],e=0,aD=0;ac=!ay.detectDuplicates;N=!ay.sortStable&&aE.slice(0);aE.sort(J);if(ac){while((aF=aE[aD++])){if(aF===aE[aD]){e=aG.push(aD)}}while(e--){aE.splice(aG[e],1)}}N=null;return aE};M=B.getText=function(aG){var aF,aD="",aE=0,e=aG.nodeType;if(!e){while((aF=aG[aE++])){aD+=M(aF)}}else{if(e===1||e===9||e===11){if(typeof aG.textContent==="string"){return aG.textContent}else{for(aG=aG.firstChild;aG;aG=aG.nextSibling){aD+=M(aG)}}}else{if(e===3||e===4){return aG.nodeValue}}}return aD};t=B.selectors={cacheLength:50,createPseudo:p,match:ah,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(y,ak);e[3]=(e[4]||e[5]||"").replace(y,ak);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){B.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+((e[7]+e[8])||e[3]==="odd")}else{if(e[3]){B.error(e[0])}}return e},PSEUDO:function(i){var e,aD=!i[5]&&i[2];if(ah.CHILD.test(i[0])){return null}if(i[3]&&i[4]!==undefined){i[2]=i[4]}else{if(aD&&X.test(aD)&&(e=n(aD,true))&&(e=aD.indexOf(")",aD.length-e)-aD.length)){i[0]=i[0].slice(0,e);i[2]=aD.slice(0,e)}}return i.slice(0,3)}},filter:{TAG:function(i){var e=i.replace(y,ak).toLowerCase();return i==="*"?function(){return true}:function(aD){return aD.nodeName&&aD.nodeName.toLowerCase()===e}},CLASS:function(e){var i=d[e+" "];return i||(i=new RegExp("(^|"+v+")"+e+"("+v+"|$)"))&&d(e,function(aD){return i.test(typeof aD.className==="string"&&aD.className||typeof aD.getAttribute!==au&&aD.getAttribute("class")||"")})},ATTR:function(aD,i,e){return function(aF){var aE=B.attr(aF,aD);if(aE==null){return i==="!="}if(!i){return true}aE+="";return i==="="?aE===e:i==="!="?aE!==e:i==="^="?e&&aE.indexOf(e)===0:i==="*="?e&&aE.indexOf(e)>-1:i==="$="?e&&aE.slice(-e.length)===e:i==="~="?(" "+aE+" ").indexOf(e)>-1:i==="|="?aE===e||aE.slice(0,e.length+1)===e+"-":false}},CHILD:function(i,aF,aE,aG,aD){var aI=i.slice(0,3)!=="nth",e=i.slice(-4)!=="last",aH=aF==="of-type";return aG===1&&aD===0?function(aJ){return !!aJ.parentNode}:function(aP,aN,aS){var aJ,aV,aQ,aU,aR,aM,aO=aI!==e?"nextSibling":"previousSibling",aT=aP.parentNode,aL=aH&&aP.nodeName.toLowerCase(),aK=!aS&&!aH;if(aT){if(aI){while(aO){aQ=aP;while((aQ=aQ[aO])){if(aH?aQ.nodeName.toLowerCase()===aL:aQ.nodeType===1){return false}}aM=aO=i==="only"&&!aM&&"nextSibling"}return true}aM=[e?aT.firstChild:aT.lastChild];if(e&&aK){aV=aT[ap]||(aT[ap]={});aJ=aV[i]||[];aR=aJ[0]===az&&aJ[1];aU=aJ[0]===az&&aJ[2];aQ=aR&&aT.childNodes[aR];while((aQ=++aR&&aQ&&aQ[aO]||(aU=aR=0)||aM.pop())){if(aQ.nodeType===1&&++aU&&aQ===aP){aV[i]=[az,aR,aU];break}}}else{if(aK&&(aJ=(aP[ap]||(aP[ap]={}))[i])&&aJ[0]===az){aU=aJ[1]}else{while((aQ=++aR&&aQ&&aQ[aO]||(aU=aR=0)||aM.pop())){if((aH?aQ.nodeName.toLowerCase()===aL:aQ.nodeType===1)&&++aU){if(aK){(aQ[ap]||(aQ[ap]={}))[i]=[az,aU]}if(aQ===aP){break}}}}}aU-=aD;return aU===aG||(aU%aG===0&&aU/aG>=0)}}},PSEUDO:function(aE,aD){var e,i=t.pseudos[aE]||t.setFilters[aE.toLowerCase()]||B.error("unsupported pseudo: "+aE);if(i[ap]){return i(aD)}if(i.length>1){e=[aE,aE,"",aD];return t.setFilters.hasOwnProperty(aE.toLowerCase())?p(function(aH,aJ){var aG,aF=i(aH,aD),aI=aF.length;while(aI--){aG=j.call(aH,aF[aI]);aH[aG]=!(aJ[aG]=aF[aI])}}):function(aF){return i(aF,0,e)}}return i}},pseudos:{not:p(function(e){var i=[],aD=[],aE=ab(e.replace(x,"$1"));return aE[ap]?p(function(aG,aL,aJ,aH){var aK,aF=aE(aG,null,aH,[]),aI=aG.length;while(aI--){if((aK=aF[aI])){aG[aI]=!(aL[aI]=aK)}}}):function(aH,aG,aF){i[0]=aH;aE(i,null,aF,aD);return !aD.pop()}}),has:p(function(e){return function(i){return B(e,i).length>0}}),contains:p(function(e){return function(i){return(i.textContent||i.innerText||M(i)).indexOf(e)>-1}}),lang:p(function(e){if(!Z.test(e||"")){B.error("unsupported lang: "+e)}e=e.replace(y,ak).toLowerCase();return function(aD){var i;do{if((i=an?aD.lang:aD.getAttribute("xml:lang")||aD.getAttribute("lang"))){i=i.toLowerCase();return i===e||i.indexOf(e+"-")===0}}while((aD=aD.parentNode)&&aD.nodeType===1);return false}}),target:function(e){var i=av.location&&av.location.hash;return i&&i.slice(1)===e.id},root:function(e){return e===u},focus:function(e){return e===H.activeElement&&(!H.hasFocus||H.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===false},disabled:function(e){return e.disabled===true},checked:function(e){var i=e.nodeName.toLowerCase();return(i==="input"&&!!e.checked)||(i==="option"&&!!e.selected)},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeType<6){return false}}return true},parent:function(e){return !t.pseudos.empty(e)},header:function(e){return r.test(e.nodeName)},input:function(e){return h.test(e.nodeName)},button:function(i){var e=i.nodeName.toLowerCase();return e==="input"&&i.type==="button"||e==="button"},text:function(i){var e;return i.nodeName.toLowerCase()==="input"&&i.type==="text"&&((e=i.getAttribute("type"))==null||e.toLowerCase()==="text")},first:am(function(){return[0]}),last:am(function(e,i){return[i-1]}),eq:am(function(e,aD,i){return[i<0?i+aD:i]}),even:am(function(e,aE){var aD=0;for(;aD<aE;aD+=2){e.push(aD)}return e}),odd:am(function(e,aE){var aD=1;for(;aD<aE;aD+=2){e.push(aD)}return e}),lt:am(function(e,aF,aE){var aD=aE<0?aE+aF:aE;for(;--aD>=0;){e.push(aD)}return e}),gt:am(function(e,aF,aE){var aD=aE<0?aE+aF:aE;for(;++aD<aF;){e.push(aD)}return e})}};t.pseudos.nth=t.pseudos.eq;for(D in {radio:true,checkbox:true,file:true,password:true,image:true}){t.pseudos[D]=C(D)}for(D in {submit:true,reset:true}){t.pseudos[D]=g(D)}function aa(){}aa.prototype=t.filters=t.pseudos;t.setFilters=new aa();function n(aF,aK){var i,aG,aI,aJ,aH,aD,e,aE=ao[aF+" "];if(aE){return aK?0:aE.slice(0)}aH=aF;aD=[];e=t.preFilter;while(aH){if(!i||(aG=A.exec(aH))){if(aG){aH=aH.slice(aG[0].length)||aH}aD.push((aI=[]))}i=false;if((aG=G.exec(aH))){i=aG.shift();aI.push({value:i,type:aG[0].replace(x," ")});aH=aH.slice(i.length)}for(aJ in t.filter){if((aG=ah[aJ].exec(aH))&&(!e[aJ]||(aG=e[aJ](aG)))){i=aG.shift();aI.push({value:i,type:aJ,matches:aG});aH=aH.slice(i.length)}}if(!i){break}}return aK?aH.length:aH?B.error(aF):ao(aF,aD).slice(0)}function o(aF){var aE=0,aD=aF.length,e="";for(;aE<aD;aE++){e+=aF[aE].value}return e}function w(aF,aD,aE){var e=aD.dir,aG=aE&&e==="parentNode",i=aj++;return aD.first?function(aJ,aI,aH){while((aJ=aJ[e])){if(aJ.nodeType===1||aG){return aF(aJ,aI,aH)}}}:function(aL,aJ,aI){var aM,aK,aH=[az,i];if(aI){while((aL=aL[e])){if(aL.nodeType===1||aG){if(aF(aL,aJ,aI)){return true}}}}else{while((aL=aL[e])){if(aL.nodeType===1||aG){aK=aL[ap]||(aL[ap]={});if((aM=aK[e])&&aM[0]===az&&aM[1]===i){return(aH[2]=aM[2])}else{aK[e]=aH;if((aH[2]=aF(aL,aJ,aI))){return true}}}}}}}function aB(e){return e.length>1?function(aG,aF,aD){var aE=e.length;while(aE--){if(!e[aE](aG,aF,aD)){return false}}return true}:e[0]}function E(aD,aG,aF){var aE=0,e=aG.length;for(;aE<e;aE++){B(aD,aG[aE],aF)}return aF}function af(e,aD,aE,aF,aI){var aG,aL=[],aH=0,aJ=e.length,aK=aD!=null;for(;aH<aJ;aH++){if((aG=e[aH])){if(!aE||aE(aG,aF,aI)){aL.push(aG);if(aK){aD.push(aH)}}}}return aL}function m(aD,i,aF,aE,aG,e){if(aE&&!aE[ap]){aE=m(aE)}if(aG&&!aG[ap]){aG=m(aG,e)}return p(function(aR,aO,aJ,aQ){var aT,aP,aL,aK=[],aS=[],aI=aO.length,aH=aR||E(i||"*",aJ.nodeType?[aJ]:aJ,[]),aM=aD&&(aR||!i)?af(aH,aK,aD,aJ,aQ):aH,aN=aF?aG||(aR?aD:aI||aE)?[]:aO:aM;if(aF){aF(aM,aN,aJ,aQ)}if(aE){aT=af(aN,aS);aE(aT,[],aJ,aQ);aP=aT.length;while(aP--){if((aL=aT[aP])){aN[aS[aP]]=!(aM[aS[aP]]=aL)}}}if(aR){if(aG||aD){if(aG){aT=[];aP=aN.length;while(aP--){if((aL=aN[aP])){aT.push((aM[aP]=aL))}}aG(null,(aN=[]),aT,aQ)}aP=aN.length;while(aP--){if((aL=aN[aP])&&(aT=aG?j.call(aR,aL):aK[aP])>-1){aR[aT]=!(aO[aT]=aL)}}}}else{aN=af(aN===aO?aN.splice(aI,aN.length):aN);if(aG){aG(null,aO,aN,aQ)}else{b.apply(aO,aN)}}})}function aq(aI){var aD,aG,aE,aH=aI.length,aL=t.relative[aI[0].type],aM=aL||t.relative[" "],aF=aL?1:0,aJ=w(function(i){return i===aD},aM,true),aK=w(function(i){return j.call(aD,i)>-1},aM,true),e=[function(aO,aN,i){return(!aL&&(i||aN!==aC))||((aD=aN).nodeType?aJ(aO,aN,i):aK(aO,aN,i))}];for(;aF<aH;aF++){if((aG=t.relative[aI[aF].type])){e=[w(aB(e),aG)]}else{aG=t.filter[aI[aF].type].apply(null,aI[aF].matches);if(aG[ap]){aE=++aF;for(;aE<aH;aE++){if(t.relative[aI[aE].type]){break}}return m(aF>1&&aB(e),aF>1&&o(aI.slice(0,aF-1).concat({value:aI[aF-2].type===" "?"*":""})).replace(x,"$1"),aG,aF<aE&&aq(aI.slice(aF,aE)),aE<aH&&aq((aI=aI.slice(aE))),aE<aH&&o(aI))}e.push(aG)}}return aB(e)}function ad(aE,aD){var e=aD.length>0,aF=aE.length>0,i=function(aP,aJ,aO,aN,aS){var aK,aL,aQ,aU=0,aM="0",aG=aP&&[],aV=[],aT=aC,aI=aP||aF&&t.find.TAG("*",aS),aH=(az+=aT==null?1:Math.random()||0.1),aR=aI.length;if(aS){aC=aJ!==H&&aJ}for(;aM!==aR&&(aK=aI[aM])!=null;aM++){if(aF&&aK){aL=0;while((aQ=aE[aL++])){if(aQ(aK,aJ,aO)){aN.push(aK);break}}if(aS){az=aH}}if(e){if((aK=!aQ&&aK)){aU--}if(aP){aG.push(aK)}}}aU+=aM;if(e&&aM!==aU){aL=0;while((aQ=aD[aL++])){aQ(aG,aV,aJ,aO)}if(aP){if(aU>0){while(aM--){if(!(aG[aM]||aV[aM])){aV[aM]=at.call(aN)}}}aV=af(aV)}b.apply(aN,aV);if(aS&&!aP&&aV.length>0&&(aU+aD.length)>1){B.uniqueSort(aN)}}if(aS){az=aH;aC=aT}return aG};return e?p(i):i}ab=B.compile=function(e,aE){var aF,aD=[],aH=[],aG=L[e+" "];if(!aG){if(!aE){aE=n(e)}aF=aE.length;while(aF--){aG=aq(aE[aF]);if(aG[ap]){aD.push(aG)}else{aH.push(aG)}}aG=L(e,ad(aH,aD));aG.selector=e}return aG};ax=B.select=function(aE,e,aF,aI){var aG,aL,aD,aM,aJ,aK=typeof aE==="function"&&aE,aH=!aI&&n((aE=aK.selector||aE));aF=aF||[];if(aH.length===1){aL=aH[0]=aH[0].slice(0);if(aL.length>2&&(aD=aL[0]).type==="ID"&&ay.getById&&e.nodeType===9&&an&&t.relative[aL[1].type]){e=(t.find.ID(aD.matches[0].replace(y,ak),e)||[])[0];if(!e){return aF}else{if(aK){e=e.parentNode}}aE=aE.slice(aL.shift().value.length)}aG=ah.needsContext.test(aE)?0:aL.length;while(aG--){aD=aL[aG];if(t.relative[(aM=aD.type)]){break}if((aJ=t.find[aM])){if((aI=aJ(aD.matches[0].replace(y,ak),ag.test(aL[0].type)&&Y(e.parentNode)||e))){aL.splice(aG,1);aE=aI.length&&o(aL);if(!aE){b.apply(aF,aI);return aF}break}}}}(aK||ab(aE,aH))(aI,e,!an,aF,ag.test(aE)&&Y(e.parentNode)||e);return aF};ay.sortStable=ap.split("").sort(J).join("")===ap;ay.detectDuplicates=!!ac;ae();ay.sortDetached=l(function(e){return e.compareDocumentPosition(H.createElement("div"))&1});if(!l(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){aA("type|href|height|width",function(i,e,aD){if(!aD){return i.getAttribute(e,e.toLowerCase()==="type"?1:2)}})}if(!ay.attributes||!l(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){aA("value",function(i,e,aD){if(!aD&&i.nodeName.toLowerCase()==="input"){return i.defaultValue}})}if(!l(function(e){return e.getAttribute("disabled")==null})){aA(c,function(i,e,aE){var aD;if(!aE){return i[e]===true?e.toLowerCase():(aD=i.getAttributeNode(e))&&aD.specified?aD.value:null}})}if(typeof define==="function"&&define.amd){define(function(){return B})}else{if(typeof module!=="undefined"&&module.exports){module.exports=B}else{av.Sizzle=B}}})(window);(function(){if(typeof Sizzle!=="undefined"){return}if(typeof define!=="undefined"&&define.amd){window.Sizzle=Prototype._actual_sizzle;window.define=Prototype._original_define;delete Prototype._actual_sizzle;delete Prototype._original_define}else{if(typeof module!=="undefined"&&module.exports){window.Sizzle=module.exports;module.exports={}}}})();(function(c){var d=Prototype.Selector.extendElements;function a(e,f){return d(c(e,f||document))}function b(f,e){return c.matches(e,[f]).length==1}Prototype.Selector.engine=c;Prototype.Selector.select=a;Prototype.Selector.match=b})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(h,d){if(typeof d!="object"){d={hash:!!d}}else{if(Object.isUndefined(d.hash)){d.hash=true}}var e,g,a=false,f=d.submit,b,c;if(d.hash){c={};b=function(i,j,k){if(j in i){if(!Object.isArray(i[j])){i[j]=[i[j]]}i[j]=i[j].concat(k)}else{i[j]=k}return i}}else{c="";b=function(i,k,j){if(!Object.isArray(j)){j=[j]}if(!j.length){return i}var l=encodeURIComponent(k).gsub(/%20/,"+");return i+(i?"&":"")+j.map(function(m){m=m.gsub(/(\r)?\n/,"\r\n");m=encodeURIComponent(m);m=m.gsub(/%20/,"+");return l+"="+m}).join("&")}}return h.inject(c,function(i,j){if(!j.disabled&&j.name){e=j.name;g=$(j).getValue();if(g!=null&&j.type!="file"&&(j.type!="submit"||(!a&&f!==false&&(!f||e==f)&&(a=true)))){i=b(i,e,g)}}return i})}};Form.Methods={serialize:function(b,a){return Form.serializeElements(Form.getElements(b),a)},getElements:function(e){var f=$(e).getElementsByTagName("*");var d,c=[],b=Form.Element.Serializers;for(var a=0;d=f[a];a++){if(b[d.tagName.toLowerCase()]){c.push(Element.extend(d))}}return c},getInputs:function(g,c,d){g=$(g);var a=g.getElementsByTagName("input");if(!c&&!d){return $A(a).map(Element.extend)}for(var e=0,h=[],f=a.length;e<f;e++){var b=a[e];if((c&&b.type!=c)||(d&&b.name!=d)){continue}h.push(Element.extend(b))}return h},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(b){var c=$(b).getElements().findAll(function(d){return"hidden"!=d.type&&!d.disabled});var a=c.findAll(function(d){return d.hasAttribute("tabIndex")&&d.tabIndex>=0}).sortBy(function(d){return d.tabIndex}).first();return a?a:c.find(function(d){return/^(?:input|select|textarea)$/i.test(d.tagName)})},focusFirstElement:function(b){b=$(b);var a=b.findFirstElement();if(a){a.activate()}return b}};Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();if(a.select&&(a.tagName.toLowerCase()!="input"||!(/^(?:button|reset|submit)$/i.test(a.type)))){a.select()}}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers=(function(){function b(h,i){switch(h.type.toLowerCase()){case"checkbox":case"radio":return f(h,i);default:return e(h,i)}}function f(h,i){if(Object.isUndefined(i)){return h.checked?h.value:null}else{h.checked=!!i}}function e(h,i){if(Object.isUndefined(i)){return h.value}else{h.value=i}}function a(k,n){if(Object.isUndefined(n)){return(k.type==="select-one"?c:d)(k)}var j,l,o=!Object.isArray(n);for(var h=0,m=k.length;h<m;h++){j=k.options[h];l=this.optionValue(j);if(o){if(l==n){j.selected=true;return}}else{j.selected=n.include(l)}}}function c(i){var h=i.selectedIndex;return h>=0?g(i.options[h]):null}function d(l){var h,m=l.length;if(!m){return null}for(var k=0,h=[];k<m;k++){var j=l.options[k];if(j.selected){h.push(g(j))}}return h}function g(h){return Element.hasAttribute(h,"value")?h.value:h.text}return{input:b,inputSelector:f,textarea:e,select:a,selectOne:c,selectMany:d,optionValue:g,button:e}})();Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,a,b,c){$super(c,b);this.element=$(a);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form"){this.registerFormCallbacks()}else{this.registerCallback(this.element)}},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type){switch(a.type.toLowerCase()){case"checkbox":case"radio":Event.observe(a,"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});(function(D){var u=document.createElement("div");var d=document.documentElement;var k="onmouseenter" in d&&"onmouseleave" in d;var L={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45};var A=function(X){return false};if(window.attachEvent){if(window.addEventListener){A=function(X){return !(X instanceof window.Event)}}else{A=function(X){return true}}}var O;function M(Y,X){return Y.which?(Y.which===X+1):(Y.button===X)}var W={0:1,1:4,2:2};function S(Y,X){return Y.button===W[X]}function P(Y,X){switch(X){case 0:return Y.which==1&&!Y.metaKey;case 1:return Y.which==2||(Y.which==1&&Y.metaKey);case 2:return Y.which==3;default:return false}}if(window.attachEvent){if(!window.addEventListener){O=S}else{O=function(Y,X){return A(Y)?S(Y,X):M(Y,X)}}}else{if(Prototype.Browser.WebKit){O=P}else{O=M}}function B(X){return O(X,0)}function i(X){return O(X,1)}function e(X){return O(X,2)}function o(X){return Element.extend(K(X))}function K(Z){Z=L.extend(Z);var Y=Z.target,X=Z.type,aa=Z.currentTarget;if(aa&&aa.tagName){if(X==="load"||X==="error"||(X==="click"&&aa.tagName.toLowerCase()==="input"&&aa.type==="radio")){Y=aa}}return Y.nodeType==Node.TEXT_NODE?Y.parentNode:Y}function j(Z,aa){var Y=K(Z),X=Prototype.Selector;if(!aa){return Element.extend(Y)}while(Y){if(Object.isElement(Y)&&X.match(Y,aa)){return Element.extend(Y)}Y=Y.parentNode}}function t(X){return{x:U(X),y:T(X)}}function U(Z){var Y=document.documentElement,X=document.body||{scrollLeft:0};return Z.pageX||(Z.clientX+(Y.scrollLeft||X.scrollLeft)-(Y.clientLeft||0))}function T(Z){var Y=document.documentElement,X=document.body||{scrollTop:0};return Z.pageY||(Z.clientY+(Y.scrollTop||X.scrollTop)-(Y.clientTop||0))}function r(X){L.extend(X);X.preventDefault();X.stopPropagation();X.stopped=true}L.Methods={isLeftClick:B,isMiddleClick:i,isRightClick:e,element:o,findElement:j,pointer:t,pointerX:U,pointerY:T,stop:r};var H=Object.keys(L.Methods).inject({},function(X,Y){X[Y]=L.Methods[Y].methodize();return X});if(window.attachEvent){function V(Y){var X;switch(Y.type){case"mouseover":case"mouseenter":X=Y.fromElement;break;case"mouseout":case"mouseleave":X=Y.toElement;break;default:return null}return Element.extend(X)}var Q={stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}};L.extend=function(Y,X){if(!Y){return false}if(!A(Y)){return Y}if(Y._extendedByPrototype){return Y}Y._extendedByPrototype=Prototype.emptyFunction;var Z=L.pointer(Y);Object.extend(Y,{target:Y.srcElement||X,relatedTarget:V(Y),pageX:Z.x,pageY:Z.y});Object.extend(Y,H);Object.extend(Y,Q);return Y}}else{L.extend=Prototype.K}if(window.addEventListener){L.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(L.prototype,H)}var v={mouseenter:"mouseover",mouseleave:"mouseout"};function f(X){return v[X]||X}if(k){f=Prototype.K}function R(X){if(X===window){return 0}if(typeof X._prototypeUID==="undefined"){X._prototypeUID=Element.Storage.UID++}return X._prototypeUID}function I(X){if(X===window){return 0}if(X==document){return 1}return X.uniqueID}if("uniqueID" in u){R=I}function x(X){return X.include(":")}L._isCustomEvent=x;function z(Z,Y){var X=D.Event.cache;if(Object.isUndefined(Y)){Y=R(Z)}if(!X[Y]){X[Y]={element:Z}}return X[Y]}function E(Y,X){if(Object.isUndefined(X)){X=R(Y)}delete D.Event.cache[X]}function h(Z,ac,af){var X=z(Z);if(!X[ac]){X[ac]=[]}var ab=X[ac];var aa=ab.length;while(aa--){if(ab[aa].handler===af){return null}}var ad=R(Z);var Y=D.Event._createResponder(ad,ac,af);var ae={responder:Y,handler:af};ab.push(ae);return ae}function s(ac,Z,ad){var Y=z(ac);var X=Y[Z]||[];var ab=X.length,ae;while(ab--){if(X[ab].handler===ad){ae=X[ab];break}}if(ae){var aa=X.indexOf(ae);X.splice(aa,1)}if(X.length===0){delete Y[Z];if(Object.keys(Y).length===1&&("element" in Y)){E(ac)}}return ae}function c(Z,Y,aa){Z=$(Z);var ab=h(Z,Y,aa);if(ab===null){return Z}var X=ab.responder;if(x(Y)){p(Z,Y,X)}else{m(Z,Y,X)}return Z}function m(aa,Z,Y){var X=f(Z);if(aa.addEventListener){aa.addEventListener(X,Y,false)}else{aa.attachEvent("on"+X,Y)}}function p(Z,Y,X){if(Z.addEventListener){Z.addEventListener("dataavailable",X,false)}else{Z.attachEvent("ondataavailable",X);Z.attachEvent("onlosecapture",X)}}function J(Y,X,Z){Y=$(Y);var ab=!Object.isUndefined(Z),ac=!Object.isUndefined(X);if(!ac&&!ab){y(Y);return Y}if(!ab){G(Y,X);return Y}var aa=s(Y,X,Z);if(!aa){return Y}a(Y,X,aa.responder);return Y}function C(aa,Z,Y){var X=f(Z);if(aa.removeEventListener){aa.removeEventListener(X,Y,false)}else{aa.detachEvent("on"+X,Y)}}function b(Z,Y,X){if(Z.removeEventListener){Z.removeEventListener("dataavailable",X,false)}else{Z.detachEvent("ondataavailable",X);Z.detachEvent("onlosecapture",X)}}function y(ac){var ab=R(ac),Z=D.Event.cache[ab];if(!Z){return}E(ac,ab);var X,aa;for(var Y in Z){if(Y==="element"){continue}X=Z[Y];aa=X.length;while(aa--){a(ac,Y,X[aa].responder)}}}function G(ac,Z){var Y=z(ac);var X=Y[Z];if(X){delete Y[Z]}X=X||[];var ab=X.length;while(ab--){a(ac,Z,X[ab].responder)}for(var aa in Y){if(aa==="element"){continue}return}E(ac)}function a(Y,X,Z){if(x(X)){b(Y,X,Z)}else{C(Y,X,Z)}}function g(X){if(X!==document){return X}if(document.createEvent&&!X.dispatchEvent){return document.documentElement}return X}function w(aa,Z,Y,X){aa=g($(aa));if(Object.isUndefined(X)){X=true}Y=Y||{};var ab=N(aa,Z,Y,X);return L.extend(ab)}function l(aa,Z,Y,X){var ab=document.createEvent("HTMLEvents");ab.initEvent("dataavailable",X,true);ab.eventName=Z;ab.memo=Y;aa.dispatchEvent(ab);return ab}function n(aa,Z,Y,X){var ab=document.createEventObject();ab.eventType=X?"ondataavailable":"onlosecapture";ab.eventName=Z;ab.memo=Y;aa.fireEvent(ab.eventType,ab);return ab}var N=document.createEvent?l:n;L.Handler=Class.create({initialize:function(Z,Y,X,aa){this.element=$(Z);this.eventName=Y;this.selector=X;this.callback=aa;this.handler=this.handleEvent.bind(this)},start:function(){L.observe(this.element,this.eventName,this.handler);return this},stop:function(){L.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(Y){var X=L.findElement(Y,this.selector);if(X){this.callback.call(this.element,Y,X)}}});function F(Z,Y,X,aa){Z=$(Z);if(Object.isFunction(X)&&Object.isUndefined(aa)){aa=X,X=null}return new L.Handler(Z,Y,X,aa).start()}Object.extend(L,L.Methods);Object.extend(L,{fire:w,observe:c,stopObserving:J,on:F});Element.addMethods({fire:w,observe:c,stopObserving:J,on:F});Object.extend(document,{fire:w.methodize(),observe:c.methodize(),stopObserving:J.methodize(),on:F.methodize(),loaded:false});if(D.Event){Object.extend(window.Event,L)}else{D.Event=L}D.Event.cache={};function q(){D.Event.cache=null}if(window.attachEvent){window.attachEvent("onunload",q)}u=null;d=null})(this);(function(c){var g=document.documentElement;var b="onmouseenter" in g&&"onmouseleave" in g;function f(h){return !b&&(h==="mouseenter"||h==="mouseleave")}function d(i,h,j){if(Event._isCustomEvent(h)){return e(i,h,j)}if(f(h)){return a(i,h,j)}return function(l){if(!Event.cache){return}var k=Event.cache[i].element;Event.extend(l,k);j.call(k,l)}}function e(i,h,j){return function(m){var k=Event.cache[i];var l=k&&k.element;if(Object.isUndefined(m.eventName)){return false}if(m.eventName!==h){return false}Event.extend(m,l);j.call(l,m)}}function a(i,h,j){return function(m){var k=Event.cache[i].element;Event.extend(m,k);var l=m.relatedTarget;while(l&&l!==k){try{l=l.parentNode}catch(n){l=k}}if(l===k){return}j.call(k,m)}}c.Event._createResponder=d;g=null})(this);Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.addMethods({childOf:Element.Methods.descendantOf});var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(b,a,c){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(b,a,c)}this.xcomp=a;this.ycomp=c;this.offset=Element.cumulativeOffset(b);return(c>=this.offset[1]&&c<this.offset[1]+b.offsetHeight&&a>=this.offset[0]&&a<this.offset[0]+b.offsetWidth)},withinIncludingScrolloffsets:function(b,a,d){var c=Element.cumulativeScrollOffset(b);this.xcomp=a+c[0]-this.deltaX;this.ycomp=d+c[1]-this.deltaY;this.offset=Element.cumulativeOffset(b);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+b.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+b.offsetWidth)},overlap:function(b,a){if(!b){return 0}if(b=="vertical"){return((this.offset[1]+a.offsetHeight)-this.ycomp)/a.offsetHeight}if(b=="horizontal"){return((this.offset[0]+a.offsetWidth)-this.xcomp)/a.offsetWidth}},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},relativize:function(a){Position.prepare();return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(b,c,a){a=a||{};return Element.clonePosition(c,b,a)}};if(!document.getElementsByClassName){document.getElementsByClassName=function(b){function a(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}b.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,e){e=e.toString().strip();var d=/\s/.test(e)?$w(e).map(a).join(""):a(e);return d?document._getElementsByXPath(".//*"+d,c):[]}:function(e,f){f=f.toString().strip();var g=[],h=(/\s/.test(f)?$w(f):null);if(!h&&!f){return g}var c=$(e).getElementsByTagName("*");f=" "+f+" ";for(var d=0,k,j;k=c[d];d++){if(k.className&&(j=" "+k.className+" ")&&(j.include(f)||(h&&h.all(function(i){return !i.toString().blank()&&j.include(" "+i+" ")})))){g.push(Element.extend(k))}}return g};return function(d,c){return $(c||document.body).getElementsByClassName(d)}}(Element.Methods)}Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(b,a){this.element.className.split(/\s+/).select(function(c){return c.length>0})._each(b,a)},set:function(a){this.element.className=a},add:function(a){if(this.include(a)){return}this.set($A(this).concat(a).join(" "))},remove:function(a){if(!this.include(a)){return}this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);(function(){window.Selector=Class.create({initialize:function(a){this.expression=a.strip()},findElements:function(a){return Prototype.Selector.select(this.expression,a)},match:function(a){return Prototype.Selector.match(a,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:function(f,g){var a=Prototype.Selector.match,d=[];for(var c=0,e=f.length;c<e;c++){var b=f[c];if(a(b,g)){d.push(Element.extend(b))}}return d},findElement:function(f,g,b){b=b||0;var a=0,d;for(var c=0,e=f.length;c<e;c++){d=f[c];if(Prototype.Selector.match(d,g)&&b===a++){return Element.extend(d)}}},findChildElements:function(b,c){var a=c.toArray().join(", ");return Prototype.Selector.select(a,b||document)}})})();String.prototype.parseColor=function(){var a="#";if(this.slice(0,4)=="rgb("){var c=this.slice(4,this.length-1).split(",");var b=0;do{a+=parseInt(c[b]).toColorPart()}while(++b<3)}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var b=1;b<4;b++){a+=(this.charAt(b)+this.charAt(b)).toLowerCase()}}if(this.length==7){a=this.toLowerCase()}}}return(a.length==7?a:(arguments[0]||this))};Element.collectTextNodes=function(a){return $A($(a).childNodes).collect(function(b){return(b.nodeType==3?b.nodeValue:(b.hasChildNodes()?Element.collectTextNodes(b):""))}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return(c.nodeType==3?c.nodeValue:((c.hasChildNodes()&&!Element.hasClassName(c,b))?Element.collectTextNodesIgnoreClass(c,b):""))}).flatten().join("")};Element.setContentZoom=function(a,b){a=$(a);a.setStyle({fontSize:(b/100)+"em"});if(Prototype.Browser.WebKit){window.scrollBy(0,0)}return a};Element.getInlineOpacity=function(a){return $(a).style.opacity||""};Element.forceRerendering=function(a){try{a=$(a);var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(b){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(a){return(-Math.cos(a*Math.PI)/2)+0.5},reverse:function(a){return 1-a},flicker:function(a){var a=((-Math.cos(a*Math.PI)/4)+0.75)+Math.random()/4;return a>1?1:a},wobble:function(a){return(-Math.cos(a*Math.PI*(9*a))/2)+0.5},pulse:function(b,a){a=a||5;return(((b%(1/a))*a).round()==0?((b*a*2)-(b*a*2).floor()):1-((b*a*2)-(b*a*2).floor()))},spring:function(a){return 1-(Math.cos(a*4.5*Math.PI)*Math.exp(-a*6))},none:function(a){return 0},full:function(a){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(a){var b="position:relative";if(Prototype.Browser.IE){b+=";zoom:1"}a=$(a);$A(a.childNodes).each(function(c){if(c.nodeType==3){c.nodeValue.toArray().each(function(d){a.insertBefore(new Element("span",{style:b}).update(d==" "?String.fromCharCode(160):d),c)});Element.remove(c)}})},multiple:function(b,c){var e;if(((typeof b=="object")||Object.isFunction(b))&&(b.length)){e=b}else{e=$(b).childNodes}var a=Object.extend({speed:0.1,delay:0},arguments[2]||{});var d=a.delay;$A(e).each(function(g,f){new c(g,Object.extend(a,{delay:f*a.speed+d}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(b,c){b=$(b);c=(c||"appear").toLowerCase();var a=Object.extend({queue:{position:"end",scope:(b.id||"global"),limit:1}},arguments[2]||{});Effect[b.visible()?Effect.PAIRS[c][1]:Effect.PAIRS[c][0]](b,a)}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(a){this.effects._each(a)},add:function(b){var c=new Date().getTime();var a=Object.isString(b.options.queue)?b.options.queue:b.options.queue.position;switch(a){case"front":this.effects.findAll(function(d){return d.state=="idle"}).each(function(d){d.startOn+=b.finishOn;d.finishOn+=b.finishOn});break;case"with-last":c=this.effects.pluck("startOn").max()||c;break;case"end":c=this.effects.pluck("finishOn").max()||c;break}b.startOn+=c;b.finishOn+=c;if(!b.options.queue.limit||(this.effects.length<b.options.queue.limit)){this.effects.push(b)}if(!this.interval){this.interval=setInterval(this.loop.bind(this),15)}},remove:function(a){this.effects=this.effects.reject(function(b){return b==a});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var c=new Date().getTime();for(var b=0,a=this.effects.length;b<a;b++){this.effects[b]&&this.effects[b].loop(c)}}});Effect.Queues={instances:$H(),get:function(a){if(!Object.isString(a)){return a}return this.instances.get(a)||this.instances.set(a,new Effect.ScopedQueue())}};Effect.Queue=Effect.Queues.get("global");Effect.Base=Class.create({position:null,start:function(options){function codeForEvent(options,eventName){return((options[eventName+"Internal"]?"this.options."+eventName+"Internal(this);":"")+(options[eventName]?"this.options."+eventName+"(this);":""))}if(options&&options.transition===false){options.transition=Effect.Transitions.linear}this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;eval('this.render = function(pos){ if (this.state=="idle"){this.state="running";'+codeForEvent(this.options,"beforeSetup")+(this.setup?"this.setup();":"")+codeForEvent(this.options,"afterSetup")+'};if (this.state=="running"){pos=this.options.transition(pos)*'+this.fromToDelta+"+"+this.options.from+";this.position=pos;"+codeForEvent(this.options,"beforeUpdate")+(this.update?"this.update(pos);":"")+codeForEvent(this.options,"afterUpdate")+"}}");this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)}},loop:function(c){if(c>=this.startOn){if(c>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish()}this.event("afterFinish");return}var b=(c-this.startOn)/this.totalTime,a=(b*this.totalFrames).round();if(a>this.currentFrame){this.render(b);this.currentFrame=a}}},cancel:function(){if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this)}this.state="finished"},event:function(a){if(this.options[a+"Internal"]){this.options[a+"Internal"](this)}if(this.options[a]){this.options[a](this)}},inspect:function(){var a=$H();for(property in this){if(!Object.isFunction(this[property])){a.set(property,this[property])}}return"#<Effect:"+a.inspect()+",options:"+$H(this.options).inspect()+">"}});Effect.Opacity=Class.create(Effect.Base,{initialize:function(b){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}var a=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(a)},update:function(a){this.element.setOpacity(a)}});Effect.Fade=function(c){c=$(c);var a=c.getInlineOpacity();var b=Object.extend({from:c.getOpacity()||1,to:0,afterFinishInternal:function(d){if(d.options.to!=0){return}d.element.hide().setStyle({opacity:a})}},arguments[1]||{});return new Effect.Opacity(c,b)};Effect.Appear=function(b){b=$(b);var a=Object.extend({from:(b.getStyle("display")=="none"?0:b.getOpacity()||0),to:1,afterFinishInternal:function(c){c.element.forceRerendering()},beforeSetup:function(c){c.element.setOpacity(c.options.from).show()}},arguments[1]||{});return new Effect.Opacity(b,a)};Effect.FadeReplace=function(a){a=$(a);return new Effect.Fade(a,Object.extend({afterFinishInternal:function(b){b.element.innerHTML=b.options.innerHTML;new Effect.Appear(b.element,{duration:b.options.duration})}},arguments[1]||{}))};Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");String.prototype.parseStyle=function(){var b,a=$H();if(Prototype.Browser.WebKit){b=new Element("div",{style:this}).style}else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';b=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(c){if(b[c]){a.set(c,b[c])}});if(Prototype.Browser.IE&&this.include("opacity")){a.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1])}return a};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(b){var a=document.defaultView.getComputedStyle($(b),null);return Element.CSS_PROPERTIES.inject({},function(c,d){c[d]=a[d];return c})}}else{Element.getStyles=function(b){b=$(b);var a=b.currentStyle,c;c=Element.CSS_PROPERTIES.inject({},function(d,e){d[e]=a[e];return d});if(!c.opacity){c.opacity=b.getOpacity()}return c}}Effect.Methods={visualEffect:function(c,e,b){c=$(c);var d=e.dasherize().camelize(),a=d.charAt(0).toUpperCase()+d.substring(1);new Effect[a](c,b);return c}};$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(a){Effect.Methods[a]=function(c,b){c=$(c);Effect[a.charAt(0).toUpperCase()+a.substring(1)](c,b);return c}});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(a){Effect.Methods[a]=Element[a]});Element.addMethods(Effect.Methods);var hexcase=0;var b64pad="";var chrsz=8;function hex_sha1(a){return binb2hex(core_sha1(str2binb(a),a.length*chrsz))}function b64_sha1(a){return binb2b64(core_sha1(str2binb(a),a.length*chrsz))}function str_sha1(a){return binb2str(core_sha1(str2binb(a),a.length*chrsz))}function hex_hmac_sha1(a,b){return binb2hex(core_hmac_sha1(a,b))}function b64_hmac_sha1(a,b){return binb2b64(core_hmac_sha1(a,b))}function str_hmac_sha1(a,b){return binb2str(core_hmac_sha1(a,b))}function sha1_vm_test(){return hex_sha1("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function core_sha1(v,o){v[o>>5]|=128<<(24-o%32);v[((o+64>>9)<<4)+15]=o;var y=Array(80);var u=1732584193;var s=-271733879;var r=-1732584194;var q=271733878;var p=-1009589776;for(var l=0;l<v.length;l+=16){var n=u;var m=s;var k=r;var h=q;var f=p;for(var g=0;g<80;g++){if(g<16){y[g]=v[l+g]}else{y[g]=rol(y[g-3]^y[g-8]^y[g-14]^y[g-16],1)}var z=safe_add(safe_add(rol(u,5),sha1_ft(g,s,r,q)),safe_add(safe_add(p,y[g]),sha1_kt(g)));p=q;q=r;r=rol(s,30);s=u;u=z}u=safe_add(u,n);s=safe_add(s,m);r=safe_add(r,k);q=safe_add(q,h);p=safe_add(p,f)}return Array(u,s,r,q,p)}function sha1_ft(e,a,g,f){if(e<20){return(a&g)|((~a)&f)}if(e<40){return a^g^f}if(e<60){return(a&g)|(a&f)|(g&f)}return a^g^f}function sha1_kt(a){return(a<20)?1518500249:(a<40)?1859775393:(a<60)?-1894007588:-899497514}function core_hmac_sha1(c,f){var e=str2binb(c);if(e.length>16){e=core_sha1(e,c.length*chrsz)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=core_sha1(a.concat(str2binb(f)),512+f.length*chrsz);return core_sha1(d.concat(g),512+160)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function rol(a,b){return(a<<b)|(a>>>(32-b))}function str2binb(d){var c=Array();var a=(1<<chrsz)-1;for(var b=0;b<d.length*chrsz;b+=chrsz){c[b>>5]|=(d.charCodeAt(b/chrsz)&a)<<(32-chrsz-b%32)}return c}function binb2str(c){var d="";var a=(1<<chrsz)-1;for(var b=0;b<c.length*32;b+=chrsz){d+=String.fromCharCode((c[b>>5]>>>(32-chrsz-b%32))&a)}return d}function binb2hex(c){var b=hexcase?"0123456789ABCDEF":"0123456789abcdef";var d="";for(var a=0;a<c.length*4;a++){d+=b.charAt((c[a>>2]>>((3-a%4)*8+4))&15)+b.charAt((c[a>>2]>>((3-a%4)*8))&15)}return d}function binb2b64(d){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var f="";for(var b=0;b<d.length*4;b+=3){var e=(((d[b>>2]>>8*(3-b%4))&255)<<16)|(((d[b+1>>2]>>8*(3-(b+1)%4))&255)<<8)|((d[b+2>>2]>>8*(3-(b+2)%4))&255);for(var a=0;a<4;a++){if(b*8+a*6>d.length*32){f+=b64pad}else{f+=c.charAt((e>>6*(3-a))&63)}}}return f}Redsea={callbacks:{process:function(){},reset:function(){},eof:function(){},statuschanged:function(){}},channelcount:0,channels:{},frameref:null,protocol:"http",host:null,port:80,hostid:null,status:0,mode:"stream",frameloadtimeout:2000,initialpingtimeout:3000,pingtimeout:8000,pingtimer:null,fallbackMode:"longpoll",reconnectTimeout:1000,reconnectTimeoutMax:8000,reconnectTimeoutDefault:1000,reconnectCount:0,reconnectLimit:15,register:function(a){a.p=Redsea.process;a.r=Redsea.reset;a.e=Redsea.xhrerror;a.eof=Redsea.eof;a.ch=Redsea.channelInfo;clearTimeout(Redsea.frameloadtimer);Redsea.setstatus(4);Redsea.log("Frame registered");clearTimeout(Redsea.pingtimer);if(Redsea.mode=="iframe"||Redsea.mode=="xhrinteractive"){Redsea.pingtimer=setTimeout(Redsea.onPingTimeout,Redsea.initialpingtimeout)}},joinChannel:function(a,b){if(typeof(Redsea.channels[a])!="undefined"){throw"Cannot join channel "+a+": already subscribed"}Redsea.channels[a]={backtrack:b};Redsea.log("Joined channel "+a);Redsea.channelcount++;if(Redsea.status!=0&&Redsea.status!=6){Redsea.connect()}},leaveChannel:function(a){if(typeof(Redsea.channels[a])=="undefined"){throw"Cannot leave channel "+a+": not subscribed"}delete Redsea.channels[a];Redsea.log("Left channel "+a);Redsea.channelcount--;if(Redsea.channelcount&&Redsea.status!=0&&Redsea.status!=6){Redsea.connect()}else{Redsea.disconnect()}},connect:function(){Redsea.log("Connecting");if(!Redsea.host){throw"Redsea host not specified"}if(isNaN(Redsea.port)){throw"Redsea port not specified"}if(!Redsea.channelcount){throw"No channels specified"}if(Redsea.status){Redsea.disconnect()}Redsea.setstatus(1);if(!Redsea.hostid){Redsea.hostid=Redsea.time()+""+Math.floor(Math.random()*1000000)}if(Redsea.mode=="stream"){Redsea.mode=Redsea.selectStreamTransport()}Redsea.log("Selected "+Redsea.mode+" transport");if(Redsea.mode=="iframe"){Redsea.loadFrame(Redsea.getSubsUrl())}else{var a=Redsea.protocol+"://"+Redsea.host+((Redsea.port==80)?"":":"+Redsea.port)+"/stream.html";Redsea.loadFrame(a)}Redsea.frameloadtimer=setTimeout(Redsea.onFrameLoadTimeout,Redsea.frameloadtimeout)},disconnect:function(){if(Redsea.status){clearTimeout(Redsea.pingtimer);clearTimeout(Redsea.frameloadtimer);if(typeof CollectGarbage=="function"){CollectGarbage()}if(Redsea.status!=6){Redsea.setstatus(0)}Redsea.log("Disconnected");try{Redsea.frameref.parentNode.removeChild(Redsea.frameref);delete Redsea.frameref;return true}catch(a){}try{Redsea.frameref.open();Redsea.frameref.close();return true}catch(a){}}},selectStreamTransport:function(){try{var b=ActiveXObject;return"iframe"}catch(a){}if((typeof window.addEventStream)=="function"){return"iframe"}return"xhrinteractive"},getSubsUrl:function(){var b=Redsea.protocol+"://"+Redsea.host+"/push/"+Redsea.hostid+"/"+Redsea.mode;for(var a in Redsea.channels){b+="/"+a;if(typeof Redsea.channels[a].lastmsgreceived!="undefined"){b+=".r"+(Redsea.channels[a].lastmsgreceived+1)}else{if(Redsea.channels[a].backtrack>0){b+=".b"+Redsea.channels[a].backtrack}else{if(Redsea.channels[a].backtrack!=undefined){b+=".h"}}}}b+="?nc="+Redsea.time();return b},loadFrame:function(a){try{if(!Redsea.frameref){var b=new ActiveXObject("htmlfile");Redsea.frameref=b}Redsea.frameref.open();Redsea.frameref.write("<html><script>");Redsea.frameref.write('document.domain="'+(document.domain)+'";');Redsea.frameref.write("<\/script></html>");Redsea.frameref.parentWindow.Redsea=Redsea;Redsea.frameref.close();var d=Redsea.frameref.createElement("div");Redsea.frameref.body.appendChild(d);d.innerHTML='<iframe src="'+a+'"></iframe>'}catch(c){if(!Redsea.frameref){var f=document.createElement("IFRAME");f.style.width="10px";f.style.height="10px";f.style.border="none";f.style.position="absolute";f.style.top="-10px";f.style.marginTop="-10px";f.style.zIndex="-20";f.Redsea=Redsea;document.body.appendChild(f);Redsea.frameref=f}Redsea.frameref.setAttribute("src",a)}},onPingTimeout:function(){Redsea.log("Ping timeout");clearTimeout(Redsea.pingtimer);if(Redsea.mode!=Redsea.fallbackMode){Redsea.log("Falling back to mode: "+Redsea.fallbackMode);Redsea.mode=Redsea.fallbackMode}Redsea.reconnectCount++;if(Redsea.reconnectCount<=Redsea.reconnectLimit){Redsea.log("Reconnect attempt #"+Redsea.reconnectCount+" in "+Redsea.reconnectTimeout+"ms");setTimeout(Redsea.connect,Redsea.reconnectTimeout);Redsea.reconnectTimeout=Math.min(Redsea.reconnectTimeout*2,Redsea.reconnectTimeoutMax)}else{Redsea.log("Reconnect limit reached. Connection failed.")}},process:function(c,a,b){if(c==-1){Redsea.log("Ping");Redsea.ping()}else{if(typeof(Redsea.channels[a])!="undefined"){Redsea.log("Message "+c+" received on channel "+a+" (last id on channel: "+Redsea.channels[a].lastmsgreceived+")\n"+b);Redsea.callbacks.process(b);Redsea.channels[a].lastmsgreceived=c;Redsea.ping()}}Redsea.setstatus(5)},ping:function(){if(Redsea.pingtimer){clearTimeout(Redsea.pingtimer);Redsea.pingtimer=setTimeout(Redsea.onPingTimeout,Redsea.pingtimeout)}Redsea.setstatus(5);Redsea.fallbackMode=Redsea.mode},reset:function(){if(Redsea.status!=6&&Redsea.status!=0){Redsea.log("Stream reset");Redsea.ping();Redsea.callbacks.reset();setTimeout(Redsea.connect,10)}},xhrerror:function(){Redsea.onPingTimeout()},eof:function(){Redsea.log("Received end of stream, will not reconnect");Redsea.callbacks.eof();Redsea.setstatus(6);Redsea.disconnect()},channelInfo:function(a,b){Redsea.channels[a].lastmsgreceived=b;Redsea.log("Received channel info for channel "+a+": resume from "+b);Redsea.reconnectCount=0;Redsea.reconnectTimeout=Redsea.reconnectTimeoutDefault},registerEventCallback:function(a,b){Function.prototype.andThen=function(d){var e=this;var c=Redsea.arguments;return function(f){e(c);d(f)}};if(typeof Redsea.callbacks[a]=="function"){Redsea.callbacks[a]=(Redsea.callbacks[a]).andThen(b)}else{Redsea.callbacks[a]=b}},onFrameLoadTimeout:function(){Redsea.log("Frame load timeout");clearTimeout(Redsea.frameloadtimer);Redsea.setstatus(3);Redsea.onPingTimeout()},setstatus:function(a){if(Redsea.status!=a){Redsea.status=a;Redsea.callbacks.statuschanged(a)}},log:function(a){},time:function(){var a=new Date();return a.getTime()}};if(dwr==null){var dwr={}}if(dwr.engine==null){dwr.engine={}}if(DWREngine==null){var DWREngine=dwr.engine}dwr.engine.setErrorHandler=function(a){dwr.engine._errorHandler=a};dwr.engine.setWarningHandler=function(a){dwr.engine._warningHandler=a};dwr.engine.setTextHtmlHandler=function(a){dwr.engine._textHtmlHandler=a};dwr.engine.setTimeout=function(a){dwr.engine._timeout=a};dwr.engine.setPreHook=function(a){dwr.engine._preHook=a};dwr.engine.setPostHook=function(a){dwr.engine._postHook=a};dwr.engine.setHeaders=function(a){dwr.engine._headers=a};dwr.engine.setParameters=function(a){dwr.engine._parameters=a};dwr.engine.XMLHttpRequest=1;dwr.engine.IFrame=2;dwr.engine.ScriptTag=3;dwr.engine.setRpcType=function(a){if(a!=dwr.engine.XMLHttpRequest&&a!=dwr.engine.IFrame&&a!=dwr.engine.ScriptTag){dwr.engine._handleError(null,{name:"dwr.engine.invalidRpcType",message:"RpcType must be one of dwr.engine.XMLHttpRequest or dwr.engine.IFrame or dwr.engine.ScriptTag"});return}dwr.engine._rpcType=a};dwr.engine.setHttpMethod=function(a){if(a!="GET"&&a!="POST"){dwr.engine._handleError(null,{name:"dwr.engine.invalidHttpMethod",message:"Remoting method must be one of GET or POST"});return}dwr.engine._httpMethod=a};dwr.engine.setOrdered=function(a){dwr.engine._ordered=a};dwr.engine.setAsync=function(a){dwr.engine._async=a};dwr.engine.setActiveReverseAjax=function(a){};dwr.engine.defaultErrorHandler=function(b,a){dwr.engine._debug("Error: "+a.name+", "+a.message,true);if(b==null||b==""){alert("A server error has occured.")}else{if(b.indexOf("0x80040111")!=-1){dwr.engine._debug(b)}else{alert(b)}}};dwr.engine.defaultWarningHandler=function(b,a){dwr.engine._debug(b)};dwr.engine.beginBatch=function(){if(dwr.engine._batch){dwr.engine._handleError(null,{name:"dwr.engine.batchBegun",message:"Batch already begun"});return}dwr.engine._batch=dwr.engine._createBatch()};dwr.engine.endBatch=function(b){var a=dwr.engine._batch;if(a==null){dwr.engine._handleError(null,{name:"dwr.engine.batchNotBegun",message:"No batch in progress"});return}dwr.engine._batch=null;if(a.map.callCount==0){return}if(b){dwr.engine._mergeBatch(a,b)}if(dwr.engine._ordered&&dwr.engine._batchesLength!=0){dwr.engine._batchQueue[dwr.engine._batchQueue.length]=a}else{dwr.engine._sendData(a)}};dwr.engine.setPollMethod=function(a){dwr.engine.setPollType(a)};dwr.engine.setMethod=function(a){dwr.engine.setRpcType(a)};dwr.engine.setVerb=function(a){dwr.engine.setHttpMethod(a)};dwr.engine.setPollType=function(){dwr.engine._debug("Manually setting the Poll Type is not supported")};dwr.engine._scriptSessionId=null;dwr.engine._getScriptSessionId=function(){if(dwr.engine._scriptSessionId==null){dwr.engine._scriptSessionId=dwr.engine._origScriptSessionId+Math.floor(Math.random()*1000)}return dwr.engine._scriptSessionId};dwr.engine._errorHandler=dwr.engine.defaultErrorHandler;dwr.engine._warningHandler=dwr.engine.defaultWarningHandler;dwr.engine._preHook=null;dwr.engine._postHook=null;dwr.engine._batches={};dwr.engine._batchesLength=0;dwr.engine._batchQueue=[];dwr.engine._rpcType=dwr.engine.XMLHttpRequest;dwr.engine._httpMethod="POST";dwr.engine._ordered=false;dwr.engine._async=true;dwr.engine._batch=null;dwr.engine._timeout=0;dwr.engine._DOMDocument=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","Msxml2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"];dwr.engine._XMLHTTP=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];dwr.engine._activeReverseAjax=false;dwr.engine._outstandingIFrames=[];dwr.engine._pollReq=null;dwr.engine._pollCometInterval=200;dwr.engine._pollRetries=0;dwr.engine._maxPollRetries=0;dwr.engine._textHtmlHandler=null;dwr.engine._headers=null;dwr.engine._parameters=null;dwr.engine._postSeperator="\n";dwr.engine._defaultInterceptor=function(a){return a};dwr.engine._urlRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._contentRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._replyRewriteHandler=dwr.engine._defaultInterceptor;dwr.engine._nextBatchId=1;dwr.engine._propnames=["rpcType","httpMethod","async","timeout","errorHandler","warningHandler","textHtmlHandler"];dwr.engine._partialResponseNo=0;dwr.engine._partialResponseYes=1;dwr.engine._partialResponseFlush=2;dwr.engine._execute=function(l,b,j,h){var e=false;if(dwr.engine._batch==null){dwr.engine.beginBatch();e=true}var d=dwr.engine._batch;var g=[];for(var c=0;c<arguments.length-3;c++){g[c]=arguments[c+3]}if(d.path==null){d.path=l}else{if(d.path!=l){dwr.engine._handleError(d,{name:"dwr.engine.multipleServlets",message:"Can't batch requests to multiple DWR Servlets."});return}}var a;var k=g[g.length-1];if(typeof k=="function"||k==null){a={callback:g.pop()}}else{a=g.pop()}dwr.engine._mergeBatch(d,a);d.handlers[d.map.callCount]={exceptionHandler:a.exceptionHandler,callback:a.callback};var f="c"+d.map.callCount+"-";d.map[f+"scriptName"]=b;d.map[f+"methodName"]=j;d.map[f+"id"]=d.map.callCount;for(c=0;c<g.length;c++){dwr.engine._serializeAll(d,[],g[c],f+"param"+c)}d.map.callCount++;if(e){dwr.engine.endBatch()}};dwr.engine._poll=function(b){if(!dwr.engine._activeReverseAjax){return}var a=dwr.engine._createBatch();a.map.id=0;a.map.callCount=1;a.isPoll=true;if(dwr.engine._pollWithXhr=="true"){a.rpcType=dwr.engine.XMLHttpRequest;a.map.partialResponse=dwr.engine._partialResponseNo}else{if(navigator.userAgent.indexOf("Gecko/")!=-1){a.rpcType=dwr.engine.XMLHttpRequest;a.map.partialResponse=dwr.engine._partialResponseYes}else{if(navigator.userAgent.indexOf("; MSIE")!=-1){a.rpcType=dwr.engine.IFrame;a.map.partialResponse=dwr.engine._partialResponseYes}else{if(navigator.userAgent.indexOf("Safari/")!=-1){a.rpcType=dwr.engine.XMLHttpRequest;a.map.partialResponse=dwr.engine._partialResponseYes}else{a.rpcType=dwr.engine.XMLHttpRequest;a.map.partialResponse=dwr.engine._partialResponseNo}}}}a.httpMethod="POST";a.async=true;a.timeout=0;a.path=(b)?b:dwr.engine._defaultPath;a.preHooks=[];a.postHooks=[];a.errorHandler=dwr.engine._pollErrorHandler;a.warningHandler=dwr.engine._pollErrorHandler;a.handlers[0]={callback:function(c){dwr.engine._pollRetries=0;setTimeout("dwr.engine._poll()",c)}};dwr.engine._sendData(a);if(a.rpcType==dwr.engine.XMLHttpRequest&&a.map.partialResponse==dwr.engine._partialResponseYes){dwr.engine._checkCometPoll()}};dwr.engine._pollErrorHandler=function(b,a){dwr.engine._pollRetries++;dwr.engine._debug("Reverse Ajax poll failed (pollRetries="+dwr.engine._pollRetries+"): "+a.name+" : "+a.message);if(dwr.engine._pollRetries<dwr.engine._maxPollRetries){setTimeout("dwr.engine._poll()",10000)}else{dwr.engine._activeReverseAjax=false;dwr.engine._debug("Giving up.")}};dwr.engine._createBatch=function(){var a={map:{callCount:0,page:window.location.pathname+window.location.search,httpSessionId:dwr.engine._sessionId,scriptSessionId:dwr.engine._getScriptSessionId()},charsProcessed:0,paramCount:0,parameters:{},headers:{},isPoll:false,handlers:{},preHooks:[],postHooks:[],rpcType:dwr.engine._rpcType,httpMethod:dwr.engine._httpMethod,async:dwr.engine._async,timeout:dwr.engine._timeout,errorHandler:dwr.engine._errorHandler,warningHandler:dwr.engine._warningHandler,textHtmlHandler:dwr.engine._textHtmlHandler};if(dwr.engine._preHook){a.preHooks.push(dwr.engine._preHook)}if(dwr.engine._postHook){a.postHooks.push(dwr.engine._postHook)}var c,b;if(dwr.engine._headers){for(c in dwr.engine._headers){b=dwr.engine._headers[c];if(typeof b!="function"){a.headers[c]=b}}}if(dwr.engine._parameters){for(c in dwr.engine._parameters){b=dwr.engine._parameters[c];if(typeof b!="function"){a.parameters[c]=b}}}return a};dwr.engine._mergeBatch=function(a,d){var e,c;for(var b=0;b<dwr.engine._propnames.length;b++){e=dwr.engine._propnames[b];if(d[e]!=null){a[e]=d[e]}}if(d.preHook!=null){a.preHooks.unshift(d.preHook)}if(d.postHook!=null){a.postHooks.push(d.postHook)}if(d.headers){for(e in d.headers){c=d.headers[e];if(typeof c!="function"){a.headers[e]=c}}}if(d.parameters){for(e in d.parameters){c=d.parameters[e];if(typeof c!="function"){a.map["p-"+e]=""+c}}}};dwr.engine._getJSessionId=function(){var c=document.cookie.split(";");for(var b=0;b<c.length;b++){var a=c[b];while(a.charAt(0)==" "){a=a.substring(1,a.length)}if(a.indexOf(dwr.engine._sessionCookieName+"=")==0){return a.substring(dwr.engine._sessionCookieName.length+1,a.length)}}return""};dwr.engine._checkCometPoll=function(){for(var b=0;b<dwr.engine._outstandingIFrames.length;b++){var e="";var c=dwr.engine._outstandingIFrames[b];try{e=dwr.engine._getTextFromCometIFrame(c)}catch(a){dwr.engine._handleWarning(c.batch,a)}if(e!=""){dwr.engine._processCometResponse(e,c.batch)}}if(dwr.engine._pollReq){var d=dwr.engine._pollReq;var e=d.responseText;if(e!=null){dwr.engine._processCometResponse(e,d.batch)}}if(dwr.engine._outstandingIFrames.length>0||dwr.engine._pollReq){setTimeout("dwr.engine._checkCometPoll()",dwr.engine._pollCometInterval)}};dwr.engine._getTextFromCometIFrame=function(b){var a=b.contentWindow.document.body;if(a==null){return""}var c=a.innerHTML;if(c.indexOf("<PRE>")==0||c.indexOf("<pre>")==0){c=c.substring(5,c.length-7)}return c};dwr.engine._processCometResponse=function(d,e){if(e.charsProcessed==d.length){return}if(d.length==0){e.charsProcessed=0;return}var b=d.indexOf("//#DWR-START#",e.charsProcessed);if(b==-1){e.charsProcessed=d.length;return}var a=d.lastIndexOf("//#DWR-END#");if(a==-1){return}if(d.charCodeAt(a+11)==13&&d.charCodeAt(a+12)==10){e.charsProcessed=a+13}else{e.charsProcessed=a+11}var c=d.substring(b+13,a);dwr.engine._receivedBatch=e;dwr.engine._eval(c);dwr.engine._receivedBatch=null};dwr.engine._sendData=function(e){e.map.batchId=dwr.engine._nextBatchId;dwr.engine._nextBatchId++;dwr.engine._batches[e.map.batchId]=e;dwr.engine._batchesLength++;e.completed=false;for(var d=0;d<e.preHooks.length;d++){e.preHooks[d]()}e.preHooks=null;if(e.timeout&&e.timeout!=0){e.interval=setInterval(function(){dwr.engine._abortRequest(e)},e.timeout)}if(e.rpcType==dwr.engine.XMLHttpRequest){if(window.XMLHttpRequest){e.req=new XMLHttpRequest()}else{if(window.ActiveXObject&&!(navigator.userAgent.indexOf("Mac")>=0&&navigator.userAgent.indexOf("MSIE")>=0)){e.req=dwr.engine._newActiveXObject(dwr.engine._XMLHTTP)}}}var a,c;if(e.req){if(e.async){e.req.onreadystatechange=function(){if(typeof dwr!="undefined"){dwr.engine._stateChange(e)}}}if(e.isPoll){dwr.engine._pollReq=e.req;if(!document.all){e.req.batch=e}}var b=navigator.userAgent.indexOf("Safari/");if(b>=0){var g=navigator.userAgent.substring(b+7);if(parseInt(g,10)<400){if(dwr.engine._allowGetForSafariButMakeForgeryEasier=="true"){e.httpMethod="GET"}else{dwr.engine._handleWarning(e,{name:"dwr.engine.oldSafari",message:"Safari GET support disabled. See getahead.org/dwr/server/servlet and allowGetForSafariButMakeForgeryEasier."})}}}e.mode=e.isPoll?dwr.engine._ModePlainPoll:dwr.engine._ModePlainCall;c=dwr.engine._constructRequest(e);try{e.req.open(e.httpMethod,c.url,e.async);try{for(a in e.headers){var j=e.headers[a];if(typeof j=="string"){e.req.setRequestHeader(a,j)}}if(!e.headers["Content-Type"]){e.req.setRequestHeader("Content-Type","text/plain")}}catch(h){dwr.engine._handleWarning(e,h)}e.req.send(c.body);if(!e.async){dwr.engine._stateChange(e)}}catch(h){dwr.engine._handleError(e,h)}}else{if(e.rpcType!=dwr.engine.ScriptTag){var f=e.isPoll?"dwr-if-poll-"+e.map.batchId:"dwr-if-"+e.map["c0-id"];if(e.isPoll&&window.ActiveXObject){e.htmlfile=new window.ActiveXObject("htmlfile");e.htmlfile.open();e.htmlfile.write("<html>");e.htmlfile.write("<div><iframe className='wibble' src='javascript:void(0)' id='"+f+"' name='"+f+"' onload='dwr.engine._iframeLoadingComplete("+e.map.batchId+");'></iframe></div>");e.htmlfile.write("</html>");e.htmlfile.close();e.htmlfile.parentWindow.dwr=dwr;e.document=e.htmlfile}else{e.div=document.createElement("div");document.body.appendChild(e.div);e.div.innerHTML="<iframe src='javascript:void(0)' frameborder='0' style='width:0px;height:0px;border:0;' id='"+f+"' name='"+f+"' onload='dwr.engine._iframeLoadingComplete ("+e.map.batchId+");'></iframe>";e.document=document}e.iframe=e.document.getElementById(f);e.iframe.batch=e;e.mode=e.isPoll?dwr.engine._ModeHtmlPoll:dwr.engine._ModeHtmlCall;if(e.isPoll){dwr.engine._outstandingIFrames.push(e.iframe)}c=dwr.engine._constructRequest(e);if(e.httpMethod=="GET"){e.iframe.setAttribute("src",c.url)}else{e.form=e.document.createElement("form");e.form.setAttribute("id","dwr-form");e.form.setAttribute("action",c.url);e.form.setAttribute("target",f);e.form.target=f;e.form.setAttribute("method",e.httpMethod);for(a in e.map){var j=e.map[a];if(typeof j!="function"){var k=e.document.createElement("input");k.setAttribute("type","hidden");k.setAttribute("name",a);k.setAttribute("value",j);e.form.appendChild(k)}}e.document.body.appendChild(e.form);e.form.submit()}}else{e.httpMethod="GET";e.mode=e.isPoll?dwr.engine._ModePlainPoll:dwr.engine._ModePlainCall;c=dwr.engine._constructRequest(e);e.script=document.createElement("script");e.script.id="dwr-st-"+e.map["c0-id"];e.script.src=c.url;document.body.appendChild(e.script)}}};dwr.engine._ModePlainCall="/call/plaincall/";dwr.engine._ModeHtmlCall="/call/htmlcall/";dwr.engine._ModePlainPoll="/call/plainpoll/";dwr.engine._ModeHtmlPoll="/call/htmlpoll/";dwr.engine._constructRequest=function(a){var b={url:a.path+a.mode,body:null};if(a.isPoll==true){b.url+="Poll.req"}else{if(a.map.callCount==1){b.url+=a.map["c0-scriptName"]+"."+a.map["c0-methodName"]+".req"}else{b.url+="Batch."+a.map.callCount+".req"}}if(dwr.engine._getJSessionId()==""){b.url+=";jsessionid="+dwr.engine._sessionId}var c;if(a.httpMethod=="GET"){a.map.callCount=""+a.map.callCount;b.url+="?";for(c in a.map){if(typeof a.map[c]!="function"){b.url+=encodeURIComponent(c)+"="+encodeURIComponent(a.map[c])+"&"}}b.url=b.url.substring(0,b.url.length-1)}else{b.body="";for(c in a.map){if(typeof a.map[c]!="function"){b.body+=c+"="+a.map[c]+dwr.engine._postSeperator}}b.body=dwr.engine._contentRewriteHandler(b.body)}b.url=dwr.engine._urlRewriteHandler(b.url);return b};dwr.engine._stateChange=function(c){var b;if(c.completed){dwr.engine._debug("Error: _stateChange() with batch.completed");return}var f=c.req;try{if(f.readyState!=4){return}}catch(d){dwr.engine._handleWarning(c,d);dwr.engine._clearUp(c);return}try{var e=f.responseText;e=dwr.engine._replyRewriteHandler(e);var a=f.status;if(e==null||e==""){dwr.engine._handleWarning(c,{name:"dwr.engine.missingData",message:"No data received from server"})}else{if(a!=200){dwr.engine._handleError(c,{name:"dwr.engine.http."+a,message:f.statusText})}else{var g=f.getResponseHeader("Content-Type");if(!g.match(/^text\/plain/)&&!g.match(/^text\/javascript/)){if(g.match(/^text\/html/)&&typeof c.textHtmlHandler=="function"){c.textHtmlHandler()}else{dwr.engine._handleWarning(c,{name:"dwr.engine.invalidMimeType",message:"Invalid content type: '"+g+"'"})}}else{if(c.isPoll&&c.map.partialResponse==dwr.engine._partialResponseYes){dwr.engine._processCometResponse(e,c)}else{if(e.search("//#DWR")==-1){dwr.engine._handleWarning(c,{name:"dwr.engine.invalidReply",message:"Invalid reply from server"})}else{b=e}}}}}}catch(d){dwr.engine._handleWarning(c,d)}dwr.engine._callPostHooks(c);dwr.engine._receivedBatch=c;if(b!=null){b=b.replace(dwr.engine._scriptTagProtection,"")}dwr.engine._eval(b);dwr.engine._receivedBatch=null;dwr.engine._validateBatch(c);dwr.engine._clearUp(c)};dwr.engine._validateBatch=function(a){if(!a.completed){for(var b=0;b<a.map.callCount;b++){if(a.handlers[b]!=null){dwr.engine._handleWarning(a,{name:"dwr.engine.incompleteReply",message:"Incomplete reply from server"});break}}}};dwr.engine._iframeLoadingComplete=function(a){var b=dwr.engine._batches[a];if(b){dwr.engine._validateBatch(b)}};dwr.engine._remoteHandleCallback=function(a,f,e){var c=dwr.engine._batches[a];if(a==0){return}if(c==null){dwr.engine._debug("Warning: batch == null in remoteHandleCallback for batchId="+a,true);return}try{var b=c.handlers[f];c.handlers[f]=null;if(!b){dwr.engine._debug("Warning: Missing handlers. callId="+f,true)}else{if(typeof b.callback=="function"){b.callback(e)}}}catch(d){dwr.engine._handleError(c,d)}};dwr.engine._remoteHandleException=function(a,e,d){var c=dwr.engine._batches[a];if(c==null){dwr.engine._debug("Warning: null batch in remoteHandleException",true);return}var b=c.handlers[e];c.handlers[e]=null;if(b==null){dwr.engine._debug("Warning: null handlers in remoteHandleException",true);return}if(d.message==undefined){d.message=""}if(typeof b.exceptionHandler=="function"){b.exceptionHandler(d.message,d)}else{if(typeof c.errorHandler=="function"){c.errorHandler(d.message,d)}}};dwr.engine._remoteHandleBatchException=function(c,a){var b=(dwr.engine._receivedBatch==null&&a!=null);if(b){dwr.engine._receivedBatch=dwr.engine._batches[a]}if(c.message==undefined){c.message=""}dwr.engine._handleError(dwr.engine._receivedBatch,c);if(b){dwr.engine._receivedBatch=null;dwr.engine._clearUp(dwr.engine._batches[a])}};dwr.engine._remotePollCometDisabled=function(c,a){dwr.engine.setActiveReverseAjax(false);var b=(dwr.engine._receivedBatch==null&&a!=null);if(b){dwr.engine._receivedBatch=dwr.engine._batches[a]}if(c.message==undefined){c.message=""}dwr.engine._handleError(dwr.engine._receivedBatch,c);if(b){dwr.engine._receivedBatch=null;dwr.engine._clearUp(dwr.engine._batches[a])}};dwr.engine._remoteBeginIFrameResponse=function(b,a){if(b!=null){dwr.engine._receivedBatch=b.batch}dwr.engine._callPostHooks(dwr.engine._receivedBatch)};dwr.engine._remoteEndIFrameResponse=function(a){dwr.engine._clearUp(dwr.engine._receivedBatch);dwr.engine._receivedBatch=null};dwr.engine._eval=function(script){if(script==null){return null}if(script==""){dwr.engine._debug("Warning: blank script",true);return null}return eval(script)};dwr.engine._abortRequest=function(a){if(a&&!a.completed){clearInterval(a.interval);dwr.engine._clearUp(a);if(a.req){a.req.abort()}dwr.engine._handleError(a,{name:"dwr.engine.timeout",message:"Timeout"})}};dwr.engine._callPostHooks=function(a){if(a.postHooks){for(var b=0;b<a.postHooks.length;b++){a.postHooks[b]()}a.postHooks=null}};dwr.engine._clearUp=function(b){if(!b){dwr.engine._debug("Warning: null batch in dwr.engine._clearUp()",true);return}if(b.completed=="true"){dwr.engine._debug("Warning: Double complete",true);return}if(b.div){b.div.parentNode.removeChild(b.div)}if(b.iframe){for(var c=0;c<dwr.engine._outstandingIFrames.length;c++){if(dwr.engine._outstandingIFrames[c]==b.iframe){dwr.engine._outstandingIFrames.splice(c,1)}}b.iframe.parentNode.removeChild(b.iframe);b.iframe=null}if(b.form){b.form.parentNode.removeChild(b.form)}if(b.req){if(b.req==dwr.engine._pollReq){dwr.engine._pollReq=null}delete b.req}if(b.map&&b.map.batchId){delete dwr.engine._batches[b.map.batchId];dwr.engine._batchesLength--}b.completed=true;if(dwr.engine._batchQueue.length!=0){var a=dwr.engine._batchQueue.shift();dwr.engine._sendData(a)}};dwr.engine._handleError=function(a,b){if(typeof b=="string"){b={name:"unknown",message:b}}if(b.message==null){b.message=""}if(b.name==null){b.name="unknown"}if(a&&typeof a.errorHandler=="function"){a.errorHandler(b.message,b)}else{if(dwr.engine._errorHandler){dwr.engine._errorHandler(b.message,b)}}if(a){dwr.engine._clearUp(a)}};dwr.engine._handleWarning=function(a,b){if(typeof b=="string"){b={name:"unknown",message:b}}if(b.message==null){b.message=""}if(b.name==null){b.name="unknown"}if(a&&typeof a.warningHandler=="function"){a.warningHandler(b.message,b)}else{if(dwr.engine._warningHandler){dwr.engine._warningHandler(b.message,b)}}if(a){dwr.engine._clearUp(a)}};dwr.engine._serializeAll=function(b,d,c,a){if(c==null){b.map[a]="null:null";return}switch(typeof c){case"boolean":b.map[a]="boolean:"+c;break;case"number":b.map[a]="number:"+c;break;case"string":b.map[a]="string:"+encodeURIComponent(c);break;case"object":if(c instanceof String){b.map[a]="String:"+encodeURIComponent(c)}else{if(c instanceof Boolean){b.map[a]="Boolean:"+c}else{if(c instanceof Number){b.map[a]="Number:"+c}else{if(c instanceof Date){b.map[a]="Date:"+c.getTime()}else{if(c&&c.join){b.map[a]=dwr.engine._serializeArray(b,d,c,a)}else{b.map[a]=dwr.engine._serializeObject(b,d,c,a)}}}}}break;case"function":break;default:dwr.engine._handleWarning(null,{name:"dwr.engine.unexpectedType",message:"Unexpected type: "+typeof c+", attempting default converter."});b.map[a]="default:"+c;break}};dwr.engine._lookup=function(e,c,a){var d;for(var b=0;b<e.length;b++){if(e[b].data==c){d=e[b];break}}if(d){return"reference:"+d.name}e.push({data:c,name:a});return null};dwr.engine._serializeObject=function(c,h,g,b){var f=dwr.engine._lookup(h,g,b);if(f){return f}if(g.nodeName&&g.nodeType){return dwr.engine._serializeXml(c,h,g,b)}var e="Object_"+dwr.engine._getObjectClassName(g)+":{";var d;for(d in g){if(typeof g[d]!="function"){c.paramCount++;var a="c"+dwr.engine._batch.map.callCount+"-e"+c.paramCount;dwr.engine._serializeAll(c,h,g[d],a);e+=encodeURIComponent(d)+":reference:"+a+", "}}if(e.substring(e.length-2)==", "){e=e.substring(0,e.length-2)}e+="}";return e};dwr.engine._errorClasses={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};dwr.engine._getObjectClassName=function(c){if(c&&c.constructor&&c.constructor.toString){var d=c.constructor.toString();var a=d.match(/function\s+(\w+)/);if(a&&a.length==2){return a[1]}}if(c&&c.constructor){for(var b in dwr.engine._errorClasses){if(c.constructor==dwr.engine._errorClasses[b]){return b}}}if(c){var d=Object.prototype.toString.call(c);var a=d.match(/\[object\s+(\w+)/);if(a&&a.length==2){return a[1]}}return"Object"};dwr.engine._serializeXml=function(c,f,e,b){var d=dwr.engine._lookup(f,e,b);if(d){return d}var a;if(window.XMLSerializer){a=new XMLSerializer().serializeToString(e)}else{if(e.toXml){a=e.toXml}else{a=e.innerHTML}}return"XML:"+encodeURIComponent(a)};dwr.engine._serializeArray=function(c,h,g,b){var f=dwr.engine._lookup(h,g,b);if(f){return f}var e="Array:[";for(var d=0;d<g.length;d++){if(d!=0){e+=","}c.paramCount++;var a="c"+dwr.engine._batch.map.callCount+"-e"+c.paramCount;dwr.engine._serializeAll(c,h,g[d],a);e+="reference:";e+=a}e+="]";return e};dwr.engine._unserializeDocument=function(a){var c;if(window.DOMParser){var e=new DOMParser();c=e.parseFromString(a,"text/xml");if(!c.documentElement||c.documentElement.tagName=="parsererror"){var b=c.documentElement.firstChild.data;b+="\n"+c.documentElement.firstChild.nextSibling.firstChild.data;throw b}return c}else{if(window.ActiveXObject){c=dwr.engine._newActiveXObject(dwr.engine._DOMDocument);c.loadXML(a);return c}else{var d=document.createElement("div");d.innerHTML=a;return d}}};dwr.engine._newActiveXObject=function(a){var d;for(var c=0;c<a.length;c++){try{d=new ActiveXObject(a[c]);break}catch(b){}}return d};dwr.engine._debug=function(f,d){var a=false;try{if(window.console){if(d&&window.console.trace){window.console.trace()}window.console.log(f);a=true}else{if(window.opera&&window.opera.postError){window.opera.postError(f);a=true}}}catch(c){}if(!a){var b=document.getElementById("dwr-debug");if(b){var e=f+"<br/>"+b.innerHTML;if(e.length>2048){e=e.substring(0,2048)}b.innerHTML=e}}};Gettext=function(c){this.domain="messages";this.locale_data=undefined;var b=["domain","locale_data"];if(this.isValidObject(c)){for(var d in c){for(var a=0;a<b.length;a++){if(d==b[a]){if(this.isValidObject(c[d])){this[d]=c[d]}}}}}this.try_load_lang();return this};Gettext.context_glue="\004";Gettext._locale_data={};Gettext.prototype.try_load_lang=function(){if(typeof(this.locale_data)!="undefined"){var d=this.locale_data;this.locale_data=undefined;this.parse_locale_data(d);if(typeof(Gettext._locale_data[this.domain])=="undefined"){throw new Error("Error: Gettext 'locale_data' does not contain the domain '"+this.domain+"'")}}var b=this.get_lang_refs();if(typeof(b)=="object"&&b.length>0){for(var a=0;a<b.length;a++){var c=b[a];if(c.type=="application/json"){if(!this.try_load_lang_json(c.href)){throw new Error("Error: Gettext 'try_load_lang_json' failed. Unable to exec xmlhttprequest for link ["+c.href+"]")}}else{if(c.type=="application/x-po"){if(!this.try_load_lang_po(c.href)){throw new Error("Error: Gettext 'try_load_lang_po' failed. Unable to exec xmlhttprequest for link ["+c.href+"]")}}else{throw new Error("TODO: link type ["+c.type+"] found, and support is planned, but not implemented at this time.")}}}}};Gettext.prototype.parse_locale_data=function(f){if(typeof(Gettext._locale_data)=="undefined"){Gettext._locale_data={}}for(var e in f){if((!f.hasOwnProperty(e))||(!this.isValidObject(f[e]))){continue}var b=false;for(var a in f[e]){b=true;break}if(!b){continue}var g=f[e];if(e==""){e="messages"}if(!this.isValidObject(Gettext._locale_data[e])){Gettext._locale_data[e]={}}if(!this.isValidObject(Gettext._locale_data[e].head)){Gettext._locale_data[e].head={}}if(!this.isValidObject(Gettext._locale_data[e].msgs)){Gettext._locale_data[e].msgs={}}for(var n in g){if(n==""){var j=g[n];for(var m in j){var i=m.toLowerCase();Gettext._locale_data[e].head[i]=j[m]}}else{Gettext._locale_data[e].msgs[n]=g[n]}}}for(var e in Gettext._locale_data){if(this.isValidObject(Gettext._locale_data[e].head["plural-forms"])&&typeof(Gettext._locale_data[e].head.plural_func)=="undefined"){var l=Gettext._locale_data[e].head["plural-forms"];var d=new RegExp("^(\\s*nplurals\\s*=\\s*[0-9]+\\s*;\\s*plural\\s*=\\s*(?:\\s|[-\\?\\|&=!<>+*/%:;a-zA-Z0-9_()])+)","m");if(d.test(l)){var k=Gettext._locale_data[e].head["plural-forms"];if(!/;\s*$/.test(k)){k=k.concat(";")}var c="var plural; var nplurals; "+k+' return { "nplural" : nplurals, "plural" : (plural === true ? 1 : plural ? plural : 0) };';Gettext._locale_data[e].head.plural_func=new Function("n",c)}else{throw new Error("Syntax error in language file. Plural-Forms header is invalid ["+l+"]")}}else{if(typeof(Gettext._locale_data[e].head.plural_func)=="undefined"){Gettext._locale_data[e].head.plural_func=function(o){var h=(o!=1)?1:0;return{nplural:2,plural:h}}}}}return};Gettext.prototype.try_load_lang_po=function(b){var d=this.sjax(b);if(!d){return}var c=this.uri_basename(b);var a=this.parse_po(d);var e={};if(a){if(!a[""]){a[""]={}}if(!a[""]["domain"]){a[""]["domain"]=c}c=a[""]["domain"];e[c]=a;this.parse_locale_data(e)}return 1};Gettext.prototype.uri_basename=function(b){var c;if(c=b.match(/^(.*\/)?(.*)/)){var a;if(a=c[2].match(/^(.*)\..+$/)){return a[1]}else{return c[2]}}else{return""}};Gettext.prototype.try_load_lang_json=function(a){var b=this.sjax(a);if(!b){return}var c=this.JSON(b);this.parse_locale_data(c);return 1};Gettext.prototype.get_lang_refs=function(){var c=new Array();var a=document.getElementsByTagName("link");for(var b=0;b<a.length;b++){if(a[b].rel=="gettext"&&a[b].href){if(typeof(a[b].type)=="undefined"||a[b].type==""){if(/\.json$/i.test(a[b].href)){a[b].type="application/json"}else{if(/\.js$/i.test(a[b].href)){a[b].type="application/json"}else{if(/\.po$/i.test(a[b].href)){a[b].type="application/x-po"}else{if(/\.mo$/i.test(a[b].href)){a[b].type="application/x-mo"}else{throw new Error("LINK tag with rel=gettext found, but the type and extension are unrecognized.")}}}}}a[b].type=a[b].type.toLowerCase();if(a[b].type=="application/json"){a[b].type="application/json"}else{if(a[b].type=="text/javascript"){a[b].type="application/json"}else{if(a[b].type=="application/x-po"){a[b].type="application/x-po"}else{if(a[b].type=="application/x-mo"){a[b].type="application/x-mo"}else{throw new Error("LINK tag with rel=gettext found, but the type attribute ["+a[b].type+"] is unrecognized.")}}}}c.push(a[b])}}return c};Gettext.prototype.textdomain=function(a){if(a&&a.length){this.domain=a}return this.domain};Gettext.prototype.gettext=function(c){var e;var a;var d;var b;return this.dcnpgettext(null,e,c,a,d,b)};Gettext.prototype.dgettext=function(d,c){var f;var a;var e;var b;return this.dcnpgettext(d,f,c,a,e,b)};Gettext.prototype.dcgettext=function(d,c,b){var f;var a;var e;return this.dcnpgettext(d,f,c,a,e,b)};Gettext.prototype.ngettext=function(c,a,e){var d;var b;return this.dcnpgettext(null,d,c,a,e,b)};Gettext.prototype.dngettext=function(d,c,a,f){var e;var b;return this.dcnpgettext(d,e,c,a,f,b)};Gettext.prototype.dcngettext=function(d,c,a,f,b){var e;return this.dcnpgettext(d,e,c,a,f,b,b)};Gettext.prototype.pgettext=function(e,c){var a;var d;var b;return this.dcnpgettext(null,e,c,a,d,b)};Gettext.prototype.dpgettext=function(d,f,c){var a;var e;var b;return this.dcnpgettext(d,f,c,a,e,b)};Gettext.prototype.dcpgettext=function(d,f,c,b){var a;var e;return this.dcnpgettext(d,f,c,a,e,b)};Gettext.prototype.npgettext=function(e,c,a,d){var b;return this.dcnpgettext(null,e,c,a,d,b)};Gettext.prototype.dnpgettext=function(d,f,c,a,e){var b;return this.dcnpgettext(d,f,c,a,e,b)};Gettext.prototype.dcnpgettext=function(y,e,x,s,l,o){if(!this.isValidObject(x)){return""}var g=this.isValidObject(s);var u=this.isValidObject(e)?e+Gettext.context_glue+x:x;var a=this.isValidObject(y)?y:this.isValidObject(this.domain)?this.domain:"messages";var w="LC_MESSAGES";var o=5;var m=new Array();if(typeof(Gettext._locale_data)!="undefined"&&this.isValidObject(Gettext._locale_data[a])){m.push(Gettext._locale_data[a])}else{if(typeof(Gettext._locale_data)!="undefined"){for(var v in Gettext._locale_data){m.push(Gettext._locale_data[v])}}}var b=[];var f=false;var k;if(m.length){for(var t=0;t<m.length;t++){var r=m[t];if(this.isValidObject(r.msgs[u])){for(var q=0;q<r.msgs[u].length;q++){b[q]=r.msgs[u][q]}b.shift();k=r;f=true;if(b.length>0&&b[0].length!=0){break}}}}if(b.length==0||b[0].length==0){b=[x,s]}var d=b[0];if(g){var h;if(f&&this.isValidObject(k.head.plural_func)){var c=k.head.plural_func(l);if(!c.plural){c.plural=0}if(!c.nplural){c.nplural=0}if(c.nplural<=c.plural){c.plural=0}h=c.plural}else{h=(l!=1)?1:0}if(this.isValidObject(b[h])){d=b[h]}}return d};Gettext.strargs=function(g,c){if(null==c||"undefined"==typeof(c)){c=[]}else{if(c.constructor!=Array){c=[c]}}var f="";while(true){var d=g.indexOf("%");var a;if(d==-1){f+=g;break}f+=g.substr(0,d);if(g.substr(d,2)=="%%"){f+="%";g=g.substr((d+2))}else{if(a=g.substr(d).match(/^%(\d+)/)){var e=parseInt(a[1]);var b=a[1].length;if(e>0&&c[e-1]!=null&&typeof(c[e-1])!="undefined"){f+=c[e-1]}g=g.substr((d+1+b))}else{f+="%";g=g.substr((d+1))}}}return f};Gettext.prototype.strargs=function(b,a){return Gettext.strargs(b,a)};Gettext.prototype.isArray=function(a){return this.isValidObject(a)&&a.constructor==Array};Gettext.prototype.isValidObject=function(a){if(null==a){return false}else{if("undefined"==typeof(a)){return false}else{return true}}};Gettext.prototype.sjax=function(d){var c;if(window.XMLHttpRequest){c=new XMLHttpRequest()}else{if(navigator.userAgent.toLowerCase().indexOf("msie 5")!=-1){c=new ActiveXObject("Microsoft.XMLHTTP")}else{c=new ActiveXObject("Msxml2.XMLHTTP")}}if(!c){throw new Error("Your browser doesn't do Ajax. Unable to support external language files.")}c.open("GET",d,false);try{c.send(null)}catch(f){return}var a=c.status;if(a==200||a==0){return c.responseText}else{var b=c.statusText+" (Error "+c.status+")";if(c.responseText.length){b+="\n"+c.responseText}alert(b);return}};Gettext.prototype.JSON=function(data){return eval("("+data+")")};
/*!
 *  howler.js v2.0.1
 *  howlerjs.com
 *
 *  (c) 2013-2016, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
(function(){var c=function(){this.init()};c.prototype={init:function(){var k=this||j;k._codecs={};k._howls=[];k._muted=false;k._volume=1;k._canPlayEvent="canplaythrough";k._navigator=(typeof window!=="undefined"&&window.navigator)?window.navigator:null;k.masterGain=null;k.noAudio=false;k.usingWebAudio=true;k.autoSuspend=true;k.ctx=null;k.mobileAutoEnable=true;k._setup();return k},volume:function(n){var k=this||j;n=parseFloat(n);if(!k.ctx){e()}if(typeof n!=="undefined"&&n>=0&&n<=1){k._volume=n;if(k._muted){return k}if(k.usingWebAudio){k.masterGain.gain.value=n}for(var m=0;m<k._howls.length;m++){if(!k._howls[m]._webAudio){var o=k._howls[m]._getSoundIds();for(var l=0;l<o.length;l++){var p=k._howls[m]._soundById(o[l]);if(p&&p._node){p._node.volume=p._volume*n}}}}return k}return k._volume},mute:function(o){var k=this||j;if(!k.ctx){e()}k._muted=o;if(k.usingWebAudio){k.masterGain.gain.value=o?0:k._volume}for(var m=0;m<k._howls.length;m++){if(!k._howls[m]._webAudio){var n=k._howls[m]._getSoundIds();for(var l=0;l<n.length;l++){var p=k._howls[m]._soundById(n[l]);if(p&&p._node){p._node.muted=(o)?true:p._muted}}}}return k},unload:function(){var k=this||j;for(var l=k._howls.length-1;l>=0;l--){k._howls[l].unload()}if(k.usingWebAudio&&typeof k.ctx.close!=="undefined"){k.ctx.close();k.ctx=null;e()}return k},codecs:function(k){return(this||j)._codecs[k.replace(/^x-/,"")]},_setup:function(){var k=this||j;k.state=k.ctx?k.ctx.state||"running":"running";k._autoSuspend();if(!k.noAudio){k._setupCodecs()}return k},_setupCodecs:function(){var k=this||j;var m=(typeof Audio!=="undefined")?new Audio():null;if(!m||typeof m.canPlayType!=="function"){return k}var o=m.canPlayType("audio/mpeg;").replace(/^no$/,"");var n=k._navigator&&k._navigator.userAgent.match(/OPR\/([0-6].)/g);var l=(n&&parseInt(n[0].split("/")[1],10)<33);k._codecs={mp3:!!(!l&&(o||m.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!o,opus:!!m.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!m.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!m.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!m.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!m.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!m.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(m.canPlayType("audio/x-m4a;")||m.canPlayType("audio/m4a;")||m.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(m.canPlayType("audio/x-mp4;")||m.canPlayType("audio/mp4;")||m.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!m.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!m.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!m.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(m.canPlayType("audio/x-flac;")||m.canPlayType("audio/flac;")).replace(/^no$/,"")};return k},_enableMobileAudio:function(){var m=this||j;var k=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(m._navigator&&m._navigator.userAgent);var l=!!(("ontouchend" in window)||(m._navigator&&m._navigator.maxTouchPoints>0)||(m._navigator&&m._navigator.msMaxTouchPoints>0));if(m._mobileEnabled||!m.ctx||(!k&&!l)){return}m._mobileEnabled=false;if(!m._mobileUnloaded&&m.ctx.sampleRate!==44100){m._mobileUnloaded=true;m.unload()}m._scratchBuffer=m.ctx.createBuffer(1,1,22050);var n=function(){var o=m.ctx.createBufferSource();o.buffer=m._scratchBuffer;o.connect(m.ctx.destination);if(typeof o.start==="undefined"){o.noteOn(0)}else{o.start(0)}o.onended=function(){o.disconnect(0);m._mobileEnabled=true;m.mobileAutoEnable=false;document.removeEventListener("touchend",n,true)}};document.addEventListener("touchend",n,true);return m},_autoSuspend:function(){var k=this;if(!k.autoSuspend||!k.ctx||typeof k.ctx.suspend==="undefined"||!j.usingWebAudio){return}for(var m=0;m<k._howls.length;m++){if(k._howls[m]._webAudio){for(var l=0;l<k._howls[m]._sounds.length;l++){if(!k._howls[m]._sounds[l]._paused){return k}}}}if(k._suspendTimer){clearTimeout(k._suspendTimer)}k._suspendTimer=setTimeout(function(){if(!k.autoSuspend){return}k._suspendTimer=null;k.state="suspending";k.ctx.suspend().then(function(){k.state="suspended";if(k._resumeAfterSuspend){delete k._resumeAfterSuspend;k._autoResume()}})},30000);return k},_autoResume:function(){var k=this;if(!k.ctx||typeof k.ctx.resume==="undefined"||!j.usingWebAudio){return}if(k.state==="running"&&k._suspendTimer){clearTimeout(k._suspendTimer);k._suspendTimer=null}else{if(k.state==="suspended"){k.state="resuming";k.ctx.resume().then(function(){k.state="running"});if(k._suspendTimer){clearTimeout(k._suspendTimer);k._suspendTimer=null}}else{if(k.state==="suspending"){k._resumeAfterSuspend=true}}}return k}};var j=new c();var d=function(l){var k=this;if(!l.src||l.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}k.init(l)};d.prototype={init:function(l){var k=this;if(!j.ctx){e()}k._autoplay=l.autoplay||false;k._format=(typeof l.format!=="string")?l.format:[l.format];k._html5=l.html5||false;k._muted=l.mute||false;k._loop=l.loop||false;k._pool=l.pool||5;k._preload=(typeof l.preload==="boolean")?l.preload:true;k._rate=l.rate||1;k._sprite=l.sprite||{};k._src=(typeof l.src!=="string")?l.src:[l.src];k._volume=l.volume!==undefined?l.volume:1;k._duration=0;k._state="unloaded";k._sounds=[];k._endTimers={};k._queue=[];k._onend=l.onend?[{fn:l.onend}]:[];k._onfade=l.onfade?[{fn:l.onfade}]:[];k._onload=l.onload?[{fn:l.onload}]:[];k._onloaderror=l.onloaderror?[{fn:l.onloaderror}]:[];k._onpause=l.onpause?[{fn:l.onpause}]:[];k._onplay=l.onplay?[{fn:l.onplay}]:[];k._onstop=l.onstop?[{fn:l.onstop}]:[];k._onmute=l.onmute?[{fn:l.onmute}]:[];k._onvolume=l.onvolume?[{fn:l.onvolume}]:[];k._onrate=l.onrate?[{fn:l.onrate}]:[];k._onseek=l.onseek?[{fn:l.onseek}]:[];k._webAudio=j.usingWebAudio&&!k._html5;if(typeof j.ctx!=="undefined"&&j.ctx&&j.mobileAutoEnable){j._enableMobileAudio()}j._howls.push(k);if(k._preload){k.load()}return k},load:function(){var k=this;var l=null;if(j.noAudio){k._emit("loaderror",null,"No audio support.");return}if(typeof k._src==="string"){k._src=[k._src]}for(var m=0;m<k._src.length;m++){var n,o;if(k._format&&k._format[m]){n=k._format[m]}else{o=k._src[m];if(typeof o!=="string"){k._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}n=/^data:audio\/([^;,]+);/i.exec(o);if(!n){n=/\.([^.]+)$/.exec(o.split("?",1)[0])}if(n){n=n[1].toLowerCase()}}if(j.codecs(n)){l=k._src[m];break}}if(!l){k._emit("loaderror",null,"No codec support for selected audio sources.");return}k._src=l;k._state="loading";if(window.location.protocol==="https:"&&l.slice(0,5)==="http:"){k._html5=true;k._webAudio=false}new g(k);if(k._webAudio){i(k)}return k},play:function(w,r){var y=this;var k=null;if(typeof w==="number"){k=w;w=null}else{if(typeof w==="string"&&y._state==="loaded"&&!y._sprite[w]){return null}else{if(typeof w==="undefined"){w="__default";var s=0;for(var q=0;q<y._sounds.length;q++){if(y._sounds[q]._paused&&!y._sounds[q]._ended){s++;k=y._sounds[q]._id}}if(s===1){w=null}else{k=null}}}}var v=k?y._soundById(k):y._inactiveSound();if(!v){return null}if(k&&!w){w=v._sprite||"__default"}if(y._state!=="loaded"&&!y._sprite[w]){y._queue.push({event:"play",action:function(){y.play(y._soundById(v._id)?v._id:undefined)}});return v._id}if(k&&!v._paused){if(!r){setTimeout(function(){y._emit("play",v._id)},0)}return v._id}if(y._webAudio){j._autoResume()}var l=v._seek>0?v._seek:y._sprite[w][0]/1000;var p=((y._sprite[w][0]+y._sprite[w][1])/1000)-l;var u=(p*1000)/Math.abs(v._rate);v._paused=false;v._ended=false;v._sprite=w;v._seek=l;v._start=y._sprite[w][0]/1000;v._stop=(y._sprite[w][0]+y._sprite[w][1])/1000;v._loop=!!(v._loop||y._sprite[w][2]);var o=v._node;if(y._webAudio){var t=function(){y._refreshBuffer(v);var z=(v._muted||y._muted)?0:v._volume;o.gain.setValueAtTime(z,j.ctx.currentTime);v._playStart=j.ctx.currentTime;if(typeof o.bufferSource.start==="undefined"){v._loop?o.bufferSource.noteGrainOn(0,l,86400):o.bufferSource.noteGrainOn(0,l,p)}else{v._loop?o.bufferSource.start(0,l,86400):o.bufferSource.start(0,l,p)}if(u!==Infinity){y._endTimers[v._id]=setTimeout(y._ended.bind(y,v),u)}if(!r){setTimeout(function(){y._emit("play",v._id)},0)}};if(y._state==="loaded"){t()}else{y.once("load",t,v._id);y._clearTimer(v._id)}}else{var n=function(){o.currentTime=l;o.muted=v._muted||y._muted||j._muted||o.muted;o.volume=v._volume*j.volume();o.playbackRate=v._rate;setTimeout(function(){o.play();if(u!==Infinity){y._endTimers[v._id]=setTimeout(y._ended.bind(y,v),u)}if(!r){y._emit("play",v._id)}},0)};var x=(y._state==="loaded"&&(window&&window.ejecta||!o.readyState&&j._navigator.isCocoonJS));if(o.readyState===4||x){n()}else{var m=function(){n();o.removeEventListener(j._canPlayEvent,m,false)};o.addEventListener(j._canPlayEvent,m,false);y._clearTimer(v._id)}}return v._id},pause:function(o){var k=this;if(k._state!=="loaded"){k._queue.push({event:"pause",action:function(){k.pause(o)}});return k}var m=k._getSoundIds(o);for(var l=0;l<m.length;l++){k._clearTimer(m[l]);var n=k._soundById(m[l]);if(n&&!n._paused){n._seek=k.seek(m[l]);n._rateSeek=0;n._paused=true;k._stopFade(m[l]);if(n._node){if(k._webAudio){if(!n._node.bufferSource){return k}if(typeof n._node.bufferSource.stop==="undefined"){n._node.bufferSource.noteOff(0)}else{n._node.bufferSource.stop(0)}k._cleanBuffer(n._node)}else{if(!isNaN(n._node.duration)||n._node.duration===Infinity){n._node.pause()}}}if(!arguments[1]){k._emit("pause",n._id)}}}return k},stop:function(p,k){var l=this;if(l._state!=="loaded"){l._queue.push({event:"stop",action:function(){l.stop(p)}});return l}var n=l._getSoundIds(p);for(var m=0;m<n.length;m++){l._clearTimer(n[m]);var o=l._soundById(n[m]);if(o){o._seek=o._start||0;o._rateSeek=0;o._paused=true;o._ended=true;l._stopFade(n[m]);if(o._node){if(l._webAudio){if(!o._node.bufferSource){if(!k){l._emit("stop",o._id)}return l}if(typeof o._node.bufferSource.stop==="undefined"){o._node.bufferSource.noteOff(0)}else{o._node.bufferSource.stop(0)}l._cleanBuffer(o._node)}else{if(!isNaN(o._node.duration)||o._node.duration===Infinity){o._node.currentTime=o._start||0;o._node.pause()}}}}if(o&&!k){l._emit("stop",o._id)}}return l},mute:function(n,p){var k=this;if(k._state!=="loaded"){k._queue.push({event:"mute",action:function(){k.mute(n,p)}});return k}if(typeof p==="undefined"){if(typeof n==="boolean"){k._muted=n}else{return k._muted}}var m=k._getSoundIds(p);for(var l=0;l<m.length;l++){var o=k._soundById(m[l]);if(o){o._muted=n;if(k._webAudio&&o._node){o._node.gain.setValueAtTime(n?0:o._volume,j.ctx.currentTime)}else{if(o._node){o._node.muted=j._muted?true:n}}k._emit("mute",o._id)}}return k},volume:function(){var k=this;var m=arguments;var o,r;if(m.length===0){return k._volume}else{if(m.length===1||m.length===2&&typeof m[1]==="undefined"){var p=k._getSoundIds();var l=p.indexOf(m[0]);if(l>=0){r=parseInt(m[0],10)}else{o=parseFloat(m[0])}}else{if(m.length>=2){o=parseFloat(m[0]);r=parseInt(m[1],10)}}}var q;if(typeof o!=="undefined"&&o>=0&&o<=1){if(k._state!=="loaded"){k._queue.push({event:"volume",action:function(){k.volume.apply(k,m)}});return k}if(typeof r==="undefined"){k._volume=o}r=k._getSoundIds(r);for(var n=0;n<r.length;n++){q=k._soundById(r[n]);if(q){q._volume=o;if(!m[2]){k._stopFade(r[n])}if(k._webAudio&&q._node&&!q._muted){q._node.gain.setValueAtTime(o,j.ctx.currentTime)}else{if(q._node&&!q._muted){q._node.volume=o*j.volume()}}k._emit("volume",q._id)}}}else{q=r?k._soundById(r):k._sounds[0];return q?q._volume:0}return k},fade:function(u,v,r,m){var y=this;var w=Math.abs(u-v);var n=u>v?"out":"in";var t=w/0.01;var s=(t>0)?r/t:r;if(s<4){t=Math.ceil(t/(4/s));s=4}if(y._state!=="loaded"){y._queue.push({event:"fade",action:function(){y.fade(u,v,r,m)}});return y}y.volume(u,m);var k=y._getSoundIds(m);for(var q=0;q<k.length;q++){var x=y._soundById(k[q]);if(x){if(!m){y._stopFade(k[q])}if(y._webAudio&&!x._muted){var l=j.ctx.currentTime;var p=l+(r/1000);x._volume=u;x._node.gain.setValueAtTime(u,l);x._node.gain.linearRampToValueAtTime(v,p)}var o=u;x._interval=setInterval(function(z,A){if(t>0){o+=(n==="in"?0.01:-0.01)}o=Math.max(0,o);o=Math.min(1,o);o=Math.round(o*100)/100;if(y._webAudio){if(typeof m==="undefined"){y._volume=o}A._volume=o}else{y.volume(o,z,true)}if(o===v){clearInterval(A._interval);A._interval=null;y.volume(o,z);y._emit("fade",z)}}.bind(y,k[q],x),s)}}return y},_stopFade:function(m){var k=this;var l=k._soundById(m);if(l&&l._interval){if(k._webAudio){l._node.gain.cancelScheduledValues(j.ctx.currentTime)}clearInterval(l._interval);l._interval=null;k._emit("fade",m)}return k},loop:function(){var l=this;var m=arguments;var k,q,p;if(m.length===0){return l._loop}else{if(m.length===1){if(typeof m[0]==="boolean"){k=m[0];l._loop=k}else{p=l._soundById(parseInt(m[0],10));return p?p._loop:false}}else{if(m.length===2){k=m[0];q=parseInt(m[1],10)}}}var o=l._getSoundIds(q);for(var n=0;n<o.length;n++){p=l._soundById(o[n]);if(p){p._loop=k;if(l._webAudio&&p._node&&p._node.bufferSource){p._node.bufferSource.loop=k;if(k){p._node.bufferSource.loopStart=p._start||0;p._node.bufferSource.loopEnd=p._stop}}}}return l},rate:function(){var u=this;var r=arguments;var q,l;if(r.length===0){l=u._sounds[0]._id}else{if(r.length===1){var k=u._getSoundIds();var p=k.indexOf(r[0]);if(p>=0){l=parseInt(r[0],10)}else{q=parseFloat(r[0])}}else{if(r.length===2){q=parseFloat(r[0]);l=parseInt(r[1],10)}}}var t;if(typeof q==="number"){if(u._state!=="loaded"){u._queue.push({event:"rate",action:function(){u.rate.apply(u,r)}});return u}if(typeof l==="undefined"){u._rate=q}l=u._getSoundIds(l);for(var o=0;o<l.length;o++){t=u._soundById(l[o]);if(t){t._rateSeek=u.seek(l[o]);t._playStart=u._webAudio?j.ctx.currentTime:t._playStart;t._rate=q;if(u._webAudio&&t._node&&t._node.bufferSource){t._node.bufferSource.playbackRate.value=q}else{if(t._node){t._node.playbackRate=q}}var m=u.seek(l[o]);var n=((u._sprite[t._sprite][0]+u._sprite[t._sprite][1])/1000)-m;var s=(n*1000)/Math.abs(t._rate);if(u._endTimers[l[o]]||!t._paused){u._clearTimer(l[o]);u._endTimers[l[o]]=setTimeout(u._ended.bind(u,t),s)}u._emit("rate",t._id)}}}else{t=u._soundById(l);return t?t._rate:u._rate}return u},seek:function(){var t=this;var q=arguments;var m,l;if(q.length===0){l=t._sounds[0]._id}else{if(q.length===1){var k=t._getSoundIds();var p=k.indexOf(q[0]);if(p>=0){l=parseInt(q[0],10)}else{l=t._sounds[0]._id;m=parseFloat(q[0])}}else{if(q.length===2){m=parseFloat(q[0]);l=parseInt(q[1],10)}}}if(typeof l==="undefined"){return t}if(t._state!=="loaded"){t._queue.push({event:"seek",action:function(){t.seek.apply(t,q)}});return t}var r=t._soundById(l);if(r){if(typeof m==="number"&&m>=0){var s=t.playing(l);if(s){t.pause(l,true)}r._seek=m;r._ended=false;t._clearTimer(l);if(s){t.play(l,true)}if(!t._webAudio&&r._node){r._node.currentTime=m}t._emit("seek",l)}else{if(t._webAudio){var n=t.playing(l)?j.ctx.currentTime-r._playStart:0;var o=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(o+n*Math.abs(r._rate))}else{return r._node.currentTime}}}return t},playing:function(n){var k=this;if(typeof n==="number"){var m=k._soundById(n);return m?!m._paused:false}for(var l=0;l<k._sounds.length;l++){if(!k._sounds[l]._paused){return true}}return false},duration:function(n){var k=this;var m=k._duration;var l=k._soundById(n);if(l){m=k._sprite[l._sprite][1]/1000}return m},state:function(){return this._state},unload:function(){var m=this;var l=m._sounds;for(var o=0;o<l.length;o++){if(!l[o]._paused){m.stop(l[o]._id);m._emit("end",l[o]._id)}if(!m._webAudio){l[o]._node.src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=";l[o]._node.removeEventListener("error",l[o]._errorFn,false);l[o]._node.removeEventListener(j._canPlayEvent,l[o]._loadFn,false)}delete l[o]._node;m._clearTimer(l[o]._id);var n=j._howls.indexOf(m);if(n>=0){j._howls.splice(n,1)}}var k=true;for(o=0;o<j._howls.length;o++){if(j._howls[o]._src===m._src){k=false;break}}if(a&&k){delete a[m._src]}j.noAudio=false;m._state="unloaded";m._sounds=[];m=null;return null},on:function(o,n,p,m){var k=this;var l=k["_on"+o];if(typeof n==="function"){l.push(m?{id:p,fn:n,once:m}:{id:p,fn:n})}return k},off:function(p,n,q){var k=this;var m=k["_on"+p];var l=0;if(n){for(l=0;l<m.length;l++){if(n===m[l].fn&&q===m[l].id){m.splice(l,1);break}}}else{if(p){k["_on"+p]=[]}else{var o=Object.keys(k);for(l=0;l<o.length;l++){if((o[l].indexOf("_on")===0)&&Array.isArray(k[o[l]])){k[o[l]]=[]}}}}return k},once:function(m,l,n){var k=this;k.on(m,l,n,1);return k},_emit:function(n,p,o){var k=this;var m=k["_on"+n];for(var l=m.length-1;l>=0;l--){if(!m[l].id||m[l].id===p||n==="load"){setTimeout(function(q){q.call(this,p,o)}.bind(k,m[l].fn),0);if(m[l].once){k.off(n,m[l].fn,m[l].id)}}}return k},_loadQueue:function(){var l=this;if(l._queue.length>0){var k=l._queue[0];l.once(k.event,function(){l._queue.shift();l._loadQueue()});k.action()}return l},_ended:function(o){var l=this;var m=o._sprite;var k=!!(o._loop||l._sprite[m][2]);l._emit("end",o._id);if(!l._webAudio&&k){l.stop(o._id,true).play(o._id)}if(l._webAudio&&k){l._emit("play",o._id);o._seek=o._start||0;o._rateSeek=0;o._playStart=j.ctx.currentTime;var n=((o._stop-o._start)*1000)/Math.abs(o._rate);l._endTimers[o._id]=setTimeout(l._ended.bind(l,o),n)}if(l._webAudio&&!k){o._paused=true;o._ended=true;o._seek=o._start||0;o._rateSeek=0;l._clearTimer(o._id);l._cleanBuffer(o._node);j._autoSuspend()}if(!l._webAudio&&!k){l.stop(o._id)}return l},_clearTimer:function(l){var k=this;if(k._endTimers[l]){clearTimeout(k._endTimers[l]);delete k._endTimers[l]}return k},_soundById:function(m){var k=this;for(var l=0;l<k._sounds.length;l++){if(m===k._sounds[l]._id){return k._sounds[l]}}return null},_inactiveSound:function(){var k=this;k._drain();for(var l=0;l<k._sounds.length;l++){if(k._sounds[l]._ended){return k._sounds[l].reset()}}return new g(k)},_drain:function(){var l=this;var k=l._pool;var n=0;var m=0;if(l._sounds.length<k){return}for(m=0;m<l._sounds.length;m++){if(l._sounds[m]._ended){n++}}for(m=l._sounds.length-1;m>=0;m--){if(n<=k){return}if(l._sounds[m]._ended){if(l._webAudio&&l._sounds[m]._node){l._sounds[m]._node.disconnect(0)}l._sounds.splice(m,1);n--}}},_getSoundIds:function(n){var k=this;if(typeof n==="undefined"){var m=[];for(var l=0;l<k._sounds.length;l++){m.push(k._sounds[l]._id)}return m}else{return[n]}},_refreshBuffer:function(l){var k=this;l._node.bufferSource=j.ctx.createBufferSource();l._node.bufferSource.buffer=a[k._src];if(l._panner){l._node.bufferSource.connect(l._panner)}else{l._node.bufferSource.connect(l._node)}l._node.bufferSource.loop=l._loop;if(l._loop){l._node.bufferSource.loopStart=l._start||0;l._node.bufferSource.loopEnd=l._stop}l._node.bufferSource.playbackRate.value=l._rate;return k},_cleanBuffer:function(l){var k=this;if(k._scratchBuffer){l.bufferSource.onended=null;l.bufferSource.disconnect(0);try{l.bufferSource.buffer=k._scratchBuffer}catch(m){}}l.bufferSource=null;return k}};var g=function(k){this._parent=k;this.init()};g.prototype={init:function(){var k=this;var l=k._parent;k._muted=l._muted;k._loop=l._loop;k._volume=l._volume;k._muted=l._muted;k._rate=l._rate;k._seek=0;k._paused=true;k._ended=true;k._sprite="__default";k._id=Math.round(Date.now()*Math.random());l._sounds.push(k);k.create();return k},create:function(){var k=this;var l=k._parent;var m=(j._muted||k._muted||k._parent._muted)?0:k._volume;if(l._webAudio){k._node=(typeof j.ctx.createGain==="undefined")?j.ctx.createGainNode():j.ctx.createGain();k._node.gain.setValueAtTime(m,j.ctx.currentTime);k._node.paused=true;k._node.connect(j.masterGain)}else{k._node=new Audio();k._errorFn=k._errorListener.bind(k);k._node.addEventListener("error",k._errorFn,false);k._loadFn=k._loadListener.bind(k);k._node.addEventListener(j._canPlayEvent,k._loadFn,false);k._node.src=l._src;k._node.preload="auto";k._node.volume=m*j.volume();k._node.load()}return k},reset:function(){var k=this;var l=k._parent;k._muted=l._muted;k._loop=l._loop;k._volume=l._volume;k._muted=l._muted;k._rate=l._rate;k._seek=0;k._rateSeek=0;k._paused=true;k._ended=true;k._sprite="__default";k._id=Math.round(Date.now()*Math.random());return k},_errorListener:function(){var k=this;k._parent._emit("loaderror",k._id,k._node.error?k._node.error.code:0);k._node.removeEventListener("error",k._errorListener,false)},_loadListener:function(){var k=this;var l=k._parent;l._duration=Math.ceil(k._node.duration*10)/10;if(Object.keys(l._sprite).length===0){l._sprite={__default:[0,l._duration*1000]}}if(l._state!=="loaded"){l._state="loaded";l._emit("load");l._loadQueue()}if(l._autoplay){l.play()}k._node.removeEventListener(j._canPlayEvent,k._loadFn,false)}};var a={};var i=function(k){var l=k._src;if(a[l]){k._duration=a[l].duration;h(k);return}if(/^data:[^;]+;base64,/.test(l)){var n=atob(l.split(",")[1]);var p=new Uint8Array(n.length);for(var m=0;m<n.length;++m){p[m]=n.charCodeAt(m)}f(p.buffer,k)}else{var o=new XMLHttpRequest();o.open("GET",l,true);o.responseType="arraybuffer";o.onload=function(){var q=(o.status+"")[0];if(q!=="0"&&q!=="2"&&q!=="3"){k._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".");return}f(o.response,k)};o.onerror=function(){if(k._webAudio){k._html5=true;k._webAudio=false;k._sounds=[];delete a[l];k.load()}};b(o)}};var b=function(l){try{l.send()}catch(k){l.onerror()}};var f=function(l,k){j.ctx.decodeAudioData(l,function(m){if(m&&k._sounds.length>0){a[k._src]=m;h(k,m)}},function(){k._emit("loaderror",null,"Decoding audio data failed.")})};var h=function(l,k){if(k&&!l._duration){l._duration=k.duration}if(Object.keys(l._sprite).length===0){l._sprite={__default:[0,l._duration*1000]}}if(l._state!=="loaded"){l._state="loaded";l._emit("load");l._loadQueue()}if(l._autoplay){l.play()}};var e=function(){j.noAudio=false;try{if(typeof AudioContext!=="undefined"){j.ctx=new AudioContext()}else{if(typeof webkitAudioContext!=="undefined"){j.ctx=new webkitAudioContext()}else{j.usingWebAudio=false}}}catch(o){j.usingWebAudio=false}if(!j.usingWebAudio){if(typeof Audio!=="undefined"){try{var p=new Audio();if(typeof p.oncanplaythrough==="undefined"){j._canPlayEvent="canplay"}}catch(o){j.noAudio=true}}else{j.noAudio=true}}try{var p=new Audio();if(p.muted){j.noAudio=true}}catch(o){}var m=(/iP(hone|od|ad)/.test(j._navigator&&j._navigator.platform));var l=j._navigator&&j._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);var k=l?parseInt(l[1],10):null;if(m&&k&&k<9){var n=/safari/.test(j._navigator&&j._navigator.userAgent.toLowerCase());if(j._navigator&&j._navigator.standalone&&!n||j._navigator&&!j._navigator.standalone&&!n){j.usingWebAudio=false}}if(j.usingWebAudio){j.masterGain=(typeof j.ctx.createGain==="undefined")?j.ctx.createGainNode():j.ctx.createGain();j.masterGain.gain.value=1;j.masterGain.connect(j.ctx.destination)}j._setup()};if(typeof define==="function"&&define.amd){define([],function(){return{Howler:j,Howl:d}})}if(typeof exports!=="undefined"){exports.Howler=j;exports.Howl=d}if(typeof window!=="undefined"){window.HowlerGlobal=c;window.Howler=j;window.Howl=d;window.Sound=g}else{if(typeof global!=="undefined"){global.HowlerGlobal=c;global.Howler=j;global.Howl=d;global.Sound=g}}})();
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.0.1
 *  howlerjs.com
 *
 *  (c) 2013-2016, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
(function(){HowlerGlobal.prototype._pos=[0,0,0];HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0];HowlerGlobal.prototype.stereo=function(d){var b=this;if(!b.ctx||!b.ctx.listener){return b}for(var c=b._howls.length-1;c>=0;c--){b._howls[c].stereo(d)}return b};HowlerGlobal.prototype.pos=function(b,e,d){var c=this;if(!c.ctx||!c.ctx.listener){return c}e=(typeof e!=="number")?c._pos[1]:e;d=(typeof d!=="number")?c._pos[2]:d;if(typeof b==="number"){c._pos=[b,e,d];c.ctx.listener.setPosition(c._pos[0],c._pos[1],c._pos[2])}else{return c._pos}return c};HowlerGlobal.prototype.orientation=function(b,i,h,e,d,g){var c=this;if(!c.ctx||!c.ctx.listener){return c}var f=c._orientation;i=(typeof i!=="number")?f[1]:i;h=(typeof h!=="number")?f[2]:h;e=(typeof e!=="number")?f[3]:e;d=(typeof d!=="number")?f[4]:d;g=(typeof g!=="number")?f[5]:g;if(typeof b==="number"){c._orientation=[b,i,h,e,d,g];c.ctx.listener.setOrientation(b,i,h,e,d,g)}else{return f}return c};Howl.prototype.init=(function(b){return function(d){var c=this;c._orientation=d.orientation||[1,0,0];c._stereo=d.stereo||null;c._pos=d.pos||null;c._pannerAttr={coneInnerAngle:typeof d.coneInnerAngle!=="undefined"?d.coneInnerAngle:360,coneOuterAngle:typeof d.coneOuterAngle!=="undefined"?d.coneOuterAngle:360,coneOuterGain:typeof d.coneOuterGain!=="undefined"?d.coneOuterGain:0,distanceModel:typeof d.distanceModel!=="undefined"?d.distanceModel:"inverse",maxDistance:typeof d.maxDistance!=="undefined"?d.maxDistance:10000,panningModel:typeof d.panningModel!=="undefined"?d.panningModel:"HRTF",refDistance:typeof d.refDistance!=="undefined"?d.refDistance:1,rolloffFactor:typeof d.rolloffFactor!=="undefined"?d.rolloffFactor:1};c._onstereo=d.onstereo?[{fn:d.onstereo}]:[];c._onpos=d.onpos?[{fn:d.onpos}]:[];c._onorientation=d.onorientation?[{fn:d.onorientation}]:[];return b.call(this,d)}})(Howl.prototype.init);Howl.prototype.stereo=function(g,h){var c=this;if(!c._webAudio){return c}if(c._state!=="loaded"){c._queue.push({event:"stereo",action:function(){c.stereo(g,h)}});return c}var b=(typeof Howler.ctx.createStereoPanner==="undefined")?"spatial":"stereo";if(typeof h==="undefined"){if(typeof g==="number"){c._stereo=g;c._pos=[g,0,0]}else{return c._stereo}}var e=c._getSoundIds(h);for(var d=0;d<e.length;d++){var f=c._soundById(e[d]);if(f){if(typeof g==="number"){f._stereo=g;f._pos=[g,0,0];if(f._node){f._pannerAttr.panningModel="equalpower";if(!f._panner||!f._panner.pan){a(f,b)}if(b==="spatial"){f._panner.setPosition(g,0,0)}else{f._panner.pan.value=g}}c._emit("stereo",f._id)}else{return f._stereo}}}return c};Howl.prototype.pos=function(b,j,g,h){var c=this;if(!c._webAudio){return c}if(c._state!=="loaded"){c._queue.push({event:"pos",action:function(){c.pos(b,j,g,h)}});return c}j=(typeof j!=="number")?0:j;g=(typeof g!=="number")?-0.5:g;if(typeof h==="undefined"){if(typeof b==="number"){c._pos=[b,j,g]}else{return c._pos}}var e=c._getSoundIds(h);for(var d=0;d<e.length;d++){var f=c._soundById(e[d]);if(f){if(typeof b==="number"){f._pos=[b,j,g];if(f._node){if(!f._panner||f._panner.pan){a(f,"spatial")}f._panner.setPosition(b,j,g)}c._emit("pos",f._id)}else{return f._pos}}}return c};Howl.prototype.orientation=function(b,j,g,h){var c=this;if(!c._webAudio){return c}if(c._state!=="loaded"){c._queue.push({event:"orientation",action:function(){c.orientation(b,j,g,h)}});return c}j=(typeof j!=="number")?c._orientation[1]:j;g=(typeof g!=="number")?c._orientation[2]:g;if(typeof h==="undefined"){if(typeof b==="number"){c._orientation=[b,j,g]}else{return c._orientation}}var e=c._getSoundIds(h);for(var d=0;d<e.length;d++){var f=c._soundById(e[d]);if(f){if(typeof b==="number"){f._orientation=[b,j,g];if(f._node){if(!f._panner){if(!f._pos){f._pos=c._pos||[0,0,-0.5]}a(f,"spatial")}f._panner.setOrientation(b,j,g)}c._emit("orientation",f._id)}else{return f._orientation}}}return c};Howl.prototype.pannerAttr=function(){var k=this;var g=arguments;var e,d,j;if(!k._webAudio){return k}if(g.length===0){return k._pannerAttr}else{if(g.length===1){if(typeof g[0]==="object"){e=g[0];if(typeof d==="undefined"){k._pannerAttr={coneInnerAngle:typeof e.coneInnerAngle!=="undefined"?e.coneInnerAngle:k._coneInnerAngle,coneOuterAngle:typeof e.coneOuterAngle!=="undefined"?e.coneOuterAngle:k._coneOuterAngle,coneOuterGain:typeof e.coneOuterGain!=="undefined"?e.coneOuterGain:k._coneOuterGain,distanceModel:typeof e.distanceModel!=="undefined"?e.distanceModel:k._distanceModel,maxDistance:typeof e.maxDistance!=="undefined"?e.maxDistance:k._maxDistance,panningModel:typeof e.panningModel!=="undefined"?e.panningModel:k._panningModel,refDistance:typeof e.refDistance!=="undefined"?e.refDistance:k._refDistance,rolloffFactor:typeof e.rolloffFactor!=="undefined"?e.rolloffFactor:k._rolloffFactor}}}else{j=k._soundById(parseInt(g[0],10));return j?j._pannerAttr:k._pannerAttr}}else{if(g.length===2){e=g[0];d=parseInt(g[1],10)}}}var c=k._getSoundIds(d);for(var f=0;f<c.length;f++){j=k._soundById(c[f]);if(j){var h=j._pannerAttr;h={coneInnerAngle:typeof e.coneInnerAngle!=="undefined"?e.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof e.coneOuterAngle!=="undefined"?e.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof e.coneOuterGain!=="undefined"?e.coneOuterGain:h.coneOuterGain,distanceModel:typeof e.distanceModel!=="undefined"?e.distanceModel:h.distanceModel,maxDistance:typeof e.maxDistance!=="undefined"?e.maxDistance:h.maxDistance,panningModel:typeof e.panningModel!=="undefined"?e.panningModel:h.panningModel,refDistance:typeof e.refDistance!=="undefined"?e.refDistance:h.refDistance,rolloffFactor:typeof e.rolloffFactor!=="undefined"?e.rolloffFactor:h.rolloffFactor};var b=j._panner;if(b){b.coneInnerAngle=h.coneInnerAngle;b.coneOuterAngle=h.coneOuterAngle;b.coneOuterGain=h.coneOuterGain;b.distanceModel=h.distanceModel;b.maxDistance=h.maxDistance;b.panningModel=h.panningModel;b.refDistance=h.refDistance;b.rolloffFactor=h.rolloffFactor}else{if(!j._pos){j._pos=k._pos||[0,0,-0.5]}a(j,"spatial")}}}return k};Sound.prototype.init=(function(b){return function(){var c=this;var d=c._parent;c._orientation=d._orientation;c._stereo=d._stereo;c._pos=d._pos;c._pannerAttr=d._pannerAttr;b.call(this);if(c._stereo){d.stereo(c._stereo)}else{if(c._pos){d.pos(c._pos[0],c._pos[1],c._pos[2],c._id)}}}})(Sound.prototype.init);Sound.prototype.reset=(function(b){return function(){var c=this;var d=c._parent;c._orientation=d._orientation;c._pos=d._pos;c._pannerAttr=d._pannerAttr;return b.call(this)}})(Sound.prototype.reset);var a=function(c,b){b=b||"spatial";if(b==="spatial"){c._panner=Howler.ctx.createPanner();c._panner.coneInnerAngle=c._pannerAttr.coneInnerAngle;c._panner.coneOuterAngle=c._pannerAttr.coneOuterAngle;c._panner.coneOuterGain=c._pannerAttr.coneOuterGain;c._panner.distanceModel=c._pannerAttr.distanceModel;c._panner.maxDistance=c._pannerAttr.maxDistance;c._panner.panningModel=c._pannerAttr.panningModel;c._panner.refDistance=c._pannerAttr.refDistance;c._panner.rolloffFactor=c._pannerAttr.rolloffFactor;c._panner.setPosition(c._pos[0],c._pos[1],c._pos[2]);c._panner.setOrientation(c._orientation[0],c._orientation[1],c._orientation[2])}else{c._panner=Howler.ctx.createStereoPanner();c._panner.pan.value=c._stereo}c._panner.connect(c._node);if(!c._paused){c._parent.pause(c._id,true).play(c._id)}}})();var goMessages={};goMessages.de={messages:{Error:[null,"Fehler"],"This chat is private.":[null,"Dieser chat ist privat."],"Delete all messages":[null,"Alle Nachrichten löschen"],Ok:[null,"OK"],"Messages deleted.":[null,"Nachrichten gelöscht."],"Start private chat":[null,"Privaten Chat starten"],Search:[null,"Suchen"],Decline:[null,"Ablehnen"],"Load Earlier Messages":[null,"Vorherige Nachrichten anzeigen"],"This chat is closed.":[null,"Dieser Chat ist geschlossen."],Instant:[null,"Sofort"],"Delete message?":[null,"Nachricht löschen?"],"Waiting for moderator approval...":[null,"Warten auf Moderator Genehmigung..."],"Live Now!":[null,"Passiert jetzt!"],"All messages will need to be<br/>manually approved for display!":[null,"Alle Nachrichten müssen manuell genehmigt werden, bevor sie angezeigt werden!"],"You have been invited to chat":[null,"Du bist eingeladen zum Chat"],Invited:[null,"Eingeladen"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"Alle Nachrichten, die sich derzeit in der Genehmigungswarteschlange befinden, werden entfernt."],"Invite&hellip;":[null,"Einladen&hellip;"],"<b>Sign in</b> as a <b>Guest</b>":[null,"<b>Anmelden</b> als <b>Gast</b>"],"This message will be permanently removed!":[null,"Diese Nachricht wird dauerhaft entfernt werden!"],"hide all...":[null,"ausblenden..."],delay:[null,"verzögern"],Accept:[null,"Annehmen"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"Du bist in einem privaten Chat mit einem Moderator. Konversationsverlauf kann gespeichert und überprüft werden."],"You have been invited to chat with:":[null,"Du bist eingeladen zum Chat mit:"],Moderation:[null,"Mäßigung"],"show all...":[null,"anzeigen..."],"User blocked.":[null,"Benutzer blockiert."],"Block user":[null,"Benutzer blockieren"],"Sign out now?":[null,"Jetzt abmelden?"],"Please sign in":[null,"Bitte anmelden"],"Sign out":[null,"Abmelden"],cancel:[null,"abbrechen"],Block:[null,"Blockiere"],"Join me now at":[null,"Begleiten Sie mich jetzt bei"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: de\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"Delete all messages from":[null,"Löschen aller Mitteilungen aus"],Guest:[null,"Gast"],"Invite User":[null,"Einladen benutzer"],full:[null,"voll"],Cancel:[null,"Abbrechen"],Admin:[null,"Admin"],"Users will be able to post messages!":[null,"Benutzer können Nachrichten veröffentlichen!"],Online:[null,"Online"],Invite:[null,"Einladen"],"Type a message and press enter":[null,"Geben Sie eine Nachricht und drücken Sie die Enter-Taste"],"Are you sure?":[null,"Sind sie sicher?"],"Connection problem":[null,"Verbindungsproblem"],"New Chat Request":[null,"Chat Anfrage"],"Turn on Manual Approval?":[null,"Schalten Sie Manuelle Genehmigung?"],"Turn off Manual Approval?":[null,"Manuelle Genehmigung abschalten?"],"Re-invite user":[null,"Den Benutzer erneut einladen"],viewers:[null,"die betrachter"],"The event is full. Please retry in a minute.":[null,"Die Veranstaltung ist voll. Bitte wiederholen Sie sofort."],online:[null,"online"],Moderator:[null,"Moderator"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"wird <b>dauerhaft</b> gelöscht.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>Es wird für immer verschwunden sein!</div>"],"Users will no longer be able to post messages!":[null,"Benutzer können keine Nachrichten mehr hinterlassen!"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"Es gab ein Problem beim Verbinden mit dem Chat. Bitte aktualisieren Sie Ihre Browsereinstellungen, um Cookies zuzulassen."],Inactive:[null,"Inaktiv"],viewer:[null,"betrachter"],Offline:[null,"Offline"],"Search by username:":[null,"Suche nach Username:"],Me:[null,"Mich"]}};goMessages.es={messages:{"User blocked.":[null,"Usuario bloqueado."],"All messages will need to be<br/>manually approved for display!":[null,"Todos los mensajes deberán ser aprobados manualmente para mostrarse."],"Sign out":[null,"Desconectar"],"Delete all messages":[null,"Borrar todos los mensajes"],Search:[null,"Búsqueda"],full:[null,"completo"],Ok:[null,"Aceptar"],"Delete all messages from":[null,"Eliminar todos los mensajes de"],viewers:[null,"telespectadors"],"Users will no longer be able to post messages!":[null,"¡Los usuarios ya no podrán publicar mensajes!"],"Delete message?":[null,"¿Eliminar mensaje?"],"Re-invite user":[null,"Volver a invitar a usuario"],"Start private chat":[null,"Iniciar chat privado"],"New Chat Request":[null,"Nueva solicitud de chat"],Guest:[null,"Invitado"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"será eliminado permanentemente.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>No podrÃ¡ recuperarse!</div>"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"Estás en una conversación privada con un moderador. El historial de conversaciones podría guardar y revisar."],"This message will be permanently removed!":[null,"¡Este mensaje se eliminar de forma permanente!"],"You have been invited to chat":[null,"Has sido invitado a chatear"],"Live Now!":[null,"¡Ocurriendo ahora!"],"This chat is closed.":[null,"Este chat está cerrado."],"Turn off Manual Approval?":[null,"¿Desactivar la aprobación manual?"],"The event is full. Please retry in a minute.":[null,"El evento está lleno. Vuelve a intentarlo en un minuto."],Inactive:[null,"Inactivo"],delay:[null,"retrasar"],"Turn on Manual Approval?":[null,"¿Activar la aprobación manual?"],online:[null,"en línea"],"Invite&hellip;":[null,"Invitar&hellip;"],Moderation:[null,"Moderación"],Accept:[null,"Aceptar"],"Block user":[null,"Bloquear usuario"],"Search by username:":[null,"Búsqueda por nombre de usuario:"],viewer:[null,"telespectador"],Cancel:[null,"Cancelar"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"Los mensajes actualmente en la cola de aprobación se eliminarán."],Moderator:[null,"Moderador"],Block:[null,"Bloque"],Me:[null,"Yo"],"Waiting for moderator approval...":[null,"Espera de la aprobación del moderador…"],"Type a message and press enter":[null,"Escriba un mensaje y pulse la tecla Entrar"],Error:[null,"Error"],Instant:[null,"Instantáneamente"],"This chat is private.":[null,"Este chat es privado."],"You have been invited to chat with:":[null,"Te han invitado a chatear con:"],"show all...":[null,"mostrar todos..."],"Connection problem":[null,"Problema de conexión"],"Join me now at":[null,"Únase a mí ahora en"],"hide all...":[null,"ocultar todos..."],Admin:[null,"Admin"],"<b>Sign in</b> as a <b>Guest</b>":[null,"<b>Iniciar sesión</b> como <b>invitado</b>"],Online:[null,"En línea"],Offline:[null,"Desconectado"],"Please sign in":[null,"Por favor inicie sesión"],Invited:[null,"Invitado"],Decline:[null,"Rechazado"],"Sign out now?":[null,"¿Desconectar ahora?"],"Are you sure?":[null,"¿Estás seguro?"],cancel:[null,"cancelar"],"Users will be able to post messages!":[null,"¡Los usuarios podrán publicar mensajes!"],"Messages deleted.":[null,"Se han eliminado los mensajes."],Invite:[null,"Invitar"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"Se ha producido un problema al conectarse al chat. Actualice la configuración de su navegador para permitir las cookies."],"Load Earlier Messages":[null,"Mostrar mensajes anteriores"],"Invite User":[null,"Invitar usuario"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: es\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"}}};goMessages.fr={messages:{"Delete all messages":[null,"Effacer tous les messages"],"Please sign in":[null,"S'il vous plaît connectez-vous"],Ok:[null,"OK"],"Messages deleted.":[null,"Les messages ont été supprimés."],"Turn on Manual Approval?":[null,"Activer Approbation Manuelle?"],"This chat is closed.":[null,"Ce chat est fermé."],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"Il y avait un problème de connexion au chat. S'il vous plaît mettre à jour vos paramètres de votre navigateur pour autoriser les fichier de témoins."],"This message will be permanently removed!":[null,"Ce message sera définitivement supprimé!"],"Sign out now?":[null,"Se déconnecter?"],"Users will be able to post messages!":[null,"Les utilisateurs pourront publier des messages!"],viewer:[null,"spectateur"],"All messages will need to be<br/>manually approved for display!":[null,"Tous les messages devront être approuvés manuellement pour l'affichage!"],"Start private chat":[null,"Lancer un clavardage privé"],Offline:[null,"Hors connexion"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"Vous êtes en clavardage privé avec un modérateur.  L'historique des conversations peuvent être enregistré et passé en revue."],Cancel:[null,"Annuler"],"You have been invited to chat with:":[null,"Vous avez été invité à discuter avec:"],"Invite User":[null,"Inviter un utilisateur"],Moderator:[null,"Modérateur"],"New Chat Request":[null,"Nouvelle demande de clavardage"],Error:[null,"Erreur"],"Search by username:":[null,"Recherche par nom d’utilisateur:"],"Delete all messages from":[null,"Supprimer tous les messages de"],delay:[null,"retard"],"Join me now at":[null,"Rejoignez-moi maintenant"],"Live Now!":[null,"En direct maintenant!"],"You have been invited to chat":[null,"Vous avez été invité à discuter"],Online:[null,"En ligne"],Block:[null,"Bloc"],Invited:[null,"Invité"],Decline:[null,"Refuser"],online:[null,"en ligne"],"This chat is private.":[null,"Ce clavardage est privée."],"Type a message and press enter":[null,"Entrez votre message ici et appuyez sur Entrée"],Me:[null,"Moi"],"<b>Sign in</b> as a <b>Guest</b>":[null,"<b>Se connecter</b> en tant qu' <b>invité</b>"],"Delete message?":[null,"Supprimer le message?"],"User blocked.":[null,"L'utilisateur a été bloqué."],Instant:[null,"Immédiatement"],"The event is full. Please retry in a minute.":[null,"L'événement est plein. Réessayez dans une minute."],"show all...":[null,"montre tout"],"Invite&hellip;":[null,"Inviter&hellip;"],cancel:[null,"annuler"],Accept:[null,"Accepter"],"Load Earlier Messages":[null,"Charge des messages antérieurs"],"Sign out":[null,"Déconnectez-vous"],Search:[null,"Recherche"],Inactive:[null,"Inactif"],"Block user":[null,"Bloc un utilisateur"],viewers:[null,"spectateurs"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: fr\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},Invite:[null,"Inviter"],full:[null,"plein"],"Are you sure?":[null,"Etes-vous sûr?"],Admin:[null,"Admin"],"Users will no longer be able to post messages!":[null,"Les utilisateurs ne pourront plus publier de messages!"],Guest:[null,"L'Invité"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"sera <b>permanence</ b> supprimé.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>Il sera parti pour toujours!</div>"],Moderation:[null,"Modération"],"hide all...":[null,"cache tout..."],"Connection problem":[null,"Problème de connexion"],"Re-invite user":[null,"Ré-inviter l'utilisateur"],"Waiting for moderator approval...":[null,"En attente de modération…"],"Turn off Manual Approval?":[null,"Désactiver Approbation Manuelle?"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"Tous les messages en file d'attente d'approbation sera ignoré."]}};goMessages.it={messages:{"All messages will need to be<br/>manually approved for display!":[null,"Tutti i messaggi dovranno essere approvati manualmente per essere mostrati!"],Invite:[null,"Invita"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: it\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"Load Earlier Messages":[null,"Visualizza messaggi precedenti"],"The event is full. Please retry in a minute.":[null,"L'evento è pieno. Riprova in un minuto."],viewers:[null,"visitatori"],Online:[null,"In linea"],"Invite&hellip;":[null,"Invitare&hellip;"],"Live Now!":[null,"Sta accadendo ora!"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"verra’ eliminato<b>per sempre</b>.<div style=‘color:#ff0000;font-weight:bold;padding-top:5px;’>Sara’ perso per sempre!</div>"],Invited:[null,"Invitato"],"Messages deleted.":[null,"I messaggi sono stati eliminati."],Ok:[null,"Ok"],"Invite User":[null,"Invita utente"],"Users will no longer be able to post messages!":[null,"Gli utenti non saranno più in grado di inviare messaggi!"],"Delete message?":[null,"Elimina messaggio?"],"hide all...":[null,"nascondi tutti..."],"Waiting for moderator approval...":[null,"In attesa di approvazione del moderatore…"],viewer:[null,"visitatore"],"Delete all messages from":[null,"Elimina tutti i messaggi da"],delay:[null,"ritardo"],"New Chat Request":[null,"Nuova richiesta di chat"],"This chat is private.":[null,"Questa chat è privata."],online:[null,"in linea"],Moderator:[null,"Moderatore"],Decline:[null,"Declino"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"Tutti i messaggi nella coda di approvazione verranno eliminati."],Admin:[null,"Amministratore"],"Turn off Manual Approval?":[null,"Spegnere l'approvazione manuale?"],"Please sign in":[null,"Accedi per favore"],Guest:[null,"Ospite"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"Sei in una chat privata con un moderatore. La cronologia delle conversazioni può essere salvata e riveduta."],cancel:[null,"annulla"],"Are you sure?":[null,"Sei sicuro?"],"You have been invited to chat with:":[null,"Sei stato invitato a chattare con:"],"Join me now at":[null,"Unisciti a me adesso"],full:[null,"pieno"],Instant:[null,"Immediatamente"],"Type a message and press enter":[null,"Digitare un messaggio e premere Invio"],Moderation:[null,"Moderazione"],Search:[null,"Cerca"],"Sign out now?":[null,"Uscire adesso?"],Block:[null,"Bloccare"],"This message will be permanently removed!":[null,"Questo messaggio verrà eliminato definitivamente!"],Accept:[null,"Accetta"],"User blocked.":[null,"L'utente è stato bloccato."],Me:[null,"Me"],"Search by username:":[null,"Ricerca per nome utente:"],"Sign out":[null,"Uscire"],"Block user":[null,"Blocca utente"],"<b>Sign in</b> as a <b>Guest</b>":[null,"Accedere come ospite"],"show all...":[null,"mostra tutti..."],Offline:[null,"Offline"],"Re-invite user":[null,"Invita nuovamente l'utente"],"Turn on Manual Approval?":[null,"Accendere l'approvazione manuale?"],Cancel:[null,"Annulla"],Error:[null,"Errore"],"This chat is closed.":[null,"Questa chat è chiuso."],Inactive:[null,"Inattivo"],"Start private chat":[null,"Avviare chat privata"],"Connection problem":[null,"Croblema di connessione"],"Users will be able to post messages!":[null,"Gli utenti potranno inviare messaggi!"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"Si è verificato un problema di connessione alla chat. Aggiorna le impostazioni del tuo browser per consentire i cookie."],"You have been invited to chat":[null,"Sei stato invitato a chattare"],"Delete all messages":[null,"Eliminare tutti i messaggi"]}};goMessages.ja={messages:{Invited:[null,"招待済み"],Online:[null,"オンライン"],"User blocked.":[null,"ユーザーがブロックしました"],"Turn on Manual Approval?":[null,"手動承認をオンにする？"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: ja\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"Invite User":[null,"ユーザーを招待します。"],"All messages will need to be<br/>manually approved for display!":[null,"すべてのメッセージを手動で承認する必要があります。"],"Delete all messages":[null,"すべてのメッセージを削除します。"],delay:[null,"ディレイ"],Error:[null,"エラー"],Instant:[null,"即座に"],"Sign out now?":[null,"今すぐサインアウトしますか？"],Offline:[null,"オフライン"],full:[null,"フル"],cancel:[null,"キャンセル"],Decline:[null,"断わる"],"Are you sure?":[null,"本当によろしいですか？"],"hide all...":[null,"非表示"],"Delete all messages from":[null,"このユーザーのすべてのメッセージを削除します。"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"<b>恒久的に</b>削除されます。<div style=‘color:#ff0000;font-weight:bold;padding-top:5px;’>（永遠に消えてしまいます。）</div>"],Guest:[null,"ゲスト"],online:[null,"オンライン"],"Messages deleted.":[null,"メッセージが削除されました"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"あなたはモデレータとのプライベートチャット中です。会話の履歴を保存して見直すことができます。"],"Please sign in":[null,"サインインして下さい"],"Re-invite user":[null,"ユーザの再招待"],"Sign out":[null,"サインアウト"],"Waiting for moderator approval...":[null,"モデレーターの承認を待っています。"],"This chat is closed.":[null,"このチャットは閉鎖されました。"],"Live Now!":[null,"今起こっている！"],"This chat is private.":[null,"このチャットは閉鎖されました。"],"<b>Sign in</b> as a <b>Guest</b>":[null,"<b>ゲスト</b>として<b>サインイン</b>"],viewer:[null,"視聴者"],"Users will no longer be able to post messages!":[null,"ユーザーはメッセージを投稿できなくなります。"],viewers:[null,"視聴者"],Invite:[null,"招待"],"Search by username:":[null,"ユーザー名で検索します。"],"Block user":[null,"ユーザーをブロック"],"Start private chat":[null,"プライベートチャット"],"Delete message?":[null,"メッセージを削除しますか？"],Block:[null,"このユーザーをブロックします。"],"Connection problem":[null,"接続問題"],Admin:[null,"管理者"],Cancel:[null,"キャンセル"],"Users will be able to post messages!":[null,"ユーザーはメッセージを投稿できます！"],"Load Earlier Messages":[null,"以前のメッセージを読み込む"],Inactive:[null,"インアクティブ"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"承認キューに表示されているすべてのメッセージがスキップされます。"],"The event is full. Please retry in a minute.":[null,"イベントは満員です。 1分後に再試行してください。"],"New Chat Request":[null,"新しいチャット"],Me:[null,"私"],"Invite&hellip;":[null,"招待&hellip;"],"You have been invited to chat with:":[null,"チャットに招待されています。"],"show all...":[null,"すべてを表示"],Moderation:[null,"節度"],Search:[null,"検索"],"Join me now at":[null,"私に今すぐ参加してください"],Accept:[null,"承認"],Ok:[null,"はい"],"This message will be permanently removed!":[null,"注：このメッセージは、恒久的に削除されます 。"],"Turn off Manual Approval?":[null,"手動承認をオフにする？"],"Type a message and press enter":[null,"メッセージを入力し、enter キーを押します"],Moderator:[null,"モデレータ"],"You have been invited to chat":[null,"チャットに招待されています"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"チャットに接続する際に問題が発生しました。 Cookieを許可するようにブラウザの設定を更新してください。"]}};goMessages.ko={messages:{"Connection problem":[null,"연결 문제 발생"],Offline:[null,"오프라인"],Error:[null,"오류"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: ko\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"hide all...":[null,"숨기기"],"Join me now at":[null,"지금 가입하십시오."],"Users will no longer be able to post messages!":[null,"사용자는 더 이상 메시지를 게시 할 수 없습니다!"],"Delete all messages":[null,"모든 메시지 삭제"],Moderation:[null,"이용자 관리"],"You have been invited to chat":[null,"채팅에 초대 되었습니다."],Inactive:[null,"비활성화"],"Invite User":[null,"이용자 초대하기"],online:[null,"명 참여중"],Online:[null,"온라인"],"Turn off Manual Approval?":[null,"수동 게시 모드를 Off 하시겠습니까?"],"<b>Sign in</b> as a <b>Guest</b>":[null,"게스트 로 로그인"],Instant:[null,"곧"],"You have been invited to chat with:":[null,"다음과 같이 채팅에 초대됨 :"],"Sign out now?":[null,"로그아웃 하시겠습니까?"],"Waiting for moderator approval...":[null,"메시지 게시 허용을 기다리는 중…"],"Start private chat":[null,"개인 채팅 모드 시작"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"중재자와 비공개 채팅을하고 있습니다. 대화 기록을 저장하고 검토 할 수 있습니다."],Me:[null,"나"],"Search by username:":[null,"다음 이름으로 검색 :"],"Messages deleted.":[null,"전체 메시지 삭제됨"],viewer:[null,"시청자"],"Turn on Manual Approval?":[null,"수동 게시 모드를 On 하시겠습니까?"],Ok:[null,"OK"],cancel:[null,"취소"],"Please sign in":[null,"로그인 해주세요"],"Are you sure?":[null,"정말 맞습니까?"],"The event is full. Please retry in a minute.":[null,"이벤트가 가득 찼습니다. 1 분 후에 다시 시도하십시오."],delay:[null,"지연"],Guest:[null,"손님"],Invited:[null,"초대됨"],"User blocked.":[null,"이용자가 차단됨"],viewers:[null,"시청자들"],Moderator:[null,"중재자"],"Delete message?":[null,"메시지를 삭제 하시겠습니까?"],"Load Earlier Messages":[null,"이전 메시지로드"],"Type a message and press enter":[null,"메시지 작성 후 엔터키를 누르세요"],"New Chat Request":[null,"새로운 채팅 요청"],Admin:[null,"관리자"],"Invite&hellip;":[null,"초대&hellip;"],full:[null,"전체"],Block:[null,"차단하기 :"],"Users will be able to post messages!":[null,"사용자가 메시지를 게시 할 수 있습니다!"],"Delete all messages from":[null,"전체 메시지 삭제하기 :"],"This message will be permanently removed!":[null,"메시지가 영구적으로 삭제됩니다!"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"채팅에 연결하는 중에 문제가 발생했습니다. 쿠키를 허용하도록 브라우저 설정을 업데이트하십시오."],"Live Now!":[null,"Live Now!"],"Sign out":[null,"로그아웃"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"<b>영구적으로 </b> 삭제되며 <div style='color:#ff0000;font-weight:bold;padding-top:5px;'>복원 할 수 없습니다</div>"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"승인 대기중인 메시지는 모두 스킵합니다."],"This chat is private.":[null,"이 채팅창은 종료 되었습니다"],"Re-invite user":[null,"다시 초대"],Decline:[null,"거절하기"],"show all...":[null,"모두보기"],Search:[null,"검색"],Cancel:[null,"취소"],"Block user":[null,"이용자 차단하기"],"This chat is closed.":[null,"이 채팅창은 종료 되었습니다"],Invite:[null,"초대하기"],"All messages will need to be<br/>manually approved for display!":[null,"메시지가 표시되기 위해서는 관리자가 허용해야 합니다!"],Accept:[null,"허용하기"]}};goMessages.nl={messages:{"Invite&hellip;":[null,"Uitnodigen&hellip;"],"User blocked.":[null,"Gebruiker geblokkeerd."],"hide all...":[null,"verberg alles..."],"Please sign in":[null,"Inloggen alsjeblieft"],"Block user":[null,"Blokkeer gebruiker"],"Sign out":[null,"Uitloggen"],delay:[null,"vertraging"],Instant:[null,"Meteen"],cancel:[null,"annuleer"],online:[null,"online"],"You have been invited to chat":[null,"U bent uitgenodigd om te chatten"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"Alle berichten die momenteel in de<br/>Goedkeuring Wachtrij staan, worden verwijderd"],full:[null,"vol"],"This chat is private.":[null,"Deze chat is privé."],Moderation:[null,"Met mate"],"Live Now!":[null,"Gebeurt nu!"],"This message will be permanently removed!":[null,"Dit bericht zal permanent worden verwijderd!"],Cancel:[null,"Annuleer"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"Je bent in een privé chat met een moderator. Conversatiegeschiedenis kan worden opgeslagen en beoordeeld."],"Load Earlier Messages":[null,"Laad eerdere berichten"],"Re-invite user":[null,"De gebruiker opnieuw uitnodigen"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: nl\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"Sign out now?":[null,"Uitloggen nu?"],Inactive:[null,"Inactief"],Online:[null,"Online"],"Delete all messages from":[null,"Verwijder alle berichten van"],viewer:[null,"kijker"],Offline:[null,"Offline"],"Invite User":[null,"Uitnodigen gebruiker"],"Users will be able to post messages!":[null,"Gebruikers kunnen berichten plaatsen!"],"Join me now at":[null,"Kom nu bij me bij"],viewers:[null,"kijkers"],Error:[null,"Fout"],Guest:[null,"Gast"],Invite:[null,"Uitnodigen"],"This chat is closed.":[null,"Deze chat is gesloten."],"Are you sure?":[null,"Weet u het zeker?"],Invited:[null,"Uitgenodigd"],Block:[null,"Blok"],"Users will no longer be able to post messages!":[null,"Gebruikers kunnen geen berichten meer plaatsen!"],"The event is full. Please retry in a minute.":[null,"Het evenement is vol. Probeer het even later opnieuw."],"Connection problem":[null,"Verbindingsprobleem"],Decline:[null,"Afwijzen"],"Delete all messages":[null,"Verwijder alle berichten"],"Delete message?":[null,"Verwijder bericht?"],Search:[null,"Opzoeken"],Admin:[null,"Beheerder"],"Turn on Manual Approval?":[null,"Schakel handmatige goedkeuring in?"],"Start private chat":[null,"Starten privé chat"],Ok:[null,"OK"],"Waiting for moderator approval...":[null,"Moderator goedkeuring in afwachting..."],"Turn off Manual Approval?":[null,"Schakel handmatige goedkeuring uit?"],"New Chat Request":[null,"Nieuw chat verzoek"],"Messages deleted.":[null,"Berichten verwijderd."],Me:[null,"Me"],"<b>Sign in</b> as a <b>Guest</b>":[null,"<b>Inloggen</b> als een <b>Gast</b>"],Accept:[null,"Accepteer"],"All messages will need to be<br/>manually approved for display!":[null,"Alle berichten moeten<br/>handmatig worden goedgekeurd voor ze worden weergegeven!"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"Er was een probleem met de verbinding naar de chat. Werkt u uw browserinstellingen om cookies toe te staan."],"Search by username:":[null,"Zoeken op gebruikersnaam:"],"Type a message and press enter":[null,"Typ een bericht en druk op enter"],Moderator:[null,"Moderator"],"show all...":[null,"toon alles...."],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"zal <b>permanent</b> worden verwijderd.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>Het zal voor altijd verdwenen zijn</div>"],"You have been invited to chat with:":[null,"U bent uitgenodigd om te chatten met:"]}};goMessages.pt={messages:{"Delete all messages":[null,"Eliminar mensagens"],full:[null,"cheio"],"Re-invite user":[null,"Re-convidar usuário"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"Você está em um chat privado com um moderador. O histórico desta conversa será gravada."],"Please sign in":[null,"Por favor faça o login"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"Ocorreu um problema ao conectar-se ao chat. Atualize as configurações do navegador para permitir cookies."],Invite:[null,"Convite"],"Users will be able to post messages!":[null,"Os usuários poderão postar mensagens!"],"Are you sure?":[null,"Você tem certeza?"],"Delete all messages from":[null,"Apagar todas as mensagens de"],"Messages deleted.":[null,"Mensagens excluídas."],Cancel:[null,"Cancelar"],Ok:[null,"Ok"],"This message will be permanently removed!":[null,"Esta mensagem será removida permanentemente!"],"This chat is closed.":[null,"Esta chat está fechada."],"hide all...":[null,"ocultar todos..."],delay:[null,"demora"],"You have been invited to chat with:":[null,"Você está convidado para chat com:"],"Invite&hellip;":[null,"Convidar&hellip;"],"Type a message and press enter":[null,"Digite uma mensagem e pressione Enter"],"Turn on Manual Approval?":[null,"Ativar aprovação manual?"],"New Chat Request":[null,"Novo pedido para chat"],"<b>Sign in</b> as a <b>Guest</b>":[null,"<b>Entrar</b> como <b>Convidado</b>"],"The event is full. Please retry in a minute.":[null,"O evento está cheio. Por favor, tente novamente em um minuto."],"show all...":[null,"mostrar todos..."],"Delete message?":[null,"Apagar mensagem?"],Error:[null,"Erro"],Accept:[null,"Aceitar"],Inactive:[null,"Inativo"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"Todas as mensagens atualmente na fila de aprovação<br/>serão removidas."],"Turn off Manual Approval?":[null,"Desativar a aprovação manual?"],"Start private chat":[null,"Começar o chat privado"],Moderation:[null,"Moderação"],viewers:[null,"espectadors"],"Sign out now?":[null,"Sair agora?"],"You have been invited to chat":[null,"Você está convidado para chat"],Admin:[null,"Admin"],Guest:[null,"Convidado"],"Invite User":[null,"Convidar usuário"],Invited:[null,"Convidado"],Moderator:[null,"Moderador"],Offline:[null,"Offline"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: pt\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"All messages will need to be<br/>manually approved for display!":[null,"Todas as mensagens precisarão ser<br/>aprovadas manualmente para exibição!"],"Connection problem":[null,"Problema de conexão"],"Join me now at":[null,"Junte-se a mim agora"],"Waiting for moderator approval...":[null,"Aguardando aprovação do moderador…"],"User blocked.":[null,"Usuário bloqueado."],"Live Now!":[null,"Acontecendo agora!"],Decline:[null,"Recusar"],online:[null,"online"],"Load Earlier Messages":[null,"Carregar mensagens anteriores"],Online:[null,"Conectado"],"Block user":[null,"Boquear usuário"],Me:[null,"mim"],"Users will no longer be able to post messages!":[null,"Os usuários não poderão mais postar mensagens!"],Instant:[null,"Imediatamente"],cancel:[null,"cancelar"],Search:[null,"Procurar"],"Sign out":[null,"Sair"],"Search by username:":[null,"Procurar por nome de usuário:"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"será <b>excluído permanentemente</b>.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>Será ido para sempre!<div>"],Block:[null,"Bloquear"],"This chat is private.":[null,"Esta chat está privado."],viewer:[null,"espectador"]}};goMessages.ru={messages:{"Sign out":[null,"выход"],Block:[null,"Блок"],"hide all...":[null,"скрыть все..."],cancel:[null,"Отмена"],Invited:[null,"Приглашение отправлено"],"Connection problem":[null,"Проблема соединения"],"Re-invite user":[null,"Повторно пригласить пользователя"],viewers:[null,"Зрители"],"Users will be able to post messages!":[null,"Пользователи смогут публиковать сообщения!"],"Users will no longer be able to post messages!":[null,"Пользователи больше не смогут отправлять сообщения!"],Cancel:[null,"Отмена"],"All messages will need to be<br/>manually approved for display!":[null,"Все сообщения должны быть<br/>одобрены вручную для показа!"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"Будет удалено <b>навсегда</b>.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>Это исчезнет навсегда</div>"],Accept:[null,"Принять"],Decline:[null,"Отклонить"],"This chat is private.":[null,"Этот чат является закрытым."],viewer:[null,"Зритель"],Invite:[null,"Пригласить"],"<b>Sign in</b> as a <b>Guest</b>":[null,"Войти как Гость"],"Type a message and press enter":[null,"Введите сообщение и нажмите клавишу ввода."],Inactive:[null,"Неактивный"],Admin:[null,"администратор"],"Search by username:":[null,"Поиск по имени пользователя:"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: ru\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"Any messages currently in the<br/>approval queue will be skipped.":[null,"Любые сообщения, находящиеся в настоящее время в очереди одобрения, будут пропущены."],Search:[null,"Поиск"],"Waiting for moderator approval...":[null,"Ожидание модератора ..."],"Invite User":[null,"Пригласить пользователя"],"The event is full. Please retry in a minute.":[null,"Событие заполнено. Повторите попытку через минуту."],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"Вы находитесь в приватном чате с модератором. История беседы может быть сохранена и проверена."],"Turn off Manual Approval?":[null,"Отключить проверку вручную?"],Me:[null,"меня"],Instant:[null,"Мгновенно"],"Are you sure?":[null,"Ты уверен?"],"Turn on Manual Approval?":[null,"Включить проверку вручную?"],"Invite&hellip;":[null,"Пригласить&hellip;"],"This chat is closed.":[null,"Этот чат закрыт."],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"Не удалось подключиться к чату. Обновите настройки своего браузера, чтобы разрешить использование файлов cookie."],"Join me now at":[null,"Присоединяйтесь ко мне сейчас"],"Delete all messages":[null,"Удалить все сообщения"],delay:[null,"Задержка"],Error:[null,"ошибка"],full:[null,"полный"],"This message will be permanently removed!":[null,"Это сообщение будет удалено навсегда!"],Moderator:[null,"На модерации"],"You have been invited to chat with:":[null,"Вас пригласили в чат:"],"Live Now!":[null,"Живи сейчас!"],"Load Earlier Messages":[null,"Загрузить предыдущие сообщения"],"Messages deleted.":[null,"Сообщения удалены."],"Block user":[null,"Блокировать пользователя"],"show all...":[null,"показать все..."],"You have been invited to chat":[null,"Вас пригласили в чат"],Moderation:[null,"На модерации"],Online:[null,"В сети"],"Sign out now?":[null,"Выйти?"],Ok:[null,"ОК"],"Start private chat":[null,"Начать приватный чат"],Offline:[null,"Не в сети"],"Delete all messages from":[null,"Удалить все сообщения из"],"Please sign in":[null,"Пожалуйста войдите"],"Delete message?":[null,"Удаленное сообщение?"],"New Chat Request":[null,"Запрос на новый чат"],online:[null,"онлайн"],Guest:[null,"Гость"],"User blocked.":[null,"Пользователь заблокирован."]}};goMessages.tl={messages:{"Start private chat":[null,"Magsimula sa mga pribadong chat"],"Invite User":[null,"Mag-imbita ng User"],Me:[null,"Ako"],Invited:[null,"Inimbitahan"],"Are you sure?":[null,"Sigurado ka ba?"],"New Chat Request":[null,"Bago Chat Paghiling"],"Join me now at":[null,"Samahan ako ngayon sa"],Instant:[null,"kaagad"],"Connection problem":[null,"Problema sa koneksyon"],"Delete message?":[null,"Tanggalin ang mensaheng ito?"],"hide all...":[null,"itago lahat..."],"You have been invited to chat with:":[null,"Inanyayahan ka upang makipag-chat sa:"],"Delete all messages":[null,"Tanggalin ang lahat ng mga mensahe"],viewer:[null,"manonood"],"Please sign in":[null,"Mangyaring mag-sign in"],"Sign out":[null,"Mag-sign out"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"Ikaw ay nasa isang pribadong chat sa isang moderator. kasaysayan ng pag-uusap ay maaaring i-save at nasuri."],Inactive:[null,"Hindi aktibo"],Accept:[null,"Tanggapin"],"Invite&hellip;":[null,"Mag-anyaya&hellip;"],"Turn off Manual Approval?":[null,"Malapit ang Mano-manong Pag-apruba?"],Search:[null,"Paghahanap"],"Type a message and press enter":[null,"Mag-type ng mensahe at pindutin ang enter"],"User blocked.":[null,"User ay naharang."],"All messages will need to be<br/>manually approved for display!":[null,"Lahat ng mga mensahe ay kailangang ma<br/>nang manu-mano naaprubahan para sa display!"],Error:[null,"Pagkakamali"],Ok:[null,"Ok"],"Load Earlier Messages":[null,"Mag-load ng Mas maaga Mensahe"],"Block user":[null,"I-block ang user"],"Waiting for moderator approval...":[null,"Naghihintay para sa pahintulot ng moderator..."],Moderation:[null,"Pag-moderate"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"magiging <b>permanente</b> tatanggalin.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>Ito ay wala na habang panahon.</div>"],Moderator:[null,"Tagapamagitan"],"Live Now!":[null,"Mabuhay ngayon!"],"This message will be permanently removed!":[null,"Ang mensaheng ito ay permanenteng aalisin!"],Block:[null,"Bloke"],Offline:[null,"Offline"],"Delete all messages from":[null,"Tanggalin ang lahat ng mga mensahe mula sa"],"This chat is private.":[null,"Ang chat na ito ay pribado."],"Search by username:":[null,"Maghanap sa pamamagitan ng username:"],"Sign out now?":[null,"Mag-sign out ngayon?"],"You have been invited to chat":[null,"Inanyayahan ka upang makipag-chat"],cancel:[null,"kanselahin"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"Anumang mensahe na kasalukuyang nasa<br/>approval queue ay maaaring malampasan."],"Messages deleted.":[null,"Mga Mensahe tinanggal."],"Users will no longer be able to post messages!":[null,"Mga gumagamit ay hindi na makakapag-post ng mga mensahe!"],online:[null,"online"],"show all...":[null,"Ipakita lahat..."],Admin:[null,"Admin"],Invite:[null,"Mag-anyaya"],Guest:[null,"Bisita"],"This chat is closed.":[null,"Ang chat na ito ay sarado."],"The event is full. Please retry in a minute.":[null,"Ang kaganapan ay puno na. Mangyaring muling subukan muli."],"Turn on Manual Approval?":[null,"Buksan ang Mano-manong Pag-apruba?"],"Users will be able to post messages!":[null,"Mga gumagamit ay maaaring mag-post ng mga mensahe!"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: fil\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"<b>Sign in</b> as a <b>Guest</b>":[null,"<b>Mag-sign in</b> bilang <b>Bisita</b>"],full:[null,"puno"],Cancel:[null,"Kanselahin"],Online:[null,"Online"],"Re-invite user":[null,"Re-imbita ng user"],viewers:[null,"mga manonood"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"Nagkaroon ng problema sa pagkonekta sa chat. Mangyaring i-update ang iyong mga setting ng browser upang payagan ang mga Cookies."],Decline:[null,"Tanggihan"],delay:[null,"antala"]}};goMessages.zh_cn={messages:{Moderation:[null,"适度"],"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"你正在和主持人进行私人聊天。对话历史可能会被保存和审查。"],"All messages will need to be<br/>manually approved for display!":[null,"所有消息将都需要<br>手动批准显示!"],full:[null,"全部"],"Re-invite user":[null,"重新邀请用户"],"This chat is closed.":[null,"这次聊天被闭合。"],Error:[null,"错误"],"Join me now at":[null,"现在加入我吧"],"Users will be able to post messages!":[null,"用户将能够发布消息！"],"Turn off Manual Approval?":[null,"关闭手动批准吗?"],Me:[null,"Me"],"Delete all messages from":[null,"删除所有邮件从"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"目前在任何消息<br>审批队列将被跳过。"],"Delete message?":[null,"删除消息？"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: zh-CN\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},Cancel:[null,"取消"],"Live Now!":[null,"现在住！"],"Load Earlier Messages":[null,"加载早期的消息"],"This chat is private.":[null,"这次聊天被闭合。"],"Search by username:":[null,"按用户名搜索:"],"hide all...":[null,"全部隐藏"],Guest:[null,"访客"],Inactive:[null,"闲置"],"Sign out":[null,"注销"],Instant:[null,"即刻"],"Please sign in":[null,"请登录"],Search:[null,"搜索"],Invite:[null,"邀请"],"Block user":[null,"阻止用户"],Admin:[null,"管理员"],"Connection problem":[null,"连接问题"],Offline:[null,"离线"],"You have been invited to chat with:":[null,"你被邀请去聊天:"],"show all...":[null,"显示全部"],delay:[null,"延迟"],cancel:[null,"取消"],viewers:[null,"观众"],"<b>Sign in</b> as a <b>Guest</b>":[null,"作为<b>来宾</b><b>登录</b>"],Decline:[null,"下降"],"New Chat Request":[null,"最新请求"],"Invite User":[null,"邀请用户"],Invited:[null,"已邀请"],Online:[null,"在线"],"Delete all messages":[null,"删除信息"],Block:[null,"区块"],"Waiting for moderator approval...":[null,"在等待主持人批准..."],Accept:[null,"接受"],"Invite&hellip;":[null,"邀请&hellip;"],"Start private chat":[null,"开始私人聊天"],"The event is full. Please retry in a minute.":[null,"活动已满。请稍等重试。"],online:[null,"在线"],"Sign out now?":[null,"现在注销吗?"],"Messages deleted.":[null,"消息已删除。"],Ok:[null,"Ok"],viewer:[null,"观众"],"User blocked.":[null,"用户被阻止。"],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"连接聊天时出现问题。请更新您的浏览器设置以允许Cookie。"],Moderator:[null,"主席"],"Type a message and press enter":[null,"输入要搜索的文本，然后按Enter键"],"This message will be permanently removed!":[null,"此消息将被永久删除!"],"Users will no longer be able to post messages!":[null,"用户将无法再发帖！"],"Are you sure?":[null,"确定吗？"],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"将被<b>永久</b>删除。<div style=‘color:#ff0000;font-weight:bold;padding-top:5px;’>它会一去不复返了</div>"],"Turn on Manual Approval?":[null,"打开手动批准吗?"],"You have been invited to chat":[null,"您已被邀请来聊天"]}};goMessages.zh_tw={messages:{Invite:[null,"邀請"],"Users will be able to post messages!":[null,"用戶將能夠發布消息！"],"Type a message and press enter":[null,"鍵入消息，然後按Enter鍵"],full:[null,"充分"],"New Chat Request":[null,"新聊天請求"],viewer:[null,"觀眾"],Inactive:[null,"待用"],"Connection problem":[null,"連接問題"],"This chat is closed.":[null,"此聊天已關閉。"],"Are you sure?":[null,"你確定？"],"Live Now!":[null,"現在住！"],"Messages deleted.":[null,"消息已刪除。"],"Delete all messages":[null,"刪除所有消息"],"":{"Project-Id-Version":" Chatroll - Client\nReport-Msgid-Bugs-To: \nPOT-Creation-Date: 2017-09-25 13:55-0400\nLanguage: zh-TW\nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\nX-Generator: POEditor.com\n"},"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":[null,"你正在和主持人進行私人聊天。對話歷史可能會被保存和審查。"],"Search by username:":[null,"按用戶名搜索："],"The event is full. Please retry in a minute.":[null,"活動已滿。請稍等重試。"],cancel:[null,"取消"],Invited:[null,"邀請"],"All messages will need to be<br/>manually approved for display!":[null,"所有信息都需要手動批准才能顯示！"],Me:[null,"我"],"Invite User":[null,"邀請用戶"],Moderation:[null,"適度"],Offline:[null,"離線"],Admin:[null,"管理員"],delay:[null,"延遲"],"Any messages currently in the<br/>approval queue will be skipped.":[null,"將批准當前在批准隊列中的任何消息。"],"This chat is private.":[null,"此聊天是私人的。"],"show all...":[null,"顯示所有..."],"will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>":[null,"將<b>永久刪除</ b> <div style ='color：＃ff0000; font-weight：bold; padding-top：5px;'>它將永遠消失！"],Moderator:[null,"主席"],"Sign out":[null,"登出"],"Turn off Manual Approval?":[null,"關閉手動審批？"],"Invite&hellip;":[null,"邀請＆hellip;"],Decline:[null,"下降"],"Delete all messages from":[null,"刪除所有郵件"],"You have been invited to chat":[null,"你被邀請聊天"],"This message will be permanently removed!":[null,"此消息將被永久刪除！"],"Waiting for moderator approval...":[null,"等待主持人批准..."],"There was a problem connecting to the chat. Please update your browser settings to allow Cookies.":[null,"連接聊天時出現問題。請更新您的瀏覽器設置以允許Cookie。"],"Sign out now?":[null,"現在退出？"],Online:[null,"線上"],"Load Earlier Messages":[null,"加載早期消息"],"Start private chat":[null,"開始私人聊天"],"Users will no longer be able to post messages!":[null,"用戶將無法再發帖！"],"hide all...":[null,"全部藏起來..."],"Block user":[null,"阻止用戶"],Block:[null,"塊"],Instant:[null,"瞬間"],"Please sign in":[null,"請登錄"],Search:[null,"搜索"],Ok:[null,"好"],Guest:[null,"客人"],"Re-invite user":[null,"重新邀請用戶"],"Join me now at":[null,"現在加入我吧"],online:[null,"線上"],viewers:[null,"觀眾"],Error:[null,"錯誤"],"<b>Sign in</b> as a <b>Guest</b>":[null,"<b>以<b>訪客</ b>登錄</ b>"],Accept:[null,"接受"],Cancel:[null,"取消"],"Turn on Manual Approval?":[null,"開啟手動審批？"],"User blocked.":[null,"用戶被阻止。"],"Delete message?":[null,"刪除郵件？"],"You have been invited to chat with:":[null,"您已被邀請與...聊天："]}};var Logger=Class.create();Logger.prototype={initialize:function(){this.entries=[];this.numFlushes=0;this.maxFlushes=1;window.onerror=function(b,c,a){logger.error("(window error) "+b+" ("+c+":"+a+")");return true};dwr.engine.setErrorHandler(function(c,b){var a="(DWR) "+c;if(b){a+=" (exception thrown)"}logger.error(a)});dwr.engine.setWarningHandler(function(c,b){var a="(DWR) "+c;if(b){a+=" (exception thrown)"}logger.warn(a)})},catchBlockError:function(c){var b=c.name+": "+c.message;var d=c.fileName?c.fileName:c.sourceURL;var a=c.lineNumber?c.lineNumber:c.line;this.error("(catch block) "+b+" ("+d+":"+a+")")},debug:function(a,b){},info:function(a,b){a="[INFO] "+a;this.queue(a)},warn:function(a,b){a="[WARNING] "+a;this.queue(a)},error:function(a,b){a="[ERROR] "+a;this.queue(a)},isDebugEnabled:function(){return false},queue:function(a){this.entries.push(a);setTimeout(logger.flush,500)},flush:function(){if(this.numFlushes<this.maxFlushes){this.numFlushes++;ServiceInterface.log(this.entries,{callback:function(){},errorHandler:function(){}})}this.entries=[]}};Date.parseGMT=function(b){var c=new Date();var a=Date.parse(b);if(isNaN(a)){c=null}else{c.setTime(a-(c.getTimezoneOffset()*60*1000))}return c};Date.prototype.timestampFormats={en:"MMM D, h:mm A",de:"D. MMM HH:mm",es:"D de MMM H:mm",fr:"D MMM HH:mm",it:"D MMM HH:mm",ja:"MMMD日 HH:mm",ko:"MMM D일 A h:mm",nl:"D MMM HH:mm",pt:"D de MMM HH:mm",ru:"D MMM, HH:mm",tl:"MMM D, HH:mm",zh_cn:"MMMD日 HH:mm",zh_tw:"MMMD日 HH:mm"};Date.prototype.monthsByLocale={en:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),de:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),es:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),fr:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),it:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),ja:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ko:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),nl:"jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),pt:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),tl:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),ru:"янв._февр._март_апр._май_июнь_июль_авг._сент._окт._нояб._дек.".split("_"),zh_cn:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),zh_tw:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_")};Date.prototype.meridiemsByLocale={en:"AM_PM".split("_"),ko:"오전_오후".split("_")};Date.prototype.getMessageTimestamp=function(){var d=goChatApp.clientConfig.language;var e=this.timestampFormats[d];if(e==null){e=this.timestampFormats.en}var a=this.getDate();var h=this.getHours();var c=this.getMinutes();var f=this.getMonth();var g=e;g=g.replace("D",a);g=g.replace("HH",(h<10)?("0"+h):h);g=g.replace("H",h);g=g.replace("h",(h==0)?"12":((h>12)?(h-12):h));g=g.replace("mm",(c<10)?("0"+c):c);var i=this.meridiemsByLocale[d];if(i==null){i=this.meridiemsByLocale.en}g=g.replace("A",(h<12)?i[0]:i[1]);var b=this.monthsByLocale[d];if(b==null){b=this.monthsByLocale.en}g=g.replace("MMM",b[f]);return g};var CustomEvent=Class.create();CustomEvent.prototype={initialize:function(){this.handlers=new Array()},observe:function(a){this.handlers.push(a)},fire:function(b){for(var a=0,c=this.handlers.length;a<c;++a){(this.handlers[a])(b)}},stopObserving:function(a){this.handlers=this.handlers.without(a)}};var TemplateManager=Class.create();TemplateManager.prototype={initialize:function(){},evaluate:function(b,a){return this.templates[b](a)}};var TooltipManager=Class.create();TooltipManager.prototype={initialize:function(){this.activeTooltip=null;this.onHideCallback=null;this.onDocumentClickListener=this._onDocumentClick.bindAsEventListener(this)},showTooltip:function(c){this.hideTooltips();c=Object.extend({element:null,html:null,relativeElement:null,top:"auto",bottom:"auto",left:"auto",right:"auto",offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,onHideCallback:null},c);var a=new Element("div");if(c.element!=null){a.insert(c.element)}else{a.innerHTML=c.html}a.setStyle({position:"absolute",zIndex:1000});a.hide();$(document.body).insert({bottom:a});if(c.relativeElement=="chat"){var e=$(document.body).down(".group-chat-container");if(e!=null&&e.up().getStyle("display")=="none"){e=null}if(e==null){e=$(document.body).down(".group-chat-embedded")}c.relativeElement=e}var i=null;var h=function(){if(i==null){if(c.relativeElement!=null){i=c.relativeElement.getDimensions()}else{i=document.viewport.getDimensions()}}};var n=null;var o=function(){if(n==null){if(c.relativeElement!=null){n=c.relativeElement.cumulativeOffset()}else{n={top:0,left:0}}}};var m=null;var l=function(){if(m==null){m=document.viewport.getDimensions()}};var g=null;var d=function(){if(g==null){if(c.relativeElement!=null){g={top:0,left:0}}else{g=document.viewport.getScrollOffsets()}}};var j=null;var f=function(){if(j==null){j=a.getDimensions()}};if(c.top=="fixed"){d();var k=g.top+c.offsetTop;a.setStyle({top:k+"px"})}else{if(c.bottom=="fixed"){l();d();f();var k=m.height+g.top-j.height-c.offsetBottom;a.setStyle({top:k+"px"})}else{if(c.top=="top"){o();var k=n.top+c.offsetTop;a.setStyle({top:k+"px"})}else{if(c.top=="bottom"){o();h();var k=n.top+i.height+c.offsetTop;a.setStyle({top:k+"px"})}else{if(c.top=="center"){d();o();h();f();var k=g.top+n.top+(i.height-j.height)/2;a.setStyle({top:k+"px"})}}}}}if(c.left=="fixed"){d();var b=g.left+c.offsetLeft;a.setStyle({left:b+"px"})}else{if(c.left=="left"){o();var b=n.left+c.offsetLeft;a.setStyle({left:b+"px"})}else{if(c.left=="right"){o();h();var b=n.left+i.width+c.offsetLeft;a.setStyle({left:b+"px"})}else{if(c.right=="right"){o();h();f();var b=n.left+i.width-j.width+c.offsetRight;a.setStyle({left:b+"px"})}else{if(c.left=="center"){d();o();h();f();var b=g.left+n.left+(i.width-j.width)/2;a.setStyle({left:b+"px"})}}}}}a.show();this.activeTooltip=a;this.onHideCallback=c.onHideCallback;setTimeout(function(){document.observe("click",this.onDocumentClickListener)}.bind(this),0);return this.activeTooltip},hideTooltips:function(){if(this.activeTooltip!=null){document.stopObserving("click",this.onDocumentClickListener);if(this.onHideCallback!=null){this.onHideCallback()}this.onHideCallback=null;this.activeTooltip.remove();this.activeTooltip=null}},_onDocumentClick:function(b){var a=Event.findElement(b,"div");if(!a.descendantOf(this.activeTooltip)){setTimeout(function(){this.hideTooltips()}.bind(this),0)}}};window.lnk=function(c,h){try{if(c===window){c=window.event.srcElement;while(c){if(c.href){break}c=c.parentNode}}var d=encodeURIComponent||escape;var f=c.href.split("#");var b=["/url?url=",d(f[0]).replace(/\+/g,"%2B"),h?h:"",f[1]?"#"+f[1]:""].join("");c.href=b;c.onmousedown=""}catch(g){}return true};var Facebook=Class.create();Facebook.prototype={initialize:function(){this.chatApp=null;this.loaded=false},setChatApp:function(a){this.chatApp=a},load:function(){if(!this.loaded){this.loaded=true;window.fbAsyncInit=this._onLoad.bind(this);var a=document.createElement("div");a.id="fb-root";document.body.appendChild(a);var b=document.createElement("script");b.async=true;b.src=document.location.protocol+"//connect.facebook.net/en_US/sdk.js";document.getElementById("fb-root").appendChild(b)}},_onLoad:function(){FB.init({appId:this.chatApp.clientConfig.fbAppId,version:"v2.10",status:true,cookie:true})},login:function(a){FB.getLoginStatus(function(b){if(b.status==="connected"){a(b)}else{FB.login(a,{perms:""})}})}};var Twitter=Class.create();Twitter.prototype={initialize:function(){this.chatApp=null},setChatApp:function(a){this.chatApp=a}};var ChartManager=Class.create();ChartManager.prototype={initialize:function(){},setChatApp:function(a){this.chatApp=a},render:function(b,c){if(b.element==null){return}var a=moment(c.beginTime).format("Z");c.timeZoneOffsetUtc=a;ServiceInterface.getChartData(c,{callback:function(e){if(b.chartType=="counter"){var E=e[0].data;var A=E[0];var B=A[1];if(b.units=="hours"&&B/3600000<1){b.units="minutes"}if(b.units=="minutes"){B=B/60000}else{if(b.units=="hours"){B=B/3600000}}function q(K,M){var J=[{value:1000000000000000000,symbol:"E"},{value:1000000000000000,symbol:"P"},{value:1000000000000,symbol:"T"},{value:1000000000,symbol:"G"},{value:1000000,symbol:"M"},{value:1000,symbol:"K"}],N=/\.0+$|(\.[0-9]*[1-9])0+$/,L;for(L=0;L<J.length;L++){if(K>=J[L].value){return(K/J[L].value).toFixed(M).replace(N,"$1")+J[L].symbol}}return K.toFixed(M).replace(N,"$1")}var p=q(B,1);if(b.units=="minutes"){p=p+" m"}else{if(b.units=="hours"){p=p+" h"}}b.element.innerHTML=p;return}var h=10;var f=[0,6,12,18];var o=[1,15];var s=moment.duration(c.endTime-c.beginTime);var g=s.asDays();var j=s.asMonths();var y=c.timeUnit;while(true){if(y=="hour"){var F=g*f.size();if(F<=h){break}else{y="day"}}else{if(y=="day"){var F=j*o.size();if(F<=h){break}else{y="month"}}else{break}}}var H={};var D=e[0].data.size();var w=0;e[0].data.each(function(N){var M=N[0];var L=moment(M);var J=L.utcOffset(a).hours();var K=L.utcOffset(a).date();var O=L.utcOffset(a).month();if(y=="hour"){if(f.indexOf(J)!=-1){H[M]=true}}else{if(y=="day"){if(J==0){if(g<=h){H[M]=true}else{if(o.indexOf(K)!=-1){H[M]=true}else{if(w==D-1&&K>=20){H[M]=true}}}}}else{if(y=="month"){if(K==1&&J==0){var i=s.asMonths();if(i<=h){H[M]=true}else{if(O%2==0){H[M]=true}}}}}}w++});var t=function(K){var J=new Date(parseInt(K));var i;if(y=="hour"){i=moment(J).utcOffset(a).format("MMM D, ha")}else{if(y=="day"){i=moment(J).utcOffset(a).format("MMM D")}else{i=moment(J).utcOffset(a).format("MMM YYYY")}}return i};var v=function(K){var J=K-60;var i=e[0].data.length;var L=J/(i-1)/2;return L};var n=v(jQuery(b.element).width());var G=[];var r=[];for(var C=0;C<e.length;C++){var E=e[C];if(b.seriesLabel!=null){E.label=b.seriesLabel}var I=[];E.data.each(function(i){if(C==0){G.push(i[0])}if(b.units=="minutes"){i[1]=i[1]/60000}else{if(b.units=="hours"){i[1]=i[1]/3600000}}I.push(i[1])});var d;var m;if(E.label.indexOf("Facebook")!=-1){d="rgba(72, 103, 170, 1.0)";m="rgba(72, 103, 170, 0.2)"}else{if(E.label.indexOf("Twitter")!=-1){d="rgba(29, 161, 242, 1.0)";m="rgba(29, 161, 242, 0.2)"}else{if(E.label.indexOf("Guest")!=-1){d="rgba(119, 142, 188, 1.0)";m="rgba(119, 142, 188, 0.2)"}else{if(E.label.indexOf("Single")!=-1){d="rgba(180, 180, 180, 1.0)";m="rgba(180, 180, 180, 0.2)"}else{if(C==0){d="rgba(0, 188, 244, 1.0)";m="rgba(0, 188, 244, 0.2)"}else{if(C==1){d="rgba(155, 187, 89, 1.0)";m="rgba(155, 187, 89, 0.2)"}else{if(C==2){d="rgba(192, 80, 77, 1.0)";m="rgba(192, 80, 77, 0.2)"}else{d="rgba(255, 152, 0, 1.0)";m="rgba(255, 152, 0, 0.2)"}}}}}}}var u={data:I,label:E.label,lineTension:0,borderWidth:4,borderJoinStyle:"bevel",borderColor:d,pointBackgroundColor:d,backgroundColor:m,pointHitRadius:n};r.push(u)}var I={labels:G,datasets:r};Chart.defaults.global.defaultFontFamily="'Lato', sans-serif";var l={maintainAspectRatio:false,legend:{display:(I.datasets.length>1)},hover:{mode:"x-axis",animationDuration:0},tooltips:{mode:"x-axis",callbacks:{title:function(J,K){var i=J[0].index;var L=K.labels[i];return t(L)},label:function(J,L){var M=L.datasets[J.datasetIndex];var i=M.label;var K=M.data[J.index];K=Math.round(K*100)/100;return i+": "+K}}},scales:{xAxes:[{ticks:{maxRotation:0,autoSkip:false,callback:function(i){if(H[i]){return t(i)}else{return null}}},gridLines:{display:false}}],yAxes:[{ticks:{beginAtZero:true,maxTicksLimit:4,callback:function(i){if(i%1==0){return i}else{return null}}}}]},onResize:function(M,K){var N=v(K.width);var L=M.config.data.datasets;for(var J=0;J<L.length;J++){L[J].pointHitRadius=N}}};var x=function(J){var K=jQuery.data(J,"chart");if(K!=null){K.destroy();jQuery.data(J,"chart",null)}if(jQuery(J).find("#chart-canvas").length==0){jQuery(J).append("<canvas id='chart-canvas'></canvas>")}var i=jQuery(J).find("#chart-canvas")[0];return i};var k=x(b.element);var z=new Chart(k,{type:"line",data:I,options:l});jQuery.data(b.element,"chart",z)},errorHandler:function(){b.element.innerHTML="Error retrieving chart data."}})}};var TimeZone=Class.create();TimeZone.prototype={initialize:function(){var b="timezoneOffset";var e=new Date().getTimezoneOffset();var c=parseInt(this.readCookie(b));if(!c||c!==e){var f=new Date();f.setTime(f.getTime()+(365*24*60*60*1000));var a="expires="+f.toUTCString();document.cookie="timezoneOffset="+e+"; "+a}},readCookie:function(a){if(this.cookies){return this.cookies[a]}var e=document.cookie.split("; ");this.cookies={};for(var b=e.length-1;b>=0;b--){var d=e[b].split("=");this.cookies[d[0]]=d[1]}return this.cookies[a]}};var timeZone=new TimeZone();var ChatApp=Class.create();ChatApp.prototype={initialize:function(clientConfigJson){this.clientConfig=(function(){return eval(clientConfigJson)})();this.templateManager=new TemplateManager();this.tooltipManager=new TooltipManager();this.profileManager=new ProfileManager();this.profileManager.setChatApp(this);this.groupManager=new GroupManager();this.groupManager.setChatApp(this);this.userPreferenceManager=new UserPreferenceManager();this.userPreferenceManager.setChatApp(this);this.accountManager=new AccountManager();this.accountManager.setChatApp(this);this.clientInterface=new ClientInterface();this.clientInterface.setChatApp(this);this.messageBus=new MessageBus();this.messageBus.setChatApp(this);gt=new Gettext({locale_data:goMessages[this.clientConfig.language]});_=function(msgid){return gt.gettext(msgid)};if(window.moment){moment.locale(this.clientConfig.language)}this.resetClientEnabled=true;this.facebook=new Facebook();this.facebook.setChatApp(this)},fireGroupUiAction:function(a){var b=this.groupManager.getGroup(this.clientConfig.groupId);if(b!=null){b.onUiActionEvent(a)}}};var Profile=Class.create();Profile.prototype={initialize:function(a){Object.extend(this,a);this.chatApp=null;this.profileLinkBefore=null;this.profileLinkAfter=null;this.profileImageClassName=null;this.profileDisplayNameClassName=null},setChatApp:function(a){this.chatApp=a},prepareForTemplateEval:function(){this.displayNameHTML=this.getDisplayNameHTML();this.iconImageHTML=this.getIconImageHTML();this.tinyImageHTML=this.getTinyImageHTML()},getDisplayNameHTML:function(){this._updateProfileLink();var a=this.displayNameHtml;if(this.guest&&(a=="")){if(this.userId==this.chatApp.profileManager.currentUserId){a=_("Me")}else{a=_("Guest")}}var b=this.profileLinkBefore;if(this.profileDisplayNameClassName!=null){b+="<span class='"+this.profileDisplayNameClassName+"'>"}b+=a;if(this.profileDisplayNameClassName!=null){b+="</span>"}b+=this.profileLinkAfter;return b},getIconImageHTML:function(){return this._getImageHTML(this.iconImageURL,"profile-icon-image")},getTinyImageHTML:function(){return this._getImageHTML(this.tinyImageURL,"profile-tiny-image")},_getImageHTML:function(d,a){this._updateProfileLink();if(this.profileLinkBefore!=""){a+=" highlight "}if(this.profileImageClassName!=null){a+=this.profileImageClassName}var c=this.profileLinkBefore+"<div ";if(a!=""){c+="class='"+a+"' "}var b;if(d){b=this.chatApp.clientConfig.baseImagesUrl+d}else{b="/t.gif"}c+="style=\"background-image:url('"+b+"')\"></div>"+this.profileLinkAfter;return c},_updateProfileLink:function(){if(this.profileLinkBefore==null&&this.profileLinkAfter==null){var a="";a="target='_blank'";if(!this.guest&&this.profileUrl!=null){this.profileLinkBefore="<a "+a+" href='"+this.profileUrl+"'>";this.profileLinkAfter="</a>"}else{if(this.guest&&this.userId==this.chatApp.profileManager.currentUserId&&this.chatApp.clientConfig.groupSigninMethods.chatroll){this.profileLinkBefore="<a "+a+" href='/profile/me'>";this.profileLinkAfter="</a>"}else{this.profileLinkBefore="";this.profileLinkAfter=""}}}}};var ProfileManager=Class.create();ProfileManager.prototype={initialize:function(){this.chatApp=null;this.currentUserId=null;this.profiles=new Hash();this.currentProfileChangeEvent=new CustomEvent();this.profileChangeEvents=new Hash()},setChatApp:function(a){this.chatApp=a},setCurrentProfile:function(a){this.currentUserId=a.userId;var b=new Profile(a);b.setChatApp(this.chatApp);this.setProfile(b)},getCurrentProfile:function(){var a=null;if(this.currentUserId!=null){a=this.getProfile(this.currentUserId)}return a},setProfile:function(c){var a=c.userId;var b=new Profile(c);b.setChatApp(this.chatApp);this.profiles.set(a,b);if(this.currentUserId==a){this._fireCurrentProfileChangeEvent(b)}this._fireProfileChangeEvent(a,b)},getProfile:function(b){if(!this.profiles.get(b)){var a=new Profile({userId:b,displayName:"",displayNameHtml:"...",guest:true,mainImageURL:null,iconImageURL:null,tinyImageURL:null,tempProfile:true});a.setChatApp(this.chatApp);this.profiles.set(b,a);ServiceInterface.getProfile(b,{callback:this._getProfileCallback.bindAsEventListener(this)})}return this.profiles.get(b)},addCurrentProfileChangeListener:function(a){this.currentProfileChangeEvent.observe(a)},removeCurrentProfileChangeListener:function(a){this.currentProfileChangeEvent.stopObserving(a)},addProfileChangeListener:function(a,b){var c=this.profileChangeEvents.get(a);if(c==null){c=new CustomEvent();this.profileChangeEvents.set(a,c)}c.observe(b)},removeProfileChangeListener:function(a,b){if(a!=null){var c=this.profileChangeEvents.get(a);if(c){c.stopObserving(b)}else{logger.error("removeProfileChangeListener: no event for profile "+a)}}else{this.profileChangeEvents.each(function(e){var d=e.value;d.stopObserving(b)})}},_fireCurrentProfileChangeEvent:function(a){this.currentProfileChangeEvent.fire(a)},_fireProfileChangeEvent:function(a,b){var c=this.profileChangeEvents.get(a);if(c){c.fire(b)}},_getProfileCallback:function(a){this.setProfile(a)}};var GroupPermission=Class.create();GroupPermission.PERMISSION_WRITE=1;GroupPermission.PERMISSION_ADMIN=4;GroupPermission.PERMISSION_ARCHIVE_ACCESS=5;GroupPermission.PERMISSION_MODERATE=6;GroupPermission.PERMISSION_SEND_PM=9;GroupPermission.PERMISSION_DELETE_OWN_MESSAGES=11;GroupPermission.PERMISSION_SEND_MODERATOR_PM=13;var Feature=Class.create();Feature.GROUP_USER_FEATURE_FREE_PM=100;Feature.GROUP_FEATURE_IN_MODULE_ARCHIVE_BROWSING=5;var Group=Class.create();Group.CONTACT_LIST_POSITION_AUTO=0;Group.CONTACT_LIST_POSITION_RIGHT=1;Group.CONTACT_LIST_POSITION_TOP=2;Group.CONTACT_LIST_POSITION_HIDDEN=3;Group.prototype={initialize:function(a){Object.extend(this,a);this.chatApp=null;this.recentMessages=null;this.lastMessageTime=null;this.clientLastViewTime=null;this.newMessageCount=0;this.onlineCount=0;this.groupUserStates=null;this.onlineCountChangeEvent=new CustomEvent();this.newMessageCountChangeEvent=new CustomEvent();this.messageEvent=new CustomEvent();this.messageDeleteEvent=new CustomEvent();this.userJoinEvent=new CustomEvent();this.userLeaveEvent=new CustomEvent();this.stickyMessageUpdateEvent=new CustomEvent();this.groupItemEvent=new CustomEvent();this.groupItemUpdateEvent=new CustomEvent();this.groupItemActionEvent=new CustomEvent();this.groupItemDeleteEvent=new CustomEvent();this.chatAdEvent=new CustomEvent();this.privateMessageActionEvent=new CustomEvent();this.approvalQueueEvent=new CustomEvent();this.messageSkippedEvent=new CustomEvent();this.groupUserStateUpdateAnyEvent=new CustomEvent();this.groupUserStateUpdateEvents=new Hash();this.uiActionEvents=new Hash()},setChatApp:function(a){this.chatApp=a},setConnectSuccessData:function(b){this.recentMessages=b.recentMessages;if(this.recentMessages&&this.recentMessages.length>0){this.lastMessageTime=this.recentMessages[this.recentMessages.length-1].createdTime}this.onlineCount=b.onlineCount;var a=b.profiles;for(var c=0,d=a.length;c<d;++c){this.chatApp.profileManager.setProfile(a[c])}this.groupUserStates=b.groupUserStates;this._initNewMessageCount()},onGroupInvite:function(b,a){var c=this.chatApp.groupManager.getGroup(b);if(!c){this.chatApp.groupManager.connectGroup(b,false,a)}},leaveGroup:function(){ServiceInterface.leaveGroup(this.groupId,{callback:function(){},errorHandler:function(){alert("Error leaving chat. Please notify support@chatroll.com")}})},setGroupUserStatus:function(a){if(!this.publicGroup){ServiceInterface.setGroupUserStatus(this.groupId,a,{callback:function(){},errorHandler:function(){logger.error("Error calling setGroupUserStatus")}})}else{if(a=="online"){this.clientLastViewTime=this.lastMessageTime;this.newMessageCount=0;this._fireNewMessageCountChangeEvent(this.newMessageCount)}}},getLastViewTime:function(){var b=null;if(!this.publicGroup){var a=this.groupUserStates[this.chatApp.profileManager.currentUserId];b=a.groupUser.lastViewTime}else{b=this.clientLastViewTime}return b},_initNewMessageCount:function(){var c=0;if(this.recentMessages&&this.recentMessages.length>0){var b=this.getLastViewTime();for(var a=this.recentMessages.length-1;a>=0;a--){var d=this.recentMessages[a];if(b&&d.createdTime.getTime()<=b.getTime()){break}c++}}this.newMessageCount=c},getNewMessageCount:function(){return this.newMessageCount},onUserJoin:function(b,a){this.groupUserStates[b.userId]=a;this._fireUserJoinEvent(b)},onUserLeave:function(a){if(a!=this.chatApp.profileManager.currentUserId){delete this.groupUserStates[a];this._fireUserLeaveEvent(a)}},onGroupUserStateUpdate:function(b,a){this.groupUserStates[b]=a;var d=a.groupUser;if(d&&d.userId==this.chatApp.profileManager.currentUserId){if(this.lastMessageTime){var c=this.getLastViewTime();if(c&&c.getTime()>=this.lastMessageTime.getTime()){this.newMessageCount=0;this._fireNewMessageCountChangeEvent(this.newMessageCount)}}if(d.state=="inactive"){this.chatApp.groupManager.closeGroup(d.groupId)}}this._fireGroupUserStateUpdateEvent(b,a);this._fireGroupUserStateUpdateAnyEvent(b,a)},onMessage:function(b){this.chatApp.profileManager.setProfile(b.profile);var a=this.groupUserStates[this.chatApp.profileManager.currentUserId];if(!a.groupUser||a.groupUser.state=="active"){this.lastMessageTime=b.createdTime;if(this.chatApp.groupManager.activeGroupId!=this.groupId){this.newMessageCount++;this._fireNewMessageCountChangeEvent(this.newMessageCount)}this._fireMessageEvent(b)}},onMessageDelete:function(b,a){this._fireMessageDeleteEvent(b,a)},onOnlineCountChange:function(a){this.onlineCount=a;this.onlineCountChangeEvent.fire()},onGroupItem:function(a,b){this._fireGroupItemEvent(a,b)},onGroupItemUpdate:function(a){this._fireGroupItemUpdateEvent(a)},onGroupItemDelete:function(a){this._fireGroupItemDeleteEvent(a)},onGroupItemAction:function(a,b){this._fireGroupItemActionEvent(a,b)},onChatAd:function(a){this._fireChatAdEvent(a)},onPrivateMessageReceived:function(a,b){this._firePrivateMessageActionEvent("received",a,b)},onPrivateMessageSend:function(a){this._firePrivateMessageActionEvent("send",a,null)},onUiActionEvent:function(a){this._fireUiActionEvent(a)},addNewMessageCountChangeListener:function(a){this.newMessageCountChangeEvent.observe(a)},removeNewMessageCountChangeListener:function(a){this.newMessageCountChangeEvent.stopObserving(a)},_fireNewMessageCountChangeEvent:function(a){this.newMessageCountChangeEvent.fire(a)},addMessageListener:function(a){this.messageEvent.observe(a)},removeMessageListener:function(a){this.messageEvent.stopObserving(a)},_fireMessageEvent:function(a){this.messageEvent.fire(a)},addMessageDeleteListener:function(a){this.messageDeleteEvent.observe(a)},removeMessageDeleteListener:function(a){this.messageDeleteEvent.stopObserving(a)},_fireMessageDeleteEvent:function(b,a){var c={userId:b,messageId:a};this.messageDeleteEvent.fire(c)},addGroupItemListener:function(a){this.groupItemEvent.observe(a)},removeGroupItemListener:function(a){this.groupItemEvent.stopObserving(a)},_fireGroupItemEvent:function(a,b){var c={groupItem:a,message:b};this.groupItemEvent.fire(c)},addUserJoinListener:function(a){this.userJoinEvent.observe(a)},removeUserJoinListener:function(a){this.userJoinEvent.stopObserving(a)},_fireUserJoinEvent:function(a){this.userJoinEvent.fire(a)},addUserLeaveListener:function(a){this.userLeaveEvent.observe(a)},removeUserLeaveListener:function(a){this.userLeaveEvent.stopObserving(a)},_fireUserLeaveEvent:function(a){this.userLeaveEvent.fire(a)},addGroupUserStateUpdateAnyListener:function(a){this.groupUserStateUpdateAnyEvent.observe(a)},removeGroupUserStateUpdateAnyListener:function(a){this.groupUserStateUpdateAnyEvent.stopObserving(a)},_fireGroupUserStateUpdateAnyEvent:function(b,a){var c={userId:b,groupUserState:a};this.groupUserStateUpdateAnyEvent.fire(c)},addGroupUserStateUpdateListener:function(b,c){var a=this.groupUserStateUpdateEvents.get(b);if(a==null){a=new CustomEvent();this.groupUserStateUpdateEvents.set(b,a)}a.observe(c)},removeGroupUserStateUpdateListener:function(b,c){var a=this.groupUserStateUpdateEvents.get(b);if(a!=null){a.stopObserving(c)}else{logger.error("removeGroupUserStateUpdateListener: no event for userId "+b)}},_fireGroupUserStateUpdateEvent:function(c,b){var a=this.groupUserStateUpdateEvents.get(c);if(a!=null){a.fire(b)}},addGroupItemUpdateListener:function(a){this.groupItemUpdateEvent.observe(a)},removeGroupItemUpdateListener:function(a){this.groupItemUpdateEvent.stopObserving(a)},_fireGroupItemUpdateEvent:function(a){this.groupItemUpdateEvent.fire(a)},addGroupItemActionListener:function(a){this.groupItemActionEvent.observe(a)},removeGroupItemActionListener:function(a){this.groupItemActionEvent.stopObserving(a)},_fireGroupItemActionEvent:function(a,b){var c={groupItem:a,action:b};this.groupItemActionEvent.fire(c)},addGroupItemDeleteListener:function(a){this.groupItemDeleteEvent.observe(a)},removeGroupItemDeleteListener:function(a){this.groupItemDeleteEvent.stopObserving(a)},_fireGroupItemDeleteEvent:function(a){this.groupItemDeleteEvent.fire(a)},addChatAdListener:function(a){this.chatAdEvent.observe(a)},removeChatAdListener:function(a){this.chatAdEvent.stopObserving(a)},_fireChatAdEvent:function(a){this.chatAdEvent.fire(a)},addPrivateMessageActionListener:function(a){this.privateMessageActionEvent.observe(a)},removePrivateMessageActionListener:function(a){this.privateMessageActionEvent.stopObserving(a)},_firePrivateMessageActionEvent:function(d,a,c){var b={action:d,userId:a,message:c};this.privateMessageActionEvent.fire(b)},addUiActionListener:function(b,a){var c=this.uiActionEvents.get(b);if(c==null){c=new CustomEvent();this.uiActionEvents.set(b,c)}c.observe(a)},removeUiActionListener:function(b,a){var c=this.uiActionEvents.get(b);if(c!=null){c.stopObserving(a)}},_fireUiActionEvent:function(a){var b=this.uiActionEvents.get(a);if(b!=null){b.fire(a)}}};var GroupItem=Class.create();GroupItem.TYPE_BOOKMARK=1;GroupItem.TYPE_IMAGE=2;GroupItem.TYPE_VIDEO_YOUTUBE=3;GroupItem.TYPE_VIDEO_BREAK=4;GroupItem.TYPE_DISCUSSION=5;var GroupManager=Class.create();GroupManager.prototype={initialize:function(){this.chatApp=null;this.groups=new Hash();this.firstActiveGroupId=null;this.activeGroupId=null;this.joinGroupEvent=new CustomEvent();this.closeGroupEvent=new CustomEvent();this.activeGroupEvent=new CustomEvent()},setChatApp:function(a){this.chatApp=a},getGroup:function(a){return this.groups.get(a)},connectGroup:function(b,c,a){var d=this.getGroup(b);if(d){if(c){this.setActiveGroup(d)}}else{ServiceInterface.connectGroup(b,{callback:this._onConnectGroupSuccess.bind(this,c,a),errorHandler:function(){alert("Error connecting to chat. Please notify support@chatroll.com")}})}},_onConnectGroupSuccess:function(c,b,a){var d=new Group(a.groupData.group);d.setChatApp(this.chatApp);d.setConnectSuccessData(a.groupData);this.addGroup(d,c,b)},addGroup:function(d,c,a){this.groups.set(d.groupId,d);this._fireJoinGroupEvent(d);if(c){this.setActiveGroup(d)}if(a){var b=new GroupInvitePopup();b.setChatApp(this.chatApp);b.setGroup(d);b.showPopup(a)}},setActiveGroup:function(a){this._fireActiveGroupEvent(a);this.activeGroupId=a.groupId;if(this.firstActiveGroupId==null){this.firstActiveGroupId=a.groupId}},closeGroup:function(b){var c=this.getGroup(b);if(c){if(b==this.activeGroupId){var a=this.getGroup(this.firstActiveGroupId);this.setActiveGroup(a)}this._fireCloseGroupEvent(c);this.groups.unset(c.groupId);ServiceInterface.disconnectGroup(b,{callback:function(){},errorHandler:function(){logger.error("Error disconnecting from chat.")}})}else{logger.error("Attempted to close unknown group "+b)}},addJoinGroupListener:function(a){this.joinGroupEvent.observe(a)},_fireJoinGroupEvent:function(a){this.joinGroupEvent.fire(a)},addCloseGroupListener:function(a){this.closeGroupEvent.observe(a)},_fireCloseGroupEvent:function(a){this.closeGroupEvent.fire(a)},addActiveGroupListener:function(a){this.activeGroupEvent.observe(a)},removeActiveGroupListener:function(a){this.activeGroupEvent.stopObserving(a)},_fireActiveGroupEvent:function(a){this.activeGroupEvent.fire(a)}};var UserPreferenceManager=Class.create();UserPreferenceManager.prototype={initialize:function(){this.chatApp=null;this.userPreference=null},setChatApp:function(a){this.chatApp=a},setUserPreference:function(a){this.userPreference=a},isSoundOn:function(){return this.userPreference.soundOn},setSoundOn:function(a){this.userPreference.soundOn=a;this._onUserPreferenceUpdate()},_onUserPreferenceUpdate:function(){ServiceInterface.updateUserPreference(this.userPreference,this.chatApp.clientConfig.groupId)}};var AccountManager=Class.create();AccountManager.prototype={initialize:function(){this.chatApp=null;this.balance=0;this.accountBalanceUpdateEvent=new CustomEvent()},setChatApp:function(a){this.chatApp=a},setBalance:function(c,d,b){this.balance=c;this._fireAccountBalanceUpdateEvent();if(b!=null){var a=new ConfirmationPopup();a.setChatApp(this.chatApp);a.setTitle("Account "+(d>0?"Credited":"Debited"));a.setCancelButtonValue(null);a.setMessage(b);a.show()}},addAccountBalaceUpdateListener:function(a){this.accountBalanceUpdateEvent.observe(a)},removeAccountBalaceUpdateListener:function(a){this.accountBalanceUpdateEvent.stopObserving(a)},_fireAccountBalanceUpdateEvent:function(){this.accountBalanceUpdateEvent.fire(""+this.balance)}};var MessageBus=Class.create();MessageBus.prototype={initialize:function(){this.chatApp=null;this.connected=false;this.heartbeatTimer=null;this.connectSuccessEvent=new CustomEvent();this.connectFailureEvent=new CustomEvent();this.disconnectEvent=new CustomEvent();this.windowUnloadListener=this._onWindowUnload.bindAsEventListener(this);Event.observe(window,"beforeunload",this.windowUnloadListener);window.cancelDisconnect=function(){Event.stopObserving(window,"beforeunload",this.windowUnloadListener);this._onWindowUnload()}.bind(this)},setChatApp:function(a){this.chatApp=a},addConnectSuccessListener:function(a){this.connectSuccessEvent.observe(a)},removeConnectSuccessListener:function(a){this.connectSuccessEvent.stopObserving(a)},_fireConnectSuccessEvent:function(a){this.connectSuccessEvent.fire(a)},addConnectFailureListener:function(a){this.connectFailureEvent.observe(a)},removeConnectFailureListener:function(a){this.connectFailureEvent.stopObserving(a)},_fireConnectFailureEvent:function(a){this.connectFailureEvent.fire(a)},addDisconnectListener:function(a){this.disconnectEvent.observe(a)},removeDisconnectListener:function(a){this.disconnectEvent.stopObserving(a)},_fireDisconnectEvent:function(){this.disconnectEvent.fire()},autoConnect:function(){if(this.chatApp.clientConfig.autoConnect){this.connect()}},connect:function(){if(!this.connected){var a=(document.domain).replace("secure.","");if((a!=document.domain)||!Prototype.Browser.IE){document.domain=a}ServiceInterface.connect(this.chatApp.clientConfig,{callback:this._onConnectSuccess.bind(this),errorHandler:this._onConnectFailure.bind(this)})}},_onConnectSuccess:function(b){this.connected=true;this.chatApp.profileManager.setCurrentProfile(b.currentProfile);this.chatApp.userPreferenceManager.setUserPreference(b.userPreference);this.chatApp.accountManager.setBalance(b.accountBalance,0,null);if(!this.chatApp.clientConfig.defaultSoundOn){this.chatApp.userPreferenceManager.setSoundOn(false)}if(b.groupData!=null){var c=new Group(b.groupData.group);c.setChatApp(this.chatApp);c.setConnectSuccessData(b.groupData);this.chatApp.groupManager.addGroup(c,true)}if(b.autoConnectGroupIds!=null){b.autoConnectGroupIds.each(function(d){setTimeout(function(){this.chatApp.groupManager.connectGroup(d,false)}.bind(this),0)}.bind(this))}this._fireConnectSuccessEvent(b);var a=dwr.engine._getScriptSessionId();Redsea.hostid=a;if(location.protocol!="https:"){Redsea.protocol="http";Redsea.host=a+".live."+document.domain}else{Redsea.protocol="https";Redsea.host=(document.domain).replace("secure.","")}Redsea.port=(location.port.length>0)?location.port:80;Redsea.registerEventCallback("process",function(d){setTimeout(d,0)});Redsea.joinChannel(a,5);Redsea.connect();this._scheduleHeartbeat();logger.debug("Client connected.")},_onConnectFailure:function(b,a){clearTimeout(this.heartbeatTimer);this._fireConnectFailureEvent(a);logger.debug("Failed to connect client!")},_scheduleHeartbeat:function(){clearTimeout(this.heartbeatTimer);this.heartbeatTimer=setTimeout(this._onHeartbeatTimer.bindAsEventListener(this),60000)},_onHeartbeatTimer:function(){this._scheduleHeartbeat();ServiceInterface.heartbeat()},_onWindowUnload:function(){if(this.connected){clearTimeout(this.heartbeatTimer);Redsea.disconnect();dwr.engine.setAsync(false);this._fireDisconnectEvent();ServiceInterface.disconnect();this.connected=false}}};var ClientInterface=Class.create();ClientInterface.prototype={initialize:function(){this.chatApp=null},setChatApp:function(a){this.chatApp=a},onOnlineCountChange:function(a,c){var b=this.chatApp.groupManager.getGroup(a);if(b){b.onOnlineCountChange(c)}else{}},onJoinGroup:function(b,e,a){var d=this.chatApp.groupManager.getGroup(b);if(d){this.chatApp.profileManager.setProfile(e);var c=this.chatApp.profileManager.getProfile(e.userId);d.onUserJoin(c,a)}else{logger.error("onJoinGroup: Could not find group "+b)}},onLeaveGroup:function(b,a){var c=this.chatApp.groupManager.getGroup(b);if(c){c.onUserLeave(a)}else{logger.error("onLeaveGroup: Could not find group "+b)}},onGroupUserStateUpdate:function(c,b,a){var d=this.chatApp.groupManager.getGroup(c);if(d){d.onGroupUserStateUpdate(b,a)}else{logger.error("onGroupUserStateUpdate: Could not find group "+c)}},onStickyMessageUpdate:function(b,a){var c=this.chatApp.groupManager.getGroup(b);if(c){c.stickyMessageUpdateEvent.fire(a)}},onProfileChange:function(a){this.chatApp.profileManager.setProfile(a)},onChatAd:function(b,a){var c=this.chatApp.groupManager.getGroup(b);if(c){c.onChatAd(a)}else{logger.error("onChatAd: Could not find group "+b)}},onMessage:function(a){var b=this.chatApp.groupManager.getGroup(a.groupId);if(b){b.onMessage(a)}else{logger.error("onMessage: Could not find group "+a.groupId)}},onMessageDelete:function(c,b,a){var d=this.chatApp.groupManager.getGroup(c);if(d){d.onMessageDelete(b,a)}else{logger.error("onMessageDelete: Could not find group "+c)}},onGroupItem:function(a,b){var c=this.chatApp.groupManager.getGroup(a.groupId);if(c){c.onGroupItem(a,b)}else{logger.error("onGroupItem: Could not find group "+a.groupId)}},onGroupItemUpdate:function(a){var b=this.chatApp.groupManager.getGroup(a.groupId);if(b){b.onGroupItemUpdate(a)}else{logger.error("onGroupItemUpdate: Could not find group "+a.groupId)}},onGroupItemDelete:function(a,c){var b=this.chatApp.groupManager.getGroup(a);if(b){b.onGroupItemDelete(c)}else{logger.error("onGroupItemDelete: Could not find group "+groupItem.groupId)}},onApprovalQueueEvent:function(a){var b=this.chatApp.groupManager.getGroup(a.groupId);if(b){b.approvalQueueEvent.fire(a)}else{logger.error("onApprovalQueueEvent: Could not find group "+a.groupId)}},onMessageSkipped:function(a){var b=this.chatApp.groupManager.getGroup(a);if(b){b.messageSkippedEvent.fire()}},onGroupInvite:function(b,a,c){if(this.chatApp.clientConfig.groupId==a){this.chatApp.profileManager.setProfile(c);var d=this.chatApp.groupManager.getGroup(a);d.onGroupInvite(b,c.userId)}},onAccountBalanceUpdate:function(b,c,a){this.chatApp.accountManager.setBalance(b,c,a)},onGiftNotification:function(d,a,c,b){if(this.chatApp.clientConfig.groupId==a){this.chatApp.profileManager.setProfile(d);var e=this.chatApp.groupManager.getGroup(a);e.onPrivateMessageReceived(d.userId,b)}},resetClient:function(a){if(this.chatApp.resetClientEnabled){if(a!=null){alert(a)}window.location.reload()}}};if(dwr==null){var dwr={}}if(dwr.engine==null){dwr.engine={}}if(DWREngine==null){var DWREngine=dwr.engine}if(ServiceInterface==null){var ServiceInterface={}}ServiceInterface._path="/service";ServiceInterface.log=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","log",b,a)};ServiceInterface.connect=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","connect",b,a)};ServiceInterface.modifyUserPermissions=function(f,d,c,b,a,e){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","modifyUserPermissions",f,d,c,b,a,e)};ServiceInterface.setMessagePostingEnabled=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","setMessagePostingEnabled",c,a,b)};ServiceInterface.setPublishInterval=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","setPublishInterval",c,a,b)};ServiceInterface.setManualApprovalEnabled=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","setManualApprovalEnabled",c,a,b)};ServiceInterface.getHistoryMessages=function(d,b,a,c){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","getHistoryMessages",d,b,a,c)};ServiceInterface.getApprovalQueueSection=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","getApprovalQueueSection",c,a,b)};ServiceInterface.approveMessage=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","approveMessage",c,a,b)};ServiceInterface.skipMessage=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","skipMessage",c,a,b)};ServiceInterface.approveAllMessages=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","approveAllMessages",b,a)};ServiceInterface.skipAllMessages=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","skipAllMessages",b,a)};ServiceInterface.clearRecentMessages=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","clearRecentMessages",b,a)};ServiceInterface.submitGroupSettingsWordFilterForm=function(d,b,a,c){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","submitGroupSettingsWordFilterForm",d,b,a,c)};ServiceInterface.submitGroupSettingsAccessPassForm=function(e,c,b,a,d){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","submitGroupSettingsAccessPassForm",e,c,b,a,d)};ServiceInterface.submitGroupSettingsAppearanceForm=function(m,l,j,i,h,g,f,e,d,c,b,a,k){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","submitGroupSettingsAppearanceForm",m,l,j,i,h,g,f,e,d,c,b,a,k)};ServiceInterface.updateStickyMessage=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","updateStickyMessage",c,a,b)};ServiceInterface.updateWelcomeMessage=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","updateWelcomeMessage",c,a,b)};ServiceInterface.setCrossPostUrl=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","setCrossPostUrl",c,a,b)};ServiceInterface.crossPost=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","crossPost",c,a,b)};ServiceInterface.sendMessage=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","sendMessage",c,a,b)};ServiceInterface.updateUserPreference=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","updateUserPreference",c,a,b)};ServiceInterface.startPrivateChat=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","startPrivateChat",c,a,b)};ServiceInterface.searchInviteUsers=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","searchInviteUsers",c,a,b)};ServiceInterface.sendInvite=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","sendInvite",c,a,b)};ServiceInterface.respondInvite=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","respondInvite",c,a,b)};ServiceInterface.deleteMessages=function(d,b,a,c){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","deleteMessages",d,b,a,c)};ServiceInterface.deleteGroupItem=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","deleteGroupItem",c,a,b)};ServiceInterface.deleteGroup=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","deleteGroup",b,a)};ServiceInterface.modifyDeniedIpPermissions=function(f,d,c,b,a,e){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","modifyDeniedIpPermissions",f,d,c,b,a,e)};ServiceInterface.purchaseAccessPass=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","purchaseAccessPass",b,a)};ServiceInterface.purchaseBluePass=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","purchaseBluePass",b,a)};ServiceInterface.purchaseGift=function(e,c,b,a,d){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","purchaseGift",e,c,b,a,d)};ServiceInterface.trackClick=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","trackClick",c,a,b)};ServiceInterface.trackConversion=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","trackConversion",b,a)};ServiceInterface.getChartData=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","getChartData",b,a)};ServiceInterface.heartbeat=function(a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","heartbeat",a)};ServiceInterface.deleteProfileImage=function(a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","deleteProfileImage",a)};ServiceInterface.getProfile=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","getProfile",b,a)};ServiceInterface.submitGroupSettingsBasicForm=function(e,c,b,a,d){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","submitGroupSettingsBasicForm",e,c,b,a,d)};ServiceInterface.submitGroupSettingsAccessForm=function(h,f,e,d,c,b,a,g){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","submitGroupSettingsAccessForm",h,f,e,d,c,b,a,g)};ServiceInterface.submitGroupSettingsPermissionsForm=function(g,e,d,c,b,a,f){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","submitGroupSettingsPermissionsForm",g,e,d,c,b,a,f)};ServiceInterface.submitGroupSettingsPrivateChatForm=function(d,b,a,c){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","submitGroupSettingsPrivateChatForm",d,b,a,c)};ServiceInterface.submitGroupSettingsSharingForm=function(f,d,c,b,a,e){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","submitGroupSettingsSharingForm",f,d,c,b,a,e)};ServiceInterface.connectGroup=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","connectGroup",b,a)};ServiceInterface.disconnectGroup=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","disconnectGroup",b,a)};ServiceInterface.setGroupUserStatus=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","setGroupUserStatus",c,a,b)};ServiceInterface.leaveGroup=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","leaveGroup",b,a)};ServiceInterface.facebookAuthenticate=function(d,b,a,c){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","facebookAuthenticate",d,b,a,c)};ServiceInterface.chatrollAuthenticate=function(e,c,b,a,d){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","chatrollAuthenticate",e,c,b,a,d)};ServiceInterface.setGuestDisplayName=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","setGuestDisplayName",c,a,b)};ServiceInterface.banUser=function(c,a,b){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","banUser",c,a,b)};ServiceInterface.banIp=function(e,c,b,a,d){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","banIp",e,c,b,a,d)};ServiceInterface.signout=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","signout",b,a)};ServiceInterface.removeFriend=function(b,a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","removeFriend",b,a)};ServiceInterface.disconnect=function(a){dwr.engine._execute(ServiceInterface._path,"ServiceInterface","disconnect",a)};var MainLayout=Class.create();MainLayout.prototype={initialize:function(){this.chatApp=null;this.resizeElements=$$(".vertical-resize");this.mobileSafari=/iPad|iPhone|iPod/.test(navigator.userAgent)&&/Safari/.test(navigator.userAgent);this._onWindowResize()},setChatApp:function(b){this.chatApp=b;var a=$$(".chat-sound-button")[0];if(a!=null){this.soundNotifier=new SoundNotifier(a);this.soundNotifier.setChatApp(b)}Event.observe(window,"resize",this._onWindowResize.bindAsEventListener(this));Event.observe(window,"scroll",this._onWindowResize.bindAsEventListener(this))},_onWindowResize:function(){var a=this.resizeElements.length;for(var b=0;b<a;b++){var c=this.resizeElements[b];var g=c.up();var j=g.cumulativeOffset().top;var h=95;var e=document.viewport.getHeight();var f=document.viewport.getScrollOffsets().top;var d=0;var k=400;if(this.mobileSafari){d=0;k=e-j-30}else{if(f<=(j-h)){d=0;k=e-j+f-15}else{d=f-j+h;k=e-h-15}}c.setStyle({top:d+"px",height:k+"px"})}}};var EmbedLayout=Class.create();EmbedLayout.prototype={initialize:function(){this.chatApp=null;this.groupChatWidget=new GroupChatWidget($$(".group-chat-embedded")[0]);this.soundNotifier=new SoundNotifier($$(".chat-sound-button")[0])},setChatApp:function(a){this.chatApp=a;this.groupChatWidget.setChatApp(this.chatApp);this.soundNotifier.setChatApp(a)}};var GroupView=Class.create();GroupView.prototype={initialize:function(b,a){this.frame=b;this.groupId=a;this.chatApp=null;this.group=null},setChatApp:function(a){this.chatApp=a;this.groupChatWidget=new GroupChatWidget($$(".group-chat-container")[0]);this.groupChatWidget.setChatApp(this.chatApp);this.chatApp.groupManager.addJoinGroupListener(this._onJoinGroup.bindAsEventListener(this))},_onJoinGroup:function(d){if(d.groupId==this.groupId){this.group=d;var c=null;this.groupContent=this.frame.down(".group-content");c=this.frame.down(".widgetid-group-settings");if(c!=null){this.groupSettingsWidget=new GroupSettingsWidget(c);this.groupSettingsWidget.setChatApp(this.chatApp);this.groupSettingsWidget.setGroup(this.group)}var a=8;c=this.frame.down(".widgetid-media-items");if(c==null){c=this.frame.down(".widgetid-media-items-maximized");a=24}if(c!=null){this.mediaItemsWidget=new GroupItemsWidget(c);this.mediaItemsWidget.setChatApp(this.chatApp);var b=new Array();b.push(GroupItem.TYPE_BOOKMARK);b.push(GroupItem.TYPE_IMAGE);b.push(GroupItem.TYPE_VIDEO_BREAK);b.push(GroupItem.TYPE_VIDEO_YOUTUBE);this.mediaItemsWidget.setItemTypeFilter(b);this.mediaItemsWidget.setGroupItemsLimit(a);this.mediaItemsWidget.setGroup(this.group)}c=this.frame.down(".widgetid-group-analytics");if(c!=null){this.groupAnalyticsWidget=new GroupAnalyticsWidget(c);this.groupAnalyticsWidget.setChatApp(this.chatApp);this.groupAnalyticsWidget.setGroup(this.group)}c=this.frame.down(".widgetid-group-archive");if(c!=null){this.groupArchiveWidget=new GroupArchiveWidget(c);this.groupArchiveWidget.setChatApp(this.chatApp);this.groupArchiveWidget.setGroup(this.group)}c=this.frame.down(".widgetid-group-archive-export");if(c!=null){this.groupArchiveExportWidget=new GroupArchiveExportWidget(c);this.groupArchiveExportWidget.setChatApp(this.chatApp);this.groupArchiveExportWidget.setGroup(this.group)}c=this.frame.down(".settings-section-appearance");if(c!=null){this.groupSettingsAppearanceWidget=new GroupSettingsAppearanceWidget(c);this.groupSettingsAppearanceWidget.setChatApp(this.chatApp);this.groupSettingsAppearanceWidget.setGroup(this.group)}}},_onLeaveGroup:function(a){if(a.groupId==this.groupId){window.location=this.chatApp.clientConfig.baseWebUrl+"/"}},destroy:function(){if(this.groupChatWidget!=null){this.groupChatWidget.destroy();this.groupChatWidget=null}if(this.mediaItemsWidget!=null){this.mediaItemsWidget.destroy();this.mediaItemsWidget=null}if(this.groupArchiveWidget!=null){this.groupArchiveWidget.destroy();this.groupArchiveWidget=null}}};var CreateGroupView=Class.create();CreateGroupView.prototype={initialize:function(a){this.frame=a;this.nameInput=this.frame.down(".create-group-name-input");this.nameCharsAvailable=this.frame.down(".create-group-name-chars-available");this.nameMaxSize=64;this.isNameModified=false;this.descInput=this.frame.down(".create-group-desc-input");this.descCharsAvailable=this.frame.down(".create-group-desc-chars-available");this.descMaxSize=150;this.urlInput=this.frame.down(".create-group-url-input");this.categoryInput=this.frame.down(".create-group-category-input");this._checkInputLength(this.nameInput,this.nameCharsAvailable,this.nameMaxSize);this._checkInputLength(this.descInput,this.descCharsAvailable,this.descMaxSize);this.isUrlModified=false;if(this.urlInput.value!=""&&this.urlInput.value!=this._createUrlFromNameInput()){this.isUrlModified=true}else{this.frame.down(".create-group-url-input").value=this._createUrlFromNameInput()}Event.observe(this.nameInput,"keyup",this._onNameInputKeyup.bindAsEventListener(this));Event.observe(this.urlInput,"keyup",this._onUrlInputKeyup.bindAsEventListener(this));Event.observe(this.descInput,"keyup",this._onDescInputKeyup.bindAsEventListener(this))},setChatApp:function(a){this.chatApp=a},_onNameInputKeyup:function(a){this.isNameModified=true;this._checkInputLength(this.nameInput,this.nameCharsAvailable,this.nameMaxSize);if(!this.isUrlModified){this.frame.down(".create-group-url-input").value=this._createUrlFromNameInput()}},_onUrlInputKeyup:function(a){this.isUrlModified=true},_onDescInputKeyup:function(a){this._checkInputLength(this.descInput,this.descCharsAvailable,this.descMaxSize)},_checkInputLength:function(e,d,a){var b=a-e.value.length;if(b<=0){e.value=e.value.substring(0,a);b=0;d.addClassName("text-danger")}else{d.removeClassName("text-danger")}var c=b+((b!=1)?" characters":" character")+" left";d.innerHTML=c},_createUrlFromNameInput:function(){var a=this.nameInput.value;a=a.gsub("'","");a=a.gsub("[^a-zA-Z0-9_\\-]"," ").strip();a=a.gsub("\\s+","-").toLowerCase();return a}};var ProfileView=Class.create();ProfileView.prototype={initialize:function(b,a){this.frame=b;this.userId=a;this.chatApp=null;this.basicSection=new BasicSection(this,this.frame.down(".basic-profile-section"))},setChatApp:function(a){this.chatApp=a}};var BasicSection=Class.create();BasicSection.prototype={initialize:function(a,b){this.profileView=a;this.frame=b;this.removeFriendButton=this.profileView.frame.down(".remove-friend-button");if(this.removeFriendButton!=null){Event.observe(this.removeFriendButton,"click",this._onRemoveFriendButtonClick.bindAsEventListener(this))}},_onRemoveFriendButtonClick:function(){ServiceInterface.removeFriend(this.profileView.userId,{callback:function(){location.reload(true)},errorHandler:function(){}})}};var ProfileSettingsView=Class.create();ProfileSettingsView.prototype={initialize:function(a){this.frame=a;var a=null;a=this.frame.down(".settings-section-basic");if(a!=null){var b=new ProfileSettingsBasicSection(a)}a=this.frame.down(".settings-section-picture");if(a!=null){var b=new ProfileSettingsPictureSection(a)}},setChatApp:function(a){}};var ProfileSettingsBasicSection=Class.create();ProfileSettingsBasicSection.prototype={initialize:function(a){this.frame=a;this.nameInput=this.frame.down(".name-input");this.selfBlurbMaxSize=500;this.selfBlurbInput=this.frame.down(".profile-selfblurb-input");this.selfBlurbCharsAvailable=this.frame.down(".profile-selfblurb-chars-available");Event.observe(this.selfBlurbInput,"keyup",this._onSelfBlurbInputKeyup.bindAsEventListener(this));this._checkInputLength(this.selfBlurbInput,this.selfBlurbCharsAvailable,this.selfBlurbMaxSize)},_onSelfBlurbInputKeyup:function(){this._checkInputLength(this.selfBlurbInput,this.selfBlurbCharsAvailable,this.selfBlurbMaxSize)},_checkInputLength:function(e,d,a){var b=a-e.value.length;if(b<=0){e.value=e.value.substring(0,a);b=0;d.addClassName("text-danger")}else{d.removeClassName("text-danger")}var c=b+((b==1)?" character":" characters")+" left";d.innerHTML=c}};var ProfileSettingsPictureSection=Class.create();ProfileSettingsPictureSection.prototype={initialize:function(a){this.frame=a;this.statusLabel=this.frame.down(".profile-image-status");this.imageUploadFrame=this.frame.down(".image-upload-frame");this.editControls=this.frame.down(".profile-image-edit-controls");this.imageSubmitButton=this.editControls.down(".image-submit-button");Event.observe(this.imageSubmitButton,"click",this._onSubmit.bindAsEventListener(this));this.imageDeleteButton=this.frame.down(".image-delete-button");if(this.imageDeleteButton!=null){Event.observe(this.imageDeleteButton,"click",this._onDelete.bindAsEventListener(this))}},_onSubmit:function(a){this.editControls.hide();this.statusLabel.innerHTML="Uploading...";this.statusLabel.removeClassName("text-danger");this.statusLabel.show();Event.observe(this.imageUploadFrame,"load",this._onLoad.bindAsEventListener(this))},_onDelete:function(a){ServiceInterface.deleteProfileImage({callback:function(){window.location.replace(window.location.href)}})},_onLoad:function(){Event.stopObserving(this.imageUploadFrame,"load",this._onLoad.bindAsEventListener(this));var a=this.imageUploadFrame.contentWindow||this.imageUploadFrame.contentDocument;if(a.document){a=a.document}var b=a.getElementById("image-upload-errors");if(b!=undefined&&b!="undefined"){this.statusLabel.innerHTML=b.innerHTML;this.statusLabel.addClassName("text-danger");this.statusLabel.show();this.editControls.show()}else{window.location.replace(window.location.href)}}};var SoundNotifier=Class.create();SoundNotifier.prototype={initialize:function(a){this.soundControl=a;this.groups=new Hash();this._soundInitialized=false;Event.observe(this.soundControl,"click",this._onControlClick.bindAsEventListener(this));this.onMessageListener=this._onMessage.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a;a.messageBus.addConnectSuccessListener(this._onConnectSuccess.bindAsEventListener(this));a.groupManager.addJoinGroupListener(this._onJoinGroup.bindAsEventListener(this));a.groupManager.addCloseGroupListener(this._onCloseGroup.bindAsEventListener(this))},_onConnectSuccess:function(a){this._updateSoundStatus()},_onControlClick:function(a){if(this.chatApp.userPreferenceManager.isSoundOn()){this.chatApp.userPreferenceManager.setSoundOn(false)}else{this.chatApp.userPreferenceManager.setSoundOn(true)}this._updateSoundStatus()},_updateSoundStatus:function(){if(this.chatApp.userPreferenceManager.isSoundOn()){if(!this._soundInitialized){var a=this.chatApp.clientConfig.baseStaticUrl;this.messageInSound=new Howl({src:[a+"/sound/message-in-68880d53.mp3"],preload:false});this.messageOutSound=new Howl({src:[a+"/sound/message-out-d33411ab.mp3"],preload:false});this._soundInitialized=true}this.soundControl.addClassName("chat-sound-button-true");this.soundControl.removeClassName("chat-sound-button-false")}else{this.soundControl.addClassName("chat-sound-button-false");this.soundControl.removeClassName("chat-sound-button-true")}},_onJoinGroup:function(a){if(!this.groups.get(a.groupId)){this.groups.set(a.groupId,a);a.addMessageListener(this.onMessageListener)}else{logger.error("_onJoinGroup: Can't create already existing group: "+a.groupId)}},_onCloseGroup:function(b){var a=this.groups.get(b.groupId);if(a){this.groups.unset(b.groupId);a.removeMessageListener(this.onMessageListener)}else{logger.error("_onCloseGroup: Couldn't find group: "+b.groupId)}},_onMessage:function(a){if(this._soundInitialized&&this.chatApp.userPreferenceManager.isSoundOn()){if(a.userId!=this.chatApp.profileManager.currentUserId){this.messageInSound.load();this.messageInSound.play()}else{this.messageOutSound.load();this.messageOutSound.play()}}}};var ConfirmationPopup=Class.create();ConfirmationPopup.prototype={initialize:function(){this.chatApp=null;this.container="chat";this.title=_("Are you sure?");this.message=null;this.okButtonValue=_("OK");this.cancelButtonValue=_("Cancel");this.onOkCallback=null;this.onCancelCallback=null;this.width=null;this.height=null;this.okButtonClicked=false},setChatApp:function(a){this.chatApp=a},setContainer:function(a){this.container=a},setTitle:function(a){this.title=a},setMessage:function(a){this.message=a},setOkButtonValue:function(a){this.okButtonValue=a},setCancelButtonValue:function(a){this.cancelButtonValue=a},setWidth:function(a){this.width=a},setHeight:function(a){this.height=a},setOnOkCallback:function(a){this.onOkCallback=a},setOnCancelCallback:function(a){this.onCancelCallback=a},destroy:function(){this.chatApp.tooltipManager.hideTooltips()},show:function(){var c=new Element("div");c.innerHTML=this.chatApp.templateManager.evaluate("site-confirmation-popup");var e=c.down(".popup-title");if(this.title!=null){e.innerHTML=this.title;Event.observe(c.down(".confirmation-close-button"),"click",this._closePopup.bindAsEventListener(this))}else{e.hide();c.down(".confirmation-close-button").hide()}c.down(".confirmation-message").innerHTML=this.message;var h=c.down(".confirmation-ok-button");if(this.okButtonValue!=null){h.value=this.okButtonValue}else{h.hide()}var d=c.down(".confirmation-cancel-button");if(this.cancelButtonValue!=null){d.value=this.cancelButtonValue}else{d.hide()}var b=c.down(".confirmation-popup-border");if(this.width!=null||this.height!=null){var g=(this.width!=null)?this.width+"px":null;var a=(this.height!=null)?this.height+"px":null;b.setStyle({width:g,height:a})}var f=this.chatApp.tooltipManager.showTooltip({element:c.firstDescendant(),relativeElement:this.container,left:"center",top:"center",onHideCallback:this._onHide.bindAsEventListener(this)});Event.observe(f.down(".confirmation-ok-button"),"click",this._onOkButtonClick.bindAsEventListener(this));Event.observe(f.down(".confirmation-cancel-button"),"click",this._onCancelButtonClick.bindAsEventListener(this))},_onOkButtonClick:function(){this.okButtonClicked=true;this.destroy();if(this.onOkCallback!=null){this.onOkCallback()}},_onCancelButtonClick:function(){this.destroy()},_onHide:function(){if(!this.okButtonClicked){if(this.onCancelCallback!=null){this.onCancelCallback()}}},_closePopup:function(){this.destroy();if(this.onCancelCallback!=null){this.onCancelCallback()}}};var FacebookConnectButton=Class.create();FacebookConnectButton.prototype={initialize:function(a){this.frame=a;this.chatApp=null;this.defaultRedirectUrl=null;this.onErrorCallback=null},setChatApp:function(a){this.chatApp=a;this.chatApp.facebook.load();Event.observe(this.frame,"click",this._onClick.bindAsEventListener(this))},setOnErrorCallback:function(a){this.onErrorCallback=a},setDefaultRedirectUrl:function(a){this.defaultRedirectUrl=a},_onClick:function(a){this.chatApp.facebook.login(function(c){if(c.authResponse){this.chatApp.resetClientEnabled=false;var b=c.authResponse;ServiceInterface.facebookAuthenticate(b.accessToken,b.expiresIn,this.chatApp.clientConfig.groupId,{callback:function(d){if(d!=null){location.replace(d)}else{if(this.defaultRedirectUrl!=null){location.replace(this.defaultRedirectUrl)}else{location.reload(true)}}}.bind(this),errorHandler:function(){this.chatApp.resetClientEnabled=true;if(this.onErrorCallback!=null){this.onErrorCallback()}}.bind(this)})}}.bind(this))}};var SigninBox=Class.create();SigninBox.randomGuestName=null;function popupWindow(b,f,a,c){var e=(screen.width/2)-(a/2);var d=(screen.height/2)-(c/2);return window.open(b,f,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+a+", height="+c+", top="+d+", left="+e)}SigninBox.prototype={initialize:function(a){this.frame=a;this.chatApp=null;this.numSelectableMethods=0;this.defaultMode=null;this.currentMode=null;this.sessionCookieSet=false},setSessionCookie:function(){if(document.cookie.indexOf("JSESSIONID")==-1){var a="https://"+document.domain+"/auth-redirect;jsessionid="+dwr.engine._sessionId+"?url=close";popupWindow(a,"",400,200);this.sessionCookieSet=true}},reloadWhenSessionCookieReady:function(){if(document.cookie.indexOf("JSESSIONID")!=-1){window.location.reload(true)}else{var b=window.setTimeout(function(){var d=new ConfirmationPopup();d.setChatApp(this.chatApp);d.setTitle(_("Connection problem"));d.setOkButtonValue("OK");d.setCancelButtonValue(null);var c="<div style='width:180px'>"+_("There was a problem connecting to the chat. Please update your browser settings to allow Cookies.")+"</div>";d.setMessage(c);d.setOnOkCallback(function(){this.setSessionCookie();window.location.reload(true)}.bind(this));d.show()}.bind(this),3000);var a=window.setInterval(function(){if(document.cookie.indexOf("JSESSIONID")!=-1){window.clearTimeout(b);window.clearInterval(a);window.location.reload(true)}}.bind(this),200)}},setChatApp:function(d){this.chatApp=d;var b=$H(this.chatApp.clientConfig.groupSigninMethods).keys().length;if(b!=0){this.frame.show();var a;if(this.chatApp.clientConfig.groupSigninMethods.chatroll){a=this.frame.down(".signin-chatroll-button");a.show();Event.observe(a,"click",function(f){this.setSessionCookie();this._setMode("chatroll")}.bindAsEventListener(this));this.numSelectableMethods++;if(this.defaultMode==null){this.defaultMode="chatroll"}}if(this.chatApp.clientConfig.groupSigninMethods.facebook){a=this.frame.down(".signin-facebook-button");a.show();this.chatApp.facebook.load();Event.observe(a,"click",function(f){this.setSessionCookie();this.chatApp.facebook.login(function(g){if(g.authResponse){this._setMode("wait");this.chatApp.resetClientEnabled=false;var e=g.authResponse;ServiceInterface.facebookAuthenticate(e.accessToken,e.expiresIn,this.chatApp.clientConfig.groupId,{callback:function(){this.reloadWhenSessionCookieReady()}.bind(this),errorHandler:function(){this.reloadWhenSessionCookieReady()}.bind(this)})}}.bind(this))}.bindAsEventListener(this));this.numSelectableMethods++}if(this.chatApp.clientConfig.groupSigninMethods.twitter){var c=this.frame.down(".signin-twitter-button");c.show();Event.observe(c,"click",function(g){var f="https://"+document.domain+"/twitter-auth-request?groupId="+this.chatApp.clientConfig.groupId;var h="https://"+document.domain+"/auth-redirect;jsessionid="+dwr.engine._sessionId+"?url="+encodeURIComponent(f);popupWindow(h,"",800,600);this.reloadWhenSessionCookieReady()}.bindAsEventListener(this));this.numSelectableMethods++}if(this.chatApp.clientConfig.groupSigninMethods.guest){a=this.frame.down(".signin-guest-button");a.show();Event.observe(a,"click",function(f){this.setSessionCookie();this._setMode("guest")}.bindAsEventListener(this));this.numSelectableMethods++;if(this.defaultMode==null){this.defaultMode="guest"}}if(this.chatApp.clientConfig.groupSigninMethods.sso){}if(this.numSelectableMethods>1||this.defaultMode==null){this.defaultMode="select";Event.observe(window,"resize",this._onWindowResize.bindAsEventListener(this))}this._setMode(this.defaultMode)}this.chatApp.messageBus.addConnectFailureListener(this._onConnectFailure.bindAsEventListener(this))},_setMode:function(g){if(g!=this.currentMode){var h=false;if(this.currentMode!=null){var e=this.frame.down(".signin-"+this.currentMode);e.hide();h=true}this.currentMode=g;var d=this.frame.down(".signin-"+this.currentMode);d.show();if(g=="select"){var a="";a+="<b>"+_("Please sign in")+"</b>";this.frame.down(".signin-prompt").innerHTML=a;this._resizeSigninButtons()}else{if(g=="chatroll"){var a="";a+="<b>Sign in</b> or <a style='font-weight:bold;text-decoration:underline;' ";a+="href='"+this.chatApp.clientConfig.baseWebUrl+"/signup?groupId="+this.chatApp.clientConfig.groupId+"' ";if(this.chatApp.clientConfig.embedded){a+="target='_blank' "}a+=">Sign up</a> with <b>Chatroll</b>";this.frame.down(".signin-prompt").innerHTML=a;this._addModeCancelButton();var f=this.frame.down(".chatroll-signin-name");var b=this.frame.down(".chatroll-signin-password");var c=this.frame.down(".chatroll-signin-submit");f.enable();b.enable();c.enable();Event.observe(c,"click",this._onChatrollSubmit.bindAsEventListener(this));Event.observe(f,"keydown",function(i){if(i.keyCode==13){c.click()}});Event.observe(b,"keydown",function(i){if(i.keyCode==13){c.click()}})}else{if(g=="wait"){this.frame.down(".signin-prompt").innerHTML=""}else{if(g=="guest"){this.frame.down(".signin-prompt").innerHTML=_("<b>Sign in</b> as a <b>Guest</b>");this._addModeCancelButton();var f=this.frame.down(".guest-signin-name");var c=this.frame.down(".guest-signin-submit");f.enable();c.enable();if(SigninBox.randomGuestName==null){SigninBox.randomGuestName="Guest"+Math.floor(Math.random()*9999);f.value=SigninBox.randomGuestName}Event.observe(c,"click",this._onGuestSubmit.bindAsEventListener(this));Event.observe(f,"keydown",function(i){if(i.keyCode==13){c.click()}})}}}}this.focus(h)}},_onWindowResize:function(){if(this.frame.down(".signin-select").visible()){this._resizeSigninButtons()}},_resizeSigninButtons:function(){var b=function(){var d=0;var c=this.frame.select(".signin-button");c.each(function(g){if(g.visible()){var f=g.getStyle("width");if(f!=null){f=parseInt(f.substr(0,f.length-2));d+=f+4}}});d=d+6;return d}.bind(this);var a=$$(".chat-signin-box")[0].getWidth();this.frame.select(".signin-button").each(function(c){c.removeClassName("signin-button-small")});if(b()>=a){this.frame.down(".tw-button").addClassName("signin-button-small");this.frame.down(".fb-button").addClassName("signin-button-small")}if(b()>=a){this.frame.down(".cr-button").addClassName("signin-button-small")}if(b()>=a){this.frame.down(".signin-guest-button").addClassName("signin-button-small")}},isSigninRequired:function(){var a=this.chatApp.profileManager.getCurrentProfile();if(a==null||(a.guest&&a.displayName=="")){return true}else{return false}},focus:function(a){if(!this.chatApp.clientConfig.embedded||a){if(this.currentMode=="chatroll"){this.frame.down(".chatroll-signin-name").select()}else{if(this.currentMode=="guest"){this.frame.down(".guest-signin-name").select()}}}},_onChatrollSubmit:function(){var b=$F(this.frame.down(".chatroll-signin-name"));var a=$F(this.frame.down(".chatroll-signin-password"));a=hex_sha1(this.chatApp.clientConfig.authChallenge+hex_sha1(a));this.setSessionCookie();this.chatApp.resetClientEnabled=false;ServiceInterface.chatrollAuthenticate(this.chatApp.clientConfig.authChallenge,b,a,this.chatApp.clientConfig.groupId,{callback:function(){this.reloadWhenSessionCookieReady()}.bind(this),errorHandler:function(){this.chatApp.resetClientEnabled=true;var c="<span style='color:#ff0000;font-weight:bold;'>Wrong username or password!</span>";this.frame.down(".signin-prompt").innerHTML=c;this._addModeCancelButton()}.bind(this)})},_onGuestSubmit:function(){this.setSessionCookie();this._setGuestName()},_setGuestName:function(){var b=this.frame.down(".guest-signin-name");var a=$F(b);b.disable();this.frame.down(".guest-signin-submit").disable();ServiceInterface.setGuestDisplayName(a,this.chatApp.clientConfig.groupId,{callback:function(c){if(!this.chatApp.messageBus.connected||this.sessionCookieSet){this.reloadWhenSessionCookieReady()}else{this.chatApp.profileManager.setCurrentProfile(c)}}.bind(this),errorHandler:function(e,d){this.frame.down(".guest-signin-name").enable();this.frame.down(".guest-signin-submit").enable();var f=_("Error");if(d!=null&&d.fieldErrors!=null){f=d.fieldErrors[0].defaultMessage}var c="<span style='color:#ff0000;font-weight:bold;'>"+f+"</span>";this.frame.down(".signin-prompt").innerHTML=c;this._addModeCancelButton()}.bind(this)})},_addModeCancelButton:function(){var a=this.frame.down(".signin-prompt").innerHTML;if(this.defaultMode=="select"){a+=" (<a class='signin-cancel' href='javascript:void(0)'>"+_("cancel")+"</a>)"}this.frame.down(".signin-prompt").innerHTML=a;if(this.defaultMode=="select"){Event.observe(this.frame.down(".signin-cancel"),"click",function(){this._setMode("select")}.bindAsEventListener(this))}},_onConnectFailure:function(c){var b=this.frame.down(".signin-over-capacity");var a="<div style='padding-top:8px;'>"+_("The event is full. Please retry in a minute.")+"</div>";if(c.javaClassName=="com.chatroll.service.group.AccessPassRequiredException"){this.accessPassOffer=c.offer;a+="<div>(Purchase an <a class='access-pass-purchase' href='javascript:void(0);'>Access Pass</a> to get access now.)</div>";b.innerHTML=a;Event.observe(b.down(".access-pass-purchase"),"click",this._onAccessPassPurchaseClick.bindAsEventListener(this))}else{b.innerHTML=a}this._setMode("over-capacity");this.frame.down(".signin-prompt").hide();this.frame.show()},_onAccessPassPurchaseClick:function(){var b=new ConfirmationPopup();b.setChatApp(this.chatApp);b.setTitle("Get Access Now");b.setOkButtonValue("Buy Now");b.setCancelButtonValue("No Thanks");var a="<div style='width:190px;'><div><img class='access-badge-icon' style='vertical-align:middle;' src='/t.gif'><span style='font-weight:bold;vertical-align:middle;padding-left:7px;'>Access Pass &ndash; "+this.accessPassOffer.amount+" Credits</span></div><div style='padding-top:5px;'>The Access Pass gives you unlimited immediate entry to this Chatroll for the next 24 hours.</div></div>";b.setMessage(a);b.setOnOkCallback(function(){var c=this.chatApp.tooltipManager.activeTooltip;ServiceInterface.purchaseAccessPass(this.chatApp.clientConfig.groupId,{callback:this._onAccessPassPurchaseSuccess.bind(this),errorHandler:this._onAccessPassPurchaseError.bind(this)})}.bind(this));b.show()},_onAccessPassPurchaseSuccess:function(){window.location.reload()},_onAccessPassPurchaseError:function(){var b=new ConfirmationPopup();b.setChatApp(this.chatApp);b.setTitle("Insufficient Credit");b.setOkButtonValue(null);b.setCancelButtonValue(null);var a="<div style='width:190px;'>You need <b>"+this.accessPassOffer.amount+" Credits</b> to<br/>buy an Access Pass.<div style='padding-top:8px;font-size:1.1em;font-weight:bold;'><a style='text-decoration:underline;' href='/store/getcredits?offerId="+this.accessPassOffer.offerId+"' target='_blank'>Get Chatroll Credits Now &raquo;</a></div></div>";b.setMessage(a);b.show()}};var MessageInput=Class.create();MessageInput.prototype={initialize:function(a,b){this.groupChatWidget=b;this.chatApp=null;this.group=null;this.frame=a;this.inputLengthLimit=512;this.sendCancelled=false;this.sending=false;this.approvalRequired=false;this.sendTime=0;this.sendDelay=0;this.onMessageListener=this._onMessage.bindAsEventListener(this);this.onGroupUserStateUpdateListener=this._onGroupUserStateUpdate.bindAsEventListener(this)},setChatApp:function(c){this.chatApp=c;if(!this.frame){var a=this.chatApp.templateManager.evaluate("group:message-input",{_:_});var b=new Element("div").update(a);this.frame=b.down("div")}this.input=this.frame.down(".chat-input");Event.observe(this.input,"keydown",this._onInputKeydown.bindAsEventListener(this));Event.observe(this.input,"keyup",this._onInputKeyup.bindAsEventListener(this));Event.observe(this.input,"change",this._onInputChange.bindAsEventListener(this));Event.observe(this.input,"focus",this._onInputFocus.bindAsEventListener(this));Event.observe(this.input,"click",this._onInputClick.bindAsEventListener(this))},setGroup:function(a){this.group=a;this._updateInputStatus();this.group.addMessageListener(this.onMessageListener);this.group.addGroupUserStateUpdateListener(this.chatApp.profileManager.currentUserId,this.onGroupUserStateUpdateListener);this.group.messageSkippedEvent.observe(function(){this.sending=false}.bind(this))},destroy:function(){this.group.removeGroupUserStateUpdateListener(this.chatApp.profileManager.currentUserId,this.onGroupUserStateUpdateListener);this.group.removeMessageListener(this.onMessageListener);if(this.frame.up()!=null){this.frame.remove()}this.frame=null},_onGroupUserStateUpdate:function(a){this._updateInputStatus()},_onMessage:function(a){if(a.userId==this.chatApp.profileManager.currentUserId){this.sending=false}},focus:function(){this.input.focus()},_sendMessage:function(){if(this.sending){this.sendCancelled=true}else{if(this.input.value.length>this.inputLengthLimit){this.sendCancelled=true}else{this.sendCancelled=false;var a=this.input.value.strip();if(a!=""){this.sending=true;this.sendDelay=0;ServiceInterface.sendMessage(this.group.groupId,a,{callback:function(b){this.sendTime=new Date().getTime();this.sendDelay=b.publishDelay;this.approvalRequired=b.approvalRequired;this._updateInputStatus()}.bind(this)})}this.input.value=""}}},_onInputKeydown:function(a){if(a.keyCode==Event.KEY_RETURN||a.keyCode==10){this.returnKeyDown=true;this._sendMessage()}},_onInputKeyup:function(a){if(a.keyCode==Event.KEY_RETURN||a.keyCode==10){if(this.returnKeyDown){this.returnKeyDown=false;if(this.sendCancelled==false){this.input.value=""}else{this.input.value=this.input.value.replace(/[\r\n]/g,"");this._trimMessageInput()}}}},_updateInputStatus:function(){if(this.sending){if(this.sendDelay>1000){var e=new Date().getTime();var a=e-this.sendTime;var c=Math.round(Math.min(a/this.sendDelay,1)*100);if(this.approvalRequired&&c==100){this.sendTime=new Date().getTime()}var d=this.frame.down(".chat-input-status");d.down(".chat-input-progress").setStyle({width:c+"%"});if(this.approvalRequired){d.down(".chat-input-approval").show()}else{d.down(".chat-input-approval").hide()}d.show();setTimeout(this._updateInputStatus.bind(this),25)}}else{this.frame.down(".chat-input-status").hide();var b=this.group.groupUserStates[this.chatApp.profileManager.currentUserId];if(b.permissions[GroupPermission.PERMISSION_WRITE]){this.input.enable();this.frame.down(".chat-input-closed").hide()}else{this.input.disable();this.frame.down(".chat-input-closed").show()}}},_trimMessageInput:function(){if(this.input.value.length>this.inputLengthLimit){this.input.value=this.input.value.substring(0,this.inputLengthLimit)}},_onInputChange:function(a){this._trimMessageInput()},_onInputFocus:function(a){this.groupChatWidget.onInputFocusOrClick()},_onInputClick:function(a){this.groupChatWidget.onInputFocusOrClick()}};var MessageList=Class.create();MessageList.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a;this.chatListPadding=0;this.stickyPadding=0;this.chatAdPadding=0;this.autoScroll=true;this.lastAutoScrollTop=0;this.scrollEventCount=0;this.userScrollElement=null;this.userScrollElementOffset=0;this.invited=false;this.groupInviteMessageTile=null;this.messageTiles=new Hash();this.userMessageCounts=new Hash();this.limitMessages=true;this.loadingHistory=false;this.activeGroupListener=this._onActiveGroupListener.bindAsEventListener(this);this.onMessageListener=this._onMessage.bindAsEventListener(this);this.onMessageDeleteListener=this._onMessageDelete.bindAsEventListener(this);this.onGroupItemListener=this._onGroupItem.bindAsEventListener(this);this.onProfileChangeListener=this._onProfileChange.bindAsEventListener(this);this.onGroupUserStateUpdateAnyListener=this._onGroupUserStateUpdateAny.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a},setGroup:function(l){this.group=l;if(!this.frame){var b={"This chat is private.":_("This chat is private."),"You are in a private chat with a moderator. Conversation history may be saved and reviewed.":_("You are in a private chat with a moderator. Conversation history may be saved and reviewed.")};var g=b[l.welcomeMessage];if(g==null){g=l.welcomeMessage}g=g.escapeHTML();var f=this.chatApp.templateManager.evaluate("group:message-list",{_:_,welcomeMessage:g});var a=new Element("div").update(f);this.frame=a.down("div")}this.messages=this.frame.down(".chat-messages");var k=this.messages.select(".message");k.each(function(i){var o=new MessageTile();o.setChatApp(this.chatApp);o.setGroup(this.group);o.initializeFromElement(i);this._onMessageTileInserted(o)}.bind(this));var m=this.group.groupUserStates[this.chatApp.profileManager.currentUserId];if(m&&m.groupUser&&m.groupUser.state=="invited"){this._enterInviteMode()}var h=this.group.recentMessages;if(h){for(var e=0;e<h.length;e++){var n=h[e];this._onMessage(n)}}this.group.addGroupUserStateUpdateAnyListener(this.onGroupUserStateUpdateAnyListener);this.group.addMessageListener(this.onMessageListener);this.group.addMessageDeleteListener(this.onMessageDeleteListener);this.group.addGroupItemListener(this.onGroupItemListener);this.chatApp.groupManager.addActiveGroupListener(this.activeGroupListener);var d=this.frame.down(".chat-history-controls");if(d!=null&&this.group.groupUserStates[this.chatApp.profileManager.currentUserId].features[Feature.GROUP_FEATURE_IN_MODULE_ARCHIVE_BROWSING]&&this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_ARCHIVE_ACCESS]){var j=this.messageTiles.keys().length;var c=false;if(this.group.publicGroup&&j>0){c=true}else{if(!this.group.publicGroup&&j>=20){c=true}}if(c){d.show();Event.observe(this.frame.down(".chat-history-load"),"click",this._onHistoryButtonClick.bindAsEventListener(this,100))}}Event.observe(this.frame,"scroll",this._onMessagesScroll.bindAsEventListener(this));Event.observe(window,"resize",this._onWindowResize.bindAsEventListener(this));this._onWindowResize()},destroy:function(){this.messageTiles.values().each(function(a){a.destroy()}.bind(this));this.messageTiles=null;if(this.groupInviteMessageTile){this.groupInviteMessageTile.destroy();this.groupInviteMessageTile=null}this.chatApp.groupManager.removeActiveGroupListener(this.activeGroupListener);this.group.removeGroupItemListener(this.onGroupItemListener);this.group.removeMessageDeleteListener(this.onMessageDeleteListener);this.group.removeMessageListener(this.onMessageListener);this.group.removeGroupUserStateUpdateAnyListener(this.onGroupUserStateUpdateAnyListener);this.chatApp.profileManager.removeProfileChangeListener(null,this.onProfileChangeListener);if(this.frame.up()!=null){this.frame.remove()}this.frame=null},setChatListPadding:function(a){this.chatListPadding=a;this.updatePadding()},setStickyPadding:function(a){this.stickyPadding=a;this.updatePadding()},setChatAdPadding:function(a){this.chatAdPadding=a;this.updatePadding()},updatePadding:function(){var c=this.chatListPadding;if(c!=0){this.messages.setStyle({paddingLeft:c+"px"})}else{this.messages.setStyle({paddingLeft:null})}var b=this.stickyPadding;if(b!=0){this.messages.setStyle({paddingTop:b+"px"})}else{this.messages.setStyle({paddingTop:null})}var a=this.chatAdPadding;if(a!=0){this.messages.setStyle({paddingBottom:a+"px"})}else{this.messages.setStyle({paddingBottom:null})}this._scrollMessages()},_enterInviteMode:function(){this.invited=true;this.groupInviteMessageTile=new GroupInviteMessageTile();this.groupInviteMessageTile.setChatApp(this.chatApp);this.groupInviteMessageTile.setGroup(this.group);this.messages.insert(this.groupInviteMessageTile.frame)},_exitInviteMode:function(){this.invited=false;this.groupInviteMessageTile.destroy();this.groupInviteMessageTile=null;var a=this.group.groupUserStates[this.chatApp.profileManager.currentUserId];if(a&&a.groupUser&&a.groupUser.state=="active"){this._loadHistory(20)}},_onMessage:function(b){var a=new MessageTile();a.setChatApp(this.chatApp);a.setGroup(this.group);a.initializeFromMessage(b);if(this.group.messageOrder==0){this.messages.insert({bottom:a.frame})}else{this.messages.insert({top:a.frame})}this._onMessageTileInserted(a);this._scrollMessages();if(this.group.groupId==this.chatApp.groupManager.activeGroupId){this.group.setGroupUserStatus("online")}},_onMessageTileInserted:function(g){var c=g.message.messageId;var e=g.message.userId;this.messageTiles.set(c,g);var b=this.userMessageCounts.get(e);if(!b){this.chatApp.profileManager.addProfileChangeListener(e,this.onProfileChangeListener);this.userMessageCounts.set(e,1)}else{this.userMessageCounts.set(e,b+1)}if(this.limitMessages&&this.messageTiles.keys().length>40){var d;var a=this.frame.down(".chat-history-controls");if(this.group.messageOrder==0){d=a.next(".message")}else{d=a.previous(".message")}var f;if(this.group.messageOrder==0){f=d.previous(".chat-welcome-message")}else{f=d.next(".chat-welcome-message")}if(f!=null){f.remove()}var c=$w(d.className)[1];var h=this.messageTiles.get(c);this._deleteMessageTile(h)}},_onMessageDelete:function(b){if(b.messageId!=0){var a=this.messageTiles.get(b.messageId);if(a!=null){this._deleteMessageTile(a)}}else{var c=this.messages.select("."+b.userId);c.each(function(e){var d=$w(e.className)[1];var f=this.messageTiles.get(d);this._deleteMessageTile(f)}.bind(this))}this._scrollMessages()},_deleteMessageTile:function(c){var a=c.message.messageId;var b=c.message.userId;this.messageTiles.unset(a);var d=this.userMessageCounts.get(b);if(d==1){this.chatApp.profileManager.removeProfileChangeListener(b,this.onProfileChangeListener);this.userMessageCounts.unset(b)}else{this.userMessageCounts.set(b,d-1)}c.destroy()},_onGroupItem:function(b){if(b.message!=null){var a=this.messageTiles.get(b.message.messageId);if(a!=null){a.onGroupItem(b.groupItem);this._scrollMessages()}}},_onProfileChange:function(a){var b=this.messages.select("."+a.userId);b.each(function(d){var c=$w(d.className)[1];var e=this.messageTiles.get(c);e.onProfileChange(a)}.bind(this))},_onGroupUserStateUpdateAny:function(b){if(b.userId==this.chatApp.profileManager.currentUserId){if(this.invited&&b.groupUserState.groupUser.state!="invited"){this._exitInviteMode()}}var a;if(this.group.publicGroup){a=this.messages.select("."+b.userId)}else{a=this.messages.select(".message")}a.each(function(d){var c=$w(d.className)[1];var e=this.messageTiles.get(c);if(e){e.onGroupUserStateUpdate(b.groupUserState)}}.bind(this))},_onActiveGroupListener:function(a){if(a.groupId==this.group.groupId){this.updatePadding();this.group.setGroupUserStatus("online")}},resumeAutoScroll:function(){if(!this.autoScroll){this.autoScroll=true;this._scrollMessages()}},_onHistoryButtonClick:function(a,b){this._loadHistory(b)},_loadHistory:function(d){if(!this.loadingHistory){this.limitMessages=false;this.loadingHistory=true;var c;var a=this.frame.down(".chat-history-controls");if(this.group.messageOrder==0){c=a.next(".message")}else{c=a.previous(".message")}var b=-1;if(c!=null){b=$w(c.className)[1]-1}ServiceInterface.getHistoryMessages(this.group.groupId,b,d,{callback:function(h){this.loadingHistory=false;if(h.length>0){var f=this.frame.down(".chat-history-controls");var g;if(this.group.messageOrder==0){g=f.next()}else{g=f.previous()}if(g){this.autoScroll=false;this.userScrollElement=g;this.userScrollElementOffset=-1*(this.userScrollElement.positionedOffset().top-this.frame.scrollTop)}var e=f;h.each(function(j){var i=new MessageTile();i.setChatApp(this.chatApp);i.setGroup(this.group);i.initializeFromMessage(j);if(this.group.messageOrder==0){e.insert({after:i.frame})}else{e.insert({before:i.frame})}e=i.frame;this._onMessageTileInserted(i)}.bind(this));this._scrollMessages()}}.bind(this),errorHandler:function(){this.loadingHistory=false}.bind(this)})}},_onWindowResize:function(){this.scrollEventCount=0;this._scrollMessages()},_onMessagesScroll:function(){this.scrollEventCount=this.scrollEventCount+1;var b=(this.scrollEventCount>=5);if(b){var a;if(this.group.messageOrder==0){var c=this.frame.scrollHeight-this.frame.getHeight()-this.frame.scrollTop;a=(c<10)}else{a=(this.frame.scrollTop<10)}if(this.autoScroll&&!a){this.autoScroll=false}else{if(!this.autoScroll&&a){this.autoScroll=true;this.scrollEventCount=0}}if(!this.autoScroll){this._saveUserScrollPosition()}}},_saveUserScrollPosition:function(){var a=this.userScrollElement;if(a==null||!a.descendantOf(this.messages)){if(this.group.messageOrder==0){a=this.messages.childElements().last()}else{a=this.messages.childElements().first()}}this.userScrollElement=null;this.userScrollElementOffset=0;var d=this.frame.scrollTop;var b=0;while(a!=null){b=a.positionedOffset().top;if(d>=b){this.userScrollElement=a;a=a.next()}else{if(this.userScrollElement){break}else{a=a.previous()}}}if(this.userScrollElement){var c=this.userScrollElement.positionedOffset().top;this.userScrollElementOffset=d-c}},_scrollMessages:function(){if(this.autoScroll){this.scrollEventCount=0;if(this.group.messageOrder==0){this.frame.scrollTop=this.frame.scrollHeight}else{this.frame.scrollTop=0}}else{if(this.userScrollElement&&this.userScrollElement.descendantOf(this.messages)){this.frame.scrollTop=this.userScrollElement.positionedOffset().top+this.userScrollElementOffset}else{this.frame.scrollTop=0}}}};var OnlineCount=Class.create();OnlineCount.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a;this.onlineCountDisplayed=null},setChatApp:function(c){this.chatApp=c;if(!this.frame){var a='<div class="chat-online-count"></div>';var b=new Element("div").update(a);this.frame=b.down("div")}},setGroup:function(a){this.group=a;this._updateOnlineCount();this.onlineCountListener=this._onOnlineCountChange.bindAsEventListener(this);this.group.onlineCountChangeEvent.observe(this.onlineCountListener)},destroy:function(){this.group.onlineCountChangeEvent.stopObserving(this.onlineCountListener);if(this.frame.up()!=null){this.frame.remove()}this.frame=null},_onOnlineCountChange:function(){this._updateOnlineCount()},_updateOnlineCount:function(){if(this.group.onlineCount!=this.onlineCountDisplayed){var b=this.group.onlineCount+" "+_("online");if(this.group.onlineCount>=this.group.freeLimit-1){b+=" <span class='chat-max-online-label'>(";var a=this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_ADMIN];if(a){b+="<a";if(this.chatApp.clientConfig.embedded){b+=" target='_blank'"}b+=" href='"+this.chatApp.clientConfig.baseWebUrl+"/"+this.group.url+"/settings/access'>"}b+=_("full");if(a){b+="</a>"}b+=")</span>"}if(this.onlineCountDisplayed!=null&&this.group.onlineCount<50){Effect.FadeReplace(this.frame,{duration:0.4,innerHTML:b})}else{this.frame.innerHTML=b}this.onlineCountDisplayed=this.group.onlineCount}}};var ChatList=Class.create();ChatList.prototype={initialize:function(a){this.chatApp=null;this.frame=a;this.items=new Hash();this.open=true;this.onNewMessageCountChangeListener=this._onNewMessageCountChange.bindAsEventListener(this);this.onMessageListener=this._onMessage.bindAsEventListener(this)},setGroupChatWidget:function(a){this.groupChatWidget=a},setChatApp:function(a){this.chatApp=a;this.chatApp.groupManager.addJoinGroupListener(this._onJoinGroupListener.bindAsEventListener(this));this.chatApp.groupManager.addCloseGroupListener(this._onCloseGroupListener.bindAsEventListener(this));Event.observe(this.frame.down(".chat-list-toggle-icon"),"click",this._onToggleIconClick.bindAsEventListener(this))},_onToggleIconClick:function(){this.open=!this.open;this._updateDisplay()},_onJoinGroupListener:function(a){this._addItem(a);this._updateDisplay();a.addMessageListener(this.onMessageListener);a.addNewMessageCountChangeListener(this.onNewMessageCountChangeListener)},_onCloseGroupListener:function(a){a.removeNewMessageCountChangeListener(this.onNewMessageCountChangeListener);a.removeMessageListener(this.onMessageListener);this._removeItem(a);this._updateDisplay()},_addItem:function(b){if(!this.items.get(b.groupId)){var a=new ChatListItem();a.setChatList(this);a.setChatApp(this.chatApp);a.setGroup(b);this.items.set(b.groupId,a);this._updateItemPosition(b)}},_onNewMessageCountChange:function(a){this._updateNewMessageIndicator()},_updateNewMessageIndicator:function(){var a=0;this.items.values().each(function(b){a=a+b.group.getNewMessageCount()});if(a){this.frame.down(".chat-list-new-indicator").show()}else{this.frame.down(".chat-list-new-indicator").hide()}},_onMessage:function(a){var b=this.chatApp.groupManager.getGroup(a.groupId);this._updateItemPosition(b)},_updateItemPosition:function(g){var e=this.items.get(g.groupId);if(e){var d=false;var f=this.frame.select(".chat-list-item");var h=f.length;for(var b=0;b<h;b++){var a=$w(f[b].className)[1];var c=this.items.get(a);if(this._compareItemsForSort(e,c)>0){c.frame.insert({before:e.frame});d=true;break}}if(!d){this.frame.down(".chat-list-items").insert({bottom:e.frame})}}else{}},_compareItemsForSort:function(f,e){if(f.group.groupId==this.chatApp.clientConfig.groupId){return 1}else{if(e.group.groupId==this.chatApp.clientConfig.groupId){return -1}}var c=f.group.lastMessageTime;var a=e.group.lastMessageTime;var h=null;var d=f.group.groupUserStates[this.chatApp.profileManager.currentUserId];if(d&&d.groupUser){h=d.groupUser.createdTime}var g=null;var b=e.group.groupUserStates[this.chatApp.profileManager.currentUserId];if(b&&b.groupUser){g=b.groupUser.createdTime}if(!c&&h){c=h}if(!a&&g){a=g}if(c&&a){return c.getTime()-a.getTime()}else{return 0}},_removeItem:function(b){var a=this.items.get(b.groupId);if(a){a.destroy();a=null;this.items.unset(b.groupId)}else{logger.error("Attempted to remove list item for unknown group "+b.groupId)}},_updateDisplay:function(){if(this.items.size()>1){if(this.open){this.frame.removeClassName("chat-list-closed")}else{this.frame.addClassName("chat-list-closed")}var a=parseInt(this.frame.getStyle("width"));this.groupChatWidget.setChatListPadding(a);this.frame.show()}else{this.frame.hide();this.groupChatWidget.setChatListPadding(0)}}};var ChatListItem=Class.create();ChatListItem.prototype={initialize:function(){this.chatList=null;this.chatApp=null;this.group=null;this.active=false;this.onUserJoinListener=this._onUserJoin.bindAsEventListener(this);this.onUserLeaveListener=this._onUserLeave.bindAsEventListener(this);this.onGroupUserStateUpdateAnyListener=this._onGroupUserStateUpdateAny.bindAsEventListener(this);this.onNewMessageCountChangeListener=this._onNewMessageCountChange.bindAsEventListener(this);this.activeGroupListener=this._onActiveGroupListener.bindAsEventListener(this);this.onProfileChangeListener=this._onProfileChange.bindAsEventListener(this)},setChatList:function(a){this.chatList=a},setChatApp:function(c){this.chatApp=c;var a=this.chatApp.templateManager.evaluate("group:chat-list-item");var b=new Element("div").update(a);this.frame=b.down("div")},setGroup:function(b){this.group=b;this.frame.addClassName(b.groupId);try{document.createEvent("TouchEvent")}catch(a){this.frame.addClassName("chat-list-item-hover-supported")}this._updateLabel(true);this._updateNewMessageIndicator();if(b.groupId==this.chatApp.clientConfig.groupId){this.frame.down(".chat-list-item-close-button").hide()}if(!this.group.publicGroup){this.group.addUserJoinListener(this.onUserJoinListener);this.group.addUserLeaveListener(this.onUserLeaveListener);this.group.addGroupUserStateUpdateAnyListener(this.onGroupUserStateUpdateAnyListener)}this.group.addNewMessageCountChangeListener(this.onNewMessageCountChangeListener);this.chatApp.groupManager.addActiveGroupListener(this.activeGroupListener);Event.observe(this.frame,"click",this._onItemClick.bindAsEventListener(this));Event.observe(this.frame.down(".chat-list-item-close-button"),"click",this._onCloseButtonClick.bindAsEventListener(this))},destroy:function(){this.chatApp.groupManager.removeActiveGroupListener(this.activeGroupListener);this.group.removeNewMessageCountChangeListener(this.onNewMessageCountChangeListener);this.group.removeGroupUserStateUpdateAnyListener(this.onGroupUserStateUpdateAnyListener);this.group.removeUserLeaveListener(this.onUserLeaveListener);this.group.removeUserJoinListener(this.onUserJoinListener);this.frame.remove();this.frame=null},_onUserJoin:function(a){this._updateLabel()},_onUserLeave:function(a){this._updateLabel()},_onProfileChange:function(a){this._updateLabel()},_onActiveGroupListener:function(b){var a=(b.groupId==this.group.groupId);this._setActive(a)},_onGroupUserStateUpdateAny:function(a){this._updateLabel();if(a.userId==this.chatApp.profileManager.currentUserId){this._updateNewMessageIndicator()}},_updateLabel:function(h){if(this.group.publicGroup){if(h){this.frame.down(".chat-list-item-label").innerHTML=this.group.nameHtmlWbr}}else{var a=[];for(var d in this.group.groupUserStates){if(d!=this.chatApp.profileManager.currentUserId){a.push(this.group.groupUserStates[d])}}a.sort(function f(j,i){var m={online:1,invited:2,offline:3};var l=m[j.status];var k=m[i.status];if(l!=k){return l-k}else{return 0}});var b="";var g=2;var c;for(c=0;c<g&&c<a.length;c++){var d=a[c].groupUser.userId;var e=this.chatApp.profileManager.getProfile(d);if(c>0){b=b+", "}b=b+" "+e.displayNameHtml}if(c==0){b=b+_("Me")}this.frame.down(".chat-list-item-label").innerHTML=b}},_setActive:function(a){if(a!=this.active){if(a){this.frame.addClassName("chat-list-item-active")}else{this.frame.removeClassName("chat-list-item-active")}this.active=a;this._updateNewMessageIndicator()}},_onNewMessageCountChange:function(a){this._updateNewMessageIndicator()},_updateNewMessageIndicator:function(){var a=this.group.getNewMessageCount();if(a){this.frame.addClassName("chat-list-item-new-messages")}else{this.frame.removeClassName("chat-list-item-new-messages")}},_onItemClick:function(){this.chatApp.groupManager.setActiveGroup(this.group)},_onCloseButtonClick:function(a){this.group.leaveGroup();Event.stop(a)}};var ChatAd=Class.create();ChatAd.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a;this.messageList=null;this.adImpression=null;this.animDuration=500;this.slotHeight=0;this.animStartTime=0;this.closeTimer=null;this.chatListPadding=0},setMessageList:function(a){this.messageList=a},setChatApp:function(c){this.chatApp=c;if(!this.frame){var a='<div class="chat-ad" style="display:none"></div>';var b=new Element("div").update(a);this.frame=b.down("div")}},setGroup:function(a){this.group=a;this.chatAdListener=this._onChatAd.bindAsEventListener(this);this.group.addChatAdListener(this.chatAdListener)},destroy:function(){this.group.removeChatAdListener(this.chatAdListener)},_animateSlot:function(a,d){if(d){this.animStartTime=new Date().getTime()}var c=(new Date().getTime())-this.animStartTime;if(c>this.animDuration){c=this.animDuration}var b=Math.sin(0.5*Math.PI*c/this.animDuration);if(!a){b=1-b}this.messageList.setChatAdPadding(Math.round(b*this.slotHeight));if(c<this.animDuration){setTimeout(function(){this._animateSlot(a,false)}.bind(this),10)}else{if(a){this._showAd()}}},_showAd:function(){this.updatePosition();this.frame.setStyle({zIndex:"inherit"});var a=this.frame.down(".ad-close");if(a){Event.observe(a,"click",this._closeAd.bindAsEventListener(this))}var b=this.frame.down(".ad-close-all");if(b){Event.observe(b,"click",this._onCloseAllClick.bindAsEventListener(this))}this.closeTimer=setTimeout(this._closeAd.bind(this),this.adImpression.durationSeconds*1000)},_clearCloseTimer:function(){if(this.closeTimer){clearTimeout(this.closeTimer);this.closeTimer=null}},_closeAd:function(){this._clearCloseTimer();this.frame.setStyle({zIndex:null});this.frame.innerHTML="";this._animateSlot(false,true)},_onCloseAllClick:function(c){var b=new ConfirmationPopup();b.setChatApp(this.chatApp);b.setTitle("Disable Ads?");b.setOkButtonValue(null);b.setCancelButtonValue("No Thanks");var a="<div style='width:170px;font-size:0.95em;'><div style='padding:5px 0;'><div><img class='pro-badge-icon pro-badge-icon-100' style='vertical-align:middle;' src='/t.gif'><span style='font-weight:bold;vertical-align:middle;padding-left:7px;'>Blue Pro &ndash; 200 Credits</span></div><div class='padding-10'></div><div>This Chatroll is ad-supported.<br/>The Blue Pro upgrade gives you ad-free access and unlocks Pro-only features.</div><div class='padding-10'></div><div style='font-size:0.9em;color:#888;'><a style='font-size:1.4em;font-weight:bold;text-decoration:underline;' href='javascript:void(0)' target='_blank'>Upgrade Now! &raquo;</a></div><div style='font-size:0.9em;color:#888;'>30-day trial available.</div></div>";b.setMessage(a);b.show()},_showPopup:function(b,f,a,c){var e=(screen.width/2)-(a/2);var d=(screen.height/2)-(c/2);return window.open(b,f,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no, width="+a+", height="+c+", top="+d+", left="+e)},_onChatAd:function(a){if(this.frame.up()){var d=(a.contentWidth!=null)?(a.contentWidth+"px"):"100%";var c=(a.contentHeight!=null)?(a.contentHeight+"px"):"auto";var f=new Template(a.content);var e=f.evaluate({sessionId:dwr.engine._sessionId});this.frame.insert("<div style='width:"+d+";height:"+c+";margin:0 auto;'>"+e+"</div>");var b=this.frame.down(".facebook-share-button");if(b){Event.observe(b,"click",function(){var h=this.adImpression.impressionId;var i=b.dataset.link;this._showPopup(i,null,550,420);ServiceInterface.trackClick(h,"facebook-share")}.bind(this))}var g=this.frame.down(".twitter-share-button");if(g){Event.observe(g,"click",function(){var h=this.adImpression.impressionId;var i=g.dataset.link;this._showPopup(i,null,550,420);ServiceInterface.trackClick(h,"twitter-share")}.bind(this))}this.slotHeight=this.frame.getHeight()+6;this.adImpression=a;this._animateSlot(true,true)}},setChatListPadding:function(a){this.chatListPadding=a;this.updatePosition()},updatePosition:function(){if(this.frame.visible()){this.frame.setStyle({left:null});if(this.chatListPadding){var a=this.frame.positionedOffset().left+this.chatListPadding;this.frame.setStyle({left:a+"px"})}}}};var StickyMessage=Class.create();StickyMessage.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a;this.chatListPadding=0},setMessageList:function(a){this.messageList=a},setChatApp:function(c){this.chatApp=c;if(!this.frame){var a='<div class="chat-sticky-message" style="display:none"></div>';var b=new Element("div").update(a);this.frame=b.down("div")}},setGroup:function(a){this.group=a;this.connectSuccessListener=function(){this._setStickyMessage(this.group.stickyMessageHtml)}.bind(this);this.chatApp.messageBus.addConnectSuccessListener(this.connectSuccessListener);this.stickyMessageUpdateListener=function(b){this._setStickyMessage(b)}.bind(this);this.group.stickyMessageUpdateEvent.observe(this.stickyMessageUpdateListener);this.activeGroupListener=this._onActiveGroupListener.bindAsEventListener(this);this.chatApp.groupManager.addActiveGroupListener(this.activeGroupListener)},destroy:function(){this.chatApp.groupManager.removeActiveGroupListener(this.activeGroupListener);this.group.stickyMessageUpdateEvent.stopObserving(this.stickyMessageUpdateListener);this.chatApp.messageBus.removeConnectSuccessListener(this.connectSuccessListener);if(this.frame.up()!=null){this.frame.remove()}this.frame=null},_setStickyMessage:function(a){if(a==""){this.messageList.setStickyPadding(0);this.frame.hide()}else{this.frame.innerHTML=a;this.frame.show();this.updatePosition();this.messageList.setStickyPadding(this.frame.getHeight())}},_onActiveGroupListener:function(a){if(a.groupId==this.group.groupId){this.updatePosition()}},setChatListPadding:function(a){this.chatListPadding=a;this.updatePosition()},updatePosition:function(){if(this.frame.visible()){this.frame.setStyle({left:null});if(this.chatListPadding){var a=this.frame.positionedOffset().left+this.chatListPadding;this.frame.setStyle({left:a+"px"})}}}};var MessageTile=Class.create();MessageTile.TYPE_CHAT=1;MessageTile.TYPE_COMMENT=2;MessageTile.TYPE_ITEM=3;MessageTile.prototype={initialize:function(){this.chatApp=null;this.group=null;this.message=null;this.frame=null;this.deleteButton=null;this.groupItemTiles=null},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a},initializeFromElement:function(element){this.frame=element;var classNames=$w(this.frame.className);this.message={messageId:classNames[1],userId:classNames[2],type:classNames[3],createdTime:(new Date(parseInt(classNames[4])))};var timestamp=this.message.createdTime.getMessageTimestamp();this.frame.down(".message-timestamp").innerHTML=timestamp;var initialItems=this.frame.select(".group-item-small");initialItems.each(function(itemElement){var objString=itemElement.down(".item-jsobj").innerHTML.unescapeHTML();var groupItem=(function(){return eval(objString)})();this.onGroupItem(groupItem)}.bind(this));this._registerPopupButtons();this._updateDeleteButton();this._updateCrossPostButton()},initializeFromMessage:function(c){this.message=c;var d=this.message.createdTime.getMessageTimestamp();if(!this.group.publicGroup&&this.message.userId==this.chatApp.profileManager.currentUserId){d=d+"<div class='message-read-receipt' style='display:none;'>&#x2713;</div>"}var a=null;if(c.type==MessageTile.TYPE_CHAT){a=this.chatApp.templateManager.evaluate("message:chat-message-tile",{message:this.message,timestamp:d})}else{if(c.type==MessageTile.TYPE_ITEM){a=this.chatApp.templateManager.evaluate("message:new-item-tile",{message:this.message,timestamp:d})}else{if(c.type==MessageTile.TYPE_COMMENT){this.message.textHtml=c.comment.textHtml;a=this.chatApp.templateManager.evaluate("message:comment-post-tile",{message:this.message,timestamp:d})}}}var b=new Element("div");b.innerHTML=a;this.frame=b.down(".message");this._registerPopupButtons();this._updateDisplay();if(c.type==MessageTile.TYPE_ITEM){this.onGroupItem(c.groupItems[0])}else{if(c.type==MessageTile.TYPE_COMMENT){this.onGroupItem(c.comment.groupItem)}}},_updateDisplay:function(){var c=this.chatApp.profileManager.getProfile(this.message.userId);var b=this.group.groupUserStates[this.message.userId];var f=null;var e=null;if(c.guest){f="guest";e=_("Guest")}else{if(b!=null){if(b.permissions[GroupPermission.PERMISSION_ADMIN]){f="admin";e=_("Admin")}else{if(b.permissions[GroupPermission.PERMISSION_MODERATE]){f="moderator";e=_("Moderator")}}}}if(f!=null){this.frame.addClassName(f)}if(this.message.userId==this.chatApp.profileManager.currentUserId){this.frame.addClassName("self")}var g="";if(e!=null){g="<span class='message-profile-type-label'> ("+e+")</span>"}var a=this.frame.down(".message-profile-name");a.innerHTML=c.getDisplayNameHTML()+g;var i=this.frame.down(".message-profile-image");i.innerHTML=c.getIconImageHTML();var d=this.frame.down(".message-status-icon");if(d!=null){d.remove()}if(b!=null&&b.products.length>0){var j=b.products[b.products.length-1];var h="<a href='#' onclick='goChatApp.fireGroupUiAction(BluePassOfferPopup.SHOW_POPUP);return false;' class='message-status-icon' title='";h+=j.name;h+="'/>";h+="<img class='pro-badge-icon pro-badge-icon-"+j.productId+"' src='/t.gif'/>";h+="</a>";i.insert({after:h});a.setStyle({paddingLeft:"18px"})}this._updateReadReceipt();this._updateCrossPostButton();this._updateDeleteButton()},_updateReadReceipt:function(){if(!this.group.publicGroup&&this.message.userId==this.chatApp.profileManager.currentUserId){for(var b in this.group.groupUserStates){if(b!=this.chatApp.profileManager.currentUserId){var a=this.group.groupUserStates[b];var c=a.groupUser.lastViewTime;if(c&&c.getTime()>=this.message.createdTime){this.frame.down(".message-read-receipt").show();break}}}}},_registerPopupButtons:function(){var b=this.frame.down(".message-profile-image");var a=this.frame.down(".message-profile-name");if(this.message.userId!=this.chatApp.profileManager.currentUserId){Event.observe(a,"click",this._onPopupButtonClick.bindAsEventListener(this));Event.observe(b,"click",this._onPopupButtonClick.bindAsEventListener(this))}else{a.setStyle({cursor:"default"});b.setStyle({cursor:"default"})}},_onPopupButtonClick:function(c){Event.stop(c);var b=this.chatApp.profileManager.getProfile(this.message.userId);var a=new ContactListPopup();a.setChatApp(this.chatApp);a.setGroup(this.group);a.setProfile(b)},_updateCrossPostButton:function(){var a=(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_MODERATE]&&this.group.crossPostGroupId!=null);if(a&&this.crossPostButton==null){this.crossPostButton=this.frame.down(".message-cross-post-button");Event.observe(this.crossPostButton,"click",this._onCrossPostButtonClick.bindAsEventListener(this))}},_updateDeleteButton:function(){var a=(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_MODERATE]||(this.message.userId==this.chatApp.profileManager.currentUserId&&this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_DELETE_OWN_MESSAGES]));if(a&&this.deleteButton==null){this.deleteButton=this.frame.down(".message-delete-button");Event.observe(this.deleteButton,"click",this._onDeleteButtonClick.bindAsEventListener(this));Event.observe(this.frame,"mouseenter",this._onMouseEnter.bindAsEventListener(this));Event.observe(this.frame,"mouseleave",this._onMouseLeave.bindAsEventListener(this))}},onProfileChange:function(a){this._updateDisplay()},onGroupUserStateUpdate:function(a){this._updateDisplay()},onGroupItem:function(b){if(this.groupItemTiles==null){this.groupItemTiles=new Hash()}if(this.groupItemsContainer==null){this.groupItemsContainer=this.frame.down(".message-group-items")}if(this.groupItemTiles.get(b.item.itemId)==null){var a=GroupItemTile.create(b.item.itemType,this.groupItemsContainer,GroupItemTile.SIZE_SMALL);a.setChatApp(this.chatApp);a.setGroup(this.group);a.setGroupItem(b);this.groupItemTiles.set(b.item.itemId,a)}},destroy:function(){if(this.groupItemTiles!=null){this.groupItemTiles.values().each(function(a){a.destroy()}.bind(this));this.groupItemTiles=null}this.frame.remove();this.frame=null},_onDeleteButtonClick:function(){this.frame.addClassName("delete-highlight");var a=this.chatApp.profileManager.getProfile(this.message.userId);var b=new DeleteMessagePopup();b.setChatApp(this.chatApp);b.setWidth(180);b.setTitle(_("Delete message?"));b.setMessage(_("This message will be permanently removed!"));b.setOnOkCallback(function(e,d){var c=this.message.messageId;if(e){c=0}ServiceInterface.deleteMessages(this.group.groupId,this.message.userId,c);if(d){ServiceInterface.banUser(this.group.groupId,this.message.userId)}}.bind(this));b.setOnCancelCallback(function(){this.frame.removeClassName("delete-highlight")}.bind(this));b.setGroup(this.group);b.setProfile(a)},_onCrossPostButtonClick:function(){ServiceInterface.crossPost(this.group.groupId,this.message.messageId)},_onMouseEnter:function(){this.deleteButton.show();if(this.crossPostButton){this.crossPostButton.show()}},_onMouseLeave:function(){this.deleteButton.hide();if(this.crossPostButton){this.crossPostButton.hide()}}};var GroupInviteMessageTile=Class.create();GroupInviteMessageTile.prototype={initialize:function(){this.chatApp=null;this.group=null;this.responded=false;this.onGroupUserStateUpdateListener=this._onGroupUserStateUpdate.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a},setGroup:function(c){this.group=c;var a=this.group.groupUserStates[this.chatApp.profileManager.currentUserId];if(a.groupUser&&a.groupUser.state=="invited"){var b=this.chatApp.templateManager.evaluate("message:group-invite-message-tile",{_:_});var d=new Element("div").update(b);this.frame=d.down("div");this.group.addGroupUserStateUpdateListener(this.chatApp.profileManager.currentUserId,this.onGroupUserStateUpdateListener);Event.observe(this.frame.down(".accept-button"),"click",this._onAcceptButtonClick.bindAsEventListener(this));Event.observe(this.frame.down(".decline-button"),"click",this._onDeclineButtonClick.bindAsEventListener(this))}},destroy:function(){if(this.frame){this.frame.remove();this.frame=null}this.group.removeGroupUserStateUpdateListener(this.chatApp.profileManager.currentUserId,this.onGroupUserStateUpdateListener)},_onGroupUserStateUpdate:function(a){if(a.groupUser&&a.groupUser.state!="invited"){this.responded=true;this._updateDisplay()}},_onAcceptButtonClick:function(){ServiceInterface.respondInvite(this.group.groupId,true,{callback:function(){},errorHandler:function(){alert("Error accepting invite. Please notify support@chatroll.com");this.responded=false;this._updateDisplay()}});this.responded=true;this._updateDisplay()},_onDeclineButtonClick:function(){ServiceInterface.respondInvite(this.group.groupId,false,{callback:function(){},errorHandler:function(){alert("Error declining invite. Please notify support@chatroll.com");this.responded=false;this._updateDisplay()}});this.responded=true;this._updateDisplay()},_updateDisplay:function(){if(!this.responded){this.frame.down(".accept-button").enable();this.frame.down(".decline-button").enable()}else{this.frame.down(".accept-button").disable();this.frame.down(".decline-button").disable()}}};var DeleteMessagePopup=Class.create(ConfirmationPopup,{initialize:function($super){$super();this.group=null;this.profile=null;this.onProfileChangeListener=this._onProfileChange.bindAsEventListener(this)},setGroup:function(a){this.group=a},setProfile:function(a){this.profile=a;if(this.profile.tempProfile){this.chatApp.profileManager.addProfileChangeListener(this.profile.userId,this.onProfileChangeListener)}else{this._showPopup()}},_onProfileChange:function(a){this.profile=a;this.chatApp.profileManager.removeProfileChangeListener(this.profile.userId,this.onProfileChangeListener);this._showPopup()},_showPopup:function(){if(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_MODERATE]){this.message+="<div style='margin: 5px 0; font-size:0.85em; text-align:left; position:relative;'>	<input class='delete-all-checkbox' type='checkbox' value='enabled' />"+_("Delete all messages from")+" "+this.profile.displayNameHtml+"<br/><input class='ban-user-checkbox' type='checkbox' value='enabled' />"+_("Block")+" "+this.profile.displayNameHtml+"</div>"}this.show()},_onOkButtonClick:function(){var c=false;var b=false;if(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_MODERATE]){var a=this.chatApp.tooltipManager.activeTooltip;c=$F(a.down(".delete-all-checkbox"))=="enabled";b=$F(a.down(".ban-user-checkbox"))=="enabled"}if(this.onOkCallback!=null){this.onOkCallback(c,b)}this.destroy()}});var ContactList=Class.create();ContactList.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a;this.items=new Hash();this.viewerItem=null;this.inviteItem=null;this.onUserJoinListener=this._onUserJoin.bindAsEventListener(this);this.onUserLeaveListener=this._onUserLeave.bindAsEventListener(this);this.onlineCountListener=this._onOnlineCountChange.bindAsEventListener(this);this.onProfileChangeListener=this._onProfileChange.bindAsEventListener(this);this.onGroupUserStateUpdateAnyListener=this._onGroupUserStateUpdateAny.bindAsEventListener(this)},setChatApp:function(c){this.chatApp=c;if(!this.frame){var a='<div class="chat-contacts"></div>';var b=new Element("div").update(a);this.frame=b.down("div")}},setGroup:function(b){this.group=b;this.viewerItem=new ViewerContactListItem();this.viewerItem.setChatApp(this.chatApp);this.frame.insert({bottom:this.viewerItem.frame});if(!this.group.publicGroup){this.inviteItem=new ContactListInviteItem();this.inviteItem.setChatApp(this.chatApp);this.inviteItem.setGroup(this.group);this.frame.insert({bottom:this.inviteItem.frame})}for(var a in this.group.groupUserStates){this._onUserJoin(this.chatApp.profileManager.getProfile(a))}this.viewerItem.setViewerCount(this.group.onlineCount-this.items.size());this.group.onlineCountChangeEvent.observe(this.onlineCountListener);this.group.addUserJoinListener(this.onUserJoinListener);this.group.addUserLeaveListener(this.onUserLeaveListener);this.group.addGroupUserStateUpdateAnyListener(this.onGroupUserStateUpdateAnyListener)},destroy:function(){this.group.removeGroupUserStateUpdateAnyListener(this.onGroupUserStateUpdateAnyListener);this.group.removeUserLeaveListener(this.onUserLeaveListener);this.group.removeUserJoinListener(this.onUserJoinListener);this.group.onlineCountChangeEvent.stopObserving(this.onlineCountListener);this.items.values().each(function(a){a.destroy();this.chatApp.profileManager.removeProfileChangeListener(a.profile.userId,this.onProfileChangeListener)}.bind(this));this.items=null;if(this.inviteItem){this.inviteItem.destroy()}if(this.viewerItem){this.viewerItem.destroy()}if(this.frame.up()!=null){this.frame.remove()}this.frame=null},_onOnlineCountChange:function(){this.viewerItem.setViewerCount(this.group.onlineCount-this.items.size())},_onUserJoin:function(a){if(!this._isViewer(a)){this._addItem(a);this.viewerItem.setViewerCount(this.group.onlineCount-this.items.size())}this.chatApp.profileManager.addProfileChangeListener(a.userId,this.onProfileChangeListener)},_onUserLeave:function(a){if(this.items.get(a)){this._removeItem(a);this.viewerItem.setViewerCount(this.group.onlineCount-this.items.size())}this.chatApp.profileManager.removeProfileChangeListener(a,this.onProfileChangeListener)},_onProfileChange:function(a){if(this.items.get(a.userId)){this._updateItemPosition(a)}else{if(!this._isViewer(a)){this._addItem(a);this.viewerItem.setViewerCount(this.group.onlineCount-this.items.size())}}},_onGroupUserStateUpdateAny:function(b){if(this.items.get(b.userId)){var a=this.chatApp.profileManager.getProfile(b.userId);this._updateItemPosition(a)}},_isViewer:function(a){return a.guest&&(a.displayName=="")&&a.userId!=this.chatApp.profileManager.currentUserId},_addItem:function(a){if(!this.items.get(a.userId)){var b=new ContactListItem();b.setChatApp(this.chatApp);b.setGroup(this.group);b.setProfile(a);this.items.set(a.userId,b);this._updateItemPosition(a)}else{logger.warn("_addItem: Attempted to re-add contact list item for user "+a.userId)}},_removeItem:function(a){var b=this.items.get(a);if(b){b.destroy();b=null;this.items.unset(a)}else{logger.error("_removeItem: Attempted to remove non-existing contact list item for user "+a)}},_updateItemPosition:function(d){var h=this.items.get(d.userId);if(h){var f=false;var a=this.frame.select(".contact-list-item");var c=a.length;var b=this.chatApp.profileManager.getCurrentProfile().userId;for(var g=0;g<c;g++){var e=$w(a[g].className)[1];var j=this.items.get(e);if(j==null){j=this.viewerItem}if(this._compareItemsForSort(b,h,j)>0){j.frame.insert({before:h.frame});f=true;break}}if(!f){this.frame.insert({bottom:h.frame})}}else{logger.error("_updateItemPosition: Attempted to update position for non-existing contact list item for user "+userId)}},_compareItemsForSort:function(f,m,d){var h=m.profile;var l=d.profile;if(l==null){return 1}var b=0;var i=0;var e=0;var j=0;var c=this.group.groupUserStates[h.userId];if(c!=null){var g=c.groupUser;if(g){if(g.state=="invited"){b=3}else{if(g.state=="active"){if(c.status=="online"){b=1}else{b=2}}else{b=4}}}if(c.permissions[GroupPermission.PERMISSION_ADMIN]){e=2}else{if(c.permissions[GroupPermission.PERMISSION_MODERATE]){e=1}}}c=this.group.groupUserStates[l.userId];if(c!=null){var g=c.groupUser;if(g){if(g.state=="invited"){i=3}else{if(g.state=="active"){if(c.status=="online"){i=1}else{i=2}}else{i=4}}}if(c.permissions[GroupPermission.PERMISSION_ADMIN]){j=2}else{if(c.permissions[GroupPermission.PERMISSION_MODERATE]){j=1}}}if(b>i){return -1}else{if(b<i){return 1}}if(e>j){return 1}else{if(e<j){return -1}}var k=0;if(!h.guest){k=2}else{if(h.displayName!=""){k=1}}var a=0;if(!l.guest){a=2}else{if(l.displayName!=""){a=1}}if(k>a){return 1}else{if(a>k){return -1}}if(h.userId==f){return 1}else{if(l.userId==f){return -1}}return 0}};var ContactListItem=Class.create();ContactListItem.prototype={initialize:function(){this.chatApp=null;this.group=null;this.profile=null;this.onProfileChangeListener=this._onProfileChange.bindAsEventListener(this);this.onGroupUserStateUpdateListener=this._onGroupUserStateUpdate.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a;this.frame=new Element("div");this.frame.addClassName("contact-list-item")},setGroup:function(a){this.group=a},setProfile:function(a){this.profile=a;this.frame.addClassName(a.userId);this._updateDisplay();this.chatApp.profileManager.addProfileChangeListener(this.profile.userId,this.onProfileChangeListener);this.group.addGroupUserStateUpdateListener(this.profile.userId,this.onGroupUserStateUpdateListener)},destroy:function(){if(this.chatApp!=null){this.group.removeGroupUserStateUpdateListener(this.profile.userId,this.onGroupUserStateUpdateListener);this.chatApp.profileManager.removeProfileChangeListener(this.profile.userId,this.onProfileChangeListener)}this.frame.remove();this.frame=null},_onProfileChange:function(a){this.profile=a;this._updateDisplay()},_onGroupUserStateUpdate:function(a){this._updateDisplay()},_updateDisplay:function(){var c=this.group.groupUserStates[this.profile.userId];var f=null;if(this.profile.guest){f="guest"}else{if(c!=null){if(c.permissions[GroupPermission.PERMISSION_ADMIN]){f="admin"}else{if(c.permissions[GroupPermission.PERMISSION_MODERATE]){f="moderator"}}}}if(f!=null){this.frame.addClassName(f)}if(this.profile.userId==this.chatApp.profileManager.currentUserId){this.frame.addClassName("self")}var e;if(c&&c.groupUser){if(c.groupUser.state=="invited"){e="invited"}else{if(c.groupUser.state=="active"){if(c.status=="online"){e="online"}else{e="offline"}}else{e="inactive"}}}else{e="online"}this.frame.removeClassName("contact-list-item-inactive");this.frame.removeClassName("contact-list-item-invited");if(e=="invited"){this.frame.addClassName("contact-list-item-invited")}else{if(e=="inactive"){this.frame.addClassName("contact-list-item-inactive")}}var a,d;if(e=="invited"){a="3";d=_("Invited")}else{if(e=="online"){a="1";d=_("Online")}else{if(e=="offline"){a="0";d=_("Offline")}else{a="0";d=_("Inactive")}}}this.frame.innerHTML=this.chatApp.templateManager.evaluate("profile:contact-list-item",{statusIcon:a,statusName:d,displayNameHTML:this.profile.getDisplayNameHTML(),tinyImageHTML:this.profile.getTinyImageHTML()});if((c!=null)&&c.products.length>0){var i=c.products[c.products.length-1];var g="<a target='_blank' href='#' onclick='goChatApp.fireGroupUiAction(BluePassOfferPopup.SHOW_POPUP);return false;' class='contact-list-product-icon' title='";g+=i.name;g+="'/>";g+="<img class='pro-badge-icon pro-badge-icon-"+i.productId+"' src='/t.gif'/>";g+="</a>";this.frame.down(".contact-list-status-icon").insert({after:g});this.frame.down(".contact-list-profile-name").setStyle({marginLeft:"37px"})}var a=this.frame.down(".contact-list-status-icon");var b=this.frame.down(".contact-list-profile-name");var h=this.frame.down(".contact-list-profile-image");if(this.profile.userId!=this.chatApp.profileManager.currentUserId){Event.observe(a,"click",this._onPopupButtonClick.bindAsEventListener(this));Event.observe(b,"click",this._onPopupButtonClick.bindAsEventListener(this));Event.observe(h,"click",this._onPopupButtonClick.bindAsEventListener(this))}else{a.setStyle({cursor:"default"});b.setStyle({cursor:"default"});h.setStyle({cursor:"default"})}},_onPopupButtonClick:function(b){Event.stop(b);var a=new ContactListPopup();a.setChatApp(this.chatApp);a.setGroup(this.group);a.setProfile(this.profile)}};var ViewerContactListItem=Class.create();ViewerContactListItem.prototype={initialize:function(){this.chatApp=null},setChatApp:function(c){this.chatApp=c;this.frame=new Element("div");this.frame.addClassName("contact-list-item contact-list-item-viewer-count");var a={status:1,displayStatus:_("Online")};var b="<div class='profile-tiny-image' style=\"background-image:url('"+this.chatApp.clientConfig.baseImagesUrl+"/images/D/E/F/DEFAULTUSER-resize_20x20.jpg')\"></div>";this.frame.innerHTML=this.chatApp.templateManager.evaluate("profile:contact-list-item",{profile:a,displayNameHTML:"",tinyImageHTML:b});this.frame.hide();this.profileName=this.frame.down(".contact-list-profile-name")},destroy:function(){this.frame.remove();this.frame=null},setViewerCount:function(a){if(a>0){var b=(a>1)?_("viewers"):_("viewer");this.profileName.innerHTML="<span style='font-weight:normal;font-size:0.9em;color:#91cc00;'>"+a+" "+b+"</span>";this.frame.show()}else{this.frame.hide()}}};var ContactListInviteItem=Class.create();ContactListInviteItem.prototype={initialize:function(){this.chatApp=null;this.group=null;this.onGroupUserStateUpdateListener=this._onGroupUserStateUpdate.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a;this.frame=new Element("div");this.frame.addClassName("contact-list-item contact-list-invite-item");this.frame.innerHTML="<a class='contact-list-invite-text' href='javascript:void(0)'>"+_("Invite&hellip;")+"</a>";this._updateDisplay();this.group.addGroupUserStateUpdateListener(this.chatApp.profileManager.currentUserId,this.onGroupUserStateUpdateListener);Event.observe(this.frame.down(".contact-list-invite-text"),"click",this._onInviteClick.bindAsEventListener(this))},_updateDisplay:function(){var a=this.group.groupUserStates[this.chatApp.profileManager.currentUserId];if(a.groupUser.state=="active"){this.frame.show()}else{this.frame.hide()}},_onGroupUserStateUpdate:function(a){this._updateDisplay()},_onInviteClick:function(b){Event.stop(b);var a=new SendInvitePopup();a.setChatApp(this.chatApp);a.setGroup(this.group);a.showPopup()},destroy:function(){this.group.removeGroupUserStateUpdateListener(this.chatApp.profileManager.currentUserId,this.onGroupUserStateUpdateListener);this.frame.remove();this.frame=null}};var ContactListPopup=Class.create();ContactListPopup.prototype={initialize:function(){this.chatApp=null;this.group=null;this.profile=null;this.wrapper=null;this.moderatorControl=null;this.startPrivateChatButton=null;this.status=null;this.onProfileChangeListener=this._onProfileChange.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a},setProfile:function(a){this.profile=a;if(this.profile.tempProfile){this.chatApp.profileManager.addProfileChangeListener(this.profile.userId,this.onProfileChangeListener)}else{this._showPopup()}},_onProfileChange:function(a){this.profile=a;this.chatApp.profileManager.removeProfileChangeListener(this.profile.userId,this.onProfileChangeListener);this._showPopup()},destroy:function(){},_showPopup:function(){var a=this.chatApp.templateManager.evaluate("profile:contact-list-popup",{_:_,profile:this.profile,displayName:this.profile.displayName,displayNameHTML:this.profile.getDisplayNameHTML(),iconImageHTML:this.profile.getIconImageHTML()});var e=new Element("div").update(a);this.wrapper=e.down("div");this.status=this.wrapper.down(".status");this.moderatorControl=this.wrapper.down(".moderator-control");Event.observe(this.wrapper.down(".popup-close-button"),"click",this._closePopup.bindAsEventListener(this));var b=false;var d=this.group.groupUserStates[this.profile.userId];if(d){b=d.permissions[GroupPermission.PERMISSION_MODERATE]}if(d&&d.groupUser&&d.groupUser.state=="inactive"){var c=this.wrapper.down(".invite-button");c.show();Event.observe(c,"click",this._onInviteButtonClick.bindAsEventListener(this))}if(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_SEND_PM]||this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_SEND_MODERATOR_PM]&&b){this.startPrivateChatButton=this.wrapper.down(".pm-show-button");this.startPrivateChatButton.show();Event.observe(this.startPrivateChatButton,"click",this._onStartPrivateChatButtonClick.bindAsEventListener(this))}if(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_MODERATE]){Event.observe(this.wrapper.down(".delete-button"),"click",this._onDeleteButtonClick.bindAsEventListener(this));Event.observe(this.wrapper.down(".ban-button"),"click",this._onBanButtonClick.bindAsEventListener(this));this.moderatorControl.show()}this.wrapper=this.chatApp.tooltipManager.showTooltip({element:this.wrapper,relativeElement:"chat",left:"center",top:"center"})},_onStartPrivateChatButtonClick:function(){if(this.chatApp.profileManager.getCurrentProfile().displayName==""){this.status.innerHTML="<span class='form-error'>Please sign in first!</span>"}else{var a=this.chatApp.clientConfig.groupId;var b=[];b.push(this.profile.userId);this.startPrivateChatButton.disable();ServiceInterface.startPrivateChat(a,b,{callback:this._onStartPrivateChatSuccess.bind(this),errorHandler:this._onStartPrivateChatError.bind(this)})}},_onStartPrivateChatSuccess:function(a){this.chatApp.groupManager.connectGroup(a.groupId,true);this._closePopup()},_onStartPrivateChatError:function(){this.status.innerHTML="<span class='form-error'>Error starting private chat. Please contact support.</span>"},_onInviteButtonClick:function(){ServiceInterface.sendInvite(this.group.groupId,this.profile.userId,{callback:function(){}.bind(this),errorHandler:function(){alert("Error sending invite. Please notify support@chatroll.com")}});this._closePopup()},_onDeleteButtonClick:function(){ServiceInterface.deleteMessages(this.group.groupId,this.profile.userId,0,{callback:this._onDeleteSuccess.bind(this),errorHandler:this._onDeleteError.bind(this)})},_onDeleteSuccess:function(){this.status.innerHTML="<span class='form-success'>"+_("Messages deleted.")+"</span>"},_onDeleteError:function(){this.status.innerHTML="<span class='form-error'>Error deleting messages. Please contact support.</span>"},_onBanButtonClick:function(){ServiceInterface.banUser(this.group.groupId,this.profile.userId,{callback:this._onBanSuccess.bind(this),errorHandler:this._onBanError.bind(this)})},_onBanSuccess:function(){this.status.innerHTML="<span class='form-success'>"+_("User blocked.")+"</span>"},_onBanError:function(){this.status.innerHTML="<span class='form-error'>Block failed. Please contact support@chatroll.com.</span>"},_closePopup:function(){this.chatApp.tooltipManager.hideTooltips();delete this}};var SendInvitePopup=Class.create();SendInvitePopup.prototype={initialize:function(){this.chatApp=null;this.group=null;this.frame=null;this.resultsContainer=null},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a},destroy:function(){},showPopup:function(){var c=$(document.body).down(".group-chat-container");if(c==null){c=$(document.body).down(".group-chat-embedded")}var a=c.down(".chat-messages-container");var b=this.chatApp.templateManager.evaluate("group:send-invite-popup",{_:_});this.frame=this.chatApp.tooltipManager.showTooltip({html:b,relativeElement:"chat",left:"center",top:"center"});this.resultsContainer=this.frame.down(".search-results");this.resultHtml=this.resultsContainer.innerHTML;this.resultsContainer.innerHTML="";Event.observe(this.frame.down(".search-input"),"keypress",function(e){var d=e.which||e.keyCode;switch(d){default:break;case Event.KEY_RETURN:this._onSearchSubmit();break}}.bindAsEventListener(this));Event.observe(this.frame.down(".search-button"),"click",this._onSearchSubmit.bindAsEventListener(this));Event.observe(this.frame.down(".popup-close-button"),"click",this._closePopup.bindAsEventListener(this));this._onSearchSubmit();this.frame.down(".search-input").focus()},_onSearchSubmit:function(){var a=$F(this.frame.down(".search-input")).strip();ServiceInterface.searchInviteUsers(this.group.groupId,a,{callback:function(b){this.resultsContainer.innerHTML="";b.each(function(d){var e=new Element("div").update(this.resultHtml);var c=e.down("div");c.down(".invite-username").update(d.displayNameHtml);Event.observe(c.down(".invite-button"),"click",function(f,g){ServiceInterface.sendInvite(this.group.groupId,f,{callback:function(){}.bind(this),errorHandler:function(){alert("Error sending invite. Please notify support@chatroll.com")}});this._closePopup()}.bind(this,d.userId));this.resultsContainer.insert({bottom:c})}.bind(this))}.bind(this),errorHandler:function(){alert("Error searching users. Please notify support@chatroll.com")}})},_closePopup:function(){this.chatApp.tooltipManager.hideTooltips();delete this}};var GroupInvitePopup=Class.create();GroupInvitePopup.prototype={initialize:function(){this.chatApp=null;this.group=null;this.wrapper=null;this.onGroupUserStateUpdateListener=this._onGroupUserStateUpdate.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a},destroy:function(){this.group.removeGroupUserStateUpdateListener(this.chatApp.profileManager.currentUserId,this.onGroupUserStateUpdateListener)},showPopup:function(d){var b=this.group.groupUserStates[this.chatApp.profileManager.currentUserId];if(b.groupUser&&b.groupUser.state=="invited"){var a=this.chatApp.profileManager.getProfile(d);var c=this.chatApp.templateManager.evaluate("group:group-invite-popup",{_:_,profile:a,displayName:a.displayName,displayNameHTML:a.getDisplayNameHTML(),iconImageHTML:a.getIconImageHTML()});this.wrapper=this.chatApp.tooltipManager.showTooltip({html:c,relativeElement:"chat",left:"center",top:"center"});this.group.addGroupUserStateUpdateListener(this.chatApp.profileManager.currentUserId,this.onGroupUserStateUpdateListener);Event.observe(this.wrapper.down(".accept-button"),"click",this._onAcceptButtonClick.bindAsEventListener(this));Event.observe(this.wrapper.down(".decline-button"),"click",this._onDeclineButtonClick.bindAsEventListener(this));Event.observe(this.wrapper.down(".popup-close-button"),"click",this._closePopup.bindAsEventListener(this))}else{delete this}},_onGroupUserStateUpdate:function(a){if(a.groupUser&&a.groupUser.state!="invited"){this._closePopup()}},_onAcceptButtonClick:function(){ServiceInterface.respondInvite(this.group.groupId,true,{callback:function(){this.chatApp.groupManager.setActiveGroup(this.group)}.bind(this),errorHandler:function(){alert("Error accepting invite. Please notify support@chatroll.com")}});this._closePopup()},_onDeclineButtonClick:function(){ServiceInterface.respondInvite(this.group.groupId,false,{callback:function(){},errorHandler:function(){alert("Error declining invite. Please notify support@chatroll.com")}});this._closePopup()},_closePopup:function(){this.chatApp.tooltipManager.hideTooltips();delete this}};var GroupItemTile=Class.create();GroupItemTile.SIZE_LARGE=1;GroupItemTile.SIZE_SMALL=2;GroupItemTile.create=function(d,b,c){var a;switch(d){case GroupItem.TYPE_BOOKMARK:a=new BookmarkGroupItemTile(b,c);break;case GroupItem.TYPE_IMAGE:a=new ImageGroupItemTile(b,c);break;case GroupItem.TYPE_VIDEO_YOUTUBE:case GroupItem.TYPE_VIDEO_BREAK:a=new VideoGroupItemTile(b,c);break;case GroupItem.TYPE_DISCUSSION:a=new DiscussionGroupItemTile(b,c);break}return a};GroupItemTile.prototype={initialize:function(a,b){this.parentElement=a;this.tileSize=b;this.groupItem=null;this.chatApp=null;this.group=null;this.deleteButton=null;this.frame=null;this.onGroupItemUpdateListener=this._onGroupItemUpdate.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a;this.group.addGroupItemUpdateListener(this.onGroupItemUpdateListener)},setGroupItem:function(a){this.groupItem=a;this._renderTile()},destroy:function(){this.group.removeGroupItemUpdateListener(this.onGroupItemUpdateListener);this.group=null;this.frame.remove();this.frame=null},_renderTile:function(){var c=false;this.frame=this.parentElement.down("."+this.groupItem.item.itemId);if(this.frame==null){c=true;var a=Object.toJSON(this.groupItem).evalJSON();a.item.imageUrl=this.chatApp.clientConfig.baseImagesUrl+a.item.imageUrl;if(this.tileSize==GroupItemTile.SIZE_LARGE){var b=this.chatApp.templateManager.evaluate(this.largeTileTemplateId,a);this.parentElement.insert({top:b})}else{var b=this.chatApp.templateManager.evaluate(this.smallTileTemplateId,a);this.parentElement.insert({bottom:b})}this.frame=this.parentElement.down("."+this.groupItem.item.itemId)}this.image=this.frame.down(".item-image");if(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_MODERATE]){this._enableDeleteButton()}return c},_onGroupItemUpdate:function(a){if(a.item.itemId==this.groupItem.item.itemId){this.image.src=this.chatApp.clientConfig.baseImagesUrl+this.groupItem.item.imageUrl}},_enableDeleteButton:function(){this.deleteButton=this.frame.down(".group-item-delete-button");if(this.deleteButton!=null){Event.observe(this.deleteButton,"click",this._onDeleteButtonClick.bindAsEventListener(this));Event.observe(this.frame,"mouseenter",this._onMouseEnter.bindAsEventListener(this));Event.observe(this.frame,"mouseleave",this._onMouseLeave.bindAsEventListener(this))}},_onDeleteButtonClick:function(){this.frame.addClassName("delete-highlight");var a=new ConfirmationPopup();a.setChatApp(this.chatApp);a.setTitle("Delete item?");a.setMessage("This item will be removed!");a.setOnOkCallback(function(){ServiceInterface.deleteGroupItem(this.groupItem.groupId,this.groupItem.item.itemId)}.bind(this));a.setOnCancelCallback(function(){this.frame.removeClassName("delete-highlight")}.bind(this));a.show()},_onMouseEnter:function(){this.deleteButton.show()},_onMouseLeave:function(){this.deleteButton.hide()}};var BookmarkGroupItemTile=Class.create(GroupItemTile,{});BookmarkGroupItemTile.prototype.largeTileTemplateId="group-item:bookmark-tile";BookmarkGroupItemTile.prototype.smallTileTemplateId="group-item:bookmark-tile-small";var ImageGroupItemTile=Class.create(GroupItemTile,{});ImageGroupItemTile.prototype.largeTileTemplateId="group-item:image-tile";ImageGroupItemTile.prototype.smallTileTemplateId="group-item:image-tile-small";var VideoGroupItemTile=Class.create(GroupItemTile,{});VideoGroupItemTile.prototype.largeTileTemplateId="group-item:video-tile";VideoGroupItemTile.prototype.smallTileTemplateId="group-item:video-tile-small";var DiscussionGroupItemTile=Class.create(GroupItemTile,{_renderTile:function($super){var e=$super();if(e){var d=this.chatApp.profileManager.getProfile(this.groupItem.userId);if(this.tileSize==GroupItemTile.SIZE_LARGE){var f=this.frame.down(".group-item-profile");d.prepareForTemplateEval();f.innerHTML=this.chatApp.templateManager.evaluate("profile:small-tile",d)}else{var c=this.frame.down(".profile-icon-image-border");c.innerHTML=d.getIconImageHTML();var b=this.frame.down(".group-item-group-link");var a=this.chatApp.clientConfig.baseWebUrl+"/"+this.group.url;b.href=a}}}});DiscussionGroupItemTile.prototype.largeTileTemplateId="group-item:discussion-tile";DiscussionGroupItemTile.prototype.smallTileTemplateId="group-item:discussion-tile-small";var BluePassOfferPopup=Class.create();BluePassOfferPopup.SHOW_POPUP="showBluePassOfferPopup";BluePassOfferPopup.prototype={initialize:function(){this.chatApp=null;this.group=null},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a;this.group.addUiActionListener(BluePassOfferPopup.SHOW_POPUP,this._onShowPopup.bindAsEventListener(this))},_onShowPopup:function(){var a=false;var c=this.group.groupUserStates[this.chatApp.profileManager.currentUserId];if((c!=null)&&c.products.length>0){var d=c.products[c.products.length-1];if(d.productId==100){a=true}}if(!a){var e=new ConfirmationPopup();e.setChatApp(this.chatApp);e.setTitle("Purchase Blue Pass");e.setOkButtonValue("Get it");e.setCancelButtonValue("No Thanks");var b="<div style='width:190px;'><div><img class='pro-badge-icon pro-badge-icon-100' style='vertical-align:middle;' src='/t.gif'><span style='font-weight:bold;vertical-align:middle;padding-left:7px;'>Blue Pass &ndash; "+200+" Credits</span></div><div style='padding-top:8px;'>Blue Pass lets you send unlimited private messages for 30 days.</div></div>";e.setMessage(b);e.setOnOkCallback(function(){var f=this.chatApp.tooltipManager.activeTooltip;ServiceInterface.purchaseBluePass(this.chatApp.clientConfig.groupId,{callback:this._onBluePassPurchaseSuccess.bind(this),errorHandler:this._onBluePassPurchaseError.bind(this)})}.bind(this));e.show()}},_onBluePassPurchaseSuccess:function(){},_onBluePassPurchaseError:function(){var b=new ConfirmationPopup();b.setChatApp(this.chatApp);b.setTitle("Insufficient Credit");b.setOkButtonValue(null);b.setCancelButtonValue(null);var a="<div style='width:190px;'>You need <b>"+200+" Credits</b> to<br/>buy a Blue Pass.<div style='padding-top:8px;font-size:1.1em;font-weight:bold;'><a style='text-decoration:underline;' href='/store/getcredits?offerId=1' target='_blank'>Get Chatroll Credits Now &raquo;</a></div></div>";b.setMessage(a);b.show()}};var PrivateMessagePopup=Class.create();PrivateMessagePopup.prototype={initialize:function(){this.chatApp=null;this.group=null;this.privateMessageEventQueue=new Array();this.isPopupShowing=false},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a;this.group.addPrivateMessageActionListener(this._onPrivateMessageAction.bindAsEventListener(this))},_onPrivateMessageAction:function(a){if(!this.isPopupShowing){this.isPopupShowing=true;this._show(a)}else{this.privateMessageEventQueue.push(a)}},_show:function(e){var f=null;var d=null;var b=null;var c=this.chatApp.profileManager.getProfile(e.userId);if(e.action=="send"){f="Private Message to "+c.displayName;b="Send a private message"}else{f="Private Message from "+c.displayName;d=e.message;b="Send a reply"}var a=this.chatApp.templateManager.evaluate("group:private-message-popup",{title:f,displayNameHTML:c.getDisplayNameHTML(),iconImageHTML:c.getIconImageHTML(),message:d,actionLabel:b});var g=this.chatApp.tooltipManager.showTooltip({html:a,relativeElement:"chat",left:"center",top:"center",onHideCallback:this._onHideCallback.bind(this)});this.status=g.down(".status");this.privateMessageInput=g.down(".pm-input");Event.observe(g.down(".pm-send-button"),"click",this._onSendButtonClick.bindAsEventListener(this,e.userId));Event.observe(g.down(".pm-cancel-button"),"click",this._onCancelButtonClick.bindAsEventListener(this));Event.observe(g.down(".popup-close-button"),"click",this._onCancelButtonClick.bindAsEventListener(this));Event.observe(this.privateMessageInput,"keydown",this._onInputKeydown.bindAsEventListener(this,e.userId));if(e.action=="received"){g.down(".pm-message").show()}if(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].permissions[GroupPermission.PERMISSION_SEND_PM]){if(this.group.groupUserStates[this.chatApp.profileManager.currentUserId].features[Feature.GROUP_USER_FEATURE_FREE_PM]){g.down(".pm-price-label").hide()}this.privateMessageInput.focus()}else{g.down(".pm-reply").hide()}},_onInputKeydown:function(b,a){if(b.keyCode==Event.KEY_RETURN||b.keyCode==10){this._sendPrivateMessage(a)}},_onSendButtonClick:function(a,b){this._sendPrivateMessage(b)},_sendPrivateMessage:function(b){var c=$F(this.privateMessageInput);c=c.strip();if(c!=""){var a=10;ServiceInterface.purchaseGift(b,a,this.group.groupId,c,{callback:this._onSendSuccess.bind(this),errorHandler:this._onSendError.bind(this,a)})}else{this.status.innerHTML="<span class='form-error'>Message cannot be empty.</span>"}},_onSendSuccess:function(){this.status.innerHTML="<span class='form-success'>Message sent.</span>";this.privateMessageInput.clear();setTimeout(function(){this._onCancelButtonClick()}.bind(this),250)},_onSendError:function(a,c,b){if(b.javaClassName=="com.chatroll.service.account.InsufficientCreditException"){this.status.innerHTML="<span class='form-error'>You need 5 Credits to send a message!</span><div style='font-size:1.1em;padding-top:2px;'><a target='_blank' style='text-decoration:underline;' href='/store/getcredits'><b>Get Credits &raquo;</b></a></div>"}else{this.status.innerHTML="<span class='form-error'>Error. Please contact support@chatroll.com</span>"}},_onCancelButtonClick:function(){this.chatApp.tooltipManager.hideTooltips()},_onHideCallback:function(){this.isPopupShowing=false;if(this.privateMessageEventQueue.length>0){setTimeout(function(){var a=this.privateMessageEventQueue.shift();this._onPrivateMessageAction(a)}.bind(this),0)}}};var ApprovalQueue=Class.create();ApprovalQueue.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a;this.messageTiles=new Hash();this.loading=false;this.loaded=false;this.lastMessageId=0;this.numTiles=0;this.maxTiles=40},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a;Event.observe(this.frame.down(".approve-all-button"),"click",function(){ServiceInterface.approveAllMessages(this.group.groupId)}.bind(this));Event.observe(this.frame.down(".skip-all-button"),"click",function(){ServiceInterface.skipAllMessages(this.group.groupId)}.bind(this));this._loadApprovalQueue();this.group.approvalQueueEvent.observe(this._onApprovalQueueEvent.bindAsEventListener(this))},_loadApprovalQueue:function(){if(!this.loading){this.loading=true;ServiceInterface.getApprovalQueueSection(this.group.groupId,this.lastMessageId+1,{callback:function(a){if(a.length>0){this.lastMessageId=a[0].messageId-1;a.each(function(b){this._insertMessage(b,true)}.bind(this))}this.loading=false;this.loaded=true}.bind(this),errorHandler:function(){alert("Error loading approval queue. Please notify support@chatroll.com")}})}},_onApprovalQueueEvent:function(b){if(b.name=="add"){if(this.loaded&&!this.loading){this._insertMessage(b.message,false)}}else{if(b.name=="approve"||b.name=="skip"){var c=this.numTiles;var d=function(e,g){var f=this.messageTiles.get(e);if(f!=null){this.messageTiles.unset(e);this.numTiles--;f.destroy(g,function(){if(this.numTiles==0){this.frame.down(".empty-indicator").show()}}.bind(this))}}.bind(this);if(b.messageId!=0){d(b.messageId,b.name)}else{var a=this.messageTiles.keys();a.each(function(e){d(e,b.name)}.bind(this))}if(c>=this.maxTiles&&this.numTiles<this.maxTiles){this._loadApprovalQueue()}}else{if(b.name=="disable"){window.location.replace(window.location.href)}}}},_insertMessage:function(b,c){if(this.numTiles<this.maxTiles||c){if(!c&&this.lastMessageId!=0&&b.messageId!=(this.lastMessageId+1)){this._loadApprovalQueue()}else{var a=new ApprovalMessageTile();a.setChatApp(this.chatApp);a.setGroup(this.group);a.setMessage(b);this.messageTiles.set(b.messageId,a);this.numTiles++;this.frame.down(".approval-tiles").insert(a.frame);this.frame.down(".empty-indicator").hide();this.lastMessageId=b.messageId}}}};var ApprovalMessageTile=Class.create();ApprovalMessageTile.prototype={initialize:function(){this.chatApp=null;this.group=null;this.message=null;this.frame=null;this.approveButton=null;this.skipButton=null},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a},setMessage:function(f){this.message=f;var g=f.createdTime.getMessageTimestamp();var a=this.chatApp.templateManager.evaluate("group:approval-message-tile",{message:this.message,timestamp:g});var c=new Element("div");c.innerHTML=a;this.frame=c.down(".approval-message-tile");this.chatApp.profileManager.setProfile(f.profile);var e=this.frame.down(".message-profile-name");var h=this.frame.down(".message-profile-image");var d=this.chatApp.profileManager.getProfile(f.userId);var b=d.guest?" <span class='message-guestmark'>(guest)</span>":"";e.innerHTML=d.getDisplayNameHTML()+b;h.innerHTML=d.getIconImageHTML();this._registerPopupButtons();Event.observe(this.frame.down(".message-approve-button"),"click",function(){this.frame.addClassName("approve-highlight");ServiceInterface.approveMessage(this.group.groupId,this.message.messageId)}.bind(this));Event.observe(this.frame.down(".message-skip-button"),"click",function(){this.frame.addClassName("delete-highlight");ServiceInterface.skipMessage(this.group.groupId,this.message.messageId)}.bind(this))},_registerPopupButtons:function(){if(this.message.userId!=this.chatApp.profileManager.currentUserId){var b=this.frame.down(".message-profile-image");var a=this.frame.down(".message-profile-name");Event.observe(a,"click",this._onPopupButtonClick.bindAsEventListener(this));Event.observe(b,"click",this._onPopupButtonClick.bindAsEventListener(this))}},_onPopupButtonClick:function(c){Event.stop(c);var b=this.chatApp.profileManager.getProfile(this.message.userId);var a=new ContactListPopup();a.setChatApp(this.chatApp);a.setGroup(this.group);a.setProfile(b)},destroy:function(a,b){if(a=="approve"){this.frame.addClassName("approve-highlight")}else{this.frame.addClassName("delete-highlight")}this.frame.down(".message-approve-button").hide();this.frame.down(".message-skip-button").hide();Effect.Fade(this.frame,{duration:2,afterFinish:function(){this.frame.remove();this.frame=null;b()}.bind(this)})}};var GroupChatWidget=Class.create();GroupChatWidget.prototype={initialize:function(a){this.chatApp=null;this.frame=a;this.chatListPadding=0;this.userListPosition=null;this.userListTopVisible=false;this.groupData=new Hash();this.activeGroupId=null;this.chatWrapper=this.frame.down(".chat-wrapper");this.signinBoxContainer=this.frame.down(".chat-signin-box");this.signinBox=new SigninBox(this.signinBoxContainer.down(".signin-box"));this.signinRequired=false;this.signoutButton=this.frame.down(".chat-signout-button");if(this.signoutButton!=null){Event.observe(this.signoutButton,"click",function(c){var b=new ConfirmationPopup();b.setChatApp(this.chatApp);b.setContainer(this.frame);b.setTitle(_("Sign out"));b.setOkButtonValue(_("Ok"));b.setCancelButtonValue(_("Cancel"));b.setMessage("<div style='width:160px;'>"+_("Sign out now?")+"</div>");b.setOnOkCallback(function(){this.chatApp.resetClientEnabled=false;ServiceInterface.signout(this.chatApp.clientConfig.groupId,{callback:function(){window.location.reload()}.bind(this),errorHandler:function(){}})}.bind(this));b.show()}.bindAsEventListener(this))}this.popoutButton=this.frame.down(".chat-popout-button");if(this.popoutButton!=null){Event.observe(this.popoutButton,"click",this._onPopoutButtonClick.bindAsEventListener(this))}this.contactsShowButton=this.frame.down(".chat-contacts-show-button");Event.observe(this.contactsShowButton,"click",this._onContactsShowButtonClick.bindAsEventListener(this));this.onCurrentProfileChangeListener=this._onCurrentProfileChange.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a;this.chatApp.profileManager.addCurrentProfileChangeListener(this.onCurrentProfileChangeListener);Event.observe(window,"resize",this._onWindowResize.bindAsEventListener(this));this._onWindowResize();this.signinBox.setChatApp(a);this._updateSigninBox();this.chatList=new ChatList(this.frame.down(".chat-list"));this.chatList.setGroupChatWidget(this);this.chatList.setChatApp(this.chatApp);this.chatApp.groupManager.addJoinGroupListener(this._onJoinGroupListener.bindAsEventListener(this));this.chatApp.groupManager.addActiveGroupListener(this._onActiveGroupListener.bindAsEventListener(this));this.chatApp.groupManager.addCloseGroupListener(this._onCloseGroupListener.bindAsEventListener(this))},destroy:function(){this.chatApp.profileManager.removeCurrentProfileChangeListener(this.onCurrentProfileChangeListener);this.frame.remove();this.frame=null},_onJoinGroupListener:function(a){this._addGroup(a)},_onActiveGroupListener:function(a){this._setActiveGroup(a)},_onCloseGroupListener:function(b){if(b.groupId!=this.activeGroupId){var a=this.groupData.get(b.groupId);if(a){a.onlineCount.destroy();a.chatAd.destroy();a.stickyMessage.destroy();a.messageList.destroy();a.contactList.destroy();a.messageInput.destroy();this.groupData.unset(b.groupId)}else{logger.error("GroupChatWidget attempted to close unknown group: "+b.groupId)}}else{logger.error("Attempted to close the active group!")}},_addGroup:function(c){var a=this.groupData.get(c.groupId);if(a==null){var a={};var b=(c.groupId==this.chatApp.clientConfig.groupId);a.messageInput=new MessageInput(b?this.frame.down(".chat-input-wrapper"):null,this);a.messageInput.setChatApp(this.chatApp);a.messageInput.setGroup(c);a.contactList=new ContactList(b?this.frame.down(".chat-contacts"):null);a.contactList.setChatApp(this.chatApp);a.contactList.setGroup(c);a.messageList=new MessageList(b?this.frame.down(".chat-messages-container"):null);a.messageList.setChatApp(this.chatApp);a.messageList.setGroup(c);a.messageList.setChatListPadding(this.chatListPadding);a.stickyMessage=new StickyMessage(b?this.frame.down(".chat-sticky-message"):null);a.stickyMessage.setMessageList(a.messageList);a.stickyMessage.setChatApp(this.chatApp);a.stickyMessage.setGroup(c);a.stickyMessage.setChatListPadding(this.chatListPadding);a.chatAd=new ChatAd(b?this.frame.down(".chat-ad"):null);a.chatAd.setMessageList(a.messageList);a.chatAd.setChatApp(this.chatApp);a.chatAd.setGroup(c);a.onlineCount=new OnlineCount(b?this.frame.down(".chat-online-count"):null);a.onlineCount.setChatApp(this.chatApp);a.onlineCount.setGroup(c);if(this.chatWrapper.hasClassName("chat-wrapper-chromeless")){a.messageInput.frame.addClassName("chat-input-wrapper-chromeless");a.messageList.frame.addClassName("chat-messages-container-chromeless");a.stickyMessage.frame.addClassName("chat-sticky-message-chromeless");a.chatAd.frame.addClassName("chat-ad-chromeless")}this.groupData.set(c.groupId,a)}else{logger.error("Attempted to add the same group twice!")}},_setActiveGroup:function(d){if(d.groupId!=this.activeGroupId){var b=true;var c=null;if(this.activeGroupId!=null){b=false;c=this.groupData.get(this.activeGroupId)}var a=this.groupData.get(d.groupId);this.activeGroupId=d.groupId;if(!b){c.messageList.frame.up().replaceChild(a.messageList.frame,c.messageList.frame);c.messageInput.frame.up().replaceChild(a.messageInput.frame,c.messageInput.frame);c.contactList.frame.up().replaceChild(a.contactList.frame,c.contactList.frame);c.stickyMessage.frame.up().replaceChild(a.stickyMessage.frame,c.stickyMessage.frame);c.onlineCount.frame.up().replaceChild(a.onlineCount.frame,c.onlineCount.frame);c.chatAd.frame.up().replaceChild(a.chatAd.frame,c.chatAd.frame)}this._updateUserListPosition(true);if(!b){a.messageList.updatePadding();a.messageInput.focus()}}},_getActiveGroupData:function(){var a=null;if(this.activeGroupId!=null){a=this.groupData.get(this.activeGroupId)}return a},setChatListPadding:function(a){this.chatListPadding=a;this.groupData.values().each(function(b){b.messageList.setChatListPadding(this.chatListPadding);b.stickyMessage.setChatListPadding(this.chatListPadding);b.chatAd.setChatListPadding(this.chatListPadding)}.bind(this));this._updateUserListPosition(true)},_onWindowResize:function(){this._updateUserListPosition()},_updateUserListPosition:function(d){if(this.activeGroupId!=null){var a="auto";var c=(this.activeGroupId==this.chatApp.clientConfig.groupId);var b=this.chatApp.clientConfig.embedded;if(!c||!b){a="auto"}else{if(this.chatApp.clientConfig.contactListPosition==Group.CONTACT_LIST_POSITION_RIGHT){a="right"}else{if(this.chatApp.clientConfig.contactListPosition==Group.CONTACT_LIST_POSITION_TOP){a="top"}else{if(this.chatApp.clientConfig.contactListPosition==Group.CONTACT_LIST_POSITION_HIDDEN){a="hidden"}}}}if(a=="auto"){a=(this.frame.getWidth()-this.chatListPadding)<360?"top":"right"}if(a!=this.userListPosition||d){this.userListPosition=a;this._updateUserListLayout()}}},_onContactsShowButtonClick:function(a){this.userListTopVisible=(!this.userListTopVisible);this._updateUserListLayout()},_updateUserListLayout:function(){var a="";if(this.chatWrapper.hasClassName("chat-wrapper-chromeless")){a="-chromeless"}if(this.userListPosition!="top"){this.userListTopVisible=false}if(this.userListTopVisible){this.frame.down(".chat-contacts-container").addClassName("chat-contacts-container-top-open"+a);this.frame.down(".chat-contacts-divider").addClassName("chat-contacts-divider-top-open"+a);this.frame.down(".chat-messages-container").addClassName("chat-messages-container-top-open"+a);this.frame.down(".chat-sticky-message").addClassName("chat-sticky-message-top-open"+a);this.contactsShowButton.innerHTML=_("hide all...")}else{this.frame.down(".chat-contacts-container").removeClassName("chat-contacts-container-top-open"+a);this.frame.down(".chat-contacts-divider").removeClassName("chat-contacts-divider-top-open"+a);this.frame.down(".chat-messages-container").removeClassName("chat-messages-container-top-open"+a);this.frame.down(".chat-sticky-message").removeClassName("chat-sticky-message-top-open"+a);this.contactsShowButton.innerHTML=_("show all...")}if(this.userListPosition=="top"){this.frame.down(".chat-contacts-container").addClassName("chat-contacts-container-top"+a);this.frame.down(".chat-contacts-divider").addClassName("chat-contacts-divider-top"+a);this.frame.down(".chat-contacts-banner").addClassName("chat-contacts-banner-top"+a);this.frame.down(".chat-messages-container").addClassName("chat-messages-container-top"+a);this.frame.down(".chat-sticky-message").addClassName("chat-sticky-message-top"+a);this.frame.down(".chat-ad").addClassName("chat-ad-top"+a);this.contactsShowButton.show()}else{this.frame.down(".chat-contacts-container").removeClassName("chat-contacts-container-top"+a);this.frame.down(".chat-contacts-divider").removeClassName("chat-contacts-divider-top"+a);this.frame.down(".chat-contacts-banner").removeClassName("chat-contacts-banner-top"+a);this.frame.down(".chat-messages-container").removeClassName("chat-messages-container-top"+a);this.frame.down(".chat-sticky-message").removeClassName("chat-sticky-message-top"+a);this.frame.down(".chat-ad").removeClassName("chat-ad-top"+a);this.contactsShowButton.hide()}if(this.userListPosition=="hidden"){this.frame.down(".chat-contacts-container").addClassName("chat-contacts-container-hidden"+a);this.frame.down(".chat-contacts-divider").addClassName("chat-contacts-divider-hidden"+a);this.frame.down(".chat-contacts-banner").addClassName("chat-contacts-banner-hidden"+a);this.frame.down(".chat-messages-container").addClassName("chat-messages-container-hidden"+a);this.frame.down(".chat-sticky-message").addClassName("chat-sticky-message-hidden"+a);this.frame.down(".chat-ad").addClassName("chat-ad-hidden"+a)}else{this.frame.down(".chat-contacts-container").removeClassName("chat-contacts-container-hidden"+a);this.frame.down(".chat-contacts-divider").removeClassName("chat-contacts-divider-hidden"+a);this.frame.down(".chat-contacts-banner").removeClassName("chat-contacts-banner-hidden"+a);this.frame.down(".chat-messages-container").removeClassName("chat-messages-container-hidden"+a);this.frame.down(".chat-sticky-message").removeClassName("chat-sticky-message-hidden"+a);this.frame.down(".chat-ad").removeClassName("chat-ad-hidden"+a)}this.frame.down(".chat-contacts-container").setStyle({left:null});this.frame.down(".chat-contacts-divider").setStyle({left:null});this.frame.down(".chat-contacts-banner").setStyle({left:null});if(this.userListPosition=="top"&&this.chatListPadding){var b=this.frame.down(".chat-contacts-container").positionedOffset().left+this.chatListPadding;this.frame.down(".chat-contacts-container").setStyle({left:b+"px"});var b=this.frame.down(".chat-contacts-divider").positionedOffset().left+this.chatListPadding;this.frame.down(".chat-contacts-divider").setStyle({left:b+"px"});var b=this.frame.down(".chat-contacts-banner").positionedOffset().left+this.chatListPadding;this.frame.down(".chat-contacts-banner").setStyle({left:b+"px"})}this.groupData.values().each(function(c){c.stickyMessage.updatePosition()})},_focus:function(){if(this.signinBoxContainer.visible()){this.signinBox.focus()}else{var a=this._getActiveGroupData();if(a){a.messageInput.focus()}}},_updateSigninBox:function(){if(this.signinBox.isSigninRequired()){this.groupData.values().each(function(a){a.messageInput.frame.hide()});this.signinBoxContainer.show();this.signinRequired=true}else{this.signinBoxContainer.hide();this.groupData.values().each(function(a){a.messageInput.frame.show()});if(!this.chatApp.clientConfig.embedded&&(this.signinRequired==true)){this._focus()}}},_onCurrentProfileChange:function(a){this._updateSigninBox();if(this.signoutButton&&!this.signinBox.isSigninRequired()){this.signoutButton.show()}},onInputFocusOrClick:function(){var a=this._getActiveGroupData();if(a){a.messageList.resumeAutoScroll()}},_onPopoutButtonClick:function(){var b=this.chatApp.groupManager.getGroup(this.chatApp.clientConfig.groupId);var a=this.chatApp.clientConfig.baseWebUrl+"/"+b.url+"/embed";window.open(a,"_blank","status=0,toolbar=0,location=0,menubar=0,resizable=1,width=500,height=500")}};var GroupItemsWidget=Class.create();GroupItemsWidget.prototype={initialize:function(a){this.frame=a;this.chatApp=null;this.group=null;this.groupItemTiles=new Hash();this.groupItemCount=0;this.groupItemsLimit=8;this.itemTypeFilter=null;this.container=this.frame.down(".group-items-widget-container");this.emptyMessage=this.frame.down(".group-items-widget-empty-message");this.onGroupItemListener=this._onGroupItem.bindAsEventListener(this);this.onGroupItemDeleteListener=this._onGroupItemDelete.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a},setItemTypeFilter:function(a){this.itemTypeFilter=a},setGroupItemsLimit:function(a){this.groupItemsLimit=a},setGroup:function(group){this.group=group;this.group.addGroupItemListener(this.onGroupItemListener);this.group.addGroupItemDeleteListener(this.onGroupItemDeleteListener);var initialItems=this.container.select(".group-item");initialItems.each(function(itemElement){var objString=itemElement.down(".item-jsobj").innerHTML.unescapeHTML();var groupItem=(function(){return eval(objString)})();this._addGroupItemTile(groupItem)}.bind(this))},destroy:function(){this.group.removeGroupItemListener(this.onGroupItemListener);this.group.removeGroupItemDeleteListener(this.onGroupItemDeleteListener);this.frame.remove();this.frame=null},_isAcceptableItemType:function(a){var b=false;if(this.itemTypeFilter==null||this.itemTypeFilter.indexOf(a.item.itemType)!=-1){b=true}return b},_addGroupItemTile:function(b){if(this._isAcceptableItemType(b)&&this.groupItemTiles.get(b.item.itemId)==null){var a=GroupItemTile.create(b.item.itemType,this.container,GroupItemTile.SIZE_LARGE);a.setChatApp(this.chatApp);a.setGroup(this.group);a.setGroupItem(b);this.groupItemTiles.set(b.item.itemId,a);this.groupItemCount++;if(this.groupItemCount>this.groupItemsLimit){var c=this.container.childElements()[this.groupItemCount-1];var d=$w(c.className)[1];this._removeGroupItemTile(d)}this.emptyMessage.hide();this.container.show()}},_onGroupItem:function(a){this._addGroupItemTile(a.groupItem)},_onGroupItemDelete:function(a){this._removeGroupItemTile(a)},_removeGroupItemTile:function(b){var a=this.groupItemTiles.unset(b);if(a!=null){a.destroy();a=null;this.groupItemCount--}}};var GroupSettingsWidget=Class.create();GroupSettingsWidget.prototype={initialize:function(g){this.frame=g;this.chatApp=null;this.group=null;this.nameMaxSize=64;this.welcomeMessageMaxSize=250;if(this.frame.down(".settings-section-basic")!=null){this.nameInput=this.frame.down(".name-input");this.nameCharsAvailable=this.frame.down(".name-chars-available");this._checkInputLength(this.nameInput,this.nameCharsAvailable,this.nameMaxSize);Event.observe(this.nameInput,"keyup",this._onNameInputKeyup.bindAsEventListener(this));this.image=this.frame.down(".group-tile-image");this.imageSubmitButton=this.frame.down(".image-submit-button");this.imageUploadFrame=this.frame.down(".image-upload-frame");this.imageUploadProgress=this.frame.down(".image-upload-progress");Event.observe(this.imageSubmitButton,"click",this._onImageSubmit.bindAsEventListener(this));Event.observe(this.imageUploadFrame,"load",this._onImageUploadComplete.bindAsEventListener(this));this.deleteGroupButton=this.frame.down(".delete-group-button");if(this.deleteGroupButton!=null){Event.observe(this.deleteGroupButton,"click",this._onDeleteGroupButtonClick.bindAsEventListener(this))}}else{if(this.frame.down(".settings-section-users")!=null){var d=this.frame.select(".settings-moderate-link");d.each(function(l){var k=$w(l.className)[1];Event.observe(l,"click",this._onSettingsActionClick.bindAsEventListener(this,{userId:k},"moderate"))}.bind(this));var e=this.frame.down(".settings-block-admins").select(".settings-user-remove-link");e.each(function(l){var k=$w(l.className)[1];Event.observe(l,"click",this._onSettingsActionClick.bindAsEventListener(this,{userId:k},"admin-remove"))}.bind(this));var b=this.frame.down(".settings-block-moderators").select(".settings-user-remove-link");b.each(function(l){var k=$w(l.className)[1];Event.observe(l,"click",this._onSettingsActionClick.bindAsEventListener(this,{userId:k},"moderator-remove"))}.bind(this));var a=this.frame.down(".settings-block-online").select(".settings-admin-add-link");a.each(function(l){var k=$w(l.className)[1];Event.observe(l,"click",this._onSettingsActionClick.bindAsEventListener(this,{userId:k},"admin-add"))}.bind(this));var j=this.frame.down(".settings-block-online").select(".settings-moderator-add-link");j.each(function(l){var k=$w(l.className)[1];Event.observe(l,"click",this._onSettingsActionClick.bindAsEventListener(this,{userId:k},"moderator-add"))}.bind(this))}else{if(this.frame.down(".settings-section-moderation-users")!=null){var h=this.frame.down(".settings-section-moderation-users").select(".settings-remove-user-ban-link");h.each(function(l){var k=$w(l.className)[1];Event.observe(l,"click",this._onSettingsActionClick.bindAsEventListener(this,{userId:k},"user-ban-remove"))}.bind(this));var c=this.frame.down(".settings-section-moderation-users").select(".settings-remove-ip-ban-link");c.each(function(l){var k=$w(l.className)[1];Event.observe(l,"click",this._onSettingsActionClick.bindAsEventListener(this,{ipAddress:k},"ip-ban-remove"))}.bind(this));this.addIpBanButton=this.frame.down(".add-ip-ban-button");Event.observe(this.addIpBanButton,"click",this._onSettingsActionClick.bindAsEventListener(this,null,"ip-ban-add"))}else{if(this.frame.down(".settings-section-access-pass")!=null){this.accessPassSettingsForm=this.frame.down(".access-pass-settings-form");this.accessPassSettingsContainer=this.accessPassSettingsForm.down(".access-pass-settings-container");this.accessPassLimitInputContainer=this.accessPassSettingsContainer.down(".access-pass-limit-input-container");this.accessPassEnabledInput=this.accessPassSettingsForm.down(".access-pass-enabled-input");this.accessPassLimitUnlimitedEnabledInput=this.accessPassSettingsContainer.down(".access-pass-limit-unlimited-enabled-input");Event.observe(this.accessPassEnabledInput,"click",this._onAccessPassEnabledInputClick.bindAsEventListener(this));Event.observe(this.accessPassLimitUnlimitedEnabledInput,"click",this._onAccessPassLimitUnlimitedEnabledInputClick.bindAsEventListener(this))}else{if(this.frame.down(".settings-section-sharing")!=null){var i=this.frame.down(".sharing-input");Event.observe(i,"click",function(){var k=$F(i)?true:false;this.frame.select(".sharing-controls").each(function(l){if(k){l.show()}else{l.hide()}})}.bindAsEventListener(this));var f=this.frame.down(".event-url-auto-input");Event.observe(f,"click",function(){var k=this.frame.down(".event-url-input");if($F(f)){k.disable()}else{k.enable()}}.bind(this))}}}}}this.saveButton=this.frame.down(".save-button");if(this.saveButton!=null){this.saveResult=this.frame.down(".save-result");Event.observe(this.saveButton,"click",this._onSaveButtonClick.bindAsEventListener(this))}},setChatApp:function(a){this.chatApp=a},setGroup:function(l){this.group=l;if(this.frame.down(".settings-section-moderation-sticky")!=null){var i=this.frame.down(".settings-block-sticky");var c=function(n){ServiceInterface.updateStickyMessage(this.group.groupId,n,{callback:function(){i.down(".alert-danger").hide();i.down(".alert-success").show();setTimeout(function(){i.down(".alert-success").hide()},2000)}.bind(this),errorHandler:function(){i.down(".alert-success").hide();i.down(".alert-danger").show()}.bind(this)})}.bind(this);Event.observe(i.down(".update-button"),"click",function(){c($F(i.down(".message-input")))}.bindAsEventListener(this));Event.observe(i.down(".clear-button"),"click",function(){i.down(".message-input").value="";c($F(i.down(".message-input")))}.bindAsEventListener(this));var g=this.frame.down(".settings-block-welcome");var j=function(n){ServiceInterface.updateWelcomeMessage(this.group.groupId,n,{callback:function(){g.down(".alert-danger").hide();g.down(".alert-success").show();setTimeout(function(){g.down(".alert-success").hide()},2000)}.bind(this),errorHandler:function(){g.down(".alert-success").hide();g.down(".alert-danger").show()}.bind(this)})}.bind(this);Event.observe(g.down(".update-button"),"click",function(){j($F(g.down(".message-input")))}.bindAsEventListener(this));Event.observe(g.down(".clear-button"),"click",function(){g.down(".message-input").value="";j($F(g.down(".message-input")))}.bindAsEventListener(this))}else{if(this.frame.down(".settings-section-moderation-display")!=null){var a=this.frame.down(".message-posting-input");Event.observe(a,"click",function(){var o=$F(a)?true:false;var n=new ConfirmationPopup();n.setChatApp(this.chatApp);n.setTitle(_("Are you sure?"));n.setContainer(null);if(o){n.setMessage(_("Users will be able to post messages!")+"<br/><br/>")}else{n.setMessage(_("Users will no longer be able to post messages!")+"<br/><br/>")}n.setOnOkCallback(function(){ServiceInterface.setMessagePostingEnabled(this.group.groupId,o,{callback:function(){window.location.replace(window.location.href)}.bind(this),errorHandler:function(){}})}.bind(this));n.setOnCancelCallback(function(){a.setValue(!o)}.bind(this));n.show()}.bindAsEventListener(this));var e=this.frame.down(".speed-form");var f=$F(e.down(".speed-input"));jQuery(".speed-input").slider({min:0,max:5000,step:100,tooltip:"show",reversed:true,value:f,formatter:function(n){if(n>0){return(n/1000)+"s "+_("delay")}else{return _("Instant")}}});Event.observe(e.down(".speed-save-button"),"click",function(){var n=$F(e.down(".speed-input"));ServiceInterface.setPublishInterval(this.group.groupId,n,{callback:function(){e.down(".alert-danger").hide();e.down(".alert-success").show();setTimeout(function(){e.down(".alert-success").hide()},2000)}.bind(this),errorHandler:function(){e.down(".alert-success").hide();e.down(".alert-error").show()}.bind(this)})}.bindAsEventListener(this));var d=this.frame.down(".settings-block-word-filter");Event.observe(d.down(".message-filter-input"),"change",function(){var n=$F(d.down(".message-filter-input"));if(n==0){d.down(".help-block-1").hide();d.down(".help-block-0").show();d.down(".words-input").hide()}else{d.down(".help-block-0").hide();d.down(".help-block-1").show();d.down(".words-input").show()}}.bindAsEventListener(this));Event.observe(d.down(".filter-save-button"),"click",function(){var n=$F(d.down(".message-filter-input"));var o=null;if(n==1){o=$F(this.frame.down(".words-input"))}ServiceInterface.submitGroupSettingsWordFilterForm(this.group.groupId,n,o,{callback:function(p){this._onSaveSuccess(p,"/settings/moderation/display")}.bind(this),errorHandler:this._onSaveError.bind(this)})}.bindAsEventListener(this));var m=this.frame.down(".settings-block-cross-posting");if(m!=null){var k=function(n){ServiceInterface.setCrossPostUrl(this.group.groupId,n,{callback:function(){window.location.replace(window.location.href)}.bind(this),errorHandler:function(){m.down(".alert-success").hide();m.down(".alert-danger").show()}.bind(this)})}.bind(this);Event.observe(m.down(".update-button"),"click",function(){var n=$F(this.frame.down(".cross-post-url-input"));k(n)}.bindAsEventListener(this));Event.observe(m.down(".clear-button"),"click",function(){this.frame.down(".cross-post-url-input").value="";k(null)}.bindAsEventListener(this))}}else{if(this.frame.down(".settings-section-moderation-approval")!=null){var b=this.frame.down(".manual-approval-input");Event.observe(b,"click",function(){var o=$F(b)?true:false;var n=new ConfirmationPopup();n.setChatApp(this.chatApp);n.setTitle(_("Are you sure?"));n.setContainer(null);if(o){n.setMessage(_("Turn on Manual Approval?")+"<br/><br/>"+_("All messages will need to be<br/>manually approved for display!")+"<br/><br/>")}else{n.setMessage(_("Turn off Manual Approval?")+"<br/><br/>"+_("Any messages currently in the<br/>approval queue will be skipped.")+"<br/><br/>")}n.setOnOkCallback(function(){ServiceInterface.setManualApprovalEnabled(this.group.groupId,o,{callback:function(){window.location.replace(window.location.href)}.bind(this),errorHandler:function(){}})}.bind(this));n.setOnCancelCallback(function(){b.setValue(!o)}.bind(this));n.show()}.bindAsEventListener(this));if(this.frame.down(".empty-indicator")!=null){this.approvalQueue=new ApprovalQueue(this.frame.down(".approval-queue"));this.approvalQueue.setChatApp(this.chatApp);this.approvalQueue.setGroup(this.group)}}else{if(this.frame.down(".settings-section-private-chat")!=null){var h=this.frame.down(".private-chat-enabled");Event.observe(h,"click",function(){var n=$F(h)?true:false;if(n){this.frame.down(".private-chat-on").show();this.frame.down(".private-chat-off").hide();this.frame.down(".enabled-controls").show()}else{this.frame.down(".private-chat-on").hide();this.frame.down(".private-chat-off").show();this.frame.down(".enabled-controls").hide()}}.bindAsEventListener(this))}}}}},destroy:function(){this.frame.remove();this.frame=null},_onNameInputKeyup:function(a){this._checkInputLength(this.nameInput,this.nameCharsAvailable,this.nameMaxSize)},_onWelcomeMessageInputKeyup:function(a){this._checkInputLength(this.welcomeMessageInput,this.welcomeMessageCharsAvailable,this.welcomeMessageMaxSize)},_checkInputLength:function(e,d,a){var b=a-e.value.length;if(b<=0){e.value=e.value.substring(0,a);b=0;d.addClassName("text-danger")}else{d.removeClassName("text-danger")}var c=b+((b!=1)?" characters":" character")+" left";d.innerHTML=c},_onImageSubmit:function(a){this.imageUploadProgress.innerHTML="Uploading..."},_onImageUploadComplete:function(){var a=this.imageUploadFrame.contentWindow||this.imageUploadFrame.contentDocument;if(a.document){a=a.document}var b=a.getElementById("image-upload-errors");if(b!=undefined&&b!="undefined"){this.imageUploadProgress.innerHTML="<div class='alert alert-danger'>"+b.innerHTML+"</div>"}else{this.image.src=this.chatApp.clientConfig.baseImagesUrl+a.getElementById("main-image-url").innerHTML;this.imageUploadProgress.innerHTML=""}},_onAccessPassEnabledInputClick:function(){if($F(this.accessPassEnabledInput)==null){this.accessPassSettingsContainer.hide()}else{this.accessPassSettingsContainer.show()}},_onAccessPassLimitUnlimitedEnabledInputClick:function(){if($F(this.accessPassLimitUnlimitedEnabledInput)==null){this.accessPassLimitInputContainer.show()}else{this.accessPassLimitInputContainer.hide()}},_onSaveButtonClick:function(){if(this.frame.down(".settings-section-basic")!=null){ServiceInterface.submitGroupSettingsBasicForm(this.group.groupId,$F(this.frame.down(".name-input")),$F(this.frame.down(".url-input")),$F(this.frame.down(".language-input")),{callback:function(u){this._onSaveSuccess(u,"/settings")}.bind(this),errorHandler:this._onSaveError.bind(this)})}else{if(this.frame.down(".settings-section-access")!=null){var m=$F(this.frame.down(".signin-guest-input"))?true:false;var r=$F(this.frame.down(".signin-chatroll-input"))?true:false;var h=$F(this.frame.down(".signin-facebook-input"))?true:false;var i=$F(this.frame.down(".signin-twitter-input"))?true:false;var n=$F(this.frame.down(".signin-sso-input"))?true:false;ServiceInterface.submitGroupSettingsAccessForm(this.group.groupId,$F(this.frame.down(".free-limit-input")),r,h,i,m,n,{callback:function(u){this._onSaveSuccess(u,"/settings/access")}.bind(this),errorHandler:this._onSaveError.bind(this)})}else{if(this.frame.down(".settings-section-permissions")!=null){this.permissionsSettingsForm=this.frame.down(".permissions-settings-form");var f=Form.getInputs(this.permissionsSettingsForm,"radio","access-input").find(function(u){return u.checked}).value;var l=Form.getInputs(this.permissionsSettingsForm,"radio","links-input").find(function(u){return u.checked}).value;var c=Form.getInputs(this.permissionsSettingsForm,"radio","delete-input").find(function(u){return u.checked}).value;var d=Form.getInputs(this.permissionsSettingsForm,"radio","archive-access-input").find(function(u){return u.checked}).value;var g=Form.getInputs(this.permissionsSettingsForm,"radio","dashboard-access-input").find(function(u){return u.checked}).value;ServiceInterface.submitGroupSettingsPermissionsForm(this.group.groupId,f,l,c,d,g,{callback:function(u){this._onSaveSuccess(u,"/settings/permissions")}.bind(this),errorHandler:this._onSaveError.bind(this)})}else{if(this.frame.down(".settings-section-private-chat")!=null){this.privateChatSettingsForm=this.frame.down(".private-chat-settings-form");var t=$F(this.frame.down(".private-chat-enabled"))?1:0;var q=Form.getInputs(this.privateChatSettingsForm,"radio","pm-input").find(function(u){return u.checked}).value;ServiceInterface.submitGroupSettingsPrivateChatForm(this.group.groupId,t,q,{callback:function(u){this._onSaveSuccess(u,"/settings/private-chat")}.bind(this),errorHandler:this._onSaveError.bind(this)})}else{if(this.frame.down(".settings-section-sharing")!=null){var s=$F(this.frame.down(".sharing-input"))?true:false;var e=$F(this.frame.down(".event-url-input"));var j=$F(this.frame.down(".event-url-auto-input"))?true:false;var b=$F(this.frame.down(".twitter-message-input"));ServiceInterface.submitGroupSettingsSharingForm(this.group.groupId,s,e,j,b,{callback:function(u){this._onSaveSuccess(u,"/settings/sharing")}.bind(this),errorHandler:this._onSaveError.bind(this)})}else{if(this.frame.down(".settings-section-access-pass")!=null){var p=null;var a=null;var k=$F(this.accessPassEnabledInput);if(k==null){k=false}else{p=$F(this.accessPassSettingsForm.down(".access-pass-price-input"));var o=$F(this.accessPassLimitUnlimitedEnabledInput);if(o==null){a=$F(this.accessPassSettingsForm.down(".access-pass-limit-input"))}}ServiceInterface.submitGroupSettingsAccessPassForm(this.group.groupId,k,a,p,{callback:function(u){this._onSaveSuccess(u,"/settings/payments/access-pass")}.bind(this),errorHandler:this._onSaveError.bind(this)})}}}}}}},_onSaveSuccess:function(b,a){window.location.replace(this.chatApp.clientConfig.baseWebUrl+"/"+b.url+a)},_onSaveError:function(e,d){var f="";var b=d.fieldErrors;if(b!=null){f="<ul>";for(var c=0,a=b.length;c<a;++c){f+="<li>"+b[c].defaultMessage+"</li>"}f+="</ul>"}this.saveResult.innerHTML="Sorry! Your settings could not be saved due to the following error(s):<br/>"+f;this.saveResult.show()},_onSettingsActionClick:function(g,a,d){switch(d){case"moderate":Event.stop(g);var h=new ContactListPopup();h.setChatApp(this.chatApp);h.setGroup(this.group);var b=this.chatApp.profileManager.getProfile(a.userId);h.setProfile(b);break;case"admin-add":ServiceInterface.modifyUserPermissions(this.group.groupId,a.userId,true,true,[4,6],{callback:function(){window.location.replace(window.location.href)},errorHandler:function(){}});break;case"moderator-add":ServiceInterface.modifyUserPermissions(this.group.groupId,a.userId,true,true,[6],{callback:function(){window.location.replace(window.location.href)},errorHandler:function(){}});break;case"admin-remove":ServiceInterface.modifyUserPermissions(this.group.groupId,a.userId,false,true,[4,6],{callback:function(){window.location.replace(window.location.href)},errorHandler:function(){}});break;case"moderator-remove":ServiceInterface.modifyUserPermissions(this.group.groupId,a.userId,false,true,[6],{callback:function(){window.location.replace(window.location.href)},errorHandler:function(){}});break;case"user-ban-add":ServiceInterface.banUser(this.group.groupId,a.userId,{callback:function(){window.location.replace(window.location.href)},errorHandler:function(){}});break;case"user-ban-remove":ServiceInterface.modifyUserPermissions(this.group.groupId,a.userId,false,false,[7],{callback:function(){window.location.replace(window.location.href)},errorHandler:function(){}});break;case"ip-ban-add":var i=$F(this.frame.down(".ip-ban-address"));var c=$F(this.frame.down(".ip-ban-duration-value"));var j=$F(this.frame.down(".ip-ban-duration-unit"));var f=this.frame.down(".ip-ban-result");ServiceInterface.banIp(this.group.groupId,i,c,j,{callback:function(){window.location.replace(window.location.href)},errorHandler:function(){f.show();f.innerHTML="Failed to ban IP."}});break;case"ip-ban-remove":ServiceInterface.modifyDeniedIpPermissions(this.group.groupId,a.ipAddress,false,[7],0,{callback:function(){window.location.replace(window.location.href)},errorHandler:function(){}});break}},_onDeleteGroupButtonClick:function(){var a=new ConfirmationPopup();a.setChatApp(this.chatApp);a.setTitle(_("Are you sure?"));a.setMessage(this.group.nameHtmlWbr+" "+_("will be <b>permanently</b> deleted.<div style='color:#ff0000;font-weight:bold;padding-top:5px;'>It will be gone forever!</div>"));a.setOnOkCallback(this._onDeleteConfirmation.bind(this));a.setContainer(null);a.show()},_onDeleteConfirmation:function(){ServiceInterface.deleteGroup(this.group.groupId,{callback:function(){location.replace("/")}.bind(this),errorHandler:function(){}})}};var GroupAnalyticsWidget=Class.create();GroupAnalyticsWidget.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a;this.datePickerFormat="MMM D, YYYY";this.chart=new ChartManager()},setChatApp:function(a){this.chatApp=a;this.chart.setChatApp(goChatApp)},setGroup:function(c){this.group=c;var a={Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]};var b="Last 7 Days";this.startDate=a[b][0].startOf("day");this.endDate=a[b][1].endOf("day");this.updateCharts();jQuery("#datepicker").daterangepicker({startDate:this.startDate,endDate:this.endDate,minDate:moment().subtract(18,"months"),maxDate:moment(),locale:{format:this.datePickerFormat},ranges:a,opens:"left",alwaysShowCalendars:true},function(f,d,e){this.startDate=f;this.endDate=d;this.updatePicker(e);if(e=="Today"||e=="Yesterday"){jQuery("#time-unit").val("hour")}else{if(e!=null&&e!="Custom Range"){jQuery("#time-unit").val("day")}}this.updateCharts()}.bind(this));this.updatePicker(b);jQuery("#time-unit").change(function(){this.updateCharts()}.bind(this))},destroy:function(){},updatePicker:function(a){var b;if(a!=null&&a!="Custom Range"){b=a}else{b=this.startDate.format(this.datePickerFormat)+" - "+this.endDate.format(this.datePickerFormat)}jQuery("#datepicker span").html(b)},updateCharts:function(){var d=$("account-user-id").innerHTML;var a=this.startDate.unix()*1000;var c=this.endDate.unix()*1000;var g=400;var e=jQuery("#time-unit").val();while(true){var b=moment.duration(1,e+"s").asSeconds();var f=(c-a)/1000/b;if(f>g){if(e=="hour"){e="day"}else{if(e=="day"){jQuery("#time-unit").val("month")}else{break}}jQuery("#time-unit").val(e)}else{break}}if(e=="hour"){c=Math.min(c,moment().unix()*1000)}this.chart.render({element:$("counter-users"),chartType:"counter"},{eventName:"Connected",beginTime:a,endTime:c,timeUnit:"all",type:"unique",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-users"),chartType:"line",seriesLabel:"Users"},{eventName:"Connected",beginTime:a,endTime:c,timeUnit:e,type:"unique",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("counter-users-account"),chartType:"counter"},{eventName:"Connected",beginTime:a,endTime:c,timeUnit:"all",type:"unique",filters:{tenantUserId:d}});this.chart.render({element:$("chart-users-account"),chartType:"line",seriesLabel:"Users"},{eventName:"Connected",beginTime:a,endTime:c,timeUnit:e,type:"unique",filters:{tenantUserId:d}});this.chart.render({element:$("counter-simultaneous-users"),chartType:"counter"},{eventName:"Connected",beginTime:a,endTime:c,timeUnit:"all",type:"max",on:"connectedCount",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-simultaneous-users"),chartType:"line",seriesLabel:"Max. Simultaneous Users"},{eventName:"Connected",beginTime:a,endTime:c,timeUnit:e,type:"max",on:"connectedCount",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("counter-total-sessions"),chartType:"counter"},{eventName:"Disconnected",beginTime:a,endTime:c,timeUnit:"all",type:"count",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-total-sessions"),chartType:"line",seriesLabel:"Chat Sessions"},{eventName:"Disconnected",beginTime:a,endTime:c,timeUnit:e,type:"count",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("counter-average-session-time"),chartType:"counter",units:"minutes"},{eventName:"Disconnected",beginTime:a,endTime:c,timeUnit:"all",type:"avg",on:"connectedDuration",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-average-session-time"),chartType:"line",seriesLabel:"Avg. Chat Time (Minutes)",units:"minutes"},{eventName:"Disconnected",beginTime:a,endTime:c,timeUnit:e,type:"avg",on:"connectedDuration",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("counter-total-session-time"),chartType:"counter",units:"hours"},{eventName:"Disconnected",beginTime:a,endTime:c,timeUnit:"all",type:"sum",on:"connectedDuration",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-total-session-time"),chartType:"line",seriesLabel:"Total Chat Time (Hours)",units:"hours"},{eventName:"Disconnected",beginTime:a,endTime:c,timeUnit:e,type:"sum",on:"connectedDuration",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("counter-messages-sent"),chartType:"counter"},{eventName:"Message Sent",beginTime:a,endTime:c,timeUnit:"all",type:"count",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-messages-sent"),chartType:"line",seriesLabel:"Messages Sent"},{eventName:"Message Sent",beginTime:a,endTime:c,timeUnit:e,type:"count",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("counter-messages-received"),chartType:"counter"},{eventName:"Message Sent",beginTime:a,endTime:c,timeUnit:"all",type:"sum",on:"deliveredCount",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-messages-received"),chartType:"line",seriesLabel:"Messages Delivered"},{eventName:"Message Sent",beginTime:a,endTime:c,timeUnit:e,type:"sum",on:"deliveredCount",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("counter-messages-sent-users"),chartType:"counter"},{eventName:"Message Sent",beginTime:a,endTime:c,timeUnit:"all",type:"unique",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-messages-sent-users"),chartType:"line",seriesLabel:"Users"},{eventName:"Message Sent",beginTime:a,endTime:c,timeUnit:e,type:"unique",filters:{tenantUserId:d,groupId:this.group.groupId}});this.chart.render({element:$("chart-share-button-clicks"),chartType:"line"},{eventName:"Ad Click",beginTime:a,endTime:c,timeUnit:e,type:"count",filters:{tenantUserId:d,groupId:this.group.groupId},segments:[{label:"Facebook Share Clicks",filters:{url:"facebook-share"}},{label:"Twitter Share Clicks",filters:{url:"twitter-share"}}]});this.chart.render({element:$("counter-total-session-time-account"),chartType:"counter",units:"hours"},{eventName:"Disconnected",beginTime:a,endTime:c,timeUnit:"all",type:"sum",on:"connectedDuration",filters:{tenantUserId:d}});this.chart.render({element:$("chart-total-session-time-account"),chartType:"line",seriesLabel:"Total Chat Time (Hours)",units:"hours"},{eventName:"Disconnected",beginTime:a,endTime:c,timeUnit:e,type:"sum",on:"connectedDuration",filters:{tenantUserId:d}});this.chart.render({element:$("chart-users-by-signin"),chartType:"line"},{eventName:"Connected",beginTime:a,endTime:c,timeUnit:e,type:"unique",filters:{tenantUserId:d,groupId:this.group.groupId},segments:[{label:"Chatroll",filters:{signinMethod:"chatroll"}},{label:"Guest",filters:{signinMethod:"guest"}},{label:"Facebook",filters:{signinMethod:"facebook"}},{label:"Twitter",filters:{signinMethod:"twitter"}},{label:"Single Sign-On",filters:{signinMethod:"sso"}}]})}};var GroupArchiveWidget=Class.create();GroupArchiveWidget.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a;this.messageTiles=new Hash();this.messagesContainer=this.frame.down(".archive-messages-container");this.onMessageDeleteListener=this._onMessageDelete.bindAsEventListener(this)},setChatApp:function(a){this.chatApp=a},setGroup:function(e){this.group=e;this.group.addMessageDeleteListener(this.onMessageDeleteListener);if(this.messagesContainer!=null){var d=this.messagesContainer.select(".message");for(var b=0;b<d.length;b++){var a=d[b];var c=new MessageTile();c.setChatApp(this.chatApp);c.setGroup(this.group);c.initializeFromElement(a);this.messageTiles.set(c.message.messageId,c)}}},destroy:function(){var b=this.messageTiles.values();for(var a=0;a<b.length;a++){b[a].destroy()}this.messageTiles=null},_onMessageDelete:function(b){if(b.messageId!=0){var a=this.messageTiles.unset(b.messageId);if(a!=null){a.destroy()}}else{var c=this.messagesContainer.select("."+b.userId);c.each(function(e){var d=$w(e.className)[1];this.messageTiles.unset(d).destroy()}.bind(this))}}};var GroupArchiveExportWidget=Class.create();GroupArchiveExportWidget.prototype={initialize:function(a){this.frame=a;this.chatApp=null;this.group=null},setChatApp:function(a){this.chatApp=a},setGroup:function(c){this.group=c;var b=function(){var h=$F(this.frame.down(".archive-export-begin-year"));var i=$F(this.frame.down(".archive-export-begin-month"));var g=$F(this.frame.down(".archive-export-begin-day"));var f=$F(this.frame.down(".archive-export-begin-hour"));var e=$F(this.frame.down(".archive-export-begin-minute"));var d=new Date();d.setFullYear(h);d.setMonth(i);d.setDate(g);d.setHours(f);d.setMinutes(e,0,0);return d.getTime()}.bind(this);var a=function(){var i=$F(this.frame.down(".archive-export-end-year"));var d=$F(this.frame.down(".archive-export-end-month"));var h=$F(this.frame.down(".archive-export-end-day"));var g=$F(this.frame.down(".archive-export-end-hour"));var f=$F(this.frame.down(".archive-export-end-minute"));var e=new Date();e.setFullYear(i);e.setMonth(d);e.setDate(h);e.setHours(g);e.setMinutes(f,0,0);return e.getTime()}.bind(this);Event.observe(this.frame.down(".export-button"),"click",function(){var d=this.chatApp.clientConfig.baseWebUrl+"/"+this.group.url+"/archive-download?beginTime="+b()+"&endTime="+a();window.open(d,"_blank","status=0,toolbar=0,location=1,menubar=1,resizable=1,scrollbars=1,width=600,height=400")}.bind(this))},destroy:function(){this.frame.remove();this.frame=null}};var GroupSettingsAppearanceWidget=Class.create();GroupSettingsAppearanceWidget.prototype={initialize:function(a){this.chatApp=null;this.group=null;this.frame=a},setChatApp:function(a){this.chatApp=a},setGroup:function(a){this.group=a;this.fgColorInput=this.frame.down("#fgcolor-value");this.bgColorInput=this.frame.down("#bgcolor-value");this.textFgColorInput=this.frame.down("#textfgcolor-value");this.textBgColorInput=this.frame.down("#textbgcolor-value");jQuery("#fgcolor-picker").colorpicker({format:"hex"}).on("changeColor",this._updatePreview.bindAsEventListener(this));jQuery("#bgcolor-picker").colorpicker({format:"hex"}).on("changeColor",this._updatePreview.bindAsEventListener(this));jQuery("#textfgcolor-picker").colorpicker({format:"hex"}).on("changeColor",this._updatePreview.bindAsEventListener(this));jQuery("#textbgcolor-picker").colorpicker({format:"hex"}).on("changeColor",this._updatePreview.bindAsEventListener(this));this.showBorderInput=this.frame.down(".customize-embed-showborder-input");Event.observe(this.showBorderInput,"change",this._updatePreview.bindAsEventListener(this));this.soundInput=this.frame.down(".customize-embed-sound-input");Event.observe(this.frame.down(".clear-button"),"click",function(){ServiceInterface.clearRecentMessages(this.group.groupId,{callback:function(){window.location.replace(window.location.href)}.bind(this),errorHandler:function(){this.frame.down(".clear-error").show()}.bind(this)})}.bind(this));Event.observe(this.frame.down(".save-button"),"click",this._onSaveButtonClick.bindAsEventListener(this));this.saveResult=this.frame.down(".save-result");this._updatePreview()},_onSaveButtonClick:function(){var a=$F(this.fgColorInput).substr(1);var k=$F(this.bgColorInput).substr(1);var n=$F(this.textFgColorInput).substr(1);var j=$F(this.textBgColorInput).substr(1);var e=$F(this.showBorderInput)?true:false;var l=$F(this.soundInput)?true:false;var c=$F(this.frame.down(".contact-list-position-input"));var h=$F(this.frame.down(".message-order-input"));var f=$F(this.frame.down(".recent-messages-interval-value"));var b=$F(this.frame.down(".recent-messages-interval-unit"));var m=1;switch(b){case"days":m=86400;break;case"hours":m=3600;break;case"minutes":m=60;break}var d=parseInt(f)*m;var i=null;if(this.frame.down(".hide-links-input")!=null){i=$F(this.frame.down(".hide-links-input"))?true:false}var g=$F(this.frame.down(".css-input"));this.saveResult.hide();ServiceInterface.submitGroupSettingsAppearanceForm(this.group.groupId,a,k,n,j,e,c,l,d,h,i,g,{callback:function(){this._onSaveSuccess()}.bind(this),errorHandler:this._onSaveError.bind(this)})},_onSaveSuccess:function(){window.location.replace(window.location.href)},_onSaveError:function(e,d){var f="";var b=d.fieldErrors;if(b!=null){f="<ul>";for(var c=0,a=b.length;c<a;++c){f+="<li>"+b[c].defaultMessage+"</li>"}f+="</ul>"}this.saveResult.innerHTML="Sorry! Your settings could not be saved due to the following error(s):<br/>"+f;this.saveResult.show()},_updatePreview:function(){var l=$F(this.bgColorInput).substr(1);var g=$F(this.fgColorInput).substr(1);var f=$F(this.textBgColorInput).substr(1);var j=$F(this.textFgColorInput).substr(1);var c=380;var k=280;var i=$F(this.showBorderInput);this.frame.down(".customize-preview-container").setStyle({background:"#"+l});var h=8;var b=2;if(i==null){h=1;b=1}var e=90;var a=70;if(Math.round(c)>Math.round(k)){a=Math.round(k/c*e)}else{e=Math.round(c/k*a)}this.frame.down(".preview-window-box").setStyle({background:"#"+f,width:e+"px",height:a+"px",border:b+"px solid #"+g,borderTop:h+"px solid #"+g});var d=b+"px solid #"+g;if(c<350){d="0"}this.frame.down(".preview-message-window").setStyle({background:"#"+f,color:"#"+j,width:(e-2*b-10)+"px",height:(a-b-h-10)+"px",borderRight:d});this.frame.down(".preview-input-box").setStyle({borderTop:b+"px solid #"+g})}};var goTemplates={};goTemplates["site-confirmation-popup"]=function(c){var a=[];a.push('<div class="confirmation-popup-border popup-border">\n\t<div class="popup-shadow"></div>\n\t<div class="popup-title"></div>\n\t<div class="popup-content">\n\t\t<div class="confirmation-message"></div>\n\t\t<div>\n\t\t\t<input class="popup-button popup-blue-button confirmation-ok-button" style="width:60px;margin:5px;" type="button" value="OK"/>\n\t\t\t<input class="popup-button confirmation-cancel-button" style="width:60px;margin:5px;" type="button" value="Cancel"/>\n\t\t</div>\n\t</div>\n\t<div class="confirmation-close-button popup-close-button">X</div>\n</div>');return a.join("")};goTemplates["profile:small-tile"]=function(c){var a=[];a.push('<div class="');a.push(c.userId);a.push(' profile-small-tile">\n\t<div class="valign" style="height:38px;"><div class="valign-in1"><div class="valign-in2 profile-icon-image-border">\n\t');a.push(c.iconImageHTML);a.push('</div></div></div>\n\t<div class="tiny" style="font-weight:bold;">');a.push(c.displayNameHTML);a.push("</div>\n</div>");return a.join("")};goTemplates["profile:contact-list-item"]=function(c){var a=[];a.push('<div class="contact-list-status-icon"><div class="status-icon status-icon-');a.push(c.statusIcon);a.push('" title="');a.push(c.statusName);a.push('"></div></div>\n<div class="contact-list-profile-name">');a.push(c.displayNameHTML);a.push('</div>\n<div class="contact-list-profile-image">');a.push(c.tinyImageHTML);a.push("</div>");return a.join("")};goTemplates["profile:contact-list-popup"]=function(c){var a=[];a.push('<div class="popup-border" style="width:190px;">\n\t<div class="popup-shadow"></div>\n\t<div class="popup-title">');a.push(c.profile.displayNameHtml);a.push('</div>\n\t<div class="popup-content">\n\t\t<div style="text-align:left;position:relative;height:48px;">\n\t\t\t<div style="position:absolute;">');a.push(c.iconImageHTML);a.push('</div>\n\t\t\t<div style="padding:10px 0 0 46px;">');a.push(c.displayNameHTML);a.push('</div>\n\t\t</div>\n\t\t<input class="popup-button invite-button" style="width:140px;display:none;" type="button" value="');a.push(c._("Re-invite user"));a.push('"/>\n\t\t<input class="popup-button pm-show-button" style="width:140px;display:none;" type="button" value="');a.push(c._("Start private chat"));a.push('"/>\n\t\t<div class="moderator-control" style="display:none; padding-top:10px">\n\t\t\t<div style="font-weight:bold;">');a.push(c._("Moderation"));a.push('</div>\n\t\t\t<input class="popup-button delete-button" style="width:140px;" type="button" value="');a.push(c._("Delete all messages"));a.push('"/>\n\t\t\t<input class="popup-button ban-button" style="width:140px;" type="button" value="');a.push(c._("Block user"));a.push('"/>\n\t\t</div>\n\t\t<div class="status"></div>\n\t</div>\n\t<div class="popup-close-button">X</div>\t\n</div>');return a.join("")};goTemplates["group:message-list"]=function(c){var a=[];a.push('<div class="chat-messages-container "><div class="chat-messages">\n    <div class="chat-history-controls" style="display:none;">\n        <a class="chat-history-load" href="javascript:void(0)">');a.push(c._("Load Earlier Messages"));a.push('</a>\n    </div><div class="chat-welcome-message">\n        ');a.push(c.welcomeMessage);a.push("</div></div></div>");return a.join("")};goTemplates["group:message-input"]=function(c){var a=[];a.push('<div class="chat-input-wrapper ">\n    <textarea class="chat-input" placeholder="');a.push(c._("Type a message and press enter"));a.push('" onfocus="this.placeholder = \'\'" onblur="this.placeholder = \'');a.push(c._("Type a message and press enter"));a.push('\'"></textarea>\n    <div class="chat-input-status" style="display:none">\n        <div class="chat-input-approval">');a.push(c._("Waiting for moderator approval..."));a.push('</div>\n        <div class="chat-input-progress-border"><div class="chat-input-progress-container"><div class="chat-input-progress"></div></div></div>\n    </div>\n    <div class="chat-input-closed" style="display:none;">\n        <div class="chat-input-closed-message">');a.push(c._("This chat is closed."));a.push("</div>\n    </div>\n</div>");return a.join("")};goTemplates["group:chat-list-item"]=function(c){var a=[];a.push('<div class="chat-list-item">\n    <div class="chat-list-item-new-indicator"></div>\n    <div class="chat-list-item-label"></div>\n    <div class="chat-list-item-close-button"><img src="/t.gif" /></div>\n</div>');return a.join("")};goTemplates["group:send-invite-popup"]=function(c){var a=[];a.push('<div class="popup-border" style="width:190px;">\n\t<div class="popup-shadow"></div>\n\t<div class="popup-title">');a.push(c._("Invite User"));a.push('</div>\n\t<div class="popup-content">\n\t\t<div style="text-align:left;position:relative;">\n            ');a.push(c._("Search by username:"));a.push('\n        </div>\n\t\t<div class="padding-5"></div>\n\t\t<div style="position:relative;height:26px;">\n\t\t\t<input class="search-input" style="position:absolute;left:0;top:1px;width:95px;" type="input" maxlength="64"/>\n\t\t\t<input class="popup-button popup-blue-button search-button" style="position:absolute;right:0;margin:0;" type="button" value="');a.push(c._("Search"));a.push('"/>\n\t\t</div>\n\t\t<div class="padding-5"></div>\n\t\t<div class="search-results" style="height:130px;">\n\t\t\t<div class="search-result" style="height:31px;position:relative;">\n\t\t\t\t<div class="invite-username" style="position:absolute;left:5px;top:5px;">arlen</div>\n\t\t\t\t<input class="popup-button invite-button" style="position:absolute;right:0;margin:0;" type="button" value="');a.push(c._("Invite"));a.push('"/>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="padding-5"></div>\n\t</div>\n\t<div class="popup-close-button">X</div>\t\n</div>');return a.join("")};goTemplates["group:group-invite-popup"]=function(c){var a=[];a.push('<div class="popup-border" style="width:190px;">\n\t<div class="popup-shadow"></div>\n\t<div class="popup-title">');a.push(c._("New Chat Request"));a.push('</div>\n\t<div class="popup-content">\n\t\t<div class="padding-5"></div>\n\t\t<div style="text-align:left;position:relative;">\n            ');a.push(c._("You have been invited to chat with:"));a.push('\n        </div>\n\t\t<div class="padding-10"></div>\n\t\t<div style="text-align:left;position:relative;">\n\t\t\t<div style="position:absolute;">');a.push(c.iconImageHTML);a.push('</div>\n\t\t\t<div style="padding:12px 0 12px 45px;font-weight:bold;">');a.push(c.displayNameHTML);a.push('</div>\n\t\t</div>\n\t\t<div class="padding-10"></div>\n\t\t<div class="moderator-control">\n\t\t\t<input class="popup-button accept-button" style="display:inline-block;width:60px;" type="button" value="');a.push(c._("Accept"));a.push('"/>\n\t\t\t<input class="popup-button decline-button" style="display:inline-block;width:60px;" type="button" value="');a.push(c._("Decline"));a.push('"/>\n\t\t</div>\n\t\t<div class="padding-5"></div>\n\t</div>\n\t<div class="popup-close-button">X</div>\t\n</div>');return a.join("")};goTemplates["group:private-message-popup"]=function(c){var a=[];a.push('<div class="popup-border" style="width:240px;">\n\t<div class="popup-shadow"></div>\n\t<div class="popup-title">');a.push(c.title);a.push('</div>\n\t<div class="popup-content">\n\t\t<div style="text-align:left;position:relative;">\n\t\t\t<div style="position:absolute;">');a.push(c.iconImageHTML);a.push('</div>\n\t\t\t<div style="padding:12px 0 12px 45px;font-weight:bold;">');a.push(c.displayNameHTML);a.push('</div>\n\t\t</div>\n\t\t<div class="pm-message" style="display:none; padding:10px 5px; text-align:left;">');a.push(c.message);a.push('</div>\n\t\t<div class="pm-reply">\n\t\t\t<div class="padding-5" style="text-align:left">\n\t\t\t\t<span class="pm-action-label">');a.push(c.actionLabel);a.push('</span><span class="pm-price-label"> for<br/> <b>5 Credits</b> or <b>FREE</b> with a <b><a href="#" onclick=\'goChatApp.fireGroupUiAction(BluePassOfferPopup.SHOW_POPUP);return false;\'>Blue Pass</a></b></span>:\n\t\t\t</div>\n\t\t\t<div class="padding-2"></div>\n\t\t\t<input class="pm-input" style="width:96%" type="input" maxlength="256"/>\n\t\t\t<div class="padding-10"></div>\n\t\t\t<input class="pm-send-button" type="button" value="Send"/>&nbsp;<input class="pm-cancel-button" type="button" value="Close"/>\n\t\t\t<div class="padding-5"></div>\n\t\t\t<div class="status"></div>\n\t\t</div>\n\t</div>\n\t<div class="popup-close-button">X</div>\t\n</div>');return a.join("")};goTemplates["group:approval-message-tile"]=function(c){var a=[];a.push('<div class="approval-message-tile ');a.push(c.message.messageId);a.push('" style="position:relative;margin:4px;padding:2px 80px 6px 2px;color:#525252;">\n\t<div class="message-content">\n\t\t<div class="message-timestamp">');a.push(c.timestamp);a.push('</div>\n\t\t<span class="message-profile-name"></span>: <span class="message-text">');a.push(c.message.textHtml);a.push('</span>\n\t</div>\n\t<div class="message-profile-image"></div>\n\t<div class="message-approve-button" style="position:absolute;cursor:pointer;top:4px;right:42px;width:32px;height:32px;border:1px solid #888;background:#91cc00;"></div>\n\t<div class="message-skip-button" style="position:absolute;cursor:pointer;top:4px;right:4px;width:32px;height:32px;border:1px solid #888;background:#f96868;"></div>\n</div>');return a.join("")};goTemplates["group-item:bookmark-tile"]=function(c){var a=[];a.push('<div class="group-item ');a.push(c.item.itemId);a.push('">\n\t<span class="item-jsobj" style="display:none;">myObject=null</span>\n\t<div style="position:relative;">\n\t\t<a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">\n\t\t\t<img class="item-image highlight" title="');a.push(c.item.title);a.push('" src="');a.push(c.item.imageUrl);a.push('"/>\n\t\t</a>\n\t\t<div class="group-item-delete-button" style="display:none;"><img class="button-delete clickable" title="Delete" src="/t.gif"/></div>\t\t\n\t</div>\n\t<div class="group-item-title">\n\t\t<a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow" style="font-size:0.85em;">');a.push(c.item.title);a.push("</a>\n\t</div>\n</div>");return a.join("")};goTemplates["group-item:bookmark-tile-small"]=function(c){var a=[];a.push('<div class="group-item-small ');a.push(c.item.itemId);a.push('">\n\t<div class="group-item-small-image-container">\n\t\t<a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">\t\t\t\t\n\t\t\t<img class="item-image highlight" style="width:45px;height:35px;" title="');a.push(c.item.title);a.push('" src="');a.push(c.item.imageUrl);a.push('"/>\n\t\t</a>\n\t</div>\n\t<div class="group-item-small-title"><a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">');a.push(c.item.title);a.push('</a></div>\n\t<span class="item-jsobj" style="display:none;">myObject=null</span>\t\n</div>\n');return a.join("")};goTemplates["group-item:image-tile"]=function(c){var a=[];a.push('<div class="group-item ');a.push(c.item.itemId);a.push('">\n\t<span class="item-jsobj" style="display:none;">myObject=null</span>\n\t<div style="position:relative;">\n\t\t<a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">\n\t\t\t<img class="item-image highlight" title="');a.push(c.item.url.name);a.push('" src="');a.push(c.item.imageUrl);a.push('"/>\n\t\t</a>\n\t\t<div class="group-item-delete-button" style="display:none;"><img class="button-delete clickable" title="Delete" src="/t.gif"/></div>\t\t\n\t</div>\n\t<div class="group-item-title">\n\t\t<a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow" style="font-size:0.85em;">');a.push(c.item.url.nameHtmlWbr);a.push("</a>\n\t</div>\n</div>");return a.join("")};goTemplates["group-item:image-tile-small"]=function(c){var a=[];a.push('<div class="group-item-small ');a.push(c.item.itemId);a.push('">\n\t<div class="group-item-small-image-container">\n\t\t<a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">\t\t\t\t\n\t\t\t<img class="item-image highlight" style="width:45px;height:35px;" title="');a.push(c.item.url.name);a.push('" src="');a.push(c.item.imageUrl);a.push('"/>\n\t\t</a>\n\t</div>\n\t<div class="group-item-small-title"><a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">');a.push(c.item.url.nameHtmlWbr);a.push('</a></div>\n\t<span class="item-jsobj" style="display:none;">myObject=null</span>\n</div>\n');return a.join("")};goTemplates["group-item:video-tile"]=function(c){var a=[];a.push('<div class="group-item ');a.push(c.item.itemId);a.push('">\n\t<span class="item-jsobj" style="display:none;">myObject=null</span>\n\t<div style="position:relative;">\n\t\t<a href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">\n\t\t\t<img class="item-image highlight" title="');a.push(c.item.title);a.push('" src="');a.push(c.item.imageUrl);a.push('"/>\n\t\t</a>\n\t\t<a href="');a.push(c.item.url.name);a.push('" class="play-button" style="position:absolute;top:47px;left:44px;" href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">\n\t\t\t<img class="button-play" alt="Play" src="/t.gif"/>\n\t\t</a>\n\t\t<div class="group-item-delete-button" style="display:none;"><img class="button-delete clickable" title="Delete" src="/t.gif"/></div>\t\n\t</div>\n\t<div class="group-item-title">\n\t\t<a class="group-item-show-button" href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow" style="font-size:0.85em;">');a.push(c.item.title);a.push("</a>\n\t</div>\n</div>");return a.join("")};goTemplates["group-item:video-tile-small"]=function(c){var a=[];a.push('<div class="group-item-small ');a.push(c.item.itemId);a.push('">\n\t<div class="group-item-small-image-container">\n\t\t<a class="group-item-show-button" href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">\t\t\t\t\n\t\t\t<img class="item-image highlight" style="width:45px;height:35px;cursor:pointer;" title="');a.push(c.item.title);a.push('" src="');a.push(c.item.imageUrl);a.push('"/>\n\t\t</a>\n\t</div>\n\t<div class="group-item-small-title" style="height:1.1em;">\n\t\t<a class="group-item-show-button" style="font-size:0.85em; overflow:hidden;" href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">');a.push(c.item.title);a.push('</a>\n\t</div>\n\t<div style="padding-left:53px;"><a class="group-item-show-button" href="');a.push(c.item.url.name);a.push('" target="_blank" rel="nofollow">\n\t\t<img class="button-play" alt="Play" src="/t.gif"/>\n\t</a></div>\n\t<span class="item-jsobj" style="display:none;">myObject=null</span>\n</div>\n');return a.join("")};goTemplates["group-item:discussion-tile"]=function(c){var a=[];a.push('<div class="group-item ');a.push(c.item.itemId);a.push(' discussion-group-item-tile">\n\t<span class="item-jsobj" style="display:none;">myObject=null</span>\n\t<div class="group-item-profile profile-small-tile" style="margin:0px; height:52px;"></div>\n\t<div style="padding-left:65px;">\n\t\t<div style="height:1.2em; overflow:hidden; font-weight:bold;">\n\t\t\t<a class="group-item-show-button" href="javascript:void(0);">');a.push(c.item.titleHtmlWbr);a.push('</a>\n\t\t</div>\n\t\t<div class="group-item-description">\n\t\t\t');a.push(c.item.descriptionShortHtml);a.push('</div>\n\t</div>\n\t<div class="group-item-delete-button" style="display:none;top:3px;"><img class="button-delete clickable" title="Delete" src="/t.gif"/></div>\t\n</div>');return a.join("")};goTemplates["group-item:discussion-tile-small"]=function(c){var a=[];a.push('<div class="group-item-small ');a.push(c.item.itemId);a.push('">\n\t<div class="group-item-small-image-container">\n\t\t<div class="valign" style="height:38px; width:38px;"><div class="valign-in1"><div class="valign-in2 profile-icon-image-border" style="border:none;">\n\t\t\t</div></div></div>\n\t</div>\n\t<div class="group-item-small-title" style="padding-left:46px;">\n\t\t<a class="group-item-show-button group-item-group-link" target="_blank" href="/">');a.push(c.item.titleHtmlWbr);a.push('</a>\n\t</div>\n\t<span class="item-jsobj" style="display:none;">myObject=null</span>\n</div>\n');return a.join("")};goTemplates["message:chat-message-tile"]=function(c){var a=[];a.push('<div class="message ');a.push(c.message.messageId);a.push(" ");a.push(c.message.userId);a.push(" ");a.push(c.message.type);a.push('  ">\n\t<div class="message-content">\n\t\t<div class="message-timestamp">');a.push(c.timestamp);a.push('</div>\n\t\t<span class="message-profile-name" ></span>: <span class="message-text">');a.push(c.message.textHtml);a.push('</span>\n\t\t<div class=\'message-group-items\'>\n\t\t\t</div>\n\t</div>\n\t<div class="message-profile-image"></div>\n\t<div class="message-cross-post-button" style="display:none;"><img class="button-cross-post clickable" title="Cross Post" src="/t.gif"/></div>\n\t<div class="message-delete-button" style="display:none;"><img class="button-delete clickable" title="Delete" src="/t.gif"/></div>\n</div>');return a.join("")};goTemplates["message:group-invite-message-tile"]=function(c){var a=[];a.push('<div class="message">\n\t<div class="message-text" style="text-align:center">\n\t\t');a.push(c._("You have been invited to chat"));a.push('\n\t</div>\n\t<div class="padding-5"></div>\n\t<div style="text-align:center">\n\t\t<input class="popup-button accept-button" style="display:inline-block;width:70px;" type="button" value="');a.push(c._("Accept"));a.push('"/>\n\t\t&nbsp;\n\t\t<input class="popup-button decline-button" style="display:inline-block;width:70px;" type="button" value="');a.push(c._("Decline"));a.push('"/>\n\t</div>\n</div>');return a.join("")};goTemplates["message:comment-post-tile"]=function(c){var a=[];a.push('<div class="message ');a.push(c.message.messageId);a.push(" ");a.push(c.message.userId);a.push(" ");a.push(c.message.type);a.push('">\n\t<div class="message-content">\n\t\t<span class="message-timestamp">');a.push(c.timestamp);a.push('</span><br/>\n\t\t<span class="message-profile-name" ></span>&nbsp;<span class="message-comment-mark">commented on:</span>\n\t\t<div class="message-group-items">\n\t\t\t</div>\n\t\t<span style="font-size:0.9em;font-style:italic;">"<span class="message-text">');a.push(c.message.comment.textHtml);a.push('</span>"</span>\n\t</div>\n\t<div class="message-profile-image"></div>\t\n\t<div class="message-delete-button" style="display:none;"><img class="button-delete clickable" title="Delete" src="/t.gif"/></div>\t\n</div>');return a.join("")};goTemplates["message:new-item-tile"]=function(c){var a=[];a.push('<div class="message ');a.push(c.message.messageId);a.push(" ");a.push(c.message.userId);a.push(" ");a.push(c.message.type);a.push('">\n\t<div class="message-content">\n\t\t<span class="message-timestamp">');a.push(c.timestamp);a.push('</span><br/>\n\t\t<span class="message-profile-name" ></span>&nbsp;<span class="message-comment-mark">posted a new discussion:</span>\n\t\t<div class="message-group-items">\n\t\t\t</div>\n\t</div>\n\t<div class="message-profile-image"></div>\t\n\t<div class="message-delete-button" style="display:none;"><img class="button-delete clickable" title="Delete" src="/t.gif"/></div>\t\n</div>');return a.join("")};TemplateManager.prototype.templates=goTemplates;