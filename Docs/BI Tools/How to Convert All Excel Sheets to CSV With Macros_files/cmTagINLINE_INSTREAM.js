try{!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=112)}([function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=function(){Array.prototype.forEach=function(e){for(var t=0;t<this.length;t++)e(this[t],t,this)};var e=function(){var e,t,i,o,r,s,a=[],l=a.slice,c=a.filter,d=window.document,u={},h={},p={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},f=/^\s*<(\w+|!)[^>]*>/,m=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,g=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,y=/^(?:body|html)$/i,v=/([A-Z])/g,b=["val","css","html","text","data","width","height","offset"],_=d.createElement("table"),w=d.createElement("tr"),T={tr:d.createElement("tbody"),tbody:_,thead:_,tfoot:_,td:w,th:w,"*":d.createElement("div")},S=/complete|loaded|interactive/,A=/^[\w-]*$/,P={},E=P.toString,C={},k=d.createElement("div"),O={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},I=Array.isArray||function(e){return e instanceof Array};function R(e){return null==e?String(e):P[E.call(e)]||"object"}function V(e){return"function"==R(e)}function D(e){return null!=e&&e==e.window}function x(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function N(e){return"object"==R(e)}function M(e){return N(e)&&!D(e)&&Object.getPrototypeOf(e)==Object.prototype}function L(e){return"number"==typeof e.length}function F(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function B(e){return e in h?h[e]:h[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function j(e,t){return"number"!=typeof t||p[F(e)]?t:t+"px"}function U(e){return"children"in e?l.call(e.children):i.map(e.childNodes,(function(e){if(1==e.nodeType)return e}))}function H(i,n,o){for(t in n)o&&(M(n[t])||I(n[t]))?(M(n[t])&&!M(i[t])&&(i[t]={}),I(n[t])&&!I(i[t])&&(i[t]=[]),H(i[t],n[t],o)):n[t]!==e&&(i[t]=n[t])}function W(e,t){return null==t?i(e):i(e).filter(t)}function z(e,t,i,n){return V(t)?t.call(e,i,n):t}function $(e,t,i){try{null==i?e.removeAttribute(t):e.setAttribute(t,i)}catch(e){}}function q(t,i){var n=t.className||"",o=n&&n.baseVal!==e;if(i===e)return o?n.baseVal:n;o?n.baseVal=i:t.className=i}function G(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?i.parseJSON(e):e):e}catch(t){return e}}function Y(e,t){t(e);for(var i=0,n=e.childNodes.length;i<n;i++)Y(e.childNodes[i],t)}return C.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var i=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(i)return i.call(e,t);var n,o=e.parentNode,r=!o;return r&&(o=k).appendChild(e),n=~C.qsa(o,t).indexOf(e),r&&k.removeChild(e),n},r=function(e){return e.replace(/-+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))},s=function(e){return c.call(e,(function(t,i){return e.indexOf(t)==i}))},C.fragment=function(t,n,o){var r,s,a;return m.test(t)&&(r=i(d.createElement(RegExp.$1))),r||(t.replace&&(t=t.replace(g,"<$1></$2>")),n===e&&(n=f.test(t)&&RegExp.$1),n in T||(n="*"),(a=T[n]).innerHTML=""+t,r=i.each(l.call(a.childNodes),(function(){a.removeChild(this)}))),M(o)&&(s=i(r),i.each(o,(function(e,t){b.indexOf(e)>-1?s[e](t):s.attr(e,t)}))),r},C.Z=function(e,t){return(e=e||[]).__proto__=i.fn,e.selector=t||"",e},C.isZ=function(e){return e instanceof C.Z},C.init=function(t,n){var o,r;if(!t)return C.Z();if("string"==typeof t)if("<"==(t=t.trim())[0]&&f.test(t))o=C.fragment(t,RegExp.$1,n),t=null;else{if(n!==e)return i(n).find(t);o=C.qsa(d,t)}else{if(V(t))return i(d).ready(t);if(C.isZ(t))return t;if(I(t))r=t,o=c.call(r,(function(e){return null!=e}));else if(N(t))o=[t],t=null;else if(f.test(t))o=C.fragment(t.trim(),RegExp.$1,n),t=null;else{if(n!==e)return i(n).find(t);o=C.qsa(d,t)}}return C.Z(o,t)},(i=function(e,t){return C.init(e,t)}).extend=function(e){try{window.TRC&&window.TRC.performance&&window.TRC.performance.mark&&window.TRC.PerfEvenType&&window.TRC.performance.mark("videoExtendFuncStart",null,"","","videoExtendFunc",window.TRC.PerfEvenType.START)}catch(e){}var t,i=l.call(arguments,1);"boolean"==typeof e&&(t=e,e=i.shift()),i.forEach((function(i){H(e,i,t)}));try{window.TRC&&window.TRC.performance&&window.TRC.performance.mark&&window.TRC.PerfEvenType&&window.TRC.performance.mark("videoExtendFuncStop",null,"","","videoExtendFunc",window.TRC.PerfEvenType.STOP)}catch(e){}return e},C.qsa=function(e,t){var i,n="#"==t[0],o=!n&&"."==t[0],r=n||o?t.slice(1):t,s=A.test(r);return x(e)&&s&&n?(i=e.getElementById(r))?[i]:[]:1!==e.nodeType&&9!==e.nodeType?[]:l.call(s&&!n?o?e.getElementsByClassName(r):e.getElementsByTagName(t):e.querySelectorAll(t))},i.contains=d.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},i.type=R,i.isFunction=V,i.isWindow=D,i.isArray=I,i.isPlainObject=M,i.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},i.inArray=function(e,t,i){return a.indexOf.call(t,e,i)},i.camelCase=r,i.trim=function(e){return null==e?"":String.prototype.trim.call(e)},i.uuid=0,i.support={},i.expr={},i.map=function(e,t){var n,o,r,s,a=[];if(L(e))for(o=0;o<e.length;o++)null!=(n=t(e[o],o))&&a.push(n);else for(r in e)null!=(n=t(e[r],r))&&a.push(n);return(s=a).length>0?i.fn.concat.apply([],s):s},i.each=function(e,t){var i,n;if(L(e)){for(i=0;i<e.length;i++)if(!1===t.call(e[i],i,e[i]))return e}else for(n in e)if(!1===t.call(e[n],n,e[n]))return e;return e},i.grep=function(e,t){return c.call(e,t)},window.JSON&&(i.parseJSON=JSON.parse),i.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(e,t){P["[object "+t+"]"]=t.toLowerCase()})),i.fn={forEach:a.forEach,reduce:a.reduce,push:a.push,sort:a.sort,indexOf:a.indexOf,concat:a.concat,map:function(e){return i(i.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return i(l.apply(this,arguments))},ready:function(e){return S.test(d.readyState)&&d.body?e(i):d.addEventListener("DOMContentLoaded",(function(){e(i)}),!1),this},get:function(t){return t===e?l.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each((function(){null!=this.parentNode&&this.parentNode.removeChild(this)}))},each:function(e){return a.every.call(this,(function(t,i){return!1!==e.call(t,i,t)})),this},filter:function(e){return V(e)?this.not(this.not(e)):i(c.call(this,(function(t){return C.matches(t,e)})))},add:function(e,t){return i(s(this.concat(i(e,t))))},is:function(e){return this.length>0&&C.matches(this[0],e)},not:function(t){var n=[];if(V(t)&&t.call!==e)this.each((function(e){t.call(this,e)||n.push(this)}));else{var o="string"==typeof t?this.filter(t):L(t)&&V(t.item)?l.call(t):i(t);this.forEach((function(e){o.indexOf(e)<0&&n.push(e)}))}return i(n)},has:function(e){return this.filter((function(){return N(e)?i.contains(this,e):i(this).find(e).size()}))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!N(e)?e:i(e)},last:function(){var e=this[this.length-1];return e&&!N(e)?e:i(e)},find:function(e){var t=this;return e?"object"==n(e)?i(e).filter((function(){var e=this;return a.some.call(t,(function(t){return i.contains(t,e)}))})):1==this.length?i(C.qsa(this[0],e)):this.map((function(){return C.qsa(this,e)})):i()},closest:function(e,t){var o=this[0],r=!1;for("object"==n(e)&&(r=i(e));o&&!(r?r.indexOf(o)>=0:C.matches(o,e));)o=o!==t&&!x(o)&&o.parentNode;return i(o)},parents:function(e){for(var t=[],n=this;n.length>0;)n=i.map(n,(function(e){if((e=e.parentNode)&&!x(e)&&t.indexOf(e)<0)return t.push(e),e}));return W(t,e)},parent:function(e){return W(s(this.pluck("parentNode")),e)},children:function(e){return W(this.map((function(){return U(this)})),e)},contents:function(){return this.map((function(){return l.call(this.childNodes)}))},siblings:function(e){return W(this.map((function(e,t){return c.call(U(t.parentNode),(function(e){return e!==t}))})),e)},empty:function(){return this.each((function(){this.innerHTML=""}))},pluck:function(e){return i.map(this,(function(t){return t[e]}))},show:function(){return this.each((function(){var e,t,i;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(e=this.nodeName,u[e]||(t=d.createElement(e),d.body.appendChild(t),i=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==i&&(i="block"),u[e]=i),u[e]))}))},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var t=V(e);if(this[0]&&!t)var n=i(e).get(0),o=n.parentNode||this.length>1;return this.each((function(r){i(this).wrapAll(t?e.call(this,r):o?n.cloneNode(!0):n)}))},wrapAll:function(e){if(this[0]){var t;for(i(this[0]).before(e=i(e));(t=e.children()).length;)e=t.first();i(e).append(this)}return this},wrapInner:function(e){var t=V(e);return this.each((function(n){var o=i(this),r=o.contents(),s=t?e.call(this,n):e;r.length?r.wrapAll(s):o.append(s)}))},unwrap:function(){return this.parent().each((function(){i(this).replaceWith(i(this).children())})),this},clone:function(){return this.map((function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(t){return this.each((function(){var n=i(this);(t===e?"none"==n.css("display"):t)?n.show():n.hide()}))},prev:function(e){return i(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return i(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each((function(t){var n=this.innerHTML;i(this).empty().append(z(this,e,t,n))})):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each((function(t){var i=z(this,e,t,this.textContent);this.textContent=null==i?"":""+i})):0 in this?this[0].textContent:null},attr:function(i,n){var o;return"string"!=typeof i||1 in arguments?this.each((function(e){if(1===this.nodeType)if(N(i))for(t in i)$(this,t,i[t]);else $(this,i,z(this,n,e,this.getAttribute(i)))})):this.length&&1===this[0].nodeType?!(o=this[0].getAttribute(i))&&i in this[0]?this[0][i]:o:e},removeAttr:function(e){return this.each((function(){1===this.nodeType&&e.split(" ").forEach((function(e){$(this,e)}),this)}))},prop:function(e,t){return e=O[e]||e,1 in arguments?this.each((function(i){this[e]=z(this,t,i,this[e])})):this[0]&&this[0][e]},data:function(t,i){var n="data-"+t.replace(v,"-$1").toLowerCase(),o=1 in arguments?this.attr(n,i):this.attr(n);return null!==o?G(o):e},val:function(e){return 0 in arguments?this.each((function(t){this.value=z(this,e,t,this.value)})):this[0]&&(this[0].multiple?i(this[0]).find("option").filter((function(){return this.selected})).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each((function(t){var n=i(this),o=z(this,e,t,n.offset()),r=n.offsetParent().offset(),s={top:o.top-r.top,left:o.left-r.left};"static"==n.css("position")&&(s.position="relative"),n.css(s)}));if(!this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(e,n){if(arguments.length<2){var o,s=this[0];if(!s)return;if(o=getComputedStyle(s,""),"string"==typeof e)return s.style[r(e)]||o.getPropertyValue(e);if(I(e)){var a={};return i.each(e,(function(e,t){a[t]=s.style[r(t)]||o.getPropertyValue(t)})),a}}var l="";if("string"==R(e))n||0===n?l=F(e)+":"+j(e,n):this.each((function(){this.style.removeProperty(F(e))}));else for(t in e)e[t]||0===e[t]?l+=F(t)+":"+j(t,e[t])+";":this.each((function(){this.style.removeProperty(F(t))}));return this.each((function(){this.style.cssText+=";"+l}))},index:function(e){return e?this.indexOf(i(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&a.some.call(this,(function(e){return this.test(q(e))}),B(e))},addClass:function(e){return e?this.each((function(t){if("className"in this){o=[];var n=q(this);z(this,e,t,n).split(/\s+/g).forEach((function(e){i(this).hasClass(e)||o.push(e)}),this),o.length&&q(this,n+(n?" ":"")+o.join(" "))}})):this},removeClass:function(t){return this.each((function(i){if("className"in this){if(t===e)return q(this,"");o=q(this),z(this,t,i,o).split(/\s+/g).forEach((function(e){o=o.replace(B(e)," ")})),q(this,o.trim())}}))},toggleClass:function(t,n){return t?this.each((function(o){var r=i(this);z(this,t,o,q(this)).split(/\s+/g).forEach((function(t){(n===e?!r.hasClass(t):n)?r.addClass(t):r.removeClass(t)}))})):this},scrollTop:function(t){if(this.length){var i="scrollTop"in this[0];return t===e?i?this[0].scrollTop:this[0].pageYOffset:this.each(i?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var i="scrollLeft"in this[0];return t===e?i?this[0].scrollLeft:this[0].pageXOffset:this.each(i?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),o=y.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(i(e).css("margin-top"))||0,n.left-=parseFloat(i(e).css("margin-left"))||0,o.top+=parseFloat(i(t[0]).css("border-top-width"))||0,o.left+=parseFloat(i(t[0]).css("border-left-width"))||0,{top:n.top-o.top,left:n.left-o.left}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent||d.body;e&&!y.test(e.nodeName)&&"static"==i(e).css("position");)e=e.offsetParent;return e}))}},i.fn.detach=i.fn.remove,["width","height"].forEach((function(t){var n=t.replace(/./,(function(e){return e[0].toUpperCase()}));i.fn[t]=function(o){var r,s=this[0];return o===e?D(s)?s["inner"+n]:x(s)?s.documentElement["scroll"+n]:(r=this.offset())&&r[t]:this.each((function(e){(s=i(this)).css(t,z(this,o,e,s[t]()))}))}})),["after","prepend","before","append"].forEach((function(e,t){var n=t%2;i.fn[e]=function(){var e,o,r=i.map(arguments,(function(t){return"object"==(e=R(t))||"array"==e||null==t?t:C.fragment(t)})),s=this.length>1;return r.length<1?this:this.each((function(e,a){o=n?a:a.parentNode,a=0==t?a.nextSibling:1==t?a.firstChild:2==t?a:null;var l=i.contains(d.documentElement,o);r.forEach((function(e){if(s)e=e.cloneNode(!0);else if(!o)return i(e).remove();o.insertBefore(e,a),l&&Y(e,(function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)}))}))}))},i.fn[n?e+"To":"insert"+(t?"Before":"After")]=function(t){return i(t)[e](this),this}})),C.Z.prototype=i.fn,C.uniq=s,C.deserializeValue=G,i.zepto=C,i}(),t=e;return function(e){var t,i=1,n=Array.prototype.slice,o=e.isFunction,r=function(e){return"string"==typeof e},s={},a={},l="onfocusin"in window,c={focus:"focusin",blur:"focusout"},d={mouseenter:"mouseover",mouseleave:"mouseout"};function u(e){return e._zid||(e._zid=i++)}function h(e,t,i,n){if((t=p(t)).ns)var o=(r=t.ns,new RegExp("(?:^| )"+r.replace(" "," .* ?")+"(?: |$)"));var r;return(s[u(e)]||[]).filter((function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||o.test(e.ns))&&(!i||u(e.fn)===u(i))&&(!n||e.sel==n)}))}function p(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function f(e,t){return e.del&&!l&&e.e in c||!!t}function m(e){return d[e]||l&&c[e]||e}function g(i,n,o,r,a,l,c){var h=u(i),g=s[h]||(s[h]=[]);n.split(/\s/).forEach((function(n){if("ready"==n)return e(document).ready(o);var s=p(n);s.fn=o,s.sel=a,s.e in d&&(o=function(t){var i=t.relatedTarget;if(!i||i!==this&&!e.contains(this,i))return s.fn.apply(this,arguments)}),s.del=l;var u=l||o;s.proxy=function(e){if(!(e=T(e)).isImmediatePropagationStopped()){e.data=r;var n=u.apply(i,e._args==t?[e]:[e].concat(e._args));return!1===n&&(e.preventDefault(),e.stopPropagation()),n}},s.i=g.length,g.push(s),"addEventListener"in i&&i.addEventListener(m(s.e),s.proxy,f(s,c))}))}function y(e,t,i,n,o){var r=u(e);(t||"").split(/\s/).forEach((function(t){h(e,t,i,n).forEach((function(t){delete s[r][t.i],"removeEventListener"in e&&e.removeEventListener(m(t.e),t.proxy,f(t,o))}))}))}a.click=a.mousedown=a.mouseup=a.mousemove="MouseEvents",e.event={add:g,remove:y},e.proxy=function(t,i){var s=2 in arguments&&n.call(arguments,2);if(o(t)){var a=function(){return t.apply(i,s?s.concat(n.call(arguments)):arguments)};return a._zid=u(t),a}if(r(i))return s?(s.unshift(t[i],t),e.proxy.apply(null,s)):e.proxy(t[i],t);throw new TypeError("expected function")},e.fn.bind=function(e,t,i){return this.on(e,t,i)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,i,n){return this.on(e,t,i,n,1)};var v=function(){return!0},b=function(){return!1},_=/^([A-Z]|returnValue$|layer[XY]$)/,w={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function T(i,n){return!n&&i.isDefaultPrevented||(n||(n=i),e.each(w,(function(e,t){var o=n[e];i[e]=function(){return this[t]=v,o&&o.apply(n,arguments)},i[t]=b})),(n.defaultPrevented!==t?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(i.isDefaultPrevented=v)),i}function S(e){var i,n={originalEvent:e};for(i in e)_.test(i)||e[i]===t||(n[i]=e[i]);return T(n,e)}e.fn.delegate=function(e,t,i){return this.on(t,e,i)},e.fn.undelegate=function(e,t,i){return this.off(t,e,i)},e.fn.live=function(t,i){return e(document.body).delegate(this.selector,t,i),this},e.fn.die=function(t,i){return e(document.body).undelegate(this.selector,t,i),this},e.fn.on=function(i,s,a,l,c){var d,u,h=this;return i&&!r(i)?(e.each(i,(function(e,t){h.on(e,s,a,t,c)})),h):(r(s)||o(l)||!1===l||(l=a,a=s,s=t),(o(a)||!1===a)&&(l=a,a=t),!1===l&&(l=b),h.each((function(t,o){c&&(d=function(e){return y(o,e.type,l),l.apply(this,arguments)}),s&&(u=function(t){var i,r=e(t.target).closest(s,o).get(0);if(r&&r!==o)return i=e.extend(S(t),{currentTarget:r,liveFired:o}),(d||l).apply(r,[i].concat(n.call(arguments,1)))}),g(o,i,l,a,s,u||d)})))},e.fn.off=function(i,n,s){var a=this;return i&&!r(i)?(e.each(i,(function(e,t){a.off(e,n,t)})),a):(r(n)||o(s)||!1===s||(s=n,n=t),!1===s&&(s=b),a.each((function(){y(this,i,s,n)})))},e.fn.trigger=function(t,i){return(t=r(t)||e.isPlainObject(t)?e.Event(t):T(t))._args=i,this.each((function(){t.type in c&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,i)}))},e.fn.triggerHandler=function(t,i){var n,o;return this.each((function(s,a){(n=S(r(t)?e.Event(t):t))._args=i,n.target=a,e.each(h(a,t.type||t),(function(e,t){if(o=t.proxy(n),n.isImmediatePropagationStopped())return!1}))})),o},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach((function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}})),e.Event=function(e,t){r(e)||(e=(t=e).type);var i=document.createEvent(a[e]||"Events"),n=!0;if(t)for(var o in t)"bubbles"==o?n=!!t[o]:i[o]=t[o];return i.initEvent(e,n,!0),T(i)}}(e),function(e){var t,i,n=0,o=window.document,r=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=/^(?:text|application)\/javascript/i,a=/^(?:text|application)\/xml/i,l="application/json",c="text/html",d=/^\s*$/,u=o.createElement("a");function h(t,i,n,r){if(t.global)return function(t,i,n){var o=e.Event(i);return e(t).trigger(o,n),!o.isDefaultPrevented()}(i||o,n,r)}function p(e,t){var i=t.context;if(!1===t.beforeSend.call(i,e,t)||!1===h(t,i,"ajaxBeforeSend",[e,t]))return!1;h(t,i,"ajaxSend",[e,t])}function f(e,t,i,n){var o=i.context,r="success";i.success.call(o,e,r,t),n&&n.resolveWith(o,[e,r,t]),h(i,o,"ajaxSuccess",[t,i,e]),g(r,t,i)}function m(e,t,i,n,o){var r=n.context;n.error.call(r,i,t,e),o&&o.rejectWith(r,[i,t,e]),h(n,r,"ajaxError",[i,n,e||t]),g(t,i,n)}function g(t,i,n){var o=n.context;n.complete.call(o,i,t),h(n,o,"ajaxComplete",[i,n]),function(t){t.global&&!--e.active&&h(t,null,"ajaxStop")}(n)}function y(){}function v(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function b(t,i,n,o){return e.isFunction(i)&&(o=n,n=i,i=void 0),e.isFunction(n)||(o=n,n=void 0),{url:t,data:i,success:n,dataType:o}}u.href=window.location.href,e.active=0,e.ajaxJSONP=function(t,i){if(!("type"in t))return e.ajax(t);var r,s,a=t.jsonpCallback,l=(e.isFunction(a)?a():a)||"jsonp"+ ++n,c=o.createElement("script"),d=window[l],u=function(t){e(c).triggerHandler("error",t||"abort")},h={abort:u};return i&&i.promise(h),e(c).on("load error",(function(n,o){clearTimeout(s),e(c).off().remove(),"error"!=n.type&&r?f(r[0],h,t,i):m(null,o||"error",h,t,i),window[l]=d,r&&e.isFunction(d)&&d(r[0]),d=r=void 0})),!1===p(h,t)?(u("abort"),h):(window[l]=function(){r=arguments},c.src=t.url.replace(/\?(.+)=\?/,"?$1="+l),o.head.appendChild(c),t.timeout>0&&(s=setTimeout((function(){u("timeout")}),t.timeout)),h)},e.ajaxSettings={type:"GET",beforeSend:y,success:y,error:y,complete:y,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:l,xml:"application/xml, text/xml",html:c,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},e.ajax=function(n){var r,g=e.extend({},n||{}),b=e.Deferred&&e.Deferred();for(t in e.ajaxSettings)void 0===g[t]&&(g[t]=e.ajaxSettings[t]);!function(t){t.global&&0==e.active++&&h(t,null,"ajaxStart")}(g),g.crossDomain||((r=o.createElement("a")).href=g.url,r.href=r.href,g.crossDomain=u.protocol+"//"+u.host!=r.protocol+"//"+r.host),g.url||(g.url=window.location.toString()),function(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=v(t.url,t.data),t.data=void 0)}(g);var _=g.dataType,w=/\?.+=\?/.test(g.url);if(w&&(_="jsonp"),!1!==g.cache&&(n&&!0===n.cache||"script"!=_&&"jsonp"!=_)||(g.url=v(g.url,"_="+Date.now())),"jsonp"==_)return w||(g.url=v(g.url,g.jsonp?g.jsonp+"=?":!1===g.jsonp?"":"callback=?")),e.ajaxJSONP(g,b);var T,S=g.accepts[_],A={},P=function(e,t){A[e.toLowerCase()]=[e,t]},E=/^([\w-]+:)\/\//.test(g.url)?RegExp.$1:window.location.protocol,C=g.xhr(),k=C.setRequestHeader;if(b&&b.promise(C),g.crossDomain||P("X-Requested-With","XMLHttpRequest"),P("Accept",S||"*/*"),(S=g.mimeType||S)&&(S.indexOf(",")>-1&&(S=S.split(",",2)[0]),C.overrideMimeType&&C.overrideMimeType(S)),(g.contentType||!1!==g.contentType&&g.data&&"GET"!=g.type.toUpperCase())&&P("Content-Type",g.contentType||"application/x-www-form-urlencoded"),g.headers)for(i in g.headers)P(i,g.headers[i]);if(C.setRequestHeader=P,C.onreadystatechange=function(){if(4==C.readyState){C.onreadystatechange=y,clearTimeout(T);var t,i=!1;if(C.status>=200&&C.status<300||304==C.status||0==C.status&&"file:"==E){_=_||function(e){return e&&(e=e.split(";",2)[0]),e&&(e==c?"html":e==l?"json":s.test(e)?"script":a.test(e)&&"xml")||"text"}(g.mimeType||C.getResponseHeader("content-type")),t=C.responseText;try{"script"==_?(0,eval)(t):"xml"==_?t=C.responseXML:"json"==_&&(t=d.test(t)?null:e.parseJSON(t))}catch(e){i=e}i?m(i,"parsererror",C,g,b):f(t,C,g,b)}else m(C.statusText||null,C.status?"error":"abort",C,g,b)}},!1===p(C,g))return C.abort(),m(null,"abort",C,g,b),C;if(g.xhrFields)for(i in g.xhrFields)C[i]=g.xhrFields[i];var O=!("async"in g)||g.async;for(i in C.open(g.type,g.url,O,g.username,g.password),A)k.apply(C,A[i]);return g.timeout>0&&(T=setTimeout((function(){C.onreadystatechange=y,C.abort(),m(null,"timeout",C,g,b)}),g.timeout)),C.send(g.data?g.data:null),C},e.get=function(){return e.ajax(b.apply(null,arguments))},e.post=function(){var t=b.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=b.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,i,n){if(!this.length)return this;var o,s=this,a=t.split(/\s/),l=b(t,i,n),c=l.success;return a.length>1&&(l.url=a[0],o=a[1]),l.success=function(t){s.html(o?e("<div>").html(t.replace(r,"")).find(o):t),c&&c.apply(s,arguments)},e.ajax(l),this};var _=encodeURIComponent;e.param=function(t,i){var n=[];return n.add=function(t,i){e.isFunction(i)&&(i=i()),null==i&&(i=""),this.push(_(t)+"="+_(i))},function t(i,n,o,r){var s,a=e.isArray(n),l=e.isPlainObject(n);e.each(n,(function(n,c){s=e.type(c),r&&(n=o?r:r+"["+(l||"object"==s||"array"==s?n:"")+"]"),!r&&a?i.add(c.name,c.value):"array"==s||!o&&"object"==s?t(i,c,o,n):i.add(n,c)}))}(n,t,i),n.join("&").replace(/%20/g,"+")}}(e),function(e){e.fn.serializeArray=function(){var t,i,n=[],o=function e(i){if(i.forEach)return i.forEach(e);n.push({name:t,value:i})};return this[0]&&e.each(this[0].elements,(function(n,r){i=r.type,(t=r.name)&&"fieldset"!=r.nodeName.toLowerCase()&&!r.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||r.checked)&&o(e(r).val())})),n},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach((function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))})),e.join("&")},e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var i=e.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(e),function(e){"__proto__"in{}||e.extend(e.zepto,{Z:function(t,i){return t=t||[],e.extend(t,e.fn),t.selector=i||"",t.__Z=!0,t},isZ:function(t){return"array"===e.type(t)&&"__Z"in t}});try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(e,i){try{return t(e,i)}catch(e){return null}}}}(e),t}();t.a=o},function(e,t){e.exports={UNIT_TYPES:{INLINE:0,INTERSTITIAL:1,SLIDER_OUTSTREAM:2,SLIDER_INSTREAM:3,EXPANDABLE:4,"300X600":5,INLINE_FEED:6,COFFEEBREAK:7,SLIDESHOW:8,INLINE_INSTREAM:9,COFFEEBREAK_MOBILE:10,"300X600_MOBILE":11,INLINE_MOBILE:12,INTERSTITIAL_MOBILE:14,SLIDER_OUTSTREAM_MOBILE:15,SLIDER_INSTREAM_MOBILE:16,EXPANDABLE_MOBILE:17,INLINE_INSTREAM_MOBILE:18,INLINE_OUT_OF_VIEW:19,INLINE_OUT_OF_VIEW_MOBILE:20,INLINE_VIEWABILITY_EXPAND:21,INLINE_VIEWABILITY_EXPAND_MOBILE:22,INLINE_INSTREAM_VIEWABILITY_EXPAND:23,INLINE_INSTREAM_VIEWABILITY_EXPAND_MOBILE:24,INLINE_FEED_MOBILE:25,WIDGET_ITEM:26,WIDGET_ITEM_MOBILE:27,NEW_INLINE:28,NEW_INLINE_MOBILE:29,NEW_INLINE_ADJACENT:30,NEW_INLINE_ADJACENT_MOBILE:31,FEED_MANAGER:32,FEED_MANAGER_MOBILE:33,MSN_WIDGET:34,SLIDER_INSTREAM_VFORCE:36,SLIDER_INSTREAM_MOBILE_VFORCE:37},STREAM_TYPES:{IN_STREAM:1,OUT_STREAM:0},UNITS_STREAM_TYPE:{INLINE:0,INTERSTITIAL:0,SLIDER_OUTSTREAM:0,SLIDER_INSTREAM:1,EXPANDABLE:1,"300X600":1,OMNI_TAG:0},APPEND_TYPE:{BEFORE_BEGIN:0,AFTER_BEGIN:1,BEFORE_END:2,AFTER_END:3,beforebegin:0,afterbegin:1,beforeend:2,afterend:3},INVALID_SELECTOR_TAG_NAMES:{IMG:0,UL:1,BUTTON:3,INPUT:4,LABEL:5},OMNI_TAG_UNIT_NAMES:{rightrail1:1,rightrail2:2,rightrail3:3,inlineTop:4,inlineMiddle:5,inlineBottom:6,interstitial:7,sliderOutstream1:8,sliderOutstream2:9,sliderInstream1:10,sliderInstream2:11,coffeeBreak:12,expandable1:13,expandable2:14,expandable3:15,invalidUnitName:1e3},ROLL_TYPE:{preroll:0,"pre-roll":0,midroll:-1,"mid-roll":-1,postroll:-2,"post-roll":-2},TAB_STATE:{focus:0,blur:1,tabOut:2},DFP_KEYWORDS:["google","dfp","gpt"],MIME_TYPES:{1:"video/mp4",5:"video/webm",7:"video/ogg",10:"video/mp4",11:"video/ogg",12:"video/webm"},SUB_UNIT_TYPE:{PLAIN:0,START_FROM_SLIDER:1,DETACH_TO_SLIDER:2,SUPER_SLIDER:3,INLINE_SINGLE_SELECTOR:4,INLINE_MULTI_SELECTOR:5,STICKY_BELOW:6,STICKY_ABOVE:7,STICKY_BELOW_ABOVE:8,WIDGET:9},FEED_SELECTOR:"tbl-feed-container",AD_CHOICE_TYPE:{TITLE:"title",VIDEO_AD:"videoAd",SLIDER:"slider"},REPLAY_AD_CLICK:{ALL:"all",RESTART_PLAYER:"restartPlayer"},DISPLAY_FILLER:{BEFORE_AD:{NONE:"none",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"},BETWEEN_ADS:{LOADING:"loading",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"},ON_TIMEOUT:{CLOSE:"close",D2D:"d2d",CONTENT:"content",STATIC:"static",none:"none"}},TITLE_POSITION:{ABOVE:"above",BELOW:"below"},KIBANA_EVENTS:{start:"start",renderWasCalled:"renderWasCalled",getAd:"getAd",getAdFailed:"getAdFailed",gotAd:"gotAd",adPlay:"adPlay",conversion:"conversion",adPaused:"adPaused",viewability:"viewability",continueAd:"continueAd",adComplete:"adComplete",firstEligibility:"firstEligibility",unitCloseByUser:"unitCloseByUser",unitClosedByMidRollTimeOut:"unitClosedByMidRollTimeOut",attach:"attach",detach:"detach",topParentSelectorLost:"topParentSelectorLost",playerWidthLost:"playerWidthLost",playerHeightLost:"playerHeightLost",invalidCDBobject:"invalidCDBobject",rvHandlerState:"rvHandlerState",playerHasRvInQ:"playerHasRvInQ",rvHandlerTimerExpired:"rvHandlerTimerExpired",D2DClick:"D2DClick"},DEBUG_DATA:{pn:"pn",sqg:"sqg",sqv:"sqv",rv:"rv",sqp:"sqp",rvps:"rvps",rvvs:"rvvs",pps:"pps",ppsc:"ppsc",vms:"vms",gpps:"gpps",gppsc:"gppsc",ft:"ft",fsc:"fsc",fpc:"fpc",sa:"sa",pi:"pi",dt:"dt",vb:"vb",dur:"dur",ttv:"ttv",bovpg:"bovpg",bovpv:"bovpv",be:"be",pap:"pap",mty:"mty",esv:"esv",rot:"rot",roid:"roid",rom:"rom",tti:"tti"},DEBUG_DATA_PIXELS:{ft:"ft",fsc:"fsc",fpc:"fpc"},PREDICT_NAMES:{distancePercentPredict:0,distancePixelsPredict:1,getAdFailPredict:2,loadingPredict:3,multiAdPredict:4,playerReadyPredict:5,repeatPredict:6,autoKillPredict:7,firstScrollPredict:8,emptyQueuePredict:9,bForcePredict:10,intersectionPredict:11,fullEligibilityPredict:12,feedXPredict:13,adProgressionAfterBeginPredict:14,adProgressionBeforeEndPredict:15,feedContainerChangedPredict:16,mp4Predict:17},ANIMATION_TYPE:{none:0,attaching:1,detaching:2,expanding:3,collapsing:4},FLOATING_VIEW_TOP_COMPONENT:{video:0,loading:1,repeat:2,d2d:3,content:4},FRAME_TYPE:{plainPage:0,friendlyIframe:1,nonFriendlyIframe:2,amp:3,inApp:4},CHECK_FOR_RV_PRIORITY:{onEligibility:"hasReachedEligibility",pixelsFromSelector:"hasReachedPixelsFromSelector",intersectionPercent:"intersectionPercent",beforeLoaderEnd:"beforeLoaderEnd"},TIMER_NAMES:{viewability:"viewability",viewabilityOneS:"viewabilityOneS",viewability100:"viewability100",viewabilityAMP:"viewabilityAMP"},AD_STATUS:{new:0,adLoaded:1,startAd:2,adImpression:3,adPlay:4,adError:5,adComplete:6},GENERAL_ERROR:{1:"empty data from player"},CSS_PROPERTIES_FROM_RBOX:["font","@font-face","font-family","font-feature-settings","@font-feature-values","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","line-break","line-height","outline","outline-color","outline-offset","outline-style","outline-width","text-decoration-line","text-underline-position","padding","padding-bottom","padding-left","padding-right","padding-top","margin","margin-bottom","margin-left","margin-right","margin-top","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","text-transform","z-index","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-indent","text-justify","text-orientation","text-overflow","text-shadow","text-transform","text-underline-position","direction","color"],NATIVE_AD:{DESC_TITLE_FONT_RATIO:.8,FIT_TO_SIZE:{TITLE:"title",FULL:"full",NONE:"none"}},UNIT_QUERY_LANGUAGE:{SUPPORTED_CONFIG_FLAGS:["stickyCard"],MAPPING:[{search:"@Ad@",replaceWith:"activeAd"}]},RV_TYPES:{NON_RV:0,RV:1,ANY:"any"},VIDEO_READY_STATE:{HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},TRC_PERFORMANCE_ACTIONS:{START:"Start",STOP:"Stop"},OS:{IOS:"iOS"},BROWSER:{IE:"IE",EDGE:"Edge",FIREFOX:"Firefox"}}},function(e,t){e.exports={readyState:"ready",adManagerState:{empty:"empty",hasAds:"hasAds",stopped:"stopped",paused:"paused"},adState:{failed:"failed",playing:"playing",paused:"paused",continueAd:"continueAd",completed:"completed",autoKill:"autoKill",repeating:"repeating",skipped:"skipped"},adQState:{impression:"impression",q0:"q0",q1:"q1",q2:"q2",q3:"q3",completed:"completed",repeating:"repeating"},getAdState:{notCalled:"notCalled",gettingAd:"gettingAd",gotAd:"gotAd",waiting:"waiting",failed:"failed",stopped:"stopped",finished:"finished"},playerState:{error:"error",stopped:"stopped",closed:"closed",restarted:"restarted"},containerViewState:{rendered:"rendered",eligible:"eligible",playing:"playing",collapsed:"collapsed",attached:"attached",detached:"detached"},videoViewState:{rendered:"rendered",attached:"attached",detached:"detached"},repeatState:{hiding:"hiding",showing:"showing",spinning:"spinning",clicked:"clicked"},loadingViewState:{hiding:"hiding",showing:"showing",clicked:"clicked"},clickThruState:{clicked:"clicked",waiting:"waiting"},timerState:{working:"started",paused:"paused",stopped:"stopped",done:"done"},closeState:{terminate:"terminate",containerViewClosed:"containerViewClosed",videoViewClosed:"videoViewClosed",adManagerStop:"adManagerStop",playerClosed:"playerClosed"},tabState:{focus:"focus",blur:"blur",tabOut:"tabOut"},rvHandlerState:{working:"working",idle:"idle"},floatingView:{detach:"detach",attach:"attach",postAttach:"postAttach",permanentClosed:"permanentClosed"},externalUnit:{playing:"playing",stopped:"stopped"},brandingDisplayState:{show:"show",hide:"hide"}}},function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,n){e||(e={}),e.Backbone||(e.Backbone={});var o=i(5);n(e,t,o)}(this,(function(e,t,i,o){var r=e.Backbone,s=[].slice;t.VERSION="1.1.2",t.$=o,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,i){return c(this,"on",e,[t,i])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:i,ctx:i||this}),this):this},once:function(e,t,n){if(!c(this,"once",e,[t,n])||!t)return this;var o=this,r=i.once((function(){o.off(e,r),t.apply(this,arguments)}));return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var o,r,s,a,l,d,u,h;if(!this._events||!c(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(l=0,d=(a=e?[e]:i.keys(this._events)).length;l<d;l++)if(e=a[l],s=this._events[e]){if(this._events[e]=o=[],t||n)for(u=0,h=s.length;u<h;u++)r=s[u],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&o.push(r);o.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&d(i,t),n&&d(n,arguments),this},stopListening:function(e,t,o){var r=this._listeningTo;if(!r)return this;var s=!t&&!o;for(var a in o||"object"!==n(t)||(o=this),e&&((r={})[e._listenId]=e),r)(e=r[a]).off(t,o,this),(s||i.isEmpty(e._events))&&delete this._listeningTo[a];return this}},l=/\s+/,c=function(e,t,i,o){if(!i)return!0;if("object"===n(i)){for(var r in i)e[t].apply(e,[r,i[r]].concat(o));return!1}if(l.test(i)){for(var s=i.split(l),a=0,c=s.length;a<c;a++)e[t].apply(e,[s[a]].concat(o));return!1}return!0},d=function(e,t){var i,n=-1,o=e.length,r=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++n<o;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r);return;case 2:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r,s);return;case 3:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r,s,a);return;default:for(;++n<o;)(i=e[n]).callback.apply(i.ctx,t);return}};i.each({listenTo:"on",listenToOnce:"once"},(function(e,t){a[t]=function(t,o,r){return(this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=i.uniqueId("l"))]=t,r||"object"!==n(o)||(r=this),t[e](o,r,this),this}})),a.bind=a.on,a.unbind=a.off,i.extend(t,a);var u=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(u.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,o){var r,s,a,l,c,d,u,h;if(null==e)return this;if("object"===n(e)?(s=e,o=t):(s={})[e]=t,o||(o={}),!this._validate(s,o))return!1;for(r in a=o.unset,c=o.silent,l=[],d=this._changing,this._changing=!0,d||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]),s)t=s[r],i.isEqual(h[r],t)||l.push(r),i.isEqual(u[r],t)?delete this.changed[r]:this.changed[r]=t,a?delete h[r]:h[r]=t;if(!c){l.length&&(this._pending=o);for(var p=0,f=l.length;p<f;p++)this.trigger("change:"+l[p],this,h[l[p]],o)}if(d)return this;if(!c)for(;this._pending;)o=this._pending,this._pending=!1,this.trigger("change",this,o);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&i.clone(this.changed);var t,n=!1,o=this._changing?this._previousAttributes:this.attributes;for(var r in e)i.isEqual(o[r],t=e[r])||((n||(n={}))[r]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){void 0===(e=e?i.clone(e):{}).parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){if(!t.set(t.parse(i,e),e))return!1;n&&n(t,i,e),t.trigger("sync",t,i,e)},V(this,e),this.sync("read",this,e)},save:function(e,t,o){var r,s,a,l=this.attributes;if(null==e||"object"===n(e)?(r=e,o=t):(r={})[e]=t,o=i.extend({validate:!0},o),r&&!o.wait){if(!this.set(r,o))return!1}else if(!this._validate(r,o))return!1;r&&o.wait&&(this.attributes=i.extend({},l,r)),void 0===o.parse&&(o.parse=!0);var c=this,d=o.success;return o.success=function(e){c.attributes=l;var t=c.parse(e,o);if(o.wait&&(t=i.extend(r||{},t)),i.isObject(t)&&!c.set(t,o))return!1;d&&d(c,e,o),c.trigger("sync",c,e,o)},V(this,o),"patch"==(s=this.isNew()?"create":o.patch?"patch":"update")&&(o.attrs=r),a=this.sync(s,this,o),r&&o.wait&&(this.attributes=l),a},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,o=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&o(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;V(this,e);var r=this.sync("delete",this,e);return e.wait||o(),r},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||R();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1)}}),i.each(["keys","values","pairs","invert","pick","omit"],(function(e){u.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}}));var h=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},p={add:!0,remove:!0,merge:!0},f={add:!0,remove:!1};i.extend(h.prototype,a,{model:u,initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,f))},remove:function(e,t){var n,o,r,s,a=!i.isArray(e);for(t||(t={}),n=0,o=(e=a?[e]:i.clone(e)).length;n<o;n++)(s=e[n]=this.get(e[n]))&&(delete this._byId[s.id],delete this._byId[s.cid],r=this.indexOf(s),this.models.splice(r,1),this.length--,t.silent||(t.index=r,s.trigger("remove",s,this,t)),this._removeReference(s,t));return a?e[0]:e},set:function(e,t){(t=i.defaults({},t,p)).parse&&(e=this.parse(e,t));var n,o,r,s,a,l,c,d=!i.isArray(e);e=d?e?[e]:[]:i.clone(e);var h=t.at,f=this.model,m=this.comparator&&null==h&&!1!==t.sort,g=i.isString(this.comparator)?this.comparator:null,y=[],v=[],b={},_=t.add,w=t.merge,T=t.remove,S=!(m||!_||!T)&&[];for(n=0,o=e.length;n<o;n++){if(r=(a=e[n]||{})instanceof u?s=a:a[f.prototype.idAttribute||"id"],l=this.get(r))T&&(b[l.cid]=!0),w&&(a=a===s?s.attributes:a,t.parse&&(a=l.parse(a,t)),l.set(a,t),m&&!c&&l.hasChanged(g)&&(c=!0)),e[n]=l;else if(_){if(!(s=e[n]=this._prepareModel(a,t)))continue;y.push(s),this._addReference(s,t)}s=l||s,!S||!s.isNew()&&b[s.id]||S.push(s),b[s.id]=!0}if(T){for(n=0,o=this.length;n<o;++n)b[(s=this.models[n]).cid]||v.push(s);v.length&&this.remove(v,t)}if(y.length||S&&S.length)if(m&&(c=!0),this.length+=y.length,null!=h)for(n=0,o=y.length;n<o;n++)this.models.splice(h+n,0,y[n]);else{S&&(this.models.length=0);var A=S||y;for(n=0,o=A.length;n<o;n++)this.models.push(A[n])}if(c&&this.sort({silent:!0}),!t.silent){for(n=0,o=y.length;n<o;n++)(s=y[n]).trigger("add",s,this,t);(c||S&&S.length)&&this.trigger("sort",this,t)}return d?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,o=this.models.length;n<o;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return s.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"]((function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0}))},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){void 0===(e=e?i.clone(e):{}).parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var o=e.reset?"reset":"set";n[o](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},V(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,o=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),o&&o(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof u)return e;(t=t?i.clone(t):{}).collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e,t){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}}),i.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"],(function(e){h.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}})),i.each(["groupBy","countBy","sortBy","indexBy"],(function(e){h.prototype[e]=function(t,n){var o=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,o,n)}}));var m=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,y)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},g=/^(\S+)\s*(.*)$/,y=["model","collection","el","id","attributes","className","tagName","events"];i.extend(m.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],!1!==i&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;for(var t in this.undelegateEvents(),e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var o=t.match(g),r=o[1],s=o[2];n=i.bind(n,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,n):this.$el.on(r,s,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e.class=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,o){var r=b[e];i.defaults(o||(o={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=i.result(n,"url")||R()),null!=o.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||n.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",r),a)return a.apply(this,arguments)}}"GET"===s.type||o.emulateJSON||(s.processData=!1),"PATCH"===s.type&&v&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=o.xhr=t.ajax(i.extend(s,o));return n.trigger("request",n,l,o),l};var v=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),b={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var _=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},w=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,S=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(_.prototype,a,{initialize:function(){},route:function(e,n,o){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(o=n,n=""),o||(o=this[n]);var r=this;return t.history.route(e,(function(i){var s=r._extractParameters(e,i);r.execute(o,s),r.trigger.apply(r,["route:"+n].concat(s)),r.trigger("route",n,s),t.history.trigger("route",r,n,s)})),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(w,"(?:$1)?").replace(T,(function(e,t){return t?e:"([^/?]+)"})).replace(S,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,(function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null}))}});var P=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,C=/^\/+|\/+$/g,k=/msie [\w.]+/,O=/\/$/,I=/#.*$/;P.started=!1,i.extend(P.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(O,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(E,"")},start:function(e){if(P.started)throw new Error("Backbone.history has already been started");P.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),o=document.documentMode,r=k.exec(navigator.userAgent.toLowerCase())&&(!o||o<=7);if(this.root=("/"+this.root+"/").replace(C,"/"),r&&this._wantsHashChange){var s=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),P.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!P.started)return!1;t&&!0!==t||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(I,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new P,u.extend=h.extend=_.extend=m.extend=P.extend=function(e,t){var n,o=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return o.apply(this,arguments)},i.extend(n,o,t);var r=function(){this.constructor=n};return r.prototype=o.prototype,n.prototype=new r,e&&i.extend(n.prototype,e),n.__super__=o.prototype,n};var R=function(){throw new Error('A "url" property or function must be specified')},V=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(34);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.unitType,r=t.className,s=t.logger,a=void 0===s?n.a.getInstance():s,l=t.version,c=t.isDebug,d=void 0===c||c;o(this,e),this._logger=a,this.unitType=i,this.className=r,this.version=l,this.isDebug=d}var t,i;return t=e,(i=[{key:"info",value:function(e,t){this._logger.info("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"success",value:function(e,t){this._logger.success("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"important",value:function(e,t){this._logger.important("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"warning",value:function(e,t){this._logger.warning("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"pixel",value:function(e,t){this._logger.pixel("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"debug",value:function(e,t){this.isDebug&&this._logger.debug("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"error",value:function(e,t){this.isDebug&&this._logger.error("unit type: ".concat(this.unitType,", ")+"class name: ".concat(this.className," - ").concat(e),t)}},{key:"ga",value:function(e){this._logger.ga(this.unitType,e,this.version)}},{key:"ul",value:function(e,t,i){this._logger.ul(e,t,i)}}])&&r(t.prototype,i),e}()},function(e,t,i){(function(t){var i;i=function(){var e="1.12.0",i="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||Function("return this")()||{},n=Array.prototype,o=Object.prototype,r="undefined"!=typeof Symbol?Symbol.prototype:null,s=n.push,a=n.slice,l=o.toString,c=o.hasOwnProperty,d="undefined"!=typeof ArrayBuffer,u="undefined"!=typeof DataView,h=Array.isArray,p=Object.keys,f=Object.create,m=d&&ArrayBuffer.isView,g=isNaN,y=isFinite,v=!{toString:null}.propertyIsEnumerable("toString"),b=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],_=Math.pow(2,53)-1;function w(e,t){return t=null==t?e.length-1:+t,function(){for(var i=Math.max(arguments.length-t,0),n=Array(i),o=0;o<i;o++)n[o]=arguments[o+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var r=Array(t+1);for(o=0;o<t;o++)r[o]=arguments[o];return r[t]=n,e.apply(this,r)}}function T(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function S(e){return void 0===e}function A(e){return!0===e||!1===e||"[object Boolean]"===l.call(e)}function P(e){var t="[object "+e+"]";return function(e){return l.call(e)===t}}var E=P("String"),C=P("Number"),k=P("Date"),O=P("RegExp"),I=P("Error"),R=P("Symbol"),V=P("ArrayBuffer"),D=P("Function"),x=i.document&&i.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof x&&(D=function(e){return"function"==typeof e||!1});var N=D,M=P("Object"),L=u&&M(new DataView(new ArrayBuffer(8))),F="undefined"!=typeof Map&&M(new Map),B=P("DataView"),j=L?function(e){return null!=e&&N(e.getInt8)&&V(e.buffer)}:B,U=h||P("Array");function H(e,t){return null!=e&&c.call(e,t)}var W=P("Arguments");!function(){W(arguments)||(W=function(e){return H(e,"callee")})}();var z=W;function $(e){return C(e)&&g(e)}function q(e){return function(){return e}}function G(e){return function(t){var i=e(t);return"number"==typeof i&&i>=0&&i<=_}}function Y(e){return function(t){return null==t?void 0:t[e]}}var Q=Y("byteLength"),K=G(Q),X=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/,Z=d?function(e){return m?m(e)&&!j(e):K(e)&&X.test(l.call(e))}:q(!1),J=Y("length");function ee(e,t){t=function(e){for(var t={},i=e.length,n=0;n<i;++n)t[e[n]]=!0;return{contains:function(e){return t[e]},push:function(i){return t[i]=!0,e.push(i)}}}(t);var i=b.length,n=e.constructor,r=N(n)&&n.prototype||o,s="constructor";for(H(e,s)&&!t.contains(s)&&t.push(s);i--;)(s=b[i])in e&&e[s]!==r[s]&&!t.contains(s)&&t.push(s)}function te(e){if(!T(e))return[];if(p)return p(e);var t=[];for(var i in e)H(e,i)&&t.push(i);return v&&ee(e,t),t}function ie(e,t){var i=te(t),n=i.length;if(null==e)return!n;for(var o=Object(e),r=0;r<n;r++){var s=i[r];if(t[s]!==o[s]||!(s in o))return!1}return!0}function ne(e){return e instanceof ne?e:this instanceof ne?void(this._wrapped=e):new ne(e)}function oe(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,Q(e))}ne.VERSION=e,ne.prototype.value=function(){return this._wrapped},ne.prototype.valueOf=ne.prototype.toJSON=ne.prototype.value,ne.prototype.toString=function(){return String(this._wrapped)};var re="[object DataView]";function se(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;return("function"===o||"object"===o||"object"==typeof t)&&function e(t,i,n,o){t instanceof ne&&(t=t._wrapped),i instanceof ne&&(i=i._wrapped);var s=l.call(t);if(s!==l.call(i))return!1;if(L&&"[object Object]"==s&&j(t)){if(!j(i))return!1;s=re}switch(s){case"[object RegExp]":case"[object String]":return""+t==""+i;case"[object Number]":return+t!=+t?+i!=+i:0==+t?1/+t==1/i:+t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object Symbol]":return r.valueOf.call(t)===r.valueOf.call(i);case"[object ArrayBuffer]":case re:return e(oe(t),oe(i),n,o)}var a="[object Array]"===s;if(!a&&Z(t)){if(Q(t)!==Q(i))return!1;if(t.buffer===i.buffer&&t.byteOffset===i.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof t||"object"!=typeof i)return!1;var c=t.constructor,d=i.constructor;if(c!==d&&!(N(c)&&c instanceof c&&N(d)&&d instanceof d)&&"constructor"in t&&"constructor"in i)return!1}o=o||[];for(var u=(n=n||[]).length;u--;)if(n[u]===t)return o[u]===i;if(n.push(t),o.push(i),a){if((u=t.length)!==i.length)return!1;for(;u--;)if(!se(t[u],i[u],n,o))return!1}else{var h,p=te(t);if(u=p.length,te(i).length!==u)return!1;for(;u--;)if(!H(i,h=p[u])||!se(t[h],i[h],n,o))return!1}return n.pop(),o.pop(),!0}(e,t,i,n)}function ae(e){if(!T(e))return[];var t=[];for(var i in e)t.push(i);return v&&ee(e,t),t}function le(e){var t=J(e);return function(i){if(null==i)return!1;var n=ae(i);if(J(n))return!1;for(var o=0;o<t;o++)if(!N(i[e[o]]))return!1;return e!==pe||!N(i[ce])}}var ce="forEach",de=["clear","delete"],ue=["get","has","set"],he=de.concat(ce,ue),pe=de.concat(ue),fe=["add"].concat(de,ce,"has"),me=F?le(he):P("Map"),ge=F?le(pe):P("WeakMap"),ye=F?le(fe):P("Set"),ve=P("WeakSet");function be(e){for(var t=te(e),i=t.length,n=Array(i),o=0;o<i;o++)n[o]=e[t[o]];return n}function _e(e){for(var t={},i=te(e),n=0,o=i.length;n<o;n++)t[e[i[n]]]=i[n];return t}function we(e){var t=[];for(var i in e)N(e[i])&&t.push(i);return t.sort()}function Te(e,t){return function(i){var n=arguments.length;if(t&&(i=Object(i)),n<2||null==i)return i;for(var o=1;o<n;o++)for(var r=arguments[o],s=e(r),a=s.length,l=0;l<a;l++){var c=s[l];t&&void 0!==i[c]||(i[c]=r[c])}return i}}var Se=Te(ae),Ae=Te(te),Pe=Te(ae,!0);function Ee(e){if(!T(e))return{};if(f)return f(e);var t=function(){};t.prototype=e;var i=new t;return t.prototype=null,i}function Ce(e){return T(e)?U(e)?e.slice():Se({},e):e}function ke(e){return U(e)?e:[e]}function Oe(e){return ne.toPath(e)}function Ie(e,t){for(var i=t.length,n=0;n<i;n++){if(null==e)return;e=e[t[n]]}return i?e:void 0}function Re(e,t,i){var n=Ie(e,Oe(t));return S(n)?i:n}function Ve(e){return e}function De(e){return e=Ae({},e),function(t){return ie(t,e)}}function xe(e){return e=Oe(e),function(t){return Ie(t,e)}}function Ne(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 3:return function(i,n,o){return e.call(t,i,n,o)};case 4:return function(i,n,o,r){return e.call(t,i,n,o,r)}}return function(){return e.apply(t,arguments)}}function Me(e,t,i){return null==e?Ve:N(e)?Ne(e,t,i):T(e)&&!U(e)?De(e):xe(e)}function Le(e,t){return Me(e,t,1/0)}function Fe(e,t,i){return ne.iteratee!==Le?ne.iteratee(e,t):Me(e,t,i)}function Be(){}function je(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}ne.toPath=ke,ne.iteratee=Le;var Ue=Date.now||function(){return(new Date).getTime()};function He(e){var t=function(t){return e[t]},i="(?:"+te(e).join("|")+")",n=RegExp(i),o=RegExp(i,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(o,t):e}}var We={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ze=He(We),$e=He(_e(We)),qe=ne.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Ge=/(.)^/,Ye={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Qe=/\\|'|\r|\n|\u2028|\u2029/g;function Ke(e){return"\\"+Ye[e]}var Xe=0;function Ze(e,t,i,n,o){if(!(n instanceof t))return e.apply(i,o);var r=Ee(e.prototype),s=e.apply(r,o);return T(s)?s:r}var Je=w((function(e,t){var i=Je.placeholder,n=function(){for(var o=0,r=t.length,s=Array(r),a=0;a<r;a++)s[a]=t[a]===i?arguments[o++]:t[a];for(;o<arguments.length;)s.push(arguments[o++]);return Ze(e,n,this,this,s)};return n}));Je.placeholder=ne;var et=w((function(e,t,i){if(!N(e))throw new TypeError("Bind must be called on a function");var n=w((function(o){return Ze(e,n,t,this,i.concat(o))}));return n})),tt=G(J);function it(e,t,i,n){if(n=n||[],t||0===t){if(t<=0)return n.concat(e)}else t=1/0;for(var o=n.length,r=0,s=J(e);r<s;r++){var a=e[r];if(tt(a)&&(U(a)||z(a)))if(t>1)it(a,t-1,i,n),o=n.length;else for(var l=0,c=a.length;l<c;)n[o++]=a[l++];else i||(n[o++]=a)}return n}var nt=w((function(e,t){var i=(t=it(t,!1,!1)).length;if(i<1)throw new Error("bindAll must be passed function names");for(;i--;){var n=t[i];e[n]=et(e[n],e)}return e})),ot=w((function(e,t,i){return setTimeout((function(){return e.apply(null,i)}),t)})),rt=Je(ot,ne,1);function st(e){return function(){return!e.apply(this,arguments)}}function at(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=null),i}}var lt=Je(at,2);function ct(e,t,i){t=Fe(t,i);for(var n,o=te(e),r=0,s=o.length;r<s;r++)if(t(e[n=o[r]],n,e))return n}function dt(e){return function(t,i,n){i=Fe(i,n);for(var o=J(t),r=e>0?0:o-1;r>=0&&r<o;r+=e)if(i(t[r],r,t))return r;return-1}}var ut=dt(1),ht=dt(-1);function pt(e,t,i,n){for(var o=(i=Fe(i,n,1))(t),r=0,s=J(e);r<s;){var a=Math.floor((r+s)/2);i(e[a])<o?r=a+1:s=a}return r}function ft(e,t,i){return function(n,o,r){var s=0,l=J(n);if("number"==typeof r)e>0?s=r>=0?r:Math.max(r+l,s):l=r>=0?Math.min(r+1,l):r+l+1;else if(i&&r&&l)return n[r=i(n,o)]===o?r:-1;if(o!=o)return(r=t(a.call(n,s,l),$))>=0?r+s:-1;for(r=e>0?s:l-1;r>=0&&r<l;r+=e)if(n[r]===o)return r;return-1}}var mt=ft(1,ut,pt),gt=ft(-1,ht);function yt(e,t,i){var n=(tt(e)?ut:ct)(e,t,i);if(void 0!==n&&-1!==n)return e[n]}function vt(e,t,i){var n,o;if(t=Ne(t,i),tt(e))for(n=0,o=e.length;n<o;n++)t(e[n],n,e);else{var r=te(e);for(n=0,o=r.length;n<o;n++)t(e[r[n]],r[n],e)}return e}function bt(e,t,i){t=Fe(t,i);for(var n=!tt(e)&&te(e),o=(n||e).length,r=Array(o),s=0;s<o;s++){var a=n?n[s]:s;r[s]=t(e[a],a,e)}return r}function _t(e){var t=function(t,i,n,o){var r=!tt(t)&&te(t),s=(r||t).length,a=e>0?0:s-1;for(o||(n=t[r?r[a]:a],a+=e);a>=0&&a<s;a+=e){var l=r?r[a]:a;n=i(n,t[l],l,t)}return n};return function(e,i,n,o){var r=arguments.length>=3;return t(e,Ne(i,o,4),n,r)}}var wt=_t(1),Tt=_t(-1);function St(e,t,i){var n=[];return t=Fe(t,i),vt(e,(function(e,i,o){t(e,i,o)&&n.push(e)})),n}function At(e,t,i){t=Fe(t,i);for(var n=!tt(e)&&te(e),o=(n||e).length,r=0;r<o;r++){var s=n?n[r]:r;if(!t(e[s],s,e))return!1}return!0}function Pt(e,t,i){t=Fe(t,i);for(var n=!tt(e)&&te(e),o=(n||e).length,r=0;r<o;r++){var s=n?n[r]:r;if(t(e[s],s,e))return!0}return!1}function Et(e,t,i,n){return tt(e)||(e=be(e)),("number"!=typeof i||n)&&(i=0),mt(e,t,i)>=0}var Ct=w((function(e,t,i){var n,o;return N(t)?o=t:(t=Oe(t),n=t.slice(0,-1),t=t[t.length-1]),bt(e,(function(e){var r=o;if(!r){if(n&&n.length&&(e=Ie(e,n)),null==e)return;r=e[t]}return null==r?r:r.apply(e,i)}))}));function kt(e,t){return bt(e,xe(t))}function Ot(e,t,i){var n,o,r=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=tt(e)?e:be(e)).length;a<l;a++)null!=(n=e[a])&&n>r&&(r=n);else t=Fe(t,i),vt(e,(function(e,i,n){((o=t(e,i,n))>s||o===-1/0&&r===-1/0)&&(r=e,s=o)}));return r}function It(e,t,i){if(null==t||i)return tt(e)||(e=be(e)),e[je(e.length-1)];var n=tt(e)?Ce(e):be(e),o=J(n);t=Math.max(Math.min(t,o),0);for(var r=o-1,s=0;s<t;s++){var a=je(s,r),l=n[s];n[s]=n[a],n[a]=l}return n.slice(0,t)}function Rt(e,t){return function(i,n,o){var r=t?[[],[]]:{};return n=Fe(n,o),vt(i,(function(t,o){var s=n(t,o,i);e(r,t,s)})),r}}var Vt=Rt((function(e,t,i){H(e,i)?e[i].push(t):e[i]=[t]})),Dt=Rt((function(e,t,i){e[i]=t})),xt=Rt((function(e,t,i){H(e,i)?e[i]++:e[i]=1})),Nt=Rt((function(e,t,i){e[i?0:1].push(t)}),!0),Mt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Lt(e,t,i){return t in i}var Ft=w((function(e,t){var i={},n=t[0];if(null==e)return i;N(n)?(t.length>1&&(n=Ne(n,t[1])),t=ae(e)):(n=Lt,t=it(t,!1,!1),e=Object(e));for(var o=0,r=t.length;o<r;o++){var s=t[o],a=e[s];n(a,s,e)&&(i[s]=a)}return i})),Bt=w((function(e,t){var i,n=t[0];return N(n)?(n=st(n),t.length>1&&(i=t[1])):(t=bt(it(t,!1,!1),String),n=function(e,i){return!Et(t,i)}),Ft(e,n,i)}));function jt(e,t,i){return a.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))}function Ut(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[0]:jt(e,e.length-t)}function Ht(e,t,i){return a.call(e,null==t||i?1:t)}var Wt=w((function(e,t){return t=it(t,!0,!0),St(e,(function(e){return!Et(t,e)}))})),zt=w((function(e,t){return Wt(e,t)}));function $t(e,t,i,n){A(t)||(n=i,i=t,t=!1),null!=i&&(i=Fe(i,n));for(var o=[],r=[],s=0,a=J(e);s<a;s++){var l=e[s],c=i?i(l,s,e):l;t&&!i?(s&&r===c||o.push(l),r=c):i?Et(r,c)||(r.push(c),o.push(l)):Et(o,l)||o.push(l)}return o}var qt=w((function(e){return $t(it(e,!0,!0))}));function Gt(e){for(var t=e&&Ot(e,J).length||0,i=Array(t),n=0;n<t;n++)i[n]=kt(e,n);return i}var Yt=w(Gt);function Qt(e,t){return e._chain?ne(t).chain():t}function Kt(e){return vt(we(e),(function(t){var i=ne[t]=e[t];ne.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),Qt(this,i.apply(ne,e))}})),ne}vt(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=n[e];ne.prototype[e]=function(){var i=this._wrapped;return null!=i&&(t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0]),Qt(this,i)}})),vt(["concat","join","slice"],(function(e){var t=n[e];ne.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),Qt(this,e)}}));var Xt=Kt({__proto__:null,VERSION:e,restArguments:w,isObject:T,isNull:function(e){return null===e},isUndefined:S,isBoolean:A,isElement:function(e){return!(!e||1!==e.nodeType)},isString:E,isNumber:C,isDate:k,isRegExp:O,isError:I,isSymbol:R,isArrayBuffer:V,isDataView:j,isArray:U,isFunction:N,isArguments:z,isFinite:function(e){return!R(e)&&y(e)&&!isNaN(parseFloat(e))},isNaN:$,isTypedArray:Z,isEmpty:function(e){if(null==e)return!0;var t=J(e);return"number"==typeof t&&(U(e)||E(e)||z(e))?0===t:0===J(te(e))},isMatch:ie,isEqual:function(e,t){return se(e,t)},isMap:me,isWeakMap:ge,isSet:ye,isWeakSet:ve,keys:te,allKeys:ae,values:be,pairs:function(e){for(var t=te(e),i=t.length,n=Array(i),o=0;o<i;o++)n[o]=[t[o],e[t[o]]];return n},invert:_e,functions:we,methods:we,extend:Se,extendOwn:Ae,assign:Ae,defaults:Pe,create:function(e,t){var i=Ee(e);return t&&Ae(i,t),i},clone:Ce,tap:function(e,t){return t(e),e},get:Re,has:function(e,t){for(var i=(t=Oe(t)).length,n=0;n<i;n++){var o=t[n];if(!H(e,o))return!1;e=e[o]}return!!i},mapObject:function(e,t,i){t=Fe(t,i);for(var n=te(e),o=n.length,r={},s=0;s<o;s++){var a=n[s];r[a]=t(e[a],a,e)}return r},identity:Ve,constant:q,noop:Be,toPath:ke,property:xe,propertyOf:function(e){return null==e?Be:function(t){return Re(e,t)}},matcher:De,matches:De,times:function(e,t,i){var n=Array(Math.max(0,e));t=Ne(t,i,1);for(var o=0;o<e;o++)n[o]=t(o);return n},random:je,now:Ue,escape:ze,unescape:$e,templateSettings:qe,template:function(e,t,i){!t&&i&&(t=i),t=Pe({},t,ne.templateSettings);var n,o=RegExp([(t.escape||Ge).source,(t.interpolate||Ge).source,(t.evaluate||Ge).source].join("|")+"|$","g"),r=0,s="__p+='";e.replace(o,(function(t,i,n,o,a){return s+=e.slice(r,a).replace(Qe,Ke),r=a+t.length,i?s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),t})),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(t.variable||"obj","_",s)}catch(e){throw e.source=s,e}var a=function(e){return n.call(this,e,ne)},l=t.variable||"obj";return a.source="function("+l+"){\n"+s+"}",a},result:function(e,t,i){var n=(t=Oe(t)).length;if(!n)return N(i)?i.call(e):i;for(var o=0;o<n;o++){var r=null==e?void 0:e[t[o]];void 0===r&&(r=i,o=n),e=N(r)?r.call(e):r}return e},uniqueId:function(e){var t=++Xe+"";return e?e+t:t},chain:function(e){var t=ne(e);return t._chain=!0,t},iteratee:Le,partial:Je,bind:et,bindAll:nt,memoize:function(e,t){var i=function(n){var o=i.cache,r=""+(t?t.apply(this,arguments):n);return H(o,r)||(o[r]=e.apply(this,arguments)),o[r]};return i.cache={},i},delay:ot,defer:rt,throttle:function(e,t,i){var n,o,r,s,a=0;i||(i={});var l=function(){a=!1===i.leading?0:Ue(),n=null,s=e.apply(o,r),n||(o=r=null)},c=function(){var c=Ue();a||!1!==i.leading||(a=c);var d=t-(c-a);return o=this,r=arguments,d<=0||d>t?(n&&(clearTimeout(n),n=null),a=c,s=e.apply(o,r),n||(o=r=null)):n||!1===i.trailing||(n=setTimeout(l,d)),s};return c.cancel=function(){clearTimeout(n),a=0,n=o=r=null},c},debounce:function(e,t,i){var n,o,r=function(t,i){n=null,i&&(o=e.apply(t,i))},s=w((function(s){if(n&&clearTimeout(n),i){var a=!n;n=setTimeout(r,t),a&&(o=e.apply(this,s))}else n=ot(r,t,this,s);return o}));return s.cancel=function(){clearTimeout(n),n=null},s},wrap:function(e,t){return Je(t,e)},negate:st,compose:function(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:at,once:lt,findKey:ct,findIndex:ut,findLastIndex:ht,sortedIndex:pt,indexOf:mt,lastIndexOf:gt,find:yt,detect:yt,findWhere:function(e,t){return yt(e,De(t))},each:vt,forEach:vt,map:bt,collect:bt,reduce:wt,foldl:wt,inject:wt,reduceRight:Tt,foldr:Tt,filter:St,select:St,reject:function(e,t,i){return St(e,st(Fe(t)),i)},every:At,all:At,some:Pt,any:Pt,contains:Et,includes:Et,include:Et,invoke:Ct,pluck:kt,where:function(e,t){return St(e,De(t))},max:Ot,min:function(e,t,i){var n,o,r=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=tt(e)?e:be(e)).length;a<l;a++)null!=(n=e[a])&&n<r&&(r=n);else t=Fe(t,i),vt(e,(function(e,i,n){((o=t(e,i,n))<s||o===1/0&&r===1/0)&&(r=e,s=o)}));return r},shuffle:function(e){return It(e,1/0)},sample:It,sortBy:function(e,t,i){var n=0;return t=Fe(t,i),kt(bt(e,(function(e,i,o){return{value:e,index:n++,criteria:t(e,i,o)}})).sort((function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index})),"value")},groupBy:Vt,indexBy:Dt,countBy:xt,partition:Nt,toArray:function(e){return e?U(e)?a.call(e):E(e)?e.match(Mt):tt(e)?bt(e,Ve):be(e):[]},size:function(e){return null==e?0:tt(e)?e.length:te(e).length},pick:Ft,omit:Bt,first:Ut,head:Ut,take:Ut,initial:jt,last:function(e,t,i){return null==e||e.length<1?null==t||i?void 0:[]:null==t||i?e[e.length-1]:Ht(e,Math.max(0,e.length-t))},rest:Ht,tail:Ht,drop:Ht,compact:function(e){return St(e,Boolean)},flatten:function(e,t){return it(e,t,!1)},without:zt,uniq:$t,unique:$t,union:qt,intersection:function(e){for(var t=[],i=arguments.length,n=0,o=J(e);n<o;n++){var r=e[n];if(!Et(t,r)){var s;for(s=1;s<i&&Et(arguments[s],r);s++);s===i&&t.push(r)}}return t},difference:Wt,unzip:Gt,transpose:Gt,zip:Yt,object:function(e,t){for(var i={},n=0,o=J(e);n<o;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},range:function(e,t,i){null==t&&(t=e||0,e=0),i||(i=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/i),0),o=Array(n),r=0;r<n;r++,e+=i)o[r]=e;return o},chunk:function(e,t){if(null==t||t<1)return[];for(var i=[],n=0,o=e.length;n<o;)i.push(a.call(e,n,n+=t));return i},mixin:Kt,default:ne});return Xt._=Xt,Xt},e.exports=i()}).call(this,i(37))},function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return f}));var n=i(13);function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i(5);var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i;return t=e,(i=[{key:"createStateHandlers",value:function(e){Object(n.a)(this,e)}}])&&o(t.prototype,i),e}(),s=i(3),a=i.n(s);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=i(5),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h(e);if(t){var o=h(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u(this,i)}}(r);function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),o.call(this,e)}return t=r,(i=[{key:"renderTemplate",value:function(){if(this.template&&this.model&&(this.template=p.template(this.template),this.$el.append(this.template(this.model.attributes)),this.ui)){var e={};for(var t in this.ui)e[t]=this.$el.find(this.ui[t]);this.ui=e}}},{key:"createStateHandlers",value:function(e){Object(n.a)(this,e)}}])&&c(t.prototype,i),r}(a.a.View)},function(e,t){e.exports={player:void 0,oppsula:void 0,pms:void 0,serviceLoader:void 0,microServices:{base_url:"//vidstat.taboola.com/",async:!0,PMS:{version:"2.2.1"}}}},function(e,t,i){"use strict";i.d(t,"d",(function(){return Re})),i.d(t,"b",(function(){return g})),i.d(t,"e",(function(){return R})),i.d(t,"f",(function(){return L})),i.d(t,"g",(function(){return Q})),i.d(t,"h",(function(){return J})),i.d(t,"a",(function(){return se})),i.d(t,"i",(function(){return ge})),i.d(t,"c",(function(){return Ye}));var n=i(3),o=i.n(n),r=i(4),s=i(0),a=(o.a.View.extend({className:"_cm-poster",id:"_cm-css-reset",initialize:function(e){this.log=new r.a({unitType:"Component",className:"PosterView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.render()},render:function(){this.staticBanner=document.createElement("img"),this.staticBanner.addEventListener("error",this._onError.bind(this));var e=this.model.get("components.PosterView.imageLocation");this.staticBanner.src=e,this.staticBanner.height=this.model.get("height"),this.staticBanner.width=this.model.get("width"),this.staticBanner.onclick=this._onClick.bind(this),this.$el.hide(),this.$el.append(this.staticBanner),this.container.prepend(this.$el)},_onError:function(){o.a.trigger("error",this.staticBanner,"imageLoadError"),this.$el.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_onClick:function(e){this.trigger("cm:banner:click")}}),i(51),o.a.View.extend({className:"_cm-click-through",initialize:function(e){this.log=new r.a({unitType:"Component",className:"ClickThrough",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.link=e.link,this.render()},render:function(){this.$el.click(this.onClick.bind(this)),this.container.appendChild(this.el)},onClick:function(){this.link&&window.open(this.link,"_blank")},hide:function(){this.$el.hide()},show:function(){this.$el.show()},updateLink:function(e){this.link=e}}),i(13)),l=i(23),c=i.n(l),d=i(1),u=i.n(d),h=i(3),p=i(5),f=i(10),m=i(2),g=h.View.extend({className:"_cm-close-area",id:"_cm-close-area",events:{"click ":"_onClick"},initialize:function(e){this.log=new f({unitType:e.unitType,className:"closeButtonView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=a.a,this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){if(!this._rendered){this._rendered=!0,this.$el.append(c.a);var e=this.model.get("wurfl.browser.name").toLowerCase();-1===e.indexOf(u.a.BROWSER.FIREFOX.toLowerCase())&&-1===e.indexOf(u.a.BROWSER.IE.toLowerCase())&&-1===e.indexOf(u.a.BROWSER.EDGE.toLowerCase())||this.$el.addClass("_cm-close-ie-fix"),this.container=p.isArray(this.container)?this.container[0]:this.container,this.container.appendChild(this.el),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&("detached"===this.model.get("videoViewState")?this.show():this.hide())}},_bindEvents:function(){this.model.get("vForce.isActive")?this.listenTo(this.model,"change:adState",this._onStateChange):this.listenTo(this.model,"change:state",this._onStateChange),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onPlaying:function(){var e=this.model.get("components.CloseButtonView.delay");this.renderTimeout=setTimeout(this.render.bind(this),e)},_onClick:function(e){e.stopPropagation(),this.model.get("onClose")||"OMNI_TAG"==this.model.get("unitType")||p.firePixel(this.model.getPixel("pixels.close"),"close (user clicked the close button)"),this.model.set("state",this.model.STATE.STOPPED_BY_USER),h.trigger("Ad:stoppedByUser"),this.model.trigger("ad:stoppedByUser",m.closeState.terminate)},_onStateChange:function(e,t){t!==e.STATE.PLAYING&&t!==m.adState.playing||this._onPlaying()},_onVideoViewStateChange:function(e,t){switch(t){case"detached":this.show();break;case"attached":this.hide()}},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),y=i(3),v=i(5),b=i(10),_=i(2),w=(y.View.extend({className:"_cm-close-area",id:"_cm-close-area",closeButtonRenderd:!1,events:{"click ":"_onClick"},initialize:function(e){this.log=new b({unitType:e.unitType,className:"closeButtonView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=a.a,this.render(),this.hide()},render:function(){this._rendered||(this._rendered=!0,this.isInDelay=!1,this.$el.append(c.a),this.container.appendChild(this.el))},_bindEvents:function(){this.listenTo(this.model,"change:state",this._onStateChange),this.listenTo(this.model,"change:adState",this._onStateChange),(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.model.get("detachToSlider.hasCloseButton")&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onPlaying:function(){this.model.get("videoViewState")!==_.videoViewState.attached||this.model.get("hasCloseButton")?this._startRender():this.isInDelay&&(this.closeButtonRenderd=!1,clearTimeout(this.delayTimeout))},_startRender:function(){if(this.closeButtonRenderd)this.show();else{this.closeButtonRenderd=!0;var e=this.model.get("components.CloseButtonView.delay");this.isInDelay=!0,this.delayTimeout=setTimeout(this.render.bind(this),e)}},_onClick:function(){this.model.get("onClose")||"OMNI_TAG"==this.model.get("unitType")||v.firePixel(this.model.getPixel("pixels.close"),"close (user clicked the close button)"),this.model.set("state",this.model.STATE.STOPPED_BY_USER),y.trigger("Ad:stoppedByUser"),this.model.trigger("ad:stoppedByUser")},_onStateChange:function(e,t){switch(t){case"playing":this._onPlaying()}},_onVideoViewStateChange:function(e,t){"detached"===t&&!this.closeButtonRenderd&&this.model.get("detachToSlider.hasCloseButton")&&this._startRender(),"attached"!==t||this.model.get("hasCloseButton")||this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),i(31)),T=i(3),S=i(5),A=i(10),P=i(98),E=(T.View.extend({className:"_cm-d2d-fallback",initialize:function(e){this.log=new A({unitType:e.unitType,className:"D2dFallbackView"}),this.model=e.model,this.container=e.container,this.isTrusted=!0,this.shouldReport=S.isFactor(this.model.get("gaFactor")),this.shouldReport&&this.model.get("isReportToKibana")&&(this.model.set("gaFactor",1),this.kibana=new w.a({model:this.model})),this.pubId=e.pubId?e.pubId:this.model.get("components.D2DFallbackView.pubId"),this.pubTagId=e.pubTagId?e.pubTagId:this.model.get("components.D2DFallbackView.pubTagId"),this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.$el.append(P),this._customize(),Object(s.a)(this.container).append(this.$el),this.iframe=this.$el.find("iframe")[0],this.iframe.contentWindow?this._writeIframe():this.iframe.onload=this._writeIframe.bind(this),S.firePixel(this.model.getPixel("pixels.D2DFallback"),"D2DFallback")},_writeIframe:function(){this.iframe.onload=this.iFrameOnLoad.bind(this);var e=this.iframe.contentWindow.document;e.open(),e.write('<script type="text/javascript" src="'.concat(this.buildFallbackURL(),'"><\/script>')),e.close(),e.onclick=this._onClick.bind(this)},iFrameOnLoad:function(){var e=Object(s.a)(this.iframe.contentWindow.document.body);Object(s.a)("div",e).length>0&&this.model.set("d2dLoaded",!0)},buildFallbackURL:function(){return"".concat(this.model.get("components.D2DFallbackView.location"),"?")+"oid=15"+"&width=".concat(this.model.get("components.D2DFallbackView.width"))+"&height=".concat(this.model.get("components.D2DFallbackView.height"))+"&pubid=".concat(this.pubId)+"&tagid=".concat(this.pubTagId)+"&pstn=".concat(this.model.get("components.D2DFallbackView.pstn"))+"&cirf=".concat(this.model.get("referrer"))+"&noaop=1&revmod=INSERT_CONTENT_TYPE&encoded=1&cb=INSERT_CACHEBUSTER&keywords=INSERT_COMMA_SEPARATED_KEYWORDS&urlonly=1&callback=document.write"},hide:function(e){this.log.info("D2D hide:",e),e?this.$el.css({display:"none"}):this.$el.css({display:"block"})},show:function(){this.$el.css({display:"block"})},_onClick:function(e){this.isTrusted=!0,e.isTrusted?window.setTimeout(this._onTimeoutEnd.bind(this),1e3*this.model.get("clickTestSeconds")):(S.firePixel(this.model.getPixel("pixels.D2DClickSuspicious"),"Suspicious D2DClick"),this.kibana&&this.kibana.onD2DClick(e.isTrusted))},_onTimeoutEnd:function(){document.hidden?S.firePixel(this.model.getPixel("pixels.D2DClick"),"D2DClick"):(S.firePixel(this.model.getPixel("pixels.D2DClickSuspicious"),"Suspicious D2DClick"),this.kibana&&this.kibana.onD2DClick(!0,!1))},_customize:function(){var e=this.model.get("components.D2DFallbackView.additionalCss");this.$el.css(S.toCssObj(e))},updateD2D:function(e,t){this.iframe&&this.pubId!=e&&this.pubTagId!=t&&(this.pubId=e,this.pubTagId=t,this._writeIframe())},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide(!0)},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide(!0)}}),i(52),i(59)),C=i.n(E),k=i(35),O=i.n(k),I=i(2),R=o.a.View.extend({className:"_cm-loading",id:"_cm-css-reset",initialize:function(e){this.log=new r.a({unitType:"Component",className:"LoadingView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),e.globalModel&&(this.globalModel=e.globalModel),this.container=e.container,this.isShowReplayScreen=e.isStartWithReplay,this.isReplayable=e.isReplayable,this._createStatesAction(),this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(this.model,"change:adQState",this._onAdStateChange.bind(this,this.adStateActions)),this.listenTo(this.model,"change:adManagerState",this._onAdStateChange.bind(this,this.getAdStateActions)),this.model.on("change:viewTopComponent",this._toggleLoadingVisibility,this),this.model.on("change:repeatState",this._onReplayAdShowing,this),this.globalModel&&this.listenTo(this.globalModel,"change:adManagerState",this._onGlobalModelAdStateChange.bind(this,this.getAdStateActions))},_createStatesAction:function(){this.adStateActions={q0:this._onAdPlaying.bind(this),completed:this._onVideoComplete.bind(this),stopped:this._stop.bind(this)},this.getAdStateActions={stopped:this._stop.bind(this)}},_onGlobalModelAdStateChange:function(e,t,i){if(i==I.adManagerState.stopped){var n=e[i];n&&n()}},_onAdStateChange:function(e,t,i){var n=e[i];n&&n()},render:function(){this.$el.append(C.a),this.loadingDiv=this.$el.find("._cm-loading-div"),"css"==this.model.get("components.Loading.type")?this.loadCss():"img"==this.model.get("components.Loading.type")&&this.loadImage(),this._applyAdditionalCss(),this.isShowReplayScreen&&this.$el.css("background","transparent"),this.$el.hide(),this.container.appendChild(this.el),this._renderReapet(),this.currentActiveImage=this.innerDisplay},_renderReapet:function(){this.repeatEl=Object(s.a)(O.a),this._setBackground(),this._setRepeatIcon(),this.learnMoreWrapper=this.repeatEl.find("._cm-learn-more-buttons-wrapper"),this.learnMoreWrapper.hide(),this.model.get("renderLearnMore")&&this._setLearnMoreIcon(),this.repeatEl.hide(),this.loadingDiv.append(this.repeatEl)},_setRepeatIcon:function(){this.repeatViewWrapper=this.repeatEl.find("._cm-repeat-view-wrapper"),this.repeatButtonsWrapper=this.repeatEl.find("._cm-repeat-buttons-wrapper");var e=this.repeatEl.find("._cm-repeat-button"),t=this.repeatEl.find("._cm-repeat-button-hover"),i=this.model.get("components.Repeat.repalyIcon"),n=this.model.get("components.Repeat.replayHoverIcon");this._setButtonSrc(e,t,i,n)},_setLearnMoreIcon:function(){var e=this.repeatEl.find("._cm-learn-more-button"),t=this.repeatEl.find("._cm-learn-more-button-hover"),i=this.model.get("components.Repeat.learnMoreIcon"),n=this.model.get("components.Repeat.learnMoreHoverIcon");this._setButtonSrc(e,t,i,n),this.model.get("adClickThroughUrl")?this.repeatEl.click(this._onLearnMoreClick.bind(this)):this.listenTo(this.model,"change:adClickThroughUrl",this._updateLearnMoreUrl)},_setButtonSrc:function(e,t,i,n){e.attr("src",i),t.attr("src",n)},_setBackground:function(){var e=this.model.get("components.Repeat.backgroundImage");this.repeatEl.css("background-image",'url("'+e+'") !important')},loadCss:function(){var e=document.createElement("div");e.className="_cm-loading-icon",this.loadingDiv.append(e),this.innerDisplay=Object(s.a)(e)},loadImage:function(){var e=document.createElement("img");e.src=this.model.get("components.Loading.imgUrl"),e.className="_cm_loader_img",this.loadingDiv.append(e),this.innerDisplay=Object(s.a)(e)},hide:function(){this.isRepeatShowing=!1,this.$el.hide(),this._setModel("loadingViewState",I.loadingViewState.hiding)},show:function(){this.isShowReplayScreen&&this._showRe(),this.$el.show(),this._setLoadingViewSize(this.currentActiveImage.width(),this.currentActiveImage.height()),this._setModel("loadingViewState",I.loadingViewState.showing)},showRepeat:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._stop(e)},_onRepeatClick:function(e){e.stopPropagation(),this.log.info("User click"),this.clickEventRegistered=!1,this._setModel("loadingViewState",I.loadingViewState.clicked),this.repeatEl.hide(),this.innerDisplay.show(),this.currentActiveImage=this.innerDisplay,this._setLoadingViewSize(this.currentActiveImage.width(),this.currentActiveImage.height())},_onLearnMoreClick:function(e){window.open(this.model.get("adClickThroughUrl")),this.model.increaseCounter("learnMoreWasClicked",!0)},_onAdPlaying:function(){this.hide()},_onVideoComplete:function(){this.model.get("displayFiller.betweenAds")!==u.a.DISPLAY_FILLER.BETWEEN_ADS.CONTENT&&this.show()},_stop:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.model.get("isAdClosedByTimer")||this.model.get("closeState")||(this.clickEventRegistered||(this.repeatButtonsWrapper.one("click",this._onRepeatClick.bind(this)),this.clickEventRegistered=!0),this.show(),this.innerDisplay.hide(),this.currentActiveImage=this.repeatEl,this._setLoadingViewSize("auto","auto"),this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.isReplayable||this.repeatButtonsWrapper.hide(),e&&this.repeatViewWrapper.addClass("_cm-repeat-view-wrapper-detached"),this.repeatEl.show())},_showRe:function(){this.isRepeatShowing||(this.innerDisplay.hide(),this.clickEventRegistered||(this.repeatButtonsWrapper.one("click",this._onRepeatClick.bind(this)),this.clickEventRegistered=!0),this.currentActiveImage=this.repeatEl,this._setLoadingViewSize("auto","auto"),this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.isReplayable||this.repeatButtonsWrapper.hide(),this.repeatEl.show(),this.isRepeatShowing=!0)},_setLoadingViewSize:function(e,t){this.loadingDiv.css({width:e,height:t})},_setModel:function(e,t){this.globalModel&&this.globalModel.set(e,t),this.model.set(e,t)},_applyAdditionalCss:function(){var e=this.model.get("additionalCss");e&&(e["z-index"]||e.zIndex)&&this.$el.css({"z-index":e["z-index"]})},_updateLearnMoreUrl:function(){this.model.get("adClickThroughUrl")&&(this.repeatEl.click(this._onLearnMoreClick.bind(this)),this.learnMoreWrapper.show())},_toggleLoadingVisibility:function(){var e=this.model.get("viewTopComponent");this.log.info("_onTopComponentChange",e),e===u.a.FLOATING_VIEW_TOP_COMPONENT.loading?this.show():this.hide()},_onReplayAdShowing:function(){this.model.get("repeatState")===I.repeatState.showing&&this.hide()},resize:function(e){this._isLoadingViewDisplayed()&&this.loadingDiv.css(e)},onAttach:function(){this._isLoadingViewDisplayed()&&this.repeatViewWrapper.removeClass("_cm-repeat-view-wrapper-detached")},_isLoadingViewDisplayed:function(){return this.model.get("loadingViewState")===I.loadingViewState.showing}}),V=i(3),D=i(5),x=i(10),N=i(2),M=i(99),L=V.View.extend({events:{"click ._cm-opt-button":"toggleDialog","click ._cm-cancel":"hideDialog","click ._cm-submit":"submitDialog"},id:"_cm-opt-out-view",className:"_cm-opt-out-view",initialize:function(e){this.log=new x({unitType:e.unitType,className:"optOut"}),this.container=e.container,this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.$el.append(M),Object(s.a)(this.container).prepend(this.$el),this.ui={},this.ui.Dialog=this.$el.find("._cm-opt-dialog"),this.hideDialog()},toggleDialog:function(){"none"===this.ui.Dialog.get(0).style.display?this.showDialog():this.hideDialog()},showDialog:function(){this.$el.trigger("cm:optout:dialog:show"),this.ui.Dialog.show()},hideDialog:function(){this.$el.trigger("cm:optout:dialog:hide"),this.ui.Dialog.hide()},submitDialog:function(){var e=this.el.querySelector("._cm-opt-text").value,t=this.model.getPixel("pixels.optOutNever")+"&userComplaint="+e;D.firePixel(t,"Never OptOut"),this.hideDialog(),this.model.set("state",this.model.STATE.OPT_OUT),this.model.set("closeState",N.closeState.terminate),this.$el.trigger("cm:optout:submit")},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()}}),F=i(3),B=i(5),j=i(10),U=i(100),H=F.View.extend({errorCount:0,events:{"click ._cm-playlist-item":"_onItemClick"},initialize:function(e){this.log=new j({unitType:"playlist-item",className:"PlayListView"}),this.model=e.model,this.container=e.container,this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(this.model,"change:active",this.setActive)},render:function(){var e={image:this.model.get("image"),title:this.model.get("title")},t=B.template(U)(e);this.$el.append(t),Object(s.a)(this.container).append(this.$el),this._item=this.$el.find("._cm-playlist-item")},_onItemClick:function(e){this.model.set("clicked",!0)},setActive:function(e,t){t?this._item.addClass("active"):this._item.removeClass("active")}}),W=i(60),z=i.n(W),$=(i(53),i(61)),q=i.n($),G=(i(5),o.a.View.extend({errorCount:0,className:"_cm-playlist",initialize:function(e){this.log=new r.a({unitType:"playlist",className:"PlayListView"}),this.playListCollection=new z.a,this.container=e.container,this._playlist=e.playlist,this._height=e.height||350,this._itemCount=parseInt(this._height/74),this._itemCount=Math.min(this._playlist.length,this._itemCount),this._playlist=this._playlist.slice(0,this._itemCount),this._height=Math.min(this._height,74*this._itemCount),this._bindEvents(),this.render()},_bindEvents:function(){this.listenTo(o.a,"change:player:content",this._onContentChanged),this.listenTo(this.model,"change:state",this._onStateChange),this.listenToOnce(this.playListCollection,"change:clicked",this._itemSelected)},render:function(){this.$el.append(q.a),Object(s.a)(this.container).append(this.$el),this._playlist_list=this.$el.find("._cm-playlist-list"),this.$el.css({height:parseInt(this._height)})},_setPlayList:function(){this.playListCollection.length>0||(this.playListCollection.add(this._playlist),this.playListCollection.forEach((function(e){new H({model:e,container:this._playlist_list})}),this),this.playListCollection.first().set("active",!0))},_onStateChange:function(e,t){switch(t){case e.STATE.PLAYER_READY:this._setPlayList()}},_itemSelected:function(e){e.set("clicked",!1),this._playItem(e),this.listenToOnce(this.playListCollection,"change:clicked",this._itemSelected)},_playItem:function(e){if(!this._playlist_list.hasClass("unclickable")){var t=this.playListCollection.findWhere({active:!0});t&&t.set("active",!1),e.set("active",!0),this.$el.trigger("_cm-unit-play",e.attributes)}},_onContentChanged:function(e){this.log.important("On content changed",e);var t=this.playListCollection.findWhere({active:!0});t&&t.set("active",!1),(t=this.playListCollection.findWhere({id:e.id}))&&t.set("active",!0)},playNext:function(){var e=this.playListCollection.findWhere({active:!0}),t=this.playListCollection.indexOf(e)+1;t>=this._itemCount&&(t=0),this._playItem(this.playListCollection.at(t))},setUnclickable:function(e){e?this._playlist_list.addClass("unclickable"):this._playlist_list.removeClass("unclickable")}}),i(5)),Y=i(35),Q=o.a.View.extend({className:"_cm-repeat",id:"_cm-css-reset",initialize:function(e){this.log=new r.a({unitType:"Component",className:"RepeatView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.active=!1,this._createStatesAction(),this._bindEvents(),this._render()},_render:function(){this.repeatEl=Object(s.a)(Y),this._setRepeatIcon(),this.learnMoreWrapper=this.repeatEl.find("._cm-learn-more-buttons-wrapper"),this.learnMoreWrapper.hide(),this.model.get("renderLearnMore")&&this._setLearnMoreIcon(),this._setBackground(),this.$el.hide(),this.$el.append(this.repeatEl),this.container.appendChild(this.el)},_setRepeatIcon:function(){this.repeatWrapper=this.repeatEl.find("._cm-repeat-buttons-wrapper");var e=this.repeatEl.find("._cm-repeat-button"),t=this.repeatEl.find("._cm-repeat-button-hover"),i=this.model.get("components.Repeat.repalyIcon"),n=this.model.get("components.Repeat.replayHoverIcon");this._setButtonSrc(e,t,i,n),this.repeatWrapper.click(this._onClick.bind(this))},_setLearnMoreIcon:function(){var e=this.repeatEl.find("._cm-learn-more-button"),t=this.repeatEl.find("._cm-learn-more-button-hover"),i=this.model.get("components.Repeat.learnMoreIcon"),n=this.model.get("components.Repeat.learnMoreHoverIcon");this._setButtonSrc(e,t,i,n),this.model.get("adClickThroughUrl")?this.learnMoreWrapper.click(this._onLearnMoreClick.bind(this)):this.listenTo(this.model,"change:adClickThroughUrl",this._updateLearnMoreUrl)},_setButtonSrc:function(e,t,i,n){e.attr("src",i),t.attr("src",n)},_setBackground:function(){var e=this.model.get("components.Repeat.backgroundImage");this.repeatEl.css("background-image",'url("'+e+'") !important')},hide:function(){this.$el.hide(),this.active=!1,this.isSpinning=!1,this.model.set("repeatState",I.repeatState.hiding)},show:function(){this.learnMoreWrapper&&this.model.get("adClickThroughUrl")&&this.model.get("renderLearnMore")&&this.learnMoreWrapper.show(),this.repeatWrapper&&this.model.get("dontRenderRepeatButton")&&this.repeatWrapper.hide(),this.$el.show(),this.active=!0,this.model.set("repeatState",I.repeatState.showing)},_bindEvents:function(){this.listenTo(this.model,"change:adQState",this._onAdStateChange)},_onClick:function(e){e.stopPropagation(),this.isSpinning||this.model.getPixel&&G.firePixel(this.model.getPixel("pixels.repeatClick"),"repeat click Pixel"),this.model.set("repeatState",I.repeatState.clicked),this.trigger("cm:repeat:click")},_createStatesAction:function(){this.adStateActions={q0:this._onAdPlaying.bind(this),completed:this._onVideoComplete.bind(this),repeating:this._onAdPlaying.bind(this)}},_onAdStateChange:function(e,t){var i=this.adStateActions[t];i&&i()},_onAdPlaying:function(){var e=this;setTimeout((function(){e.hide()}),100)},_onVideoComplete:function(){this.model.get("isReplayAd")&&this.show()},_onLearnMoreClick:function(e){window.open(this.model.get("adClickThroughUrl")),this.model.increaseCounter("learnMoreWasClicked",!0)},_updateLearnMoreUrl:function(){this.model.get("adClickThroughUrl")&&(this.learnMoreWrapper.click(this._onLearnMoreClick.bind(this)),this.learnMoreWrapper.show())},addAdditionalCss:function(e){Object(s.a)(this.repeatEl).addClass(e)}}),K=i(3),X=(i(5),i(10)),Z=i(101),J=K.View.extend({className:"_cm-timer",initialize:function(e){this.log=new X({unitType:e.unitType,className:"timerView"}),this.container=e.container,this._time=Number(e.time)||Number(this.model.get("components.TimerView.time")),this._isHide=e.isHide,this._stepTime=1,this.render()},render:function(){this.$el.append(Z),this.hide(),this.container.appendChild(this.el),this.$el.find("._cm-timer-circle ._cm-timer-mask, ._cm-timer-circle ._cm-timer-fill").css("transition","transform "+this._stepTime+"s linear"),this._innerText=this.$el.find("._cm-timer-inset>span")},startTimer:function(){this.log.info("Timer start"),0!==this._time?(this._currentTimer=this._stepTime,this._innerText.text(parseInt(this._time)),this._setDegree(180/this._time*this._currentTimer),window.setTimeout(this._timerUpdate.bind(this),1e3*this._stepTime)):this._finish()},_timerUpdate:function(){if(this._innerText.text(parseInt(this._time-this._currentTimer)),this._currentTimer+=this._stepTime,this._currentTimer>this._time)this._finish();else{var e=180/this._time*this._currentTimer;this._setDegree(e),window.setTimeout(this._timerUpdate.bind(this),1e3*this._stepTime)}},_setDegree:function(e){this.$el.find("._cm-timer-circle ._cm-timer-fill, ._cm-timer-circle ._cm-timer-mask._cm-timer-full").css("transform","rotate("+e+"deg)"),this.$el.find("._cm-timer-circle ._cm-timer-fill._cm-timer-fix").css("transform","rotate("+2*e+"deg)")},_finish:function(){this._isHide&&this.hide(),this.$el.trigger("cm:timer:finish")},hide:function(){this.$el.hide()}}),ee=i(5),te=i(102),ie=(o.a.View.extend({className:"_cm-branding-title",id:"_cm-css-reset",events:{},initialize:function(e){this.log=new r.a({unitType:"Component",className:"BrandingTitleView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.container=e.container,this.render(),this.bindEvents()},bindEvents:function(){this.model.listenTo(this.model,"change:customization.titleContainer.branding",this._customize.bind(this)),this.model.listenTo(this.model,"change:customization.titleContainer.branding.displayState",this._onDisplayStateChange.bind(this))},render:function(){this.template=ee.template(te),this.$el.append(this.template(this.model.attributes)),this.ui={title:this.$el.find("._cm-branding-view-title-text"),branding:this.$el.find("._cm-branding-view-branding-text")},this._customize(),this.container.appendChild(this.el),this.model.get("isFitToSize")&&this._fitToSize()},_customize:function(){var e=this.model.get("customization.titleContainer.title"),t=this.model.get("customization.titleContainer.branding");e&&((e=ee.toCssObj(e)).height="auto",this.ui.title.css(e)),t&&((t=ee.toCssObj(t)).height="auto",this.ui.branding.css(t))},_fitToSize:function(){var e=Object(s.a)(this.container).height(),t=this.model.get("videoPlaceholderSize");e&&t&&(Number(t.height)+this.$el.height()>=e?Number(t.height)+this.ui.title.height()<e?this._hideDescription():this._hide():this._show())},_hide:function(){this.$el.hide()},_show:function(){this.$el.show()},_onDisplayStateChange:function(e){e===I.brandingDisplayState.show?this._showAndFitToSize():this._hide()},_showAndFitToSize:function(){this._show(),this._fitToSize()},_hideDescription:function(){this.ui.branding.hide()}}),i(29),i(3)),ne=i(5),oe=i(103),re=i(104),se=ie.View.extend({events:{click:"_openAdChoice"},className:"_cm-ad-choice",initialize:function(e){this.log=new r.a({unitType:this.model.get("unitType"),className:"AdChoice",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.log.info("Ad Choice ".concat(e.type," initialized.")),this.container=e.container,this.parentPlaceholder=e.parent,this.placementType=e.type,this.shouldHandelDetachAttach=d.UNIT_TYPES[this.model.get("unitType")]===d.UNIT_TYPES.FEED_MANAGER&&this.placementType!==d.AD_CHOICE_TYPE.TITLE,this.placementModel=this._getAdChoicePlacementModel(e.type),this.titlePosition=this.model.get("components.adChoice.position"),this.icon=this.model.get("components.adChoice.icon"),this._translateText(),this._bindEvents(),this.render(),this._firstVideoViewStateHandle(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.template=ne.template(oe),this.$el.append(this.template(this.placementModel)),this.$el.children("._cm-ad-choice-logo").css({background:"url("+this.icon+") no-repeat"}),this.placementModel.isActive&&(this.placementModel.adViewStyle&&this.$el.css(ne.toCssObj(this.placementModel.adViewStyle)),this.$el.find("._cm-ad-choice-text").css(ne.toCssObj(this.placementModel.style)),this.$el.find("._cm-ad-choice-logo").css(ne.toCssObj(this.placementModel.logoStyle))),this._setAdChoiceUrl(),this._alignTitle(),Object(s.a)(this.container).append(this.el)},_bindEvents:function(){this.shouldHandelDetachAttach&&(this.log.info("Ad Choice ".concat(this.placementType," is listening to videoViewState")),this.listenTo(this.model,"change:videoViewState",this._handleVideoViewState.bind(this))),this.listenTo(this.model,"change:adPlayingWithAdChoice",this._onAdPlayingWithAdChoiceChange.bind(this)),this.listenTo(this.model,"change:content.isContentPlay",this._onAdPlayingWithAdChoiceChange.bind(this)),this.listenTo(this.model,"change:adjustWideFeed",this._onAdjustWideFeed.bind(this));var e=this.model.get("wurfl.browser.name");e!==d.BROWSER.IE&&e!==d.BROWSER.EDGE||this.listenTo(this.model,"change:isExpandEnded",this._onExpandEnded.bind(this))},_onExpandEnded:function(){this.log.info("onExpandEnded - IE or Edge detected");var e=this;this.$el.hide(),window.setTimeout((function(){e.$el.show()}),0)},_getAdChoicePlacementModel:function(e){var t;switch(e){case d.AD_CHOICE_TYPE.TITLE:t=this.model.get("components.adChoice.title");break;case d.AD_CHOICE_TYPE.VIDEO_AD:t=this.model.get("components.adChoice.videoAd");break;case d.AD_CHOICE_TYPE.SLIDER:t=this.model.get("components.adChoice.slider");break;default:t={text:"",style:{},logoStyle:{}}}return t},_getSCardSelector:function(){var e;switch(d.UNIT_TYPES[this.model.get("unitType")]){case d.UNIT_TYPES.WIDGET_ITEM:e='*[data-placement-name="'+this.model.get("placement")+'"]';break;case d.UNIT_TYPES.FEED_MANAGER:e=".tbl-feed-container .trc-content-sponsored";break;case d.UNIT_TYPES.INLINE_INSTREAM:case d.UNIT_TYPES.INLINE:case d.UNIT_TYPES.SLIDER_INSTREAM:e=".trc_rbox_container .trc-content-sponsored";break;default:e=""}return e},_setAdChoiceUrl:function(){this._selector=this._getSCardSelector();var e=this._extractUrl(this._selector);Object(s.a)("._cm-ad-choice-text",this.$el).attr("href",e),Object(s.a)("._cm-ad-choice-logo",this.$el).attr("href",e)},_extractUrl:function(e){var t,i,n=Object(s.a)(e)[0];return n?(Object(s.a)(window).width()<=768||this.model.get("isMobile")?(t=Object(s.a)(n).find("a.trc_mobile_adc_link"),this._isOpenNewTab=!0):t=Object(s.a)(n).find("a.trc_desktop_adc_link"),i=t.length>0?Object(s.a)(t[0]).attr("href").replace(/(Card)(\D*)(\d+)/,"Card "+this.model.get("cardNumber")):this.model.get("components.adChoice.fallbackUrl")):((Object(s.a)(window).width()<=768||this.model.get("isMobile"))&&(this._isOpenNewTab=!0),i=this.model.get("components.adChoice.fallbackUrl")),i},_alignTitle:function(){if(this.placementType===d.AD_CHOICE_TYPE.TITLE&&this._selector){var e=getComputedStyle(Object(s.a)(this._selector)[0]);e&&"rtl"===e.direction&&Object(s.a)(this.container).css("text-align","left !important")}},_firstVideoViewStateHandle:function(){d.UNIT_TYPES[this.model.get("unitType")]===d.UNIT_TYPES.FEED_MANAGER&&this.placementType!==d.AD_CHOICE_TYPE.TITLE&&this._handleVideoViewState()},_handleVideoViewState:function(){switch(this.model.get("videoViewState")){case I.videoViewState.attached:this._onAttach();break;case I.videoViewState.detached:this._onDetach()}},_onAttach:function(){switch(this.placementType){case d.AD_CHOICE_TYPE.VIDEO_AD:this._show();break;case d.AD_CHOICE_TYPE.SLIDER:this._hide()}},_onDetach:function(){switch(this.placementType){case d.AD_CHOICE_TYPE.VIDEO_AD:this._hide();break;case d.AD_CHOICE_TYPE.SLIDER:this._show()}this._updateAdChoicesVisibility()},_openAdChoice:function(e){this._firePixel("pixels.adChoice","adChoice click pixel."),window.TRC&&(this._isOpenNewTab||window.TRC.aboutUs&&window.TRC.aboutUs.open&&window.TRC.aboutUs.open(e))},_firePixel:function(e,t){var i=this.model.getPixel(e);ne.firePixel(i,t)},_show:function(){this.placementModel.isActive&&!this.model.get("adPlayingWithAdChoice")&&this.$el.show(),this._validateComponentVisibilityStatus(!0)},_hide:function(){this.placementModel.isActive&&this.$el.hide(),this._validateComponentVisibilityStatus(!1)},_validateComponentVisibilityStatus:function(e){var t=this.componentsVisibilityListener&&this.model.get(this.componentsVisibilityListener);void 0!==t&&e!==t&&this.model.set(this.componentsVisibilityListener,e)},_updateAdChoicesVisibility:function(){this.model.get("adPlayingWithAdChoice")&&this.placementType!==d.AD_CHOICE_TYPE.TITLE?this._hide():this._show()},_onAdPlayingWithAdChoiceChange:function(){this.model.get("content.isContentPlay")&&!this.model.get("components.adChoice.isActiveOnContent")?this._hide():this.shouldHandelDetachAttach?this._handleVideoViewState():this._updateAdChoicesVisibility()},_onAdjustWideFeed:function(){var e=this.model.get("adjustWideFeed");this.titlePosition===d.TITLE_POSITION.BELOW&&(e?Object(s.a)(this.parentPlaceholder).addClass("_cm-wide-feed-title-below"):Object(s.a)(this.parentPlaceholder).removeClass("_cm-wide-feed-title-below"))},_translateText:function(){this.model.get("components.adChoice.isTranslateText")&&this.model.get("language")&&this.model.set("components.adChoice.videoAd.text",re[this.model.get("language").toUpperCase()])},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this._hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this._show():this._hide()}}),ae=i(6);i(3);i(10);var le=(ae.b,i(3)),ce=i(5),de=i(10),ue=i(105),he={display:"inline !important"},pe={display:"none !important"},fe={transition:"width 2000ms !important",width:"32px !important"},me={width:"32px !important"},ge=le.View.extend({className:"_cm-volume-area",id:"_cm-css-reset",events:{click:"_toggleVolume"},initialize:function(e){this._setInitialParameters(e),this._isHandleDetach(),this._hasCloseButton(),this._initVolumeState(),this._createStatesAction(),this._setMinimizeOnClickCallback(),this._bindEvents(),this.render(),this.log.info("Volume Button initialized.")},_bindEvents:function(){this.listenTo(this.currModel,"change:volumeMuted",this._onVolumeChange.bind(this)),this.listenTo(this.currModel,"startVolumeAnimation",this._minimizeAfterRender.bind(this)),this._handleDetach&&this.listenTo(this.model,"change:videoViewState",this._handleVideoViewState.bind(this)),this.currModel.on("lastVolumeStateCheck",this._onLastVolumeStateCheck,this),this.model.on("change:viewTopComponent",this.setButtonVisible,this),this.listenTo(this.model,"change:adQState",this._onAdStateChange),this.model.on("showVolumeButtonOnBackFromSwap",this.show,this)},_setComponentsVisibilityListener:function(){this.model.on("change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange,this),this.model.get(this.componentsVisibilityListener)||this.hide()},render:function(){this._initTemplate(),this._setPosition(),this._styleCustomization(),this._checkIfMinimized(),this._renderComponent()},_initTemplate:function(){var e=ce.template(ue)(this._settings);this.$el.append(e)},_renderComponent:function(){var e=this,t=this.model.get("wurfl.browser.name");t===d.BROWSER.IE||t===d.BROWSER.EDGE?setTimeout((function(){Object(s.a)(e.container).append(e.el)}),200):Object(s.a)(this.container).append(this.el)},_setInitialParameters:function(e){this.log=new de({unitType:this.model.get("unitType"),className:"volumeButtonView"}),this.container=e.container,this.currModel=e.globalModel?e.globalModel:this.model,this._settings=this.model.get("components.volume"),this._isMuted=!0,this._unitType=d.UNIT_TYPES[this.model.get("unitType")],this._isAlwaysBottom=this.model.get("components.volume.isAlwaysBottom"),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},_initVolumeState:function(){void 0===this.currModel.get("volumeMuted")&&this.currModel.set("volumeMuted",!0)},_setMinimizeOnClickCallback:function(){this._minimizeOnClick=ce.once(this._minimize.bind(this,fe))},_onLastVolumeStateCheck:function(){this._onVolumeChange()},_toggleVolume:function(){this._isMuted?(this._unMute(),this._fireUnmute()):(this._mute(),this._fireMute()),this._minimizeOnClick(),this.currModel.set("volumeUserInteraction",!0)},_mute:function(){this._showMute(),this._hideUnmute(),this._isMuted=!0},_unMute:function(){this._hideMute(),this._showUnmute(),this._isMuted=!1},_fireMute:function(){this.currModel.set("volumeMuted",!0),this.currModel.set("onUnMuteClicked",!1)},_fireUnmute:function(){this.currModel.set("volumeMuted",!1),this.currModel.set("onUnMuteClicked",!0)},_onVolumeChange:function(){this.currModel.get("volumeMuted")?this._mute():this._unMute()},_minimizeAfterRender:function(){this.currModel.get("volumeMustBeMinimized")?this._minimize(me):setTimeout(function(){this._isMinimized||this._minimize(fe)}.bind(this),this._settings.timeToMinimize)},_minimize:function(e){Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border").css(e),this._isMinimized=!0,this.currModel.set("volumeMustBeMinimized",!0)},_hideMute:function(){Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(pe)},_showMute:function(){Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(he)},_hideUnmute:function(){Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(pe)},_showUnmute:function(){Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(he)},_setPosition:function(){this.hasCloseButton||this._isAlwaysBottom?this.$el.addClass("_cm-volume-area-bottom"):this.$el.addClass("_cm-volume-area-top"),this._handleDetach&&this._handleVideoViewState()},_isHandleDetach:function(){this._handleDetach=!1,this._unitType===d.UNIT_TYPES.FEED_MANAGER&&!1===this.model.get("hasCloseButton")&&!0===this.model.get("detachToSlider.hasCloseButton")&&(this._handleDetach=!0)},_hasCloseButton:function(){this._unitType!==d.UNIT_TYPES.FEED_MANAGER&&this._unitType!==d.UNIT_TYPES.INLINE_INSTREAM&&this._unitType!==d.UNIT_TYPES.MSN_WIDGET||(this.hasCloseButton=this.model.get("closeButton.hasCloseButton")),this._unitType!==d.UNIT_TYPES.WIDGET_ITEM&&this._unitType!==d.UNIT_TYPES.EXPANDABLE&&this._unitType!==d.UNIT_TYPES.EXPANDABLE_MOBILE||(this.hasCloseButton=this.model.get("components.CloseButtonView.hasCloseButton")),this._unitType,d.UNIT_TYPES.SLIDER_INSTREAM,this._unitType,d.UNIT_TYPES.EXPANDABLE},_handleVideoViewState:function(){if(!this._isAlwaysBottom){var e=this.model.get("videoViewState");e===I.videoViewState.attached&&(this.$el.addClass("_cm-volume-area-top"),this.$el.removeClass("_cm-volume-area-bottom")),e===I.videoViewState.detached&&this.hasCloseButton&&(this.$el.addClass("_cm-volume-area-bottom"),this.$el.removeClass("_cm-volume-area-top"))}},_styleCustomization:function(){this._settings.style&&(ce.isEmpty(this._settings.style.border)||Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border").css(this._settings.style.border),ce.isEmpty(this._settings.style.mute)||Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-mute").css(this._settings.style.mute),ce.isEmpty(this._settings.style.unmute)||Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-unmute").css(this._settings.style.unmute),ce.isEmpty(this._settings.style.text)||Object(s.a)("#_cm-css-reset._cm-volume-area > ._cm-volume-border > ._cm-volume-text").css(this._settings.style.text))},_checkIfMinimized:function(){this._unitType===d.UNIT_TYPES.FEED_MANAGER&&this.currModel.get("volumeMinimized")&&this._minimize(me)},setButtonVisible:function(){this.log.info("_onTopComponentChange",this.model.get("viewTopComponent")),this.model.get("viewTopComponent")===d.FLOATING_VIEW_TOP_COMPONENT.video?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},_createStatesAction:function(){this.adStateActions={q0:this.show.bind(this),completed:this.hide.bind(this),repeating:this.show.bind(this)}},_onAdStateChange:function(e,t){var i=this.adStateActions[t];i&&i()},_onComponentsVisibilityChange:function(){this.currModel.get(this.componentsVisibilityListener)?this.show():this.hide()}}),ye=i(3),ve=i(5),be=i(10),_e=i(54),we=(ye.View.extend({className:"_cm-ad-loading-progress",id:"_cm-css-reset",initialize:function(e){this.model.set("progressLoaderInit",!0),this._setInitialParameters(e),this._bindEvents(),this.currModel.get("isFirstAdLoaded")&&(this._startWatchingViewPort(),this._show()),this.render(),this.log.info("ad-loading-progress initialize")},_bindEvents:function(){this.log.info("ad-loading-progress _bindEvents"),this.listenTo(this.currModel,"change:isFirstAdLoaded",this._onFirstAdLoaded.bind(this)),this.listenToOnce(this.currModel,"change:hasReadyAd",this._onAdImpression.bind(this)),this.listenTo(this.currModel,"ProgressLoaderRepositioned",this._restart.bind(this))},_setInitialParameters:function(e){this.log=new be({unitType:this.model.get("unitType"),className:"adLoadingProgressView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.currModel=e.globalModel?e.globalModel:this.model,this.$el=Object(s.a)(this.el),this.viewPercent=this.currModel.get("components.adLoadingProgress.inViewPortEligibility")||100,this.loadingTimerTime=Number(this.currModel.get("components.adLoadingProgress.maxProgressTime"))||5e3,this.count=1,this.currModel.set("loaderCurrCount",this.count),this.progressTik=this.loadingTimerTime/50,this.showProgress=this.currModel.get("components.adLoadingProgress.showProgressBar")},render:function(){this._initTemplate(),this._customize(),this.model.get("eligiblePlaceholder")?this._renderComponent():this.model.once("change:eligiblePlaceholder",this._renderComponent.bind(this))},_renderComponent:function(){this.container=this.model.get("eligiblePlaceholder");var e={width:this.model.get("width")+3+"px",height:this.model.get("height")+2+"px"};this.$el.css(e),this.$el.css(this._getPosition(this.model.get("eligiblePlaceholder"))),Object(s.a)("body").append(this.el),this.$el.css(),Object(s.a)("._cm-ad-loading-progress_title_span").text(this.currModel.get("components.adLoadingProgress.title")),this.showProgress&&Object(s.a)("._cm-ad-loading-progress-container").css({display:"block"})},_initTemplate:function(){var e=ve.template(_e)(this._settings);this.$el.append(e),this.$loadingPercentElement=Object(s.a)("._cm-ad-loading-progress_percent_span")},_onFirstAdLoaded:function(){this.log.info("FirstAd _onFirstAdLoaded loaded"),this.currModel.get("isFirstAdLoaded")&&(this._startWatchingViewPort(),this._show())},_startWatchingViewPort:function(){this.listenTo(ye,"window:scroll:change",this._calculateViewPortIntersection.bind(this,!1));var e=this.$el.parent().height();this.$el.parent().height(e+1)},_calculateViewPortIntersection:function(){if(!this.stopWatchingViewPort){var e=ve.getViewPercent(this.el,this.$el.width(),this.$el.height(),this.currModel.get("scrollSelector"));this.log.info("currViewPercent: ",e||0),this.viewPercent<=e&&(this._startLoadingTimer(),this.stopWatchingViewPort=!0)}},_onAdImpression:function(){this.model.get("progressLoaderTimerReached")&&this.model.set("eligiblePlaceholder",!1),this.close()},_startLoadingTimer:function(){this.loadingTimer=window.setTimeout(function(){this.log.info("Loading timer progress reached"),this.currModel.set("progressLoaderTimerReached",!0),window.clearInterval(this.calculationInterval),this.calculationInterval=null}.bind(this),this.loadingTimerTime),this._startCalculation()},_startCalculation:function(){this.calculationInterval=window.setInterval(function(){this._calculateLoadingProgress(),Object(s.a)("._cm-ad-loading-progress-bar-loaded").css({width:"100%",transition:"width "+this.loadingTimerTime+"ms","transition-timing-function":"linear"})}.bind(this),this.progressTik)},_calculateLoadingProgress:function(){Object(s.a)("._cm-ad-loading-progress_percent_span").text(this.count+"%"),this.count<100&&(this.count+=2,this.currModel.set("loaderCurrCount",this.count))},_restart:function(){this.container=this.model.get("eligiblePlaceholder"),this._renderComponent(),this._hide(),this.currModel.set("progressLoaderTimerReached",!1),Object(s.a)("._cm-ad-loading-progress_percent_span").text("1%"),this.count=1,Object(s.a)("._cm-ad-loading-progress-bar-loaded").css({transition:"none",width:"0%"}),this.stopWatchingViewPort=!1,this._show()},_show:function(){this.$el.css({display:"flex"})},_hide:function(){this.$el.css({display:"none"})},close:function(){this.model.set("progressLoaderViewClosed",!0),this._hide(),window.clearInterval(this.calculationInterval),this.calculationInterval=null,this.loadingTimer&&(window.clearTimeout(this.loadingTimer),this.loadingTimer=null),this.stopListening(ye,"window:scroll:change"),this.model.set("components.adLoadingProgress.isActive".false)},_customize:function(){var e=this.model.get("components.adLoadingProgress.additionalCss");this.$el.css(ve.toCssObj(e))},_getPosition:function(e){var t=e.getBoundingClientRect(),i=document.body.getBoundingClientRect();return{top:t.top-i.top-1+"px",left:t.left+"px"}}}),i(63));i.n(we);i(5);var Te=(ae.b,i(30),i(65)),Se=i.n(Te),Ae=i(3),Pe=i(5),Ee=i(10),Ce=(i(2),Ae.View.extend({className:"_cm-skip-ad-area",id:"_cm-skip-ad-area",events:{"click ":"_onClick"},initialize:function(e){this.log=new Ee({unitType:e.unitType,className:"SkipAdButtonView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=a.a,this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){if(!this._rendered){this._rendered=!0,this._settings=this.model.get("components.skipAdButton");var e=Pe.template(Se.a)(this._settings);this.$el.append(e),this.container.appendChild(this.el)}},_bindEvents:function(){},_onClick:function(e){e.stopPropagation(),this.model.increaseCounter("skipButtonClicked")},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),i(66)),ke=i.n(Ce),Oe=i(3),Ie=(i(5),i(10)),Re=Oe.View.extend({className:"video_controls show",id:"video_controls",initialize:function(e){this.log=new Ie({unitType:e.unitType,className:"progressBarView"}),this.model=e.model,this.container=e.container,this.video=e.video,this._bindEvents(),this.render()},_bindEvents:function(){this.video.addEventListener("ended",this.resetProgress.bind(this)),this.model.listenTo(this.model,"change:mute",this.muteChanged.bind(this)),this.model.listenTo(this.model,"change:content.startProgressBar",this.ManageProgressBarInterval.bind(this))},render:function(){this.container.appendChild(this.el),this.$el.append(ke.a),this.setControls(),this.show()},setControls:function(){this.setProgressBarComponent(),this.setPlayPauseButton(),this.setMuteButton()},hide:function(){this.$el.hide()},show:function(){this.$el.show()},setProgressPercent:function(e){this.progressDiv.style.width=e+"%"},resetProgress:function(){this.progressDiv.classList.add("init_bg"),this.setProgressPercent(0)},playClicked:function(){this.model.set("content.playClicked",!0),this.model.set("content.pauseClicked",!1),this.pauseButton.classList.add("show"),this.pauseButton.classList.remove("hide"),this.playButton.classList.remove("show"),this.playButton.classList.add("hide")},pauseClicked:function(){this.model.set("content.pauseClicked",!0),this.playButton.classList.add("show"),this.playButton.classList.remove("hide"),this.pauseButton.classList.remove("show"),this.pauseButton.classList.add("hide")},muteClicked:function(){this.model.get("mute")?this.unMute():this.mute()},muteChanged:function(){this.model.get("mute")?this.setMuteClasses():this.setUnMuteClasses()},mute:function(){this.model.set("mute",!0),this.setMuteClasses()},unMute:function(){this.model.set("mute",!1),this.setUnMuteClasses()},setMuteClasses:function(){this.muteImg.style.display="block",this.unmuteImg.style.display="none"},setUnMuteClasses:function(){this.muteImg.style.display="none",this.unmuteImg.style.display="block"},setProgressBarComponent:function(){this.progressDiv=this.$el.find(".blue_bg")[0],this.progressComponentDiv=this.$el.find(".cm_video_controls_progressbar_area")[0],this.model.get("components.contentVideo.hideProgressBar")&&(this.progressComponentDiv.style.display="none"),this.resetProgress()},setMuteButton:function(){this.muteButton=this.$el.find(".cm_video_controls_mute").get(0),this.model.get("components.contentVideo.hideMuteButton")&&(this.muteButton.style.display="none"),this.muteImg=this.$el.find(".cm_video_controls_mute .display_mute").get(0),this.unmuteImg=this.$el.find(".cm_video_controls_mute .display_unmute").get(0),this.muteImg.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.muteImgUrl"),'")'),this.unmuteImg.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.unmuteImgUrl"),'")'),this.muteButton.onclick=this.muteClicked.bind(this),this.muteChanged()},setPlayPauseButton:function(){this.playButton=this.$el.find(".play")[0],this.pauseButton=this.$el.find(".pause")[0],this.pauseButton.style.backgroundImage='url("'.concat(this.model.get("components.contentVideo.pauseImgUrl"),'")'),this.model.get("components.contentVideo.hidePlayButton")&&(this.pauseButton.classList.remove("show"),this.pauseButton.classList.add("hide")),this.playButton.onclick=this.playClicked.bind(this),this.pauseButton.onclick=this.pauseClicked.bind(this)},ManageProgressBarInterval:function(){this.model.get("content.startProgressBar")?this.progressInterval=setInterval(this.setProgress.bind(this),100):this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=null)},setProgress:function(){this.setProgressPercent(this.video.currentTime/this.video.duration*100)}}),Ve=i(3),De=i(5),xe=i(10),Ne=i(54),Me=(Ve.View.extend({className:"_cm-ad-loading-progress",id:"_cm-css-reset",initialize:function(e){e.isActive&&(this.model=e.model,this.container=e.container,this._setInitialParameters(e),this._bindEvents(),this.render(),this._startWatchingViewPort(),this.log.info("ad-loading-progress initialize"))},_bindEvents:function(){this.log.info("ad-loading-progress _bindEvents"),this.listenToOnce(this.model,"change:hasReadyAd",this.close.bind(this)),this.listenTo(this.model,"change:ProgressLoaderRepositioned",this._restart.bind(this))},_setInitialParameters:function(e){this.log=new xe({unitType:this.model.get("unitType"),className:"adLoadingProgressView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.globalModel=e.globalModel||this.model,this.globalModel.set("progressLoaderInit",!0),this.$el=Object(s.a)(this.el),this.viewPercent=this.model.get("components.adLoadingProgress.inViewPortEligibility")||100,this.loadingTimerTime=Number(this.model.get("components.adLoadingProgress.maxProgressTime"))||5e3,this.count=1,this.globalModel.set("loaderCurrCount",this.count),this.progressTik=this.loadingTimerTime/100,this.showProgress=this.model.get("components.adLoadingProgress.showProgressBar")},render:function(){this._initTemplate(),this._customize(),this._renderComponent(),this._show()},_initTemplate:function(){var e=De.template(Ne)(this._settings);this.$el.append(e),this.$loadingPercentElement=Object(s.a)("._cm-ad-loading-progress_percent_span")},_customize:function(){var e=this.model.get("components.adLoadingProgress.additionalCss");this.$el.css(De.toCssObj(e))},_renderComponent:function(){var e={width:this.model.get("width")+"px",height:this.model.get("height")+"px"};this.$el.css(e),Object(s.a)(this.container).append(this.el),Object(s.a)("._cm-ad-loading-progress_title_span").text(this.model.get("components.adLoadingProgress.title")),this.showProgress&&Object(s.a)("._cm-ad-loading-progress-container").css({display:"block"})},_startWatchingViewPort:function(){this.listenTo(Ve,"window:scroll:change",this._calculateViewPortIntersection.bind(this,!1)),this._calculateViewPortIntersection()},_calculateViewPortIntersection:function(){var e=De.getViewPercent(this.el,this.$el.width(),this.$el.height(),this.model.get("scrollSelector"));!this.calculationRunning&&this.viewPercent<=e&&this._startLoadingTimer(),this.calculationRunning&&!e&&this.el.getBoundingClientRect().top<0&&this._stopCalculation()},_startLoadingTimer:function(){this.loadingTimer=window.setTimeout(function(){this._stopCalculation()}.bind(this),this.loadingTimerTime),this._startCalculation()},_startCalculation:function(){this.calculationRunning=!0,this.calculationInterval=window.setInterval(function(){this._calculateLoadingProgress()}.bind(this),this.progressTik),Object(s.a)("._cm-ad-loading-progress-bar-loaded").css({width:"100%",transition:"width "+this.loadingTimerTime+"ms","transition-timing-function":"linear"})},_stopLoadingTimer:function(){this.loadingTimer&&clearTimeout(this.loadingTimer)},_stopCalculation:function(){this.calculationRunning=!1,this.globalModel.set("progressLoaderTimerReached",!0),window.clearInterval(this.calculationInterval),this.calculationInterval=null},_calculateLoadingProgress:function(){Object(s.a)("._cm-ad-loading-progress_percent_span").text(this.count+"%"),this.count<100&&(this.count+=1,this.globalModel.set("loaderCurrCount",this.count))},_restart:function(){this._stopLoadingTimer(),this.globalModel.set("progressLoaderTimerReached",!1),this.model.get("ProgressLoaderRepositioned")&&(Object(s.a)("._cm-ad-loading-progress_percent_span").text("1%"),this.count=1,Object(s.a)("._cm-ad-loading-progress-bar-loaded").css({transition:"none",width:"0%"}),this.calculationRunning=!1,this.model.set("ProgressLoaderRepositioned",!1))},_show:function(){this.$el.css({display:"flex"}),this.model.set("isProgressLoaderViewRunning",!0)},_hide:function(){this.$el.css({display:"none"})},close:function(){this.log.info("close loader"),this.model.set("isProgressLoaderViewRunning",!1),this.globalModel.set("progressLoaderViewClosed",!0),this._hide(),window.clearInterval(this.calculationInterval),this.calculationInterval=null,this.loadingTimer&&(window.clearTimeout(this.loadingTimer),this.loadingTimer=null),this.stopListening(Ve,"window:scroll:change"),this.model.set("components.adLoadingProgress.isActive",!1)}}),i(55),i(19)),Le=i(69);i.n(Le);i(5);var Fe=(Me.a,i(70)),Be=i.n(Fe),je=i(71),Ue=i.n(je),He=i(3),We=i(5),ze=i(10),$e=He.View.extend({className:"_cm-content-carousel-item",events:{"click ":"_onClick"},initialize:function(e){this.log=new ze({unitType:e.unitType,className:"ContentCarouselItemView"}),this.model=e.model,this.itemId=e.itemId,this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=a.a,Object(s.a)(this.container).append(this.$el),this._setInfo(),this.render()},render:function(){if(!this._rendered){var e=We.template(Ue.a)(this.itemInfo);this.$el.append(e),this.imageNode=this.$el.find("._cm-content-carousel-item-image"),this.imageNode.css({"background-image":' url("'.concat(this.model.get("components.contentCarousel.backgroundImage"),'")')})}},_bindEvents:function(){},_onClick:function(){this.itemInfo.selected||this.model.set("playlistItemClicked",this.itemId)},_setInfo:function(){this.itemInfo=this.model.get("player.playlist")[this._getItemIndex()],this.itemInfo.description=this.itemInfo.title.replace(/-/g," "),this.itemInfo.playingNowString=this.model.get("playingNowString"),this.updateSelected()},updateSelected:function(){this.itemInfo.selected=this.model.get("player.playlist")[this._getItemIndex()].selected,Object(s.a)(this.$el).removeClass("true"),Object(s.a)(this.$el).removeClass("false"),Object(s.a)(this.$el).addClass(this.itemInfo.selected.toString())},_getItemIndex:function(){for(var e=this.model.get("player.playlist"),t=0,i=0;i<e.length;i++)if(e[i].id===this.itemId){t=i;break}return t}}),qe=i(3),Ge=(i(5),i(10)),Ye=qe.View.extend({className:"_cm-content-carousel-area",id:"_cm-content-carousel-area",initialize:function(e){this.log=new Ge({unitType:e.unitType,className:"ContentCarouselView"}),this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=a.a,this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener(),Object(s.a)(this.container).append(this.$el)},render:function(){this._rendered?this.updatePlaylistItem():(this._rendered=!0,this.$el.append(Be.a),this.listContainer=this.$el.find("._cm-content-carousel-items-container"),this.blockDiv=this.$el.find("._cm-content-carousel-blocker"),this.scrollElement=document.querySelector("div._cm-content-carousel-items-container-wrapper"),this.listItemsArray=[],this.unBlockView(),this._createListItems(),this._setScrollButtons())},_createListItems:function(){for(var e=this.model.get("player.playlist"),t=0;t<e.length;t++)e[t].id=t,e[t].selected=!1;this.model.set("player.playlist",e);for(var i=0;i<e.length;i++){var n=new $e({model:this.model,container:this.listContainer,itemId:i});this.listItemsArray.push(n)}},_bindEvents:function(){},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},_setScrollButtons:function(){var e=this.$el.find("._cm-content-carousel-arrow-left"),t=this.$el.find("._cm-content-carousel-arrow-right");e.on("click",this._scrollLeft.bind(this)),t.on("click",this._scrollRight.bind(this))},_scrollLeft:function(){this.scrollElement.scrollBy(-100,0)},_scrollRight:function(){this.scrollElement.scrollBy(100,0)},hide:function(){this.$el.hide()},show:function(){this.$el.show()},blockView:function(){this.blockDiv.css({display:"block"})},unBlockView:function(){this.blockDiv.css({display:"none"})},updatePlaylistItem:function(){for(var e=0;e<this.listItemsArray.length;e++)this.listItemsArray[e].updateSelected()}})},function(e,t,i){"use strict";i.d(t,"l",(function(){return Y})),i.d(t,"g",(function(){return Q.a})),i.d(t,"i",(function(){return ne})),i.d(t,"j",(function(){return we})),i.d(t,"d",(function(){return Me})),i.d(t,"k",(function(){return Be})),i.d(t,"a",(function(){return Je})),i.d(t,"h",(function(){return gt})),i.d(t,"f",(function(){return at})),i.d(t,"b",(function(){return St})),i.d(t,"c",(function(){return T})),i.d(t,"e",(function(){return Ft}));var n=i(0),o=i(3),r=i.n(o),s=i(6),a=i(4),l=i(2),c=i.n(l),d=i(7),u=i.n(d),h=i(20),p=i(1),f=i.n(p),m=i(14);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=i(5),T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=_(e);if(t){var o=_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return b(this,i)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e.model)).model=e.model,t.subModel=e.subModel,t.adData=e.adData||{},t.scrollManager=new m.a,t.onDebugDataChange=e.onDebugDataChange,t.log=new a.a({unitType:t.model.get("unitType"),className:"DebugData",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.isViewed=e.isViewed,e.onDebugDataChange&&(t._onDebugChange(),t._bindEvents()),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"sqv",funcName:"_onDebugChange"},{event:"conversionCount",funcName:"_onDebugChange"},{event:"rvvs1",funcName:"_onDebugChange"},{event:"rvvs0",funcName:"_onDebugChange"},{event:"rvps1",funcName:"_onDebugChange"},{event:"rvps0",funcName:"_onDebugChange"}])}},{key:"_onDebugChange",value:function(){this.onDebugDataChange(this.getDebugData())}},{key:"getDebugData",value:function(){if(this.model.get("isSendDebugDataReporting")){var e="";for(var t in f.a.DEBUG_DATA){var i=this[t]();e+=void 0!==i?"".concat(f.a.DEBUG_DATA[t],":").concat(i,"!"):"".concat(f.a.DEBUG_DATA[t],":!")}return e}}},{key:"pn",value:function(){return f.a.PREDICT_NAMES[this.adData.pn]}},{key:"sqg",value:function(){return this.adData.adId}},{key:"sqv",value:function(){return this.model.get("sqv")}},{key:"sqp",value:function(){if(this.model.get("conversionCount"))return parseInt(this.model.get("conversionCount"))}},{key:"rv",value:function(){return this.isRv()?1:0}},{key:"rvvs",value:function(){return this.isRv()?this.model.get("rvvs1"):this.model.get("rvvs0")}},{key:"rvps",value:function(){return this.isRv()?this.model.get("rvps1"):this.model.get("rvps0")}},{key:"ppsc",value:function(){return parseInt(this.scrollManager.ppsChange)}},{key:"vms",value:function(){var e=this.scrollManager.vms;return e!==1/0?parseInt(e):"inf"}},{key:"pps",value:function(){return parseInt(this.scrollManager.pps)}},{key:"gpps",value:function(){return parseInt(this.adData.getAdPPS)}},{key:"gppsc",value:function(){return parseInt(this.adData.getAdPPSChange)}},{key:"isRv",value:function(){return w.parseBool(this.adData.requiredViewability)}},{key:"ft",value:function(){return this.model.get("frameType")}},{key:"fsc",value:function(){var e=this.model.get("startCard");if(void 0!==e&&""!==e)return parseInt(e)}},{key:"fpc",value:function(){var e=this.model.get("permanentCard");if(void 0!==e&&""!==e)return parseInt(e)}},{key:"sa",value:function(){var e=this.subModel||this.model;return e&&e.get("isPlacementSingleAd")?1:0}},{key:"pi",value:function(){return this.model.get("MSNCard.placementIndex")}},{key:"dt",value:function(){var e=this.subModel||this.model;return e.get("videoViewState")&&e.get("videoViewState")===l.videoViewState.detached?1:0}},{key:"vb",value:function(){return this.isViewed?1:0}},{key:"dur",value:function(){var e=this.subModel||this.model,t=parseInt(e.get("activeAdMaxTime"));return t||(t=void 0),t}},{key:"ttv",value:function(){return this.adData.timeToVimp?parseInt(this.adData.timeToVimp):0}},{key:"bovpg",value:function(){return this.adData.bovpg?parseInt(this.adData.bovpg):""}},{key:"bovpv",value:function(){return this.adData.bovpv?parseInt(this.adData.bovpv):""}},{key:"be",value:function(){return this.model.get("playerHasRvInQ")?1:0}},{key:"pap",value:function(){return void 0!==this.adData.pap?parseInt(this.adData.pap):""}},{key:"mty",value:function(){return void 0!==this.adData.mty?parseInt(this.adData.mty):""}},{key:"esv",value:function(){return this.adData.esv?1:0}},{key:"rot",value:function(){return this.adData.rot}},{key:"roid",value:function(){return this.adData.roid}},{key:"rom",value:function(){return this.adData.rom}},{key:"tti",value:function(){return this.adData.timeToImpression}}])&&y(t.prototype,i),o}(s.a);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=i(5),O={viewability:{id:30,name:"viewability"},viewabilityOneS:{id:54,name:"viewabilityOneS"},viewability100:{id:63,name:"viewability100"},viewabilityAMP:{id:131,name:"viewabilityAMP"},noViewabilityAMP:{id:132,name:"noViewabilityAMP"},compView100:{id:107,name:"compView100"},pauseAfterPlay:{id:31,name:"pauseAfterPlay"},conversion:{id:32,name:"adPlay"},clickThru:{id:33,name:"clickThru"},fireSkipVimp1EligibilityLost:{id:43,name:"skipLostEligibility"},fireSkipVimp1Vimp0Playing:{id:44,name:"skipOtherPlaying"},unitImpression:{id:45,name:"unitImpression"},continueAd:{id:46,name:"continueAd"},continueAdInAnotherCard:{id:55,name:"continueAdInAnotherCard"},shouldContinueAdInAnotherCard:{id:56,name:"shouldContinueAdInAnotherCard"},lostCardEligibility:{id:57,name:"lostCardEligibil*ity"},adUnmuted:{id:58,name:"adUnmuted"},userAdUnmuted:{id:64,name:"userAdUnmuted"},learnMoreClick:{id:71,name:"learnMoreClick"},adTitleClick:{id:74,name:"adTitleClick"},adCtaButtonClick:{id:75,name:"adCtaButtonClick"},adDescriptionClick:{id:76,name:"adDescriptionClick"},adBrandingClick:{id:77,name:"adBrandingClick"},adIconClick:{id:78,name:"adIconClick"},detach:{id:79,name:"detach"},attach:{id:80,name:"attach"},sliderClosed:{id:81,name:"sliderClosed"},twoSecAfterPlay:{id:82,name:"twoSecAfterPlay"},adProgressionAfterBeginPredict:{id:84,name:"adProgressionAfterBeginPredict"},adProgressionBeforeEndPredict:{id:85,name:"adProgressionBeforeEndPredict"},adSwappedOut:{id:104,name:"adSwappedOut"},adSwappedIn:{id:105,name:"adSwappedIn"},pauseAfterPlayScrolledUp:{id:108,name:"pauseAfterPlayScrolledUp"},pauseAfterPlayScrolledDown:{id:109,name:"pauseAfterPlayScrolledDown"},pauseAfterPlaySwitchedTab:{id:110,name:"pauseAfterPlaySwitchedTab"},eligibilityLostScrolledUp:{id:111,name:"eligibilityLostScrolledUp"},eligibilityLostScrolledDown:{id:112,name:"eligibilityLostScrolledDown"},eligibilitySwitchedTab:{id:113,name:"eligibilitySwitchedTab"},oneSecondNoPlaySamePlace:{id:114,name:"oneSecondNoPlaySamePlace"},oneSecondNoPlayScrolledUp:{id:115,name:"oneSecondNoPlayScrolledUp"},oneSecondNoPlayScrolledDown:{id:116,name:"oneSecondNoPlayScrolledDown"},displayingFullNAS:{id:125,name:"displayingFullNAS"},displayingNASTitleOnly:{id:126,name:"displayingNASTitleOnly"},adPausedOtherUnitIsPlaying:{id:127,name:"adPausedOtherUnitIsPlaying"},rvBlockedInQ:{id:128,name:"rvBlockedInQ"},reportingObserver:{id:129,name:"reportingObserver"},noReplayForHipAdjacAd:{id:140,name:"noReplayForHipAdjacAd"},adPlayingNextAdReadyRV1:{id:142,name:"adPlayingNextAdReadyRV1"}},I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=C(e);if(t){var o=C(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return E(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e.model)).model=e.model,t.adData=e.adData,t.reportFunc=e.reportFunc,t.getAdData=e.getAdDataFunc,t.setDebugData=e.setDebugData,t.vpaidData=e.vpaidData,t.log=new a.a({unitType:t.model.get("unitType"),className:"oppsService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.oppManager=new h.a({"auc-dast":t.model.get("cmDast"),pt:k.crc32(t.model.get("abTest")||999)},{billableEvents:t.model.get("billableEvents"),oppUrl:t.model.get("player.urls.oppsRequest"),nonBllbOppUrl:t.model.get("player.urls.nonBllboppsRequest")}),t.isViewed=!1,t.hadConversion=!1,t.hadImpression=!1,t.isFirstPlayForAd=!0,t.pageEventHistory=window.cmTag.PEH,t.unifiedPlacementEH=window.cmTag.UPEH,t._bindEvents(),t._fireUnitImpression(),t}return t=r,(i=[{key:"_bindEvents",value:function(){}},{key:"_fireUnitImpression",value:function(){this._fireOpp(O.unitImpression.id,O.unitImpression.name),this.reportFunc(O.unitImpression.name,{tab:this.model.get("isInTab"),eligibility:this.model.get("isEligibleToPlay"),gotVimpCountQ:this.model.get("impressionCount"),hadEligibility:this.model.get("hadEligibility"),hadLostEligibility:!!this.model.get("lostEligibilityTime")},!0),this.model.get("hadEligibility")||this.reportFunc("waitingForEligibilty",{tab:this.model.get("isInTab")},!1)}},{key:"fireSkipVimp1EligibilityLost",value:function(e){if(e){this._fireOpp(O.fireSkipVimp1EligibilityLost.id,O.fireSkipVimp1EligibilityLost.name);var t=this.subModel?this.subModel.get("videoViewContainer"):this.model.get("videoViewContainer");if(!t){var i=Object(n.a)(this.subModel?this.subModel.get("parentSelector"):this.model.get("parentSelector"));t=k.isArray(i)?i[0]:i}this.adData.pap=k.offsetFromBottomOfViewPort(t)+Object(n.a)(t).height()>0?1:0,this.model.get("isInTab")?this.adData.pap?(this._fireOpp(O.eligibilityLostScrolledUp.id,O.eligibilityLostScrolledUp.name),this.reportFunc(O.eligibilityLostScrolledUp.name,{},!0)):(this._fireOpp(O.eligibilityLostScrolledDown.id,O.eligibilityLostScrolledDown.name),this.reportFunc(O.eligibilityLostScrolledDown.name,{},!0)):(this._fireOpp(O.eligibilitySwitchedTab.id,O.eligibilitySwitchedTab.name),this.reportFunc(O.eligibilitySwitchedTab.name,{},!0))}this.reportFunc(O.fireSkipVimp1EligibilityLost.name,{},!1)}},{key:"fireSkipVimp1Vimp0Playing",value:function(e){e&&this._fireOpp(O.fireSkipVimp1Vimp0Playing.id,O.fireSkipVimp1Vimp0Playing.name),this.reportFunc(O.fireSkipVimp1Vimp0Playing.name,{otherAdRequiredViewbility:this.model.get("activeAdData.requiredViewability"),otherAdPlayerSequenceId:this.model.get("activeAdData.tagData.sequenceId"),otherAdDp:this.model.get("activeAdData.dp")},!1)}},{key:"fireLostCardEligibility",value:function(){this._fireOpp(O.lostCardEligibility.id,O.lostCardEligibility.name)}},{key:"onConversion",value:function(){this.hadConversion||(this.shouldFirePauseAfterPlay=!0,this.hadConversion=!0,this._fireOpp(O.conversion.id,O.conversion.name),this.reportFunc(O.conversion.name,{},!0))}},{key:"fireAdUnmuted",value:function(){this.adUnmutedOppFired||(this._fireOpp(O.adUnmuted.id,O.adUnmuted.name),this.adUnmutedOppFired=!0)}},{key:"fireUserAdUnmuted",value:function(){this.userAdUnmutedOppFired||(this._fireOpp(O.userAdUnmuted.id,O.userAdUnmuted.name),this.userAdUnmutedOppFired=!0)}},{key:"onFirstPauseAfterPlay",value:function(){if(this.shouldFirePauseAfterPlay&&!this.isViewed){this.shouldFirePauseAfterPlay=!1;var e=this.subModel?this.subModel.get("videoViewContainer"):this.model.get("videoViewContainer");e=k.isArray(e)?e[0]:e,this.adData.pap=k.offsetFromBottomOfViewPort(e)+Object(n.a)(e).height()>0?1:0,this._fireOpp(O.pauseAfterPlay.id,O.pauseAfterPlay.name),this.reportFunc(O.pauseAfterPlay.name,{tab:this.model.get("isInTab")},!0),this.model.get("isInTab")?this.adData.pap?(this._fireOpp(O.pauseAfterPlayScrolledUp.id,O.pauseAfterPlayScrolledUp.name),this.reportFunc(O.pauseAfterPlayScrolledUp.name,{},!0)):(this._fireOpp(O.pauseAfterPlayScrolledDown.id,O.pauseAfterPlayScrolledDown.name),this.reportFunc(O.pauseAfterPlayScrolledDown.name,{},!0)):(this._fireOpp(O.pauseAfterPlaySwitchedTab.id,O.pauseAfterPlaySwitchedTab.name),this.reportFunc(O.pauseAfterPlayScrolledUp.name,{},!0))}}},{key:"onViewabilityOneS",value:function(){this._fireOpp(O.viewabilityOneS.id,O.viewabilityOneS.name)}},{key:"onViewability",value:function(){this.isViewed=!0,this._fireOpp(O.viewability.id,O.viewability.name),this.reportFunc(O.viewability.name,{},!0)}},{key:"onTwoSecAfterPlay",value:function(){this.model.get("opps.twoSecAfterPlay.isFire")&&this._fireOpp(O.twoSecAfterPlay.id,O.twoSecAfterPlay.name)}},{key:"onViewability100",value:function(){this._fireOpp(O.viewability100.id,O.viewability100.name)}},{key:"onViewabilityAMP",value:function(){this._fireOpp(O.viewabilityAMP.id,O.viewabilityAMP.name)}},{key:"onNoViewabilityAMP",value:function(){this._fireOpp(O.noViewabilityAMP.id,O.noViewabilityAMP.name)}},{key:"onCompView100",value:function(){this._fireOpp(O.compView100.id,O.compView100.name)}},{key:"fireContinueAd",value:function(){this.isContinueAdFired||(this.isContinueAdFired=!0,this._fireOpp(O.continueAd.id,O.continueAd.name),this.reportFunc(O.continueAd.name,{tab:this.model.get("isInTab")},!0))}},{key:"onAdClicked",value:function(){this._fireOpp(O.clickThru.id),this.reportFunc(O.clickThru.name,{},!0),this.model.set("clickThruState",l.clickThruState.waiting)}},{key:"onAdDetached",value:function(){this.model.get("opps.detach.isFire")&&(this._fireOpp(O.detach.id),this.reportFunc(O.detach.name,{},!0))}},{key:"onAdAttached",value:function(){this.model.get("opps.attach.isFire")&&(this._fireOpp(O.attach.id),this.reportFunc(O.attach.name,{},!0))}},{key:"onAdSliderClosed",value:function(){this.model.get("opps.sliderClosed.isFire")&&(this._fireOpp(O.sliderClosed.id),this.reportFunc(O.sliderClosed.name,{},!0))}},{key:"fireLearnMoreClick",value:function(){this._fireOpp(O.learnMoreClick.id)}},{key:"fireTitleContaineClick",value:function(e){var t=O[e];t&&this._fireOpp(t.id,t.name)}},{key:"_fireOpp",value:function(e,t,i){if(this.adData&&e){t&&this.log.info("Fire ".concat(t," opps"));var n={rs:this.adData.sequenceId,st:p.ROLL_TYPE[this.adData.rollType],sts:this.model.get("playerRepeatCount"),os:Number(this.adData.waterfallTagId)+1,rst:e,d:Date.now()-this.adData.created,dast:this.adData.dast,vpd:this.adData.pubId,vptd:this.adData.tagId,pv:this.model.get("playerVersion"),dp:k.crc32(this.adData.dp),vmt:Number(this.adData.isRon)||0,abt:this._getAbTest(),vstt:this.model.get("isInTab")?1:0,agl:this.model.get("preset.level")?this.model.get("preset.level"):1,pdast:this.adData.pdast,ft:this.model.get("frameType"),ttv:this.adData.timeToVimp,bovpv:this.adData.bovpv,bovpg:this.adData.bovpg,be:this.model.get("playerHasRvInQ")?1:0,pap:void 0!==this.adData.pap?this.adData.pap:"",mty:this.adData.mty,extpvid:window.TRCImpl&&window.TRCImpl.external_page_view,rv:this.adData.requiredViewability};this._setSubUnitData(e,n),this._setCmTagParams(n),this._setModifiedPlacement(n),this._sendDebugDataReporting(n,e),!0===this.model.get("isOppsulaEnabled")&&u.a.oppsula&&!this.isBillableEvent(n.rst)?(n["auc-dast"]=this.model.get("cmDast")||void 0,u.a.oppsula.send(n)):this.oppManager.send(n,i)}}},{key:"_getAbTest",value:function(){return"".concat(this.model.get("abTest")).concat(this.adData.requiredViewabilityDrawn?"!ronrv":"").concat(this.adData.moatSampling?"!mtsmp":"")}},{key:"isBillableEvent",value:function(e){return this.model.get("billableEvents").indexOf(e)>-1}},{key:"setSubModel",value:function(e){this.subModel=e}},{key:"_onSecondsToCloseGlobal",value:function(){this.reportFunc("secondsToCloseGlobal",{},!0)}},{key:"_onCloseButtonClick",value:function(){this.reportFunc("closeButtonClick",{},!0)}},{key:"_setSubUnitData",value:function(e,t){var i=this.model.get("isFireSP");for(var n in i){if(e!==parseInt(n)||!i[n])break;var o=this.getAdData();void 0!==o.sp&&(t.sp=o.sp)}var r=this.model.get("subUnitType");this.model&&(r||0===r)&&(t.su=r)}},{key:"_setModifiedPlacement",value:function(e){var t=this.model.get("modifiedPlacement");t&&(e.mp=t)}},{key:"_setCmTagParams",value:function(e){var t=this.model.get("oppsQS")||{};k.assignWithoutUndefinedValues(e,t)}},{key:"fireContinueAdInAnotherCard",value:function(){this._fireOpp(O.continueAdInAnotherCard.id,O.continueAdInAnotherCard.name),this.reportFunc(O.continueAdInAnotherCard.name,{},!0)}},{key:"fireShouldContinueAdInAnotherCard",value:function(){this._fireOpp(O.shouldContinueAdInAnotherCard.id,O.shouldContinueAdInAnotherCard.name),this.reportFunc(O.shouldContinueAdInAnotherCard.name,{},!0)}},{key:"adProgressionBeforeEndPredict",value:function(){this.model.get("opps.adProgressionBeforeEndPredict.isFire")&&this._fireOpp(O.adProgressionBeforeEndPredict.id,O.adProgressionBeforeEndPredict.name)}},{key:"adProgressionAfterBeginPredict",value:function(){this.model.get("opps.adProgressionAfterBeginPredict.isFire")&&this._fireOpp(O.adProgressionAfterBeginPredict.id,O.adProgressionAfterBeginPredict.name)}},{key:"_sendDebugDataReporting",value:function(e,t){this._isSendDebugData()&&(e.dbg=this._getDebugData(),this.model.get("isSendDebugDataReportingLog")&&this.log.info("DBG-Opp ".concat(t," - ").concat(e.dbg)))}},{key:"_getDebugData",value:function(){return new T({model:this.model,subModel:this.subModel,adData:this.adData,onDebugDataChange:this.setDebugData,isViewed:this.isViewed}).getDebugData()}},{key:"_isSendDebugData",value:function(){if(this.model.get("isSendDebugDataReporting"))return!0;var e=this.model.get("debugData.advertisersToReport")||"",t=this.vpaidData.advId;return e.toString().indexOf(t)>-1}},{key:"adSwappedOut",value:function(){this._fireOpp(O.adSwappedOut.id,O.adSwappedOut.name),this.reportFunc(O.adSwappedOut.name,{},!0)}},{key:"adSwappedIn",value:function(){this._fireOpp(O.adSwappedIn.id,O.adSwappedIn.name),this.reportFunc(O.adSwappedIn.name,{},!0)}},{key:"onOneSecondNoPlaySamePlace",value:function(){this._fireOpp(O.oneSecondNoPlaySamePlace.id,O.oneSecondNoPlaySamePlace.name),this.reportFunc(O.oneSecondNoPlaySamePlace.name,{},!0)}},{key:"onOneSecondNoPlayScrolledUp",value:function(){this._fireOpp(O.oneSecondNoPlayScrolledUp.id,O.oneSecondNoPlayScrolledUp.name),this.reportFunc(O.oneSecondNoPlayScrolledUp.name,{},!0)}},{key:"onOneSecondNoPlayScrolledDown",value:function(){this._fireOpp(O.oneSecondNoPlayScrolledDown.id,O.oneSecondNoPlayScrolledDown.name),this.reportFunc(O.oneSecondNoPlayScrolledDown.name,{},!0)}},{key:"onDisplayingFullNAS",value:function(){this._fireOpp(O.displayingFullNAS.id,O.displayingFullNAS.name),this.reportFunc(O.displayingFullNAS.name,{},!0)}},{key:"onDisplayingNASTitleOnly",value:function(){this._fireOpp(O.displayingNASTitleOnly.id,O.displayingNASTitleOnly.name),this.reportFunc(O.displayingNASTitleOnly.name,{},!0)}},{key:"fireGenericOpp",value:function(e){var t=O[e];t&&(this._fireOpp(t.id,t.name),this.reportFunc(t.name,{},!0))}},{key:"fireBeaconOpp",value:function(e){var t=O[e];t&&(this._fireOpp(t.id,t.name,!0),this.reportFunc(t.name,{},!0))}},{key:"onHipAdjacAdWithoutReplay",value:function(){this._fireOpp(O.noReplayForHipAdjacAd.id,O.noReplayForHipAdjacAd.name),this.reportFunc(O.noReplayForHipAdjacAd.name,{},!0)}},{key:"onAdPlayingNextAdReadyRV1",value:function(){this._fireOpp(O.adPlayingNextAdReadyRV1.id,O.adPlayingNextAdReadyRV1.name),this.reportFunc(O.adPlayingNextAdReadyRV1.name,{},!0)}}])&&A(t.prototype,i),r}(s.a),R=i(26),V=i(56),D=i.n(V);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=i(5),j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(s,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=F(e);if(t){var o=F(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return L(this,i)}}(s);function s(e){var t,i=e.model,n=e.ppKey,r=e.adId,c=e.impressionCb,d=e.completeCb,u=e.kibana,h=e.predictName,p=e.getAdProperties;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,i)).model=i,t._handleKibana(u),t.getAdKey=isNaN(parseInt(n))?n:parseInt(n),t.adId=r,t.impressionCb=c,t.completeCb=d,t.predictName=h,t.scrollManager=new m.a,t.getAdProperties=p||{},t.handleAdjacencyAd(),t.log=new a.a({unitType:t.model.get("unitType"),className:"adService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.adState=l.readyState,t.getAdState=l.getAdState.notCalled,t.adQState=l.adQState.readyState,t.hadPlay=!1,t.isActive=!1,t.hadImpression=!1,t.sizeObj={},t.adClickCounter=1,t.onAdImpressionTimer=null,t._bindEvents(),t._onPlayerStateReady(),t._getAd(),t.isLostView100=!1,t}return t=s,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adManagerState:paused",funcName:"_pauseGetAd",isListenOnce:!0},{event:"adManagerState:stopped",funcName:"_stopGetAd",isListenOnce:!0},{event:"playerState:ready",funcName:"_onPlayerStateReady",isListenOnce:!0},{event:"adViewabilityFired:true",funcName:"adViewabilityFired",isListenOnce:!0},{event:"adConversionFired:true",funcName:"adConversionFired",isListenOnce:!0}])}},{key:"_onPlayerStateReady",value:function(){!this.player&&u.a.player&&(this.player=u.a.player)}},{key:"_pauseGetAd",value:function(){this.cancelGetAd(),this.getAdState=l.getAdState.stopped,this.setToModel("getAdState",l.getAdState.stopped),this.model.get("isReplayAd")||(this.player=void 0)}},{key:"_stopGetAd",value:function(){this.cancelGetAd(),this.getAdState=l.getAdState.finished,this.player=void 0}},{key:"adViewabilityFired",value:function(){if(this._hasVpaidWrapper()&&this.vpaidWrapper.emit){this.vpaidWrapper.emit("unit::viewability");var e=this.vpaidWrapper.getVpaidData(),t=e&&e.eventTrackers&&e.eventTrackers.viewability;B.each(t,this._sendPixel,this)}this.isViewabilityFired=!0}},{key:"adConversionFired",value:function(){this._hasVpaidWrapper()&&this.vpaidWrapper.emit&&this.vpaidWrapper.emit("unit::conversion")}},{key:"_getAd",value:function(){if(!this._hasPlayer()||!this.player.getAd)return this.setToModel("getAdCurrId",this.adId),void setTimeout(this.setToModel.bind(this,"getAdState",l.getAdState.failed),0);if(this.getAdState!==l.getAdState.gettingAd){if(this.adRequestTime=Date.now(),this.model.get("bottomOfViewPortDebugSelector")){var e=Object(n.a)(this.model.get("bottomOfViewPortDebugSelector"));this.bottomOfViewPortOnGetAd=e.length>0&&B.offsetFromBottomOfViewPort(e[0])}this.log.info("GetAd was called, requiredViewability: ".concat(this.getAdKey,", time =").concat(this.adRequestTime," ")),this.getAdPPS=this.scrollManager.pps,this.getAdPPSChange=this.scrollManager.ppsChange,this.setToModel("lastGetAdKey",this.getAdKey),this.model.get("getAdState")===l.getAdState.gettingAd?this.model.trigger("change:getAdState",this.model,this.model.get("getAdState")):this.setToModel("getAdState",l.getAdState.gettingAd),this.getAdState=l.getAdState.gettingAd;var t=this.model.get("exploreMore")>0;"any"===this.getAdKey?this.getAdResult=this.player.getAd({getAdTimeout:this._getTimeOut(),adProperties:this.getAdProperties.adProperties,excAdProperties:this.getAdProperties.excAdProperties,forceWf:t}):this.getAdResult=this.player.getAd({requiredViewability:this.getAdKey,getAdTimeout:this._getTimeOut(),adProperties:this.getAdProperties.adProperties,excAdProperties:this.getAdProperties.excAdProperties,forceWf:t}),this._sendEventToKibana(this.kibanaEvents.getAd,{getAdKey:this.getAdKey,predictName:this.predictName}),this.getAdResult?this.getAdResult.then(this._getAdResult.bind(this)).catch(this._getAdCatch.bind(this)):this.log.error("getAd Failed in auction  manager")}else this.log.info("[adID=${trimmedBranch}]getAd was called while trying to get an ad from player",this.adId)}},{key:"_getAdResult",value:function(e){try{if(B.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoGotAd",p.TRC_PERFORMANCE_ACTIONS.START),this.vpaidWrapper=e,this._setAdTypeConfig(),this.rpox=e.tag.rpox,this.vpaidData=this.vpaidWrapper.getVpaidData(),this.adData=B.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon","requiredViewability","rpox"]),this.adData.cpm=this.vpaidWrapper.tag.vpaidWrapperData&&this.vpaidWrapper.tag.vpaidWrapperData.vastPrice?this.vpaidWrapper.tag.vpaidWrapperData.vastPrice:this.vpaidWrapper.tag.price,this.adData.requiredViewability=B.parseBool(this.adData.requiredViewability),this.adData.getAdPPS=this.getAdPPS,this.adData.getAdPPSChange=this.getAdPPSChange,this.adData.timeToVimp=Date.now()-this.adRequestTime,this.model.get("bottomOfViewPortDebugSelector")&&this.bottomOfViewPortOnGetAd){var t=Object(n.a)(this.model.get("bottomOfViewPortDebugSelector"));this.adData.bovpg=!!this.bottomOfViewPortOnGetAd&&parseInt(this.bottomOfViewPortOnGetAd),this.adData.bovpv=t.length>0&&parseInt(B.offsetFromBottomOfViewPort(t[0]))}this.adData.dast=this.vpaidWrapper.tag.vidDast||this.vpaidWrapper.tag.dast,this.adData.mty=this.vpaidWrapper.tag.vpaidWrapperData&&this.vpaidWrapper.tag.vpaidWrapperData.mediatype?this.vpaidWrapper.tag.vpaidWrapperData.mediatype:void 0,this.adData.moatSampling=this.vpaidWrapper.tag.moatSampling||!1,this.adData.requiredViewabilityDrawn=this.vpaidWrapper.tag.requiredViewabilityDrawn||!1,this.vpaidWrapper.playerDAST&&this.vpaidWrapper.playerDAST.get&&(this.adData.pdast=this.vpaidWrapper.playerDAST.get()),this._setDebugReportDataOnGotAd(),this.vpaidWrapper.vpaidLog.data.unit_history=[],this.reportToVpaid("gotAd",{tab:this.model.get("isInTab"),eligibility:this.model.get("isEligibleToPlay"),gotVimpCountQ:this.model.get("impressionCount"),hadEligibility:this.model.get("hadEligibility"),hadLostEligibility:!!this.model.get("lostEligibilityTime"),predictName:this.predictName,getAdKey:"any"===this.getAdKey?10:this.getAdKey},!1),this.adData&&(u.a.supportTool.dp[this.adId]=this.adData.dp),this.setToModel("lastGotAdData",this.adData),this.model.get("lastImpressionData.sequenceId")?this.sequenceId=this.model.get("lastImpressionData.sequenceId")+1:this.sequenceId=1;var i=void 0;return this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.data&&(i=this.vpaidWrapper.vpaidLog.data._id),this.lastImpressionData={predictPoint:this.predictPoint,requiredViewability:this.vpaidWrapper.tag.requiredViewability,getAdKey:"any"===this.getAdKey?10:this.getAdKey,sequenceId:this.sequenceId,dp:this.vpaidWrapper.tag.dp,tagData:B.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),vpaidId:i,lineItemId:this.vpaidWrapper.tag.lineItemId,predictName:this.predictName},this.setToModel("lastImpressionData",this.lastImpressionData),this._sendEventToKibana(this.kibanaEvents.gotAd,this.lastImpressionData),this.setToModel("impressionCount",this.model.get("impressionCount")+1),this.oppsService=new I({model:this.model,adData:this.adData,vpaidData:this.vpaidData,reportFunc:this.reportToVpaid.bind(this),getAdDataFunc:this.getAdData.bind(this),setDebugData:this.vpaidWrapper.setDebugData.bind(this.vpaidWrapper)}),this.vpaidWrapper.setDebugDataFunc&&this.vpaidWrapper.setDebugDataFunc(this.oppsService._getDebugData.bind(this.oppsService)),this.log.info("GotAd requiredViewability: ".concat(e.tag.requiredViewability?1:0)),this.getAdState=l.getAdState.gotAd,this.setToModel("getAdState",l.getAdState.gotAd),this.getAdResult=void 0,this._registerListeners(),this._onAdImpression(e),this._setAdRV(),null}catch(e){this.log.error(e)}finally{B.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoGotAd",p.TRC_PERFORMANCE_ACTIONS.STOP)}}},{key:"_getAdCatch",value:function(e){this.hadImpression||(this.getAdResult=void 0,this.log.info("GetAd failed requiredViewability: ".concat(this.getAdKey),this.adId),this.getAdState=l.getAdState.failed,this.setToModel("getAdCurrId",this.adId),this.setToModel("getAdState",l.getAdState.failed))}},{key:"_registerListeners",value:function(){this.vpaidWrapper.on&&(this.vpaidWrapper.on("AdError",this._onAdError.bind(this)),this.vpaidWrapper.on("AdVideoFirstQuartile",this._onAdVideoFirstQuartile.bind(this)),this.vpaidWrapper.on("AdVideoMidpoint",this._onAdVideoMidpoint.bind(this)),this.vpaidWrapper.on("AdVideoThirdQuartile",this._onAdVideoThirdQuartile.bind(this)),this.vpaidWrapper.on("end",this._adVideoEnd.bind(this)),this.vpaidWrapper.on("AdClickThru",this._onAdClickThru.bind(this)),this.vpaidWrapper.on("activeAdCurrentTime",this._onActiveAdCurrentTime.bind(this)),this.vpaidWrapper.on("NewCompletion",this._onNewCompletion.bind(this)))}},{key:"_onActiveAdCurrentTime",value:function(e){this.isCompleted||(this.setToModel("activeAdCurrentTime",e.currentTime),this.setToModel("activeAdMaxTime",e.duration))}},{key:"_onAdImpression",value:function(e){this.vpaidWrapper.pauseAd(),this._sendEventToKibana(this.kibanaEvents.adPaused,{pauseReason:"pauseOnAdImpression"}),this.reportToVpaid("pauseAdCalled",{reason:"pauseOnAdImpression",tab:this.model.get("isInTab")},!1),this._bringToBack(),this.log.info("onAdImpression (got ad - pausing ad)",this.adId),this.hadImpression=!0,this.rpox=e.tag.rpox,this.adQState=l.adQState.impression;var t={lineItemId:this.model.get("lineItemId"),placement:this.model.get("placement"),redId:this.model.get("redId")};this.model.get("isSendCPM")&&(t.cpm=this.adData.cpm),r.a.trigger("onImpression",t);var i=e.getVpaidData();this.adData.timeToImpression=i.startTimestamp?Date.now()-i.startTimestamp:void 0,this.model.get("adQState")===l.adQState.impression?setTimeout(this.model.trigger.bind(this.model,"change:adQState",this.adQState),0):setTimeout(this.setToModel.bind(this,"adQState",this.adQState),0),this.impressionCb(this),B.sendingEventToTaboolaBridge("impression",this.adId),this.adData.requiredViewability&&this._startOneSecondNoPlayTimer()}},{key:"_onAdError",value:function(e){this.log.error("Vpaid Wrapper Error, key: "+this.getAdKey,this.adId),B.sendingEventToTaboolaBridge("adError",this.adId)}},{key:"_onAdVideoFirstQuartile",value:function(){this.hadPlay&&(this.adQState=l.adQState.q1,this.setToModel("adQState",l.adQState.q1,this.adId),this.log.info("AdVideoFirstQuartile"),B.sendingEventToTaboolaBridge("firstQuartile",this.adId))}},{key:"_onAdVideoMidpoint",value:function(){this.hadPlay&&(this.adQState=l.adQState.q2,this.setToModel("adQState",l.adQState.q2,this.adId),this.log.info("AdVideoMidpoint"),B.sendingEventToTaboolaBridge("midpoint",this.adId))}},{key:"_onAdVideoThirdQuartile",value:function(){this.hadPlay&&(this.adQState=l.adQState.q3,this.setToModel("adQState",l.adQState.q3,this.adId),this.log.info("AdVideoThirdQuartile"),B.sendingEventToTaboolaBridge("thirdQuartile",this.adId))}},{key:"_adVideoEnd",value:function(){if(this.player){var e=this.subModel||this.model;if(this.model.get("isReplayAd")||e.stopListening(e,"change:nativeAdClick"),this._setAdPlayingWithAdChoice(!1),this.log.info("on ad video end",this.adId),this.reportToVpaid("vpaidDone",{tab:this.model.get("isInTab")},!0),this.isCompleted=!0,!this.hadPlay)return this.adState=l.adState.autoKill,void this.completeCb(this,!0);this._sendEventToKibana(this.kibanaEvents.adComplete),this.setToModel("activeTag",void 0),this.adQState=l.adQState.completed,this.adState=l.adState.completed,this.completeCb(this,!1),this.model.get("isReplayAd")||(this.vpaidWrapper=void 0,this.setToModel("activeAdData",void 0)),this.setOrTrigger("adQState",this.adQState),this.setOrTrigger("adState",this.adQState),this.getAdState=l.getAdState.stopped,u.a.supportTool.dp[this.adId]=void 0,delete u.a.supportTool.dp[this.adId],B.sendingEventToTaboolaBridge("complete",this.adId),this.onCompView100(),this._stopRV1Observer()}}},{key:"_onAdClickThru",value:function(){1===this.adClickCounter?(this.setToModel("clickThruState",l.clickThruState.clicked),this.oppsService.onAdClicked(),B.sendingEventToTaboolaBridge("adClick",this.adId),this.reportToVpaid("firstAdClick",{number:this.adClickCounter},!1)):this.reportToVpaid("falseAdClick",{number:this.adClickCounter},!1),this.adClickCounter++}},{key:"_onTitleContainerClick",value:function(){if(this._hasVpaidWrapper()){var e=this.vpaidWrapper.getVpaidData(),t=this.getFromModel("adNativeSettings").link||e.vastClickThruLink;t&&this._clickThru(t);var i=this.getFromModel("nativeAdClick");this.oppsService.fireTitleContaineClick(i),this._onAdClickThru()}}},{key:"_clickThru",value:function(e){if(this.model.get("isInApp")&&window.taboolaMobile&&window.tbNativeBridge){var t=window.tbNativeBridge;if(t.invoke)return void t.invoke("onClick",["",e,e,!1,"0","video"])}window.open(e)}},{key:"_bringToFront",value:function(){if(this.vpaidWrapper.localTarget){var e=this.model.get("style.videoBackgroundColor");Object(n.a)(this.vpaidWrapper.localTarget).css({zIndex:1e3,display:"block",backgroundColor:e})}}},{key:"_bringToBack",value:function(){this.vpaidWrapper.localTarget&&Object(n.a)(this.vpaidWrapper.localTarget).css({zIndex:0})}},{key:"_hasVpaidWrapper",value:function(){return this._hasPlayer()&&this.vpaidWrapper}},{key:"_hasPlayer",value:function(){return this.player&&!this.player.playerIsClosed}},{key:"setActiveTag",value:function(){this.log.info("setActiveTag",this.adId);var e=B.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]);this.model.get("activeTag")!==e&&this.setToModel("activeTag",e)}},{key:"getAdData",value:function(){if(this.vpaidWrapper){var e=void 0;this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.data&&(e=this.vpaidWrapper.vpaidLog.data._id);var t={adId:this.adId,predictPoint:this.predictPoint,requiredViewability:this.vpaidWrapper.tag?B.parseBool(this.vpaidWrapper.tag.requiredViewability):void 0,getAdKey:"any"===this.getAdKey?10:this.getAdKey,sequenceId:this.sequenceId,dp:this.vpaidWrapper.tag?this.vpaidWrapper.tag.dp:void 0,rpox:this.rpox,isCompleted:this.isCompleted,tagData:B.filterObject(this.vpaidWrapper.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),vpaidId:e};return this._setSubUnitData(t),t}}},{key:"isPWOV",value:function(){return!(!this.vpaidWrapper||!this.vpaidWrapper.pwov)&&this.model.get("isPWOV")&&B.isFactor(100/this.vpaidWrapper.pwov)}},{key:"pause",value:function(){if((this.model.get("isInTab")&&"continueAd"===this.model.get("onOutOfView")||this.isPWOV())&&this.isViewabilityFired&&!this.model.get("blockedByExternalUnit"))return this.log.info("onOutOfView continueAd",this.adId),this.setToModel("adState",l.adState.continueAd),this.adState=l.adState.continueAd,this.oppsService.fireContinueAd(),this._sendEventToKibana(this.kibanaEvents.continueAd),void(this.isLostView100=!0);this._hasVpaidWrapper()&&(this.log.info("Pause ad",this.adId),this.vpaidWrapper.pauseAd(),this.oppsService.onFirstPauseAfterPlay(),this._sendEventToKibana(this.kibanaEvents.adPaused,{pauseReason:"outOfView"}),this.reportToVpaid("pauseAdCalled",{reason:"outOfView",tab:this.model.get("isInTab")},!1)),this.setToModel("adState",l.adState.paused),this.adState=l.adState.paused}},{key:"skipAd",value:function(){this.log.info("Skip ad",this.adId),this.setToModel("isReplayAd",!1),this._hasVpaidWrapper()&&this.vpaidWrapper.skipAd(),this.setToModel("adState",l.adState.skipped)}},{key:"play",value:function(){this.clearOnAdImpressionTimer(),this.model.set("lastActiveAd",this.adId),this.log.info("playing ad",this.adId);var e=this.getAdData();this.setToModel("activeAdData",e),this._hasVpaidWrapper()&&(this._updateAdChoiceVisibility(),this._keepReplayableAdAlive()),this.hadPlay||(this.hadPlay=!0,this.log.info("Winning ad: "+this.getAdKey,this.adId),this.model.get("isMultiActiveAds")||(this._bringToFront(this.vpaidWrapper),Object(n.a)(this.vpaidWrapper.adTarget).removeClass("_cm-ad")),this.setActiveTag(),this._checkIfStartRV1Observer(),this.adQState=l.adQState.q0,this.setToModel("adQState",l.adQState.q0),this._setDebugReportDataOnConversion(e),this.oppsService.onConversion(),this.adConversionFired(),this.setAdParametersToModel(),setTimeout(this._fireTwoSecAfterPlay.bind(this),2e3)),this._hasVpaidWrapper()?(this.log.info("resumeAd VpaidWrapper is alive ",this.adId),this._bringToFront(this.vpaidWrapper),this.vpaidWrapper.resumeAd(),this.model.set("hadPlayedAd",!0),this.reportToVpaid("resumeAdCalled",{tab:this.model.get("isInTab")},!1),this._sendEventToKibana(this.kibanaEvents.adPlay)):this.log.warning("resumeAd failed VpaidWrapper is NOT alive ",this.adId),setTimeout(this._firePlayEvents.bind(this),0),this.start||(this.start=!0,B.sendingEventToTaboolaBridge("start",this.adId));var t=this.getCurrModel();this.isLostView100||(this.isLostView100=!t.get("isViewable100"),this.isViewabilityListenerSet||this.isLostView100||(t.on("change:isViewable100",this.onViewabile100Change.bind(this)),this.isViewabilityListenerSet=!0))}},{key:"_firePlayEvents",value:function(){this.adState=l.adState.playing,this.setToModel("adState",l.adState.playing),r.a.trigger("global:adState:playing")}},{key:"_fireTwoSecAfterPlay",value:function(){this.oppsService.onTwoSecAfterPlay()}},{key:"cancelGetAd",value:function(){this.getAdResult&&(this.log.info("GetAd was cancelled",this.adId),this.getAdResult.cancel(),this.getAdResult=void 0)}},{key:"setToModel",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.model.set(e,t,i),this.subModel&&this.subModel.set(e,t,i)}},{key:"getFromModel",value:function(e){return this.subModel?this.subModel.get(e):this.model.get(e)}},{key:"setSubModel",value:function(e){this.subModel=e,this.oppsService&&this.oppsService.setSubModel(this.subModel)}},{key:"getCurrModel",value:function(){return this.subModel?this.subModel:this.model}},{key:"forceTrigger",value:function(e){this.model.trigger("change:"+e,this.model,this.model.get(e)),this.subModel&&this.subModel.trigger("change:"+e,this.subModel,this.subModel.get(e))}},{key:"setOrTrigger",value:function(e,t){this.model.get(e)===t?this.forceTrigger(e):this.setToModel(e,t)}},{key:"resize",value:function(e){e&&e.width&&e.height?this.sizeObj.width===e.width&&this.sizeObj.height===e.height||(this.sizeObj.width=e.width,this.sizeObj.height=e.height,this.log.info("resizing ad",n.a.extend({},e,{adId:this.adId,aspectRatio:this.aspectRatioString})),this.vpaidWrapper.resizeAd(e.width,e.height,this.aspectRatioString)):this.log.warning("resize was called with empty sizeObj!",e)}},{key:"recheckSize",value:function(){var e=this.sizeObj;this.sizeObj={},this.resize(e)}},{key:"mute",value:function(){this.vpaidWrapper&&(this.log.info("Mute Player"),this.vpaidWrapper.mute(),B.sendingEventToTaboolaBridge("volumeChange",0))}},{key:"unmute",value:function(){this.vpaidWrapper&&(this.log.info("UnMute Player"),this.vpaidWrapper.unmute(),this.oppsService.fireAdUnmuted(),B.sendingEventToTaboolaBridge("volumeChange",100))}},{key:"fireSkipVimp1EligibilityLost",value:function(e){this.clearOnAdImpressionTimer(),this.oppsService.fireSkipVimp1EligibilityLost(e)}},{key:"fireSkipVimp1Vimp0Playing",value:function(e){this.clearOnAdImpressionTimer(),this.oppsService.fireSkipVimp1Vimp0Playing(e)}},{key:"onViewability",value:function(){this.isViewed||(this.isViewed=!0,this.adViewabilityFired(),this.oppsService.onViewability(),this._sendEventToKibana(this.kibanaEvents.viewability))}},{key:"onViewabilityOneS",value:function(){this.isViewedOneS||(this.isViewedOneS=!0,this.oppsService.onViewabilityOneS())}},{key:"onViewability100",value:function(){this.isViewed100||(this.setToModel("viewability100",!0),this.isViewed100=!0,this.oppsService.onViewability100())}},{key:"onViewabilityAMP",value:function(){this.isViewedAMP||(this.isViewedAMP=!0,this.isNoViewedAMP=!0,this.oppsService.onViewabilityAMP())}},{key:"onNoViewabilityAMP",value:function(){this.isNoViewedAMP||(this.isNoViewedAMP=!0,this.oppsService.onNoViewabilityAMP())}},{key:"onCompView100",value:function(){this.isLostView100||this.isCompViewed100||(this.isCompViewed100=!0,this.oppsService.onCompView100())}},{key:"onDetached",value:function(){this.isDetached||(this.isDetached=!0,this.oppsService.onAdDetached())}},{key:"onAttached",value:function(){this.isDetached&&(this.isDetached=!1,this.oppsService.onAdAttached())}},{key:"onSliderClose",value:function(){this.isSliderClosed||(this.isSliderClosed=!0,this.oppsService.onAdSliderClosed())}},{key:"reportToVpaid",value:function(e,t,i){this._setSubUnitData(t),this._hasVpaidWrapper()&&this.vpaidWrapper.vpaidLog&&this.vpaidWrapper.vpaidLog.push&&(this.vpaidWrapper.vpaidLog.push("unit_".concat(e),t,!1),this.vpaidWrapper.vpaidLog.data&&this.vpaidWrapper.vpaidLog.data.unit_history&&this.vpaidWrapper.vpaidLog.data.unit_history.push&&this.vpaidWrapper.vpaidLog.data.unit_history.push(e),this.vpaidWrapper.vpaidLog.data.statuses.push(e),i&&this.vpaidWrapper.vpaidLog.push("unit_state",{status:e},i))}},{key:"fireSkipVimp1EligibilityLost",value:function(e){this.oppsService.fireSkipVimp1EligibilityLost(e)}},{key:"fireSkipVimp1Vimp0Playing",value:function(e){this.oppsService.fireSkipVimp1Vimp0Playing(e)}},{key:"reportRpoxSkip",value:function(e){this.reportToVpaid("skipRpox",{otherRpox:e.rpox,otherRequiredViewability:e.requiredViewability,otherAdDp:e.dp,otherSequenceId:e.sequenceId},!1)}},{key:"reportPpKeySkip",value:function(e){this.reportToVpaid("skipPpKey",{otherRpox:e.rpox,otherRequiredViewability:e.requiredViewability,otherAdDp:e.dp,otherSequenceId:e.sequenceId},!1)}},{key:"_setAdPlayingWithAdChoice",value:function(e){this.setToModel("adPlayingWithAdChoice",e)}},{key:"_updateAdChoiceVisibility",value:function(){this.vpaidWrapper.hasAdChoices?this._setAdPlayingWithAdChoice(!0):this._setAdPlayingWithAdChoice(!1)}},{key:"_setSubUnitData",value:function(e){var t=this.model.get("subUnitType");if(this.model&&(t||0===t)&&(e.su=t),this.subModel){var i=this.model.get("detachToSlider"),n=this.subModel.get("gotFirstEligibility");i&&i.isStartFromSlider&&i.isDetachToSlider?e.sp=n?this.subModel.get("cardNumber"):0:i&&i.isStartFromSlider&&!this.subModel.get("isEligibleToPlay")?e.sp=0:this.model.get("cardNumber")&&(e.sp=this.model.get("cardNumber"))}else this.model.get("MSNCard.row")&&(e.sp=this.model.get("MSNCard.row"))}},{key:"_handleKibana",value:function(e){this.kibanaEvents=p.KIBANA_EVENTS,e&&(this.kibana=e)}},{key:"_sendEventToKibana",value:function(e,t){this.kibana&&((t=t||{}).adId=this.adId,this.subModel&&this.subModel.get("cardNumber")&&(t.cardNumber=this.subModel.get("cardNumber")),this.kibana.adEvent(e,t))}},{key:"onCardSwap",value:function(){this.oppsService.fireContinueAdInAnotherCard()}},{key:"onShouldCardSwap",value:function(){this.oppsService.fireShouldContinueAdInAnotherCard()}},{key:"onLearnMoreClick",value:function(){this.oppsService.fireLearnMoreClick()}},{key:"_setDebugReportDataOnGotAd",value:function(){this.model.increaseCounter("sqv"),this.adData.requiredViewability?this.model.increaseCounter("rvvs1"):this.model.increaseCounter("rvvs0"),this.adData.pn=this.predictName,this.adData.adId=this.adId,this.adData.esv=this.vpaidData.earlySrcVPAID}},{key:"_setDebugReportDataOnConversion",value:function(){this.model.increaseCounter("conversionCount"),this.adData.requiredViewability?this.model.increaseCounter("rvps1"):this.model.increaseCounter("rvps0")}},{key:"_setAdRV",value:function(){this.adData.requiredViewability?this.setToModel("gotRvAd",!0):this.setToModel("gotNonRvAd",!0)}},{key:"_getTimeOut",value:function(){return this.model.get("vForce.secondsToGetAdFail.".concat(this.getAdKey))}},{key:"_setAdTypeConfig",value:function(){if(this.vpaidWrapper&&this.vpaidWrapper.getVpaidData){var e=this.vpaidWrapper.getVpaidData();for(var t in this.adTypeTranslator=new R.default({model:this.subModel||this.model}),this.adTypeConfig={},e)if(e[t]){var i=this.adTypeTranslator.getConfigForKey(t);if(B.isEmpty(i))continue;if(this.log.info("got adTypeConfig for key "+t,i),i.revertAfter){var n=this._createRevertAdType(i,t);this._setAdTypeConfigAfter(i.revertAfter,n)}i.setAdConfigAfter?this._setAdTypeConfigAfter(i.setAdConfigAfter,i):this.setToModel(i),this.adTypeConfig[t]=i}this.aspectRatioNum=this.getAspectRatioNum(e),this.log.info("Ad size received is - width: "+e.adWidth+"; height: "+e.adHeight),this._setAdTypeConfigAfter("setSubModel",{aspectRatioNum:this.aspectRatioNum}),this.supportVideoCurrentTimeEvents=e.supportVideoCurrentTimeEvents}}},{key:"_setAdTypeConfigAfter",value:function(e,t){var i=this[e];B.isFunction(i)&&(this[e]=function(){i.apply(this,arguments),this.setToModel(t),this.log.info("setting ad type config after ".concat(i.name," function"),t)})}},{key:"_createRevertAdType",value:function(e,t){var i={};for(var n in e)"setAdConfigAfter"!==n&&"revertAfter"!==n&&(i[n]=this.model.get(n));return i}},{key:"onAdSetToUnits",value:function(){}},{key:"_keepReplayableAdAlive",value:function(){var e=this.vpaidWrapper;e.dontDie&&this.model.get("isReplayAd")&&(e.isReplayable||this.model.get("isForceDontDie"))&&(e.dontDie(),this.model.set("dontRenderRepeatButton",!e.isReplayable))}},{key:"setAdParametersToModel",value:function(){if(this.model.get("components.nativeAd.isActive")){var e=this.vpaidWrapper.getVpaidData(),t=e.adNativeSettings||{},i=this.subModel||this.model;e.adNativeSettings&&this.model.set("continueToPlayInNexCard.isActive",!1),this.setNativeAdClickListener(),this.setToModel("adNativeSettings",void 0,{silent:!0}),this.setToModel("adNativeSettings",t,{silent:!0}),i.trigger("change:adNativeSettings",i,i.get("adNativeSettings"))}this.vpaidWrapper.clickThruUrl?(this.log.info("updated click through URL",this.vpaidWrapper.clickThruUrl),this.setToModel("adClickThroughUrl",this.vpaidWrapper.clickThruUrl)):this.setToModel("adClickThroughUrl",""),this.setToModel("activeAdRV",this.adData.requiredViewability)}},{key:"_setTagDataToStorage",value:function(){try{this.model.setStorage("activeAdData",this.vpaidWrapper.tag)}catch(e){this.log.error("error setting activeAdData",{error:e,tag:this.vpaidWrapper.tag})}}},{key:"setNativeAdClickListener",value:function(){var e=this.subModel||this.model;e.listenTo(e,"change:nativeAdClick",this._onTitleContainerClick.bind(this))}},{key:"_sendPixel",value:function(e){"img"===e.method?(new Image).src=e.pixel:"js"===e.method&&this._sendJSPixel(e.pixel)}},{key:"_sendJSPixel",value:function(e){var t=document.createElement("script");t.src=e,t.type="text/javascript",t.async=!0,document.body.appendChild(t)}},{key:"getAspectRatioNum",value:function(e){return e&&e.supportVerticalVideo?(this.aspectRatioString=e.adWidth.toString()+":"+e.adHeight.toString(),e.adWidth/e.adHeight):this.aspectRatioNum?this.aspectRatioNum:(this.aspectRatioString="16:9",this.model.get("defaultAspectRatioNum"))}},{key:"onadProgressionAfterBeginPredict",value:function(){this.oppsService.adProgressionAfterBeginPredict()}},{key:"onadProgressionBeforeEndPredictPredict",value:function(){this.oppsService.adProgressionBeforeEndPredict()}},{key:"onAdSwappedOut",value:function(){this.oppsService.adSwappedOut()}},{key:"onAdSwappedIn",value:function(){this.oppsService.adSwappedIn()}},{key:"_startOneSecondNoPlayTimer",value:function(){var e=Object(n.a)(this.subModel?this.subModel.get("parentSelector"):this.model.get("parentSelector"));this.mesureElement=B.isArray(e)?e[0]:e,this.onImpressionPosition=B.offsetFromBottomOfViewPort(this.mesureElement),this.onAdImpressionTimer=setTimeout(this._reportOneSecondNoPlay.bind(this),1e3)}},{key:"_reportOneSecondNoPlay",value:function(){null!==this.onAdImpressionTimer&&(this.onOneSecondPosition=B.offsetFromBottomOfViewPort(this.mesureElement),this.onImpressionPosition===this.onOneSecondPosition&&this.oppsService.onOneSecondNoPlaySamePlace(),this.onImpressionPosition>this.onOneSecondPosition&&this.oppsService.onOneSecondNoPlayScrolledDown(),this.onImpressionPosition<this.onOneSecondPosition&&this.oppsService.onOneSecondNoPlayScrolledUp())}},{key:"clearOnAdImpressionTimer",value:function(){this.onAdImpressionTimer&&(clearTimeout(this.onAdImpressionTimer),this.onAdImpressionTimer=null)}},{key:"onViewabile100Change",value:function(){var e=this.getCurrModel();this.model.get("adState")===l.adState.paused||e.get("isViewable100")||(this.isLostView100=!0)}},{key:"_onNewCompletion",value:function(){this.onCompView100()}},{key:"handleAdjacencyAd",value:function(){this.model.get("hasScAdjacency")&&(this.getAdProperties=B.extend(this.getAdProperties,{excAdProperties:{adjacencyAd:[!0]}}))}},{key:"onDisplayingFullNAS",value:function(){this.firedDisplayingFullNAS||(this.firedDisplayingFullNAS=!0,this.oppsService.onDisplayingFullNAS())}},{key:"onDisplayingNASTitleOnly",value:function(){this.firedDisplayingNASTitleOnly||(this.firedDisplayingNASTitleOnly=!0,this.oppsService.onDisplayingNASTitleOnly())}},{key:"fireAdOppOnce",value:function(e){this["".concat(e,"Fired")]||(this["".concat(e,"Fired")]=!0,this.oppsService.fireGenericOpp(e))}},{key:"_stopRV1Observer",value:function(){this.AmpViewabilityHelper&&(this.AmpViewabilityHelper.stopObserver(this.targetElement),this.AmpViewabilityHelper=null)}},{key:"_checkIfStartRV1Observer",value:function(){this.model.get("frameType")===p.FRAME_TYPE.amp&&this.model.get("isUseAmpObserver")&&(this.AmpViewabilityHelper=new D.a({model:this.model,subModel:this.subModel}),this.targetElement=this.vpaidWrapper.adTarget?this.vpaidWrapper.adTarget:this.vpaidWrapper.localTarget,this.targetElement&&(this.log.info("Winning ad vpaidWrapper: ",this.targetElement),this.AmpViewabilityHelper.startObserver(this.targetElement)))}},{key:"onHipAdjacAdWithoutReplay",value:function(){this.oppsService.onHipAdjacAdWithoutReplay()}}])&&N(t.prototype,i),s}(s.a),U=i(12);function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e,t){return!t||"object"!==H(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=i(5),Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=q(e);if(t){var o=q(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $(this,i)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).model=e,t.log=new a.a({unitType:t.model.get("unitType"),className:"seerService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.activePredict={},t._createPlayerReadyPredict(),t._createRequestedPredictors(),t}return t=o,(i=[{key:"multiAd",value:function(){this.activePredict.multiAd||(this.activePredict.multiAd=[]);var e=this.model.get("predictors.multiAd.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"qState",predictArr:this.activePredict.multiAd,predict:U.p})}},{key:"emptyQueue",value:function(){this.activePredict.emptyQueue=this._createPredict(U.g,this.getAdProperties("emptyQueue"))}},{key:"getAdFail",value:function(){this.activePredict.getAdFailPredict=this._createPredict(U.l,this.getAdProperties("getAdFail"))}},{key:"repeat",value:function(){this.activePredict.repeatPredict=this._createPredict(U.r,this.getAdProperties("repeat"))}},{key:"loading",value:function(){this.activePredict.loadingPredict=this._createPredict(U.n,this.getAdProperties("loading"))}},{key:"autoKill",value:function(){this.activePredict.autoKillPredict=this._createPredict(U.c,this.getAdProperties("autoKill"))}},{key:"fullEligibility",value:function(){this.activePredict.fullEligibilityPredict=this._createPredict(U.k,this.getAdProperties("fullEligibility"))}},{key:"bForce",value:function(){this.activePredict.bForcePredict=this._createPredict(U.d,this.getAdProperties("bForce"))}},{key:"distancePercent",value:function(){this.activePredict.distancePercent||(this.activePredict.distancePercent=[]);var e=this.model.get("predictors.distancePercent.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"requirePercentageToSelector",predictArr:this.activePredict.distancePercent,predict:U.e})}},{key:"distancePixels",value:function(){this.activePredict.distancePixels||(this.activePredict.distancePixels=[]);var e=this.model.get("predictors.distancePixels.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"pixelsFromSelectors",predictArr:this.activePredict.distancePixels,predict:U.f})}},{key:"firstScroll",value:function(){this.activePredict.firstScrollPredict=this._createPredict(U.j,this.getAdProperties("firstScroll"))}},{key:"feedX",value:function(){this.activePredict.feedXPredict=this._createPredict(U.i,this.getAdProperties("feedX"))}},{key:"feedContainerChanged",value:function(){this.activePredict.feedContainerChanged=this._createPredict(U.h,this.getAdProperties("feedContainerChanged"))}},{key:"time",value:function(){this.activePredict.time||(this.activePredict.time=[]);var e=this.model.get("predictors.time.predictPoints");"number"==typeof e||Array.isArray(e)?this._createPredict(U.s,{}):this._createMultiPointPredict({predictPoints:e,predictArr:this.activePredict.time,predict:U.s})}},{key:"transition",value:function(){this.activePredict.transition||(this.activePredict.transition=[]);var e=this.model.get("predictors.transition.predictPoints");this._createMultiPointPredict({predictPoints:e,predictArr:this.activePredict.transition,predict:U.t})}},{key:"intersection",value:function(){this.activePredict.intersectionPredict||(this.activePredict.intersectionPredict=[]);var e=this.model.get("predictors.intersection.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"intersectionPercent",predictArr:this.activePredict.intersectionPredict,predict:U.m})}},{key:"adProgressionAfterBegin",value:function(){this.activePredict.adProgressionAfterBeginPredict||(this.activePredict.adProgressionAfterBeginPredict=[]);var e=this.model.get("predictors.adProgressionAfterBegin.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"secondsAfterBegin",predictArr:this.activePredict.adProgressionAfterBeginPredict,predict:U.a})}},{key:"adProgressionBeforeEnd",value:function(){this.activePredict.adProgressionBeforeEndPredict||(this.activePredict.adProgressionBeforeEndPredict=[]);var e=this.model.get("predictors.adProgressionBeforeEnd.predictPoints");this._createMultiPointPredict({predictPoints:e,pointKey:"secondsBeforeEnd",predictArr:this.activePredict.adProgressionBeforeEndPredict,predict:U.b})}},{key:"mp4",value:function(){this.activePredict.mp4Predict=this._createPredict(U.o,this.getAdProperties("mp4"))}},{key:"_createPlayerReadyPredict",value:function(){this.model.get("predictors.playerReady")&&this.model.get("predictors.playerReady.isActive")&&(this.activePredict.playerPredict=this._createPredict(U.q,this.getAdProperties("playerReady")))}},{key:"onPredict",value:function(e,t,i){this.model.get("stopPredicts")||(this.model.set("nextPredictName",t),this.model.set("nextPredict",e),this.model.set("nextAdProperties",i),this.model.increaseCounter("predictCounter"))}},{key:"startWF",value:function(){this.model.set("startWF",!0)}},{key:"_createRequestedPredictors",value:function(){if(this.model.get("playerState")===l.readyState){var e=this,t=this.model.get("predictors");Object.keys(t).forEach(function(i){var n=t[i];n&&e[i]&&(n.isActive||n.isStartWF)&&!e.activePredict[i]&&(this.log.info("Predict activePredict",i),e[i].call(e))}.bind(this))}else this.model.listenToOnce(this.model,"change:playerState",this._createRequestedPredictors.bind(this))}},{key:"_createMultiPointPredict",value:function(e){var t=this,i=e.predictPoints,n=e.pointKey,o=e.predictArr,r=e.predict;G.each(i,(function(e,i){o.push(t._createPredict(r,{predictPoint:e[n],predictKey:void 0!==e.key?e.key:i,adProperties:{adProperties:e.adProperties,excAdProperties:e.excAdProperties}}))}))}},{key:"_createPredict",value:function(e,t){return G.extend(t,{model:this.model,onPredict:this.onPredict,startWfFunc:this.startWF}),new e(t)}},{key:"getAdProperties",value:function(e){return{adProperties:{adProperties:this.model.get("predictors.".concat(e,".adProperties")),excAdProperties:this.model.get("predictors.".concat(e,".excAdProperties"))}}}}])&&W(t.prototype,i),o}(s.a),Q=(i(17),i(31));function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?ee(e):t}function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ie=i(5),ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(s,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=te(e);if(t){var o=te(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return J(this,i)}}(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).model=e,t.log=new a.a({unitType:t.model.get("unitType"),className:"pixelsService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.hadEligibility=!1,t.hadImpression=!1,t.playerHadRvInQ=!1,t.shouldFirePauseAfterPlay=!1,t.adsList={},t._bindEvents(),t.model.set("hadEligibility",!1),t.model.get("detachToSlider.isStartFromSlider")&&t._firePixel(t.model.getPixel("pixels.sliderFeedStartWithABT"),"slider to feed start with abTest"),t._fireCMPpixel(),r.a.once("window:resize:change",t._onWindowResize.bind(ee(t))),r.a.once("window:orientation:change",t._onDeviceOrientationChange.bind(ee(t))),t}return t=s,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adQState:impression",funcName:"_onAdImpression"},{event:"adState:playing",funcName:"_onAdPlaying"},{event:"adState:completed",funcName:"_onAdCompleted"},{event:"loadingViewState:clicked",funcName:"_onRepeatClicked"},{event:"isEligibleToPlay",funcName:"_onEligibilityChange"},{event:"eligibilityValidation.isValid",funcName:"_onEligibilityValidationChange"},{event:"videoViewState:attached",funcName:"_fireAttachPixel",isListenOnce:!0},{event:"videoViewState:detached",funcName:"_fireDetachPixel",isListenOnce:!0},{event:"closeTimer",funcName:"_fireTimerPixel"},{event:"getAdState:gettingAd",funcName:"_fireGetAdPixel"},{event:"TRCResetCloseUnit:true",funcName:"_onTRCResetCloseUnit"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"},{event:"isSkippedDistancePredict:true",funcName:"_onSkipDistancePredict"},{event:"publisherVideoDetected:true",funcName:"_onPublisherVideoDetected"},{event:"rvHandlerTimerExpired:true",funcName:"_onRvHandlerTimerExpired"},{event:"playerHasRvInQ:true",funcName:"_onPlayerHasRvInQ"},{event:"fullEligibilityPredicted:true",funcName:"_onFullEligibilityPredicted"},{event:"publisherIframeVideoDetected:true",funcName:"_onPublisherIframeVideoDetected",isListenOnce:!0},{event:"compDetected",funcName:"_onCompetitionDetected"},{event:"progressLoaderInit:true",funcName:"_onProgressLoaderInit"},{event:"progressLoaderTimerReached:true",funcName:"_onProgressLoaderMove"},{event:"progressLoaderViewClosed:true",funcName:"_onProgressLoaderClose"},{event:"feedxToggle",funcName:"_onFeedxToggle"},{event:"isOrganicCardInjected:true",funcName:"_onOrganicCardInjected"},{event:"organicInjectorFail:true",funcName:"_onOrganicCardInjectionFail"},{event:"isTerminateOnResize:true",funcName:"_onTerminateOnResize"},{event:"generalError",funcName:"_onGeneralError"},{event:"exploreMore",funcName:"_onExploreMore"},{event:"foundUnitDimensions:true",funcName:"_onUnitDimensionsFound"},{event:"videoResetCloseUnit:true",funcName:"_onVideoResetCloseUnit"},{event:"hadForcedDetach:true",funcName:"_onForcedDetach"},{event:"misplacedVideoDetected:true",funcName:"_onMisplacedVideoDetected"},{event:"overlayDetected",funcName:"_onOverlayDetected"},{event:"noAdjacInFirstWFs:true",funcName:"_onNonAdjacInFirstWFs"}]),r.a.once("global:passback",this._onPassbackFunctionCalled.bind(this)),this.model.get("autoplaySoundOn")?this._onAutoplayVolumeStatus():this.createStateHandlers([{event:"autoplaySoundOn:true",funcName:"_onAutoplayVolumeStatus",isListenOnce:!0}])}},{key:"_onWindowResize",value:function(){this._firePixel(this.model.getPixel("pixels.windowResize"),"window.resize event triggered")}},{key:"_onDeviceOrientationChange",value:function(){this._firePixel(this.model.getPixel("pixels.deviceOrientationChange"),"Device orientation changed")}},{key:"_onAdImpression",value:function(){this._firePixel(this.model.getPixel("pixels.addImpresion"),"addImpresion (the player got an ad)")}},{key:"_onAdPlaying",value:function(){var e=this.model.get("activeAdData");this.adsList[e.adId]&&this.adsList[e.adId].hadPlay||(this.adsList[e.adId]=e,this.adsList[e.adId].hadPlay=!0,this._firePixel(this.model.getPixel("pixels.conversion"),"conversion (the ad is playing)"))}},{key:"_onAdCompleted",value:function(){this.isViewed=!1,this.activeTag=void 0}},{key:"_onOverlayDetected",value:function(e){e.get("adState")===l.adState.playing?this._onOverlayAfterImpression(e):this._onOverlayBeforeImpression(e)}},{key:"_onOverlayBeforeImpression",value:function(e){if(!this.firedOverlayBeforeImpressionPixel){this.firedOverlayBeforeImpressionPixel=!0;var t=this.model.get("overlay")||{};this._firePixel(this.model.getPixel("pixels.overlayDetected"),"Overlay detected",{debug:"".concat(t.overlayData,";ap:").concat(t.actualEligiblePercent)})}}},{key:"_onOverlayAfterImpression",value:function(e){if(!this.firedOverlayAfterImpressionPixel){var t=this.model.get("pixels.overlayDetectedAfterImpression");if(t.isFire&&ie.rollNumbers(t.factor||0)){this.firedOverlayAfterImpressionPixel=!0;var i=this.model.get("overlay")||{};this._firePixel(this.model.getPixel("pixels.overlayDetectedAfterImpression"),"Overlay detected after impression",{debug:"".concat(i.overlayData,";ap:").concat(i.actualEligiblePercent)})}}}},{key:"_onEligibilityChange",value:function(e,t,i){this.stopSendingEligibility||(t&&!this.hadEligibility?this._onEligibility():!t&&this.hadEligibility&&i&&!i.isValidation&&(this._firePixel(this.model.getPixel("pixels.lostEligibility"),"Lost first eligible"),this.model.set("lostEligibilityTime",(new Date).getTime()),this.stopSendingEligibility=!0))}},{key:"_onEligibilityValidationChange",value:function(e,t){t?this.hadValidatedEligibility||(this.hadValidatedEligibility=!0,this._firePixel(this.model.getPixel("pixels.validEligibility"),"First validated eligible")):this._onEligibilityChange(e,!0,{isValidation:!0})}},{key:"_onEligibility",value:function(){this.model.set("hadEligibility",!0),this.hadEligibility=!0,this._firePixel(this.model.getPixel("pixels.eligible"),"First eligible")}},{key:"_onRepeatClicked",value:function(){this._firePixel(this.model.getPixel("pixels.repeatClick"),"repeat click Pixel")}},{key:"_onRenderWasCalled",value:function(){this._firePixel(this.model.getPixel("pixels.renderOnDemand"),"Render Was Called")}},{key:"_onPublisherVideoDetected",value:function(){this._firePixel(this.model.getPixel("pixels.publisherVideoDetected"),"Publisher Video Tag was Detected")}},{key:"_onPublisherIframeVideoDetected",value:function(){this._firePixel(this.model.getPixel("pixels.publisherIframeVideoDetected"),"Publisher Video Tag was Detected in iframe")}},{key:"_fireCMPpixel",value:function(){this.model.get("hasCMPonPage")?this._firePixel(this.model.getPixel("pixels.hasCMPonPage"),"GDPR - Has CMP on page"):this._firePixel(this.model.getPixel("pixels.noCMPonPage"),"GDPR - No CMP on page")}},{key:"_onForcedDetach",value:function(){this._firePixel(this.model.getPixel("pixels.forcedDetach"),"forced detach to slider")}},{key:"_onRecoReelNotFound",value:function(){this.recoReelNotFoundFired||(this.recoReelNotFoundFired=!0,this._firePixel(this.model.getPixel("pixels.recoReelNotFound"),"RecoReel Not Found Pixel"))}},{key:"_firePixel",value:function(e,t,i){e&&(e=this._setAdditionalData(e,i),this.log.pixel("firing pixel: "+t+" url: "+e),document.createElement("IMG").src=e)}},{key:"_setAdditionalData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.get("modifiedPlacement")&&(t.mp=this.model.get("modifiedPlacement")),this.model.get("subUnitType")&&(t.su=this.model.get("subUnitType")),this._addParametersToUrl(e,t,-1===e.indexOf("?"))}},{key:"_addParametersToUrl",value:function(e,t,i){var o=e;return o+=i?"?":"&",n.a.each(t,(function(e,t){void 0!==t&&""!==t&&(o+=e+"="+t+"&")})),o}},{key:"_fireAttachPixel",value:function(){this._firePixel(this.model.getPixel("pixels.attach"),"first attach")}},{key:"_fireDetachPixel",value:function(){this._firePixel(this.model.getPixel("pixels.detach"),"first detach")}},{key:"_fireTimerPixel",value:function(e,t){this.model.get("pixels.".concat(t,"Timer.isFire"))&&this._firePixel(this.model.getPixel("pixels.".concat(t,"Timer")),"".concat(t," timer"))}},{key:"_fireGetAdPixel",value:function(){var e={};this._setDebugReportData(e),"any"===this.model.get("lastGetAdKey")&&this.model.get("pixels.getAdAny.isFire")?this._firePixel(this.model.getPixel("pixels.getAdAny"),"getAd",e):0===this.model.get("lastGetAdKey")&&this.model.get("pixels.getAdNoRV.isFire")?this._firePixel(this.model.getPixel("pixels.getAdNoRV"),"getAd",e):1===this.model.get("lastGetAdKey")&&this.model.get("pixels.getAd.isFire")&&this._firePixel(this.model.getPixel("pixels.getAd"),"getAd",e)}},{key:"_onTRCResetCloseUnit",value:function(){this._firePixel(this.model.getPixel("pixels.TRCResetCloseUnit"),"TRCResetCloseUnit")}},{key:"_onVideoResetCloseUnit",value:function(){this._firePixel(this.model.getPixel("pixels.onVideoResetCloseUnit"),"VideoResetCloseUnit")}},{key:"_onParentSelectorLost",value:function(){this._firePixel(this.model.getPixel("pixels.onParentSelectorLost"),"onParentSelectorLost")}},{key:"_onRvHandlerTimerExpired",value:function(){this._firePixel(this.model.getPixel("pixels.rvHandlerTimerExpired"),"rvHandlerTimerExpired")}},{key:"_onPlayerHasRvInQ",value:function(){this.playerHadRvInQ||(this._firePixel(this.model.getPixel("pixels.onPlayerHasRVinQ"),"onPlayerHasRVinQ"),this.playerHadRvInQ=!0)}},{key:"_setDebugReportData",value:function(e){if(this.model.get("isSendDebugDataReporting")){var t=f.a.PREDICT_NAMES[this.model.get("nextPredictName")],i="pn:".concat(t,"!sqg:").concat(this.model.get("adId"),"!");for(var n in f.a.DEBUG_DATA_PIXELS){var o=this[n]();i+=void 0===o?"".concat(f.a.DEBUG_DATA[n],":!"):"".concat(f.a.DEBUG_DATA[n],":").concat(o,"!")}e.debug=i,this.model.get("isSendDebugDataReportingLog")&&this.log.info("DBG-Pixel getAd-".concat(this.model.get("lastGetAdKey")," - ").concat(i))}}},{key:"_onSkipDistancePredict",value:function(){this._firePixel(this.model.getPixel("pixels.skippedDistancePredict"),"onSkipDistancePredict")}},{key:"_onFullEligibilityPredicted",value:function(){this.model.get("pixels.fullEligibilityPredict.isFire")&&this._firePixel(this.model.getPixel("pixels.fullEligibilityPredict"),"fullEligibilityPredict")}},{key:"_onCompetitionDetected",value:function(){this._firePixel(this.model.getPixel("pixels.compDetectedOnPage"),"compDetectedOnPage")}},{key:"_onMisplacedVideoDetected",value:function(){var e={debug:"!url:"+(window&&window.location&&window.location.href?window.location.href:"")};this._firePixel(this.model.getPixel("pixels.misplacedVideoDetected"),"misplacedVideoDetected",e)}},{key:"ft",value:function(){return this.model.get("frameType")}},{key:"fsc",value:function(){var e=this.model.get("startCard");if(void 0!==e&&""!==e)return parseInt(e)}},{key:"fpc",value:function(){var e=this.model.get("permanentCard");if(void 0!==e&&""!==e)return parseInt(e)}},{key:"_onFeedxToggle",value:function(){this._firePixel(this.model.getPixel("pixels.feedxToggle"),"feedxToggled")}},{key:"_onExploreMore",value:function(){this._firePixel(this.model.getPixel("pixels.exploreMore"),"exploreMore")}},{key:"_onProgressLoaderInit",value:function(){this._firePixel(this.model.getPixel("pixels.progressLoaderInit"),"progressLoaderInit")}},{key:"_onProgressLoaderClose",value:function(){this._firePixel(this.model.getPixel("pixels.progressLoaderClose"),"progressLoaderClose")}},{key:"_onProgressLoaderMove",value:function(){this._firePixel(this.model.getPixel("pixels.progressLoaderMove"),"progressLoaderMove")}},{key:"_onOrganicCardInjected",value:function(){this._firePixel(this.model.getPixel("pixels.organicCardInjected"),"organicCardInjected")}},{key:"_onOrganicCardInjectionFail",value:function(){this._firePixel(this.model.getPixel("pixels.organicCardInjectionFail"),"organicCardInjectionFail")}},{key:"_onTerminateOnResize",value:function(){this._firePixel(this.model.getPixel("pixels.terminateOnResize"),"closeDueResize")}},{key:"_onUnitDimensionsFound",value:function(){this._firePixel(this.model.getPixel("pixels.onUnitDimensionsFound"),"UnitDimensionsFound")}},{key:"_onAutoplayVolumeStatus",value:function(){this.isSentAutoplayVolume||(this._firePixel(this.model.getPixel("pixels.autoplaySoundOn"),"autoplaySoundOn"),this.isSentAutoplayVolume=!0)}},{key:"_onGeneralError",value:function(){var e={debug:"ge:"+this.model.get("generalErrorData")};this._firePixel(this.model.getPixel("pixels.generalError"),"generalErrorData",e)}},{key:"_onPassbackFunctionCalled",value:function(){(ie.isFunction(this.model.get("onPassback"))||this.model.get("isApiPassbackExist"))&&this._firePixel(this.model.getPixel("pixels.passbackFunctionCalled"),"passback function called")}},{key:"_onNonAdjacInFirstWFs",value:function(){this._firePixel(this.model.getPixel("pixels.noAdjacInFirstWFs"),"noAdjacInFirstWFs")}}])&&X(t.prototype,i),s}(s.a),oe=i(11),re=i.n(oe),se=i(32);function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t){return!t||"object"!==ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var he=i(5),pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(s,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ue(e);if(t){var o=ue(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return de(this,i)}}(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).model=e,t.log=new a.a({unitType:t.model.get("unitType"),className:"playerService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.isRestarted=!1,t}return t=s,(i=[{key:"_init",value:function(){this._bindEvents(),this.model.get("isPlayerLoaded")&&this._onPlayerLoaded()}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isPlayerLoaded",funcName:"_onPlayerLoaded"},{event:"getAdState:stopped",funcName:"_pausePlayer"},{event:"isInTab",funcName:"_onTabEvent"},{event:"startWF",funcName:"startWf"},{event:"canStartPlayer:true",funcName:"_onPlayerLoaded"}])}},{key:"_onPlayerLoaded",value:function(){if(this.model.get("isPlayerLoaded")&&this.model.get("canStartPlayer")&&!this.player&&this._validatePlayerSize()){if(this.isMuted="on"!==this.model.get("volume"),this.volume="off"!==this.model.get("volume")?40:0,this.contentIndex=0,this.playlist=this.model.get("player.playlist"),this.playlist&&he.isEmpty(this.playlist))return void this.model.listenToOnce(this.model,"change:player.playlist",this._onPlayerLoaded.bind(this));he.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoPlayerInit",f.a.TRC_PERFORMANCE_ACTIONS.START);var e=this.playlist[this.contentIndex];this.model.set("isInIdleMode",!this.model.get("isInTab")&&this.model.get("isCallIDLE"));var t=this._getAdTypesToDrop();this.data={abTest:this.model.get("abTest"),ad_controls:this.model.get("player.hasAdControls"),aspect_ratio:this.model.get("aspectRatio"),auc_dast:this.model.get("cmDast"),autostart:this.model.get("autoPlay"),base_url:this.model.get("urls.base"),bf_factor:this.model.get("player.bfFactor"),bug_feature:this.model.get("player.hasBFeature"),cfr:this.model.get("cfr"),cipid:this.model.get("cipid"),cirf:decodeURIComponent(this.model.get("referrer")),creativeId:this.model.get("creativeId"),controls:this.model.get("player.hasControls"),country:this.model.get("country"),debug:this.model.get("isDebug")?["*"]:[],default_ad_parameters:this.model.get("defaultAdParameters"),default_ad_timeout:this.model.get("adMaxPlaySeconds"),default_b2b:this.model.get("player.b2b"),fire99:this.model.get("player.isFire99"),ga_factor:this.model.get("gaFactor"),ga_frame_src:this.model.get("gaFrameSrc"),image:this.model.get("loaderImage"),interrupt_loading:this.model.get("interruptLoading"),ip:this.model.get("ip"),isViewable:this.model.get("isPlayerViewable"),keywords:this.model.get("adTitle"),min_vpaid_run_time:this.model.get("player.minVpaidRunTime"),no_debug_report:this.model.get("noDebugReport"),oid:this.model.get("originId"),opps_base_path:this.model.get("player.urls.oppsBasePath"),non_bllb_opps_base_path:this.model.get("player.urls.nonBllbOppsBasePath"),page_url:decodeURIComponent(this.model.get("referrer")),referrer:decodeURIComponent(this.model.get("referrer")),repeat:this.model.get("repeat"),ron_percent:this.model.get("ronPercent"),schedule_auto:this.model.get("timeBetweenAds"),tags:this.model.get("tags"),time_between_waterfall:this.model.get("secondsBW"),use_flash_bypass:this.model.get("player.isBypassFlash"),use_flash_player:this.model.get("player.isFlashPlayer"),version:this.model.get("adTitle"),vertical:this.model.get("vertical"),wf_base_path:this.model.get("player.urls.wfBasePath"),domain_wf_base_path:this.model.get("player.urls.domainWfBasePath"),wf_url:this.model.get("player.urls.wfRequest"),opps_url:this.model.get("player.urls.oppsRequest"),height:""+parseInt(this.model.get("height")),width:""+parseInt(this.model.get("width")),dplayerSettings:this.model.get("player.settings"),loadrsrc:!0,preset:this.model.get("preset"),isDFP:this.model.get("iframeData.inDFP"),can_opt_out:!1,description:e.title,domain:window.location.hostname,mute:this.isMuted,title:e.title,volume:this.volume,isIdleMode:this.model.get("isInIdleMode"),dlywf:this.model.get("dlywf"),target_id:this.getTarget(),schedule:this.model.getScheduleArr(),dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),isMobile:this.model.get("isMobile"),queue_size:this.model.get("player.settings.queueSize"),max_ready_vpaid:this.model.get("player.settings.maxReadyVpaid"),adto:this.model.get("player.settings.adto"),vakll:this.model.get("player.settings.vakll"),mintimwf:this.model.get("player.settings.mintimwf"),agressiveLevel:this.model.get("preset.level"),suppressContentZindex:this._getSuppressContentZindex(),vimpFireEvent:this.model.get("vimpFireEvent"),subUnitType:this.model.get("subUnitType"),vForce:this.model.get("vForce.isActive"),get_ad_timeout_seconds:this.model.get("vForce.getAdTimeoutSeconds"),wf_manual:this.model.get("wfManual"),wf_dynmc_ps:this.model.get("wfDynamicPause"),run_wf_when_empty:this.model.get("runWfWhenEmpty"),rndmt:this.model.get("rndmt"),unit_name:this.model.get("unitName"),unit_loader_version:this.model.get("version"),unit_main_version:this.model.get("unitVersion"),mprdct:this.model.get("player.settings.mprdct"),gdprApplies:this.model.get("gdprApplies"),cdb:this.model.get("consentDaisyBit"),oppsQS:this.model.get("oppsQS"),adTypesToDrop:t,red_id:this.model.get("redId"),files:[e],pixelsUrl:this.model.get("pixels.url"),numOfWfUntilDcSwitch:this.model.get("numOfWfUntilDcSwitch"),onPlayerClose:this._onPlayerClose.bind(this),onPlayerError:this._onPlayerError.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerStop:this._onPlayerStop.bind(this)},he.extend(this.data,this.extraData||{}),he.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoOvaMediaPlayerInit",f.a.TRC_PERFORMANCE_ACTIONS.START),this.player=new OvaMediaPlayer(this.data),he.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoOvaMediaPlayerInit",f.a.TRC_PERFORMANCE_ACTIONS.STOP),u.a.player=this.player,this.player.on("AdClickThru",this._onAdClickThru.bind(this)),this.player.on("emptyFirstWaterfall",this._triggerPassback.bind(this)),this._alignPlayer(),he.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoPlayerInit",f.a.TRC_PERFORMANCE_ACTIONS.STOP)}}},{key:"_validatePlayerSize",value:function(){var e=this.model.get("width"),t=this.model.get("height"),i=!0;return he.isWidthValid(e)?he.isHeightValid(t)||(this.model.set("height",he.getVideoHeight(e)),this.model.set("playerHeightLost",!0)):(i=!1,this.model.set("playerWidthLost",!0)),i}},{key:"_getSuppressContentZindex",value:function(){return this.model.get("suppressContentZindex")&&this.model.get("vForce.isActiv")||!1}},{key:"_onAdClickThru",value:function(){this.model.set("clickThruState",l.clickThruState.clicked)}},{key:"_onPlayerReady",value:function(){this.playerQueueSeeker=new se.a(this.model),this.playerQueueSeeker.registerIsPlayerHasRvInQ(this.isPlayerHasRvInQ.bind(this)),this.playerQueueSeeker.registerToPlayerQueueStatusChange({instance:this,type:void 0,typeValue:void 0,status:"adLoaded",cb:this.isFirstAdLoaded.bind(this),isListenOnce:!0}),this._onTabEvent(this.model,this.model.get("isInTab")),this.model.set("playerVersion",this.player.get("player_version")),this.model.set("playerRepeatCount",this.player.repeatCount),this.model.set("playerState",l.readyState),this.player.on("AdVolumeChange",this._onVolumeChange.bind(this)),this.player.on("AdPaused",this._onAdPaused.bind(this)),this.player.on("AdPlaying",this._onAdPlaying.bind(this)),this.player.on("UserInteractionPauseState",this._onPausedChanged.bind(this)),this.player.on("queueStatus",this.playerQueueSeeker.updateAdsList.bind(this.playerQueueSeeker)),this.player.on("queueStatus",this._onQueueStatusChange.bind(this)),this.player.setDebugData&&(this.debugData=new T({model:this.model,onDebugDataChange:this.player.setDebugData.bind(this.player)}),this.player.setDebugDataFunc&&this.player.setDebugDataFunc(this.debugData.getDebugData.bind(this.debugData))),this.isRestarted?(this.model.set("playerState",l.playerState.restarted),this.model.get("player.settings.dlywf")&&this.startWf()):this.model.set("playerState",l.readyState),this.model.get("isContainerRatioNotValidForTakeOver")&&this.dropAds(re.a.adjacency.name)}},{key:"_onQueueStatusChange",value:function(e){this.model.set("playerQueue",e.items)}},{key:"_onPausedChanged",value:function(e){this.model.set("generalPlayingUnitState",!e)}},{key:"_onAdPaused",value:function(){this.model.set("generalPlayingUnitState",!1)}},{key:"_onAdPlaying",value:function(){this.model.set("generalPlayingUnitState",!0)}},{key:"_onPlayerClose",value:function(){this._setGeneralPlayingUnitState(!1),this.model.set("playerState",l.playerState.closed)}},{key:"_setGeneralPlayingUnitState",value:function(e){this.model.set("generalPlayingUnitState",null),this.model.set("generalPlayingUnitState",e)}},{key:"_onPlayerStop",value:function(){this.model.set("playerState",l.playerState.stopped)}},{key:"_onPlayerError",value:function(){this.model.set("playerState",l.playerState.error)}},{key:"isPlayerHasRvInQ",value:function(){this.model.set("playerHasRvInQ",!0)}},{key:"isFirstAdLoaded",value:function(){this.model.set("isFirstAdLoaded",!0)}},{key:"close",value:function(){setTimeout(function(){this.player&&(this.player.closeCleanPlayer(),this.player=null,this.model.set("closeState",l.closeState.playerClosed),this.model.set("playerState",l.playerState.closed),this.log.info("player was closed"))}.bind(this),0)}},{key:"_pausePlayer",value:function(){this.close()}},{key:"_onLoadingClick",value:function(){this.isRestarted=!0,setTimeout(this._onPlayerLoaded.bind(this),0)}},{key:"_hasPlayer",value:function(){return this.player&&!this.player.playerIsClosed}},{key:"_onVolumeChange",value:function(e){this.isMuted=0===e.adVolume}},{key:"getTarget",value:function(){if(this.model.get("targetId"))return this.model.get("targetId").toString();var e=he.now().toString(),t=Object(n.a)("<div>");return t.attr("id",e),t.css({width:this.model.get("width")+"px",height:0,position:"absolute",top:0,left:0,display:"none"}),"FEED_MANAGER"!==this.model.get("unitType")&&t.css({}),t.appendTo("body"),this.playerDiv=t,e}},{key:"_onTabEvent",value:function(e,t){this.model.get("isCallIDLE")&&this.player&&this.player.startIdleMode&&this.player.stopIdleMode&&(t?(this.player.stopIdleMode(),this.model.set("isInIdleMode",!1),this.log.info("Stop idle mode")):(this.player.startIdleMode(),this.model.set("isInIdleMode",!0),this.log.info("Start idle mode")))}},{key:"startWf",value:function(){this._hasPlayer()&&this.player.startWf&&!this.model.get("isInIdleMode")?(this.log.info("Starting Waterfall"),this.player.startWf()):this.model.get("isInIdleMode")&&this.createStateHandlers([{event:"isInIdleMode:false",funcName:"startWf",isListenOnce:!0}])}},{key:"_alignPlayer",value:function(){if(this.playerDiv||this.targetElem){var e=this.playerDiv||this.targetElem.parent(),t=this.player.store.get("dataSaver"),i=this.player.store.get("forcecnvsmpg");(t||i)&&this.model.get("playerTextAlign")&&e.css({"text-align":"left"})}}},{key:"_getAdTypesToDrop",value:function(){var e=[];return this._canGetAdjacCard()||e.push(re.a.adjacency.name+"Ad"),e}},{key:"_triggerPassback",value:function(){var e=this.model.get("isApiPassbackExist");!this.model.get("isFirstAdLoaded")&&e&&(this.log.info("Waterfall returned Empty"),r.a.trigger("global:passback",{isApiPassbackExist:e}),this.model.set("closeState",l.closeState.terminate))}}])&&le(t.prototype,i),s}(s.a);function fe(e){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ge(e,t,i){return(ge="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=be(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(i):o.value}})(e,t,i||e)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e,t){return!t||"object"!==fe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _e=i(5),we=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=be(e);if(t){var o=be(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ve(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e)).targetElem=Object(n.a)("#"+t.model.get("targetId").toString()),t._waterfallRetries=Number(t.model.get("waterfallRetries")),isNaN(t._waterfallRetries)&&(t._waterfallRetries=0),t._init(),t}return t=r,(i=[{key:"_bindEvents",value:function(){ge(be(r.prototype),"_bindEvents",this).call(this),this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"resize"},{event:"videoViewSize",funcName:"resizeDetach"},{event:"videoViewState:detached",funcName:"_onDetach"},{event:"loadingViewState:clicked",funcName:"_onLoadingClick"},{event:"adState:playing",funcName:"_dropSingleAds",isListenOnce:!0},{event:["dropAds:adjacency","playerState:ready"],funcName:"_dropAdjcAds",isListenOnce:!0},{event:"dropAdjacDueHIP",funcName:"_dropAdjcAds",isListenOnce:!0}])}},{key:"resize",value:function(e,t,i){if(this.model.get("videoViewState")!==l.videoViewState.detached||i){var n=t||e;if(this.lastSize=this.lastSize||{},this.lastSize.width===n.width&&this.lastSize.height===n.height)return;this.player&&this.player.resize&&n&&n.width&&n.height&&(this.lastSize=_e.extend({},n),this.player.resize(n.width,n.height),this.log.info("player was resize",n))}}},{key:"_onDetach",value:function(){var e={width:this.model.get("width"),height:this.model.get("height")};this.resize(e,null,!0)}},{key:"resizeDetach",value:function(e,t){this.resize(e,t,!0)}},{key:"_dropAdjcAds",value:function(){this.dropAds(re.a.adjacency.name)}},{key:"_dropSingleAds",value:function(){this.dropAds(re.a.adjacency.name),this.dropAds(re.a.singleAd.name)}},{key:"dropAds",value:function(e){this.player&&this.player.dropAds&&(this.player.dropAds(re.a[e].playerType),this.log.info("dropping ".concat(e," ads from player Q")),this.model.appendArray("droppedAdTypes",e))}},{key:"_canGetAdjacCard",value:function(){return!this.model.get("isContainerRatioNotValidForTakeOver")}},{key:"_onAdError",value:function(){this.log.error("onAdError"),this._errorCount++,this._waterfallRetries&&!this._hasImpression&&this._errorCount>=this._waterfallRetries&&(this.log.info("number of errors reached the allowed waterfall retries - stopping the unit",this._waterfallRetries),this.model.set("closeState",l.closeState.terminate))}}])&&me(t.prototype,i),r}(pe);function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Ae(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e,t){return!t||"object"!==Te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5),i(5),i(5);var ke=i(5),Oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(s,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ce(e);if(t){var o=Ce(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ee(this,i)}}(s);function s(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(i=o.call(this,e)).model=e,i.globalModel=t,i.model.set("isEligibleToPlay",!1),i.model.get("isTestParentSelector")&&i._bindScroll(),i.model.get("isInAppBridgeOn")&&window.taboolaBridge&&i._observeInAppIntersectionChange(),i.oldRect={},i.viewabilityPercent=i.model.get("viewabilityPercent"),i.printCurrentViewPercent=i.model.get("printCurrentViewPercent"),i.isEligibilityValidatorActive=i.model.get("eligibilityValidator.isActive"),i.isEligibilityValidatorActive&&(i.validateEligibilityOnlyForRV=i.model.get("eligibilityValidator.isRvOnly"),i.eligibilityValidator=new Ft({model:i.model,globalModel:i.globalModel})),i}return t=s,(i=[{key:"_bindScroll",value:function(){this._testTopParentSelector(),r.a.on("window:scroll:change",this._testTopParentSelector.bind(this))}},{key:"_initObserver",value:function(){var e={rootMargin:"0px",threshold:[0,this.model.get("viewPercent")/100,this.model.get("viewabilityPercent")/100,this.model.get("100viewPercent")/100]};if(this.model.get("stickyCard.isActive")){var t,i=this.model.get("stickyCard.observerThreshold");i&&(t=e.threshold).push.apply(t,function(e){return function(e){if(Array.isArray(e))return Se(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Se(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Se(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i))}this.observer=new IntersectionObserver(this._observerCallback.bind(this),e),this.log.info("IntersectionObserver was created")}},{key:"bindEvent",value:function(){}},{key:"_getDimensions",value:function(e){var t=Object(n.a)(e);return{width:t.width()||this.model.get("width"),height:t.height()||this.model.get("height")}}},{key:"_calculateEligibility",value:function(){this.model.get("isUseObserver")||(this.inViewDiv=this._getInViewDiv()),this._testEligibility()}},{key:"_onTabEvent",value:function(e){}},{key:"_printCurrentViewPercent",value:function(e,t){this.printCurrentViewPercent&&this.log.info("".concat(e,": "),t||0)}},{key:"_getInViewDiv",value:function(){for(var e=0;e<this.placeHolders.length;e++){var t=this.placeHolders[e],i=this._getDimensions(t),n=ke.getViewPercent(t,i.width,ke.getVideoHeight(i.width),this.model.get("scrollSelector"));this._printCurrentViewPercent("currViewPercent",n);var o=this.model.get("viewPercent")||100;if(this._shouldValidateEligibility(n)&&(n=this.eligibilityValidator.getViewablePercentForNonFullyViewableUnits(t,n),this._printCurrentViewPercent("currViewPercent - validated",n),this._onEligibilityValidation(o,n)),this.model.set("isViewable",this.viewabilityPercent<=n),this.model.set("isViewable100",n>=this.model.get("100viewPercent")),this.model.get("stickyCard.isActive")){var r=n<this.model.get("stickyCard.attachPercent")&&this._canStickToTop(t);this.model.set("isEligibleToStick",r)}if(o<=n)return this.placeHolders[e]}}},{key:"_onEligibilityValidation",value:function(e,t){this.model.set("eligibilityValidation.isValid",e<=t)}},{key:"_observerCallback",value:function(e,t){this.inViewDiv=void 0;for(var i=!1,n=0;n<e.length;n++){var o=100*e[n].intersectionRatio;if(this._shouldValidateEligibility(o)&&(i=!0,o=this.eligibilityValidator.getViewablePercentForNonFullyViewableUnits(e[n].target,o)),this.model.set("isViewable100",o>=this.model.get("100viewPercent")),this.model.set("isViewable",this.viewabilityPercent<=o),this.model.get("stickyCard.isActive")){var s=o<this.model.get("stickyCard.attachPercent")&&e[n].boundingClientRect.top<=0;this.model.set("isEligibleToStick",s)}if(o>=this.model.get("viewPercent")){this.inViewDiv=e[n];break}}!this.inViewDiv&&i&&r.a.once("window:scroll:change",this._observerCallback.bind(this,e,t)),this._testEligibility()}},{key:"_testEligibility",value:function(){}},{key:"_testTopParentSelector",value:function(){var e=this._getTopParentSelector();this.topParentSelector||(this.topParentSelector=e),this.topParentSelector&&!e&&this.model.get("isCheckTopParentSelectorLost")&&(this.model.set("topParentSelectorLost",!0),this._stopObserver())}},{key:"_getTopParentSelector",value:function(){var e=this.model.get("parentSelector");return e=ke.isArray(e)?e[0]:e,e=Object(n.a)(e)[0],ke.getTopOfEl(e)}},{key:"_observeInAppIntersectionChange",value:function(){window.taboolaBridge.on("intersectionChanged",this._onIntersectionChanged.bind(this)),window.taboolaBridge.active=!0}},{key:"_onIntersectionChanged",value:function(e){var t=e.rects.boundingClientRect,i={width:function(){return t.width},height:function(){return Math.abs(t.top-window.taboolaBridge.data.rootBounds.height)},top:function(){var e=0;return t.top<0&&(e-=t.top),e}};this.model.set("scrollSelector",i),this._calculateEligibility()}},{key:"_canStickToTop",value:function(e){return!!e&&e.getBoundingClientRect().top<=0}},{key:"_shouldValidateEligibility",value:function(e){if(this.isEligibilityValidatorActive&&this.viewabilityPercent<=e){if(!this.validateEligibilityOnlyForRV)return!0;var t=this.model.get("activeAdData");return t?t.requiredViewability:this.model.get("playerHasRvInQ")}return!1}},{key:"_getFromModel",value:function(e){return(this.globalModel||this.model).get(e)}},{key:"_stopObserver",value:function(){this.observer&&this.observer.disconnect&&this.observer.disconnect()}},{key:"_setToModel",value:function(e,t){this.model.set(e,t),this.globalModel&&this.globalModel.set(e,t)}},{key:"onAttach",value:function(){this._checkSliderEligibilityOnScroll&&(r.a.off("window:scroll:change",this._checkSliderEligibilityOnScroll),this.isListenToSliderEligiilityChange=!1)}},{key:"checkSliderEligibility",value:function(){this.isListenToSliderEligiilityChange||(this.isListenToSliderEligiilityChange=!0,this._checkSliderEligibilityOnScroll=this.checkSliderEligibility.bind(this),r.a.on("window:scroll:change",this._checkSliderEligibilityOnScroll));var e=this.isSliderEligibleToPlay();return e?(this._removeSliderPlaceholder(),this._setToModel("isSliderEligibleToPlay",!0)):this._setToModel("isSliderEligibleToPlay",!1),e}},{key:"isSliderEligibleToPlay",value:function(){if(!this._shouldValidateEligibility(100))return!0;this.sliderPlaceholder||this._createSliderPlaceholder();var e=this.eligibilityValidator.getViewablePercentForNonFullyViewableUnits(this.sliderPlaceholder,100);return this.viewabilityPercent<=e}},{key:"_createSliderPlaceholder",value:function(){var e=this.model.get("detachToSlider");this.sliderPlaceholder=document.createElement("div"),this.sliderPlaceholder.style[e.position.horizontal]=e.position.horizontalOffset+"px",this.sliderPlaceholder.style[e.position.vertical]=e.position.verticalOffset+"px",this.sliderPlaceholder.style.width=e.width+"px",this.sliderPlaceholder.style.height=e.height+"px",this.sliderPlaceholder.style.position="fixed",this.sliderPlaceholder.style.zIndex=this._getPlaceholderZIndex(),document.body.appendChild(this.sliderPlaceholder)}},{key:"_removeSliderPlaceholder",value:function(){this.sliderPlaceholder&&this.sliderPlaceholder.parentElement&&(this.sliderPlaceholder.parentElement.removeChild(this.sliderPlaceholder),this.sliderPlaceholder=void 0)}},{key:"_getPlaceholderZIndex",value:function(){var e=this.model.get("videoViewContainer");Array.isArray(e)&&(e=e[0]);var t=e.querySelectorAll('[class*="VpaidWrapper"]')[0];return t?t.style.zIndex:0}}])&&Ae(t.prototype,i),s}(s.a);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ne=i(5),Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(s,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=xe(e);if(t){var o=xe(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return De(this,i)}}(s);function s(e,t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(i=o.call(this,e)).$parentElement=Object(n.a)(t),i.model.set("isInTab",!document.hidden),i.log=new a.a({unitType:"Service",className:i.constructor.name,version:i.model.get("version"),isDebug:i.model.get("isDebug")}),i.placeHolders=[],i.model.get("isUseObserver")&&i._initObserver(),i.bindEvent(),i._createPlaceHolders(),i._initEligibilityListener(),i}return t=s,(i=[{key:"bindEvent",value:function(){this.model.listenTo(r.a,"window:tab:change",this._onTabEvent.bind(this)),this.createStateHandlers([{event:"containerViewState:rendered",funcName:"_setPlaceHolderToVideoView"},{event:"getAdState:gotAd",funcName:"_testEligibility"},{event:"componentVisibility",funcName:"_calculateEligibility"}])}},{key:"_setPlaceHolderToVideoView",value:function(){this.model.get("isUseObserver")?(this.observer.disconnect(),this._clearTempDivs(),this.observer.observe(this.model.get("containerViewPlaceHolder"))):(this._clearTempDivs(),this.placeHolders=[this.model.get("containerViewPlaceHolder")],this._calculateEligibility())}},{key:"_clearTempDivs",value:function(){if(this.model.get("frameType")!==f.a.FRAME_TYPE.plainPage&&this.model.get("isDataTrackDivHasDim"))for(var e in this.placeHolders)Object(n.a)(this.placeHolders[e]).hide()}},{key:"_initEligibilityListener",value:function(){this.model.get("isUseObserver")?this._registerObserverListeners():(this._calculateEligibility(),r.a.on("window:scroll:change",this._calculateEligibility.bind(this)),this.model.listenTo(this.model,"change:aspectRatioNum",this._calculateEligibility.bind(this)))}},{key:"_createPlaceHolders",value:function(){for(var e=this.$parentElement.length>0?this.$parentElement:Object(n.a)(this.model.get("parentSelector").toString()),t=0;t<e.length;t++){var i=e[t];if(!i.querySelector("#_cm-css-reset")){var o=this._createTempDiv(i);i.appendChild(o),this.placeHolders.push(o)}}}},{key:"_createTempDiv",value:function(){var e=document.createElement("div");return e.classList.add("_cm-div"),e.id="_cm-css-reset",this.model.get("isDataTrackDivHasDim")&&this.model.get("frameType")!==f.a.FRAME_TYPE.plainPage&&Object(n.a)(e).css({height:"1px !important",width:"1px !important",visibility:"hidden !important",position:"absolute !important"}),e.setAttribute("data-tracked","true"),e}},{key:"_onTabEvent",value:function(e){e===f.a.TAB_STATE.tabOut?(this.model.set("isViewable",!1),this.model.set("isInTab",!1),this.model.get("isIgnoreTabInIframe")&&this.model.get("frameType")!==f.a.FRAME_TYPE.plainPage||this.model.set("isEligibleToPlay",!1)):(this._calculateEligibility(),this.model.set("isInTab",!0))}},{key:"_registerObserverListeners",value:function(){for(var e=0;e<this.placeHolders.length;e++)this.observer.observe(this.placeHolders[e])}},{key:"_testEligibility",value:function(){if(this.inViewDiv){this.model.set("isEligibleToPlay",!0),this.model.set("isViewable",!this.model.get("isIgnoreTabInIframe")||this.model.get("frameType")===f.a.FRAME_TYPE.plainPage||this.model.get("isInTab"));var e=this.model.get("getAdState");this.model.get("eligiblePlaceholder")||e!==l.getAdState.gotAd||this.model.set("eligiblePlaceholder",this.inViewDiv),this.model.get("hadEligibility")||this.model.set("hadEligibility",!0)}else this.model.set("isEligibleToPlay",!1)}},{key:"_getInViewDiv",value:function(){for(var e=0;e<this.placeHolders.length;e++){var t=this.placeHolders[e],i=this._getDimensions(t),n=i.height||Ne.getVideoHeightByRatio(i.width,this.model.get("aspectRatioNum")),o=Ne.getViewPercent(t,i.width,n,this.model.get("scrollSelector"));this._printCurrentViewPercent("currViewPercent",o);var r=this.model.get("viewPercent")||100;if(this._shouldValidateEligibility(o)&&(o=this.eligibilityValidator.getViewablePercentForNonFullyViewableUnits(t,o),this._printCurrentViewPercent("currViewPercent - validated",o),this._onEligibilityValidation(r,o)),this.model.set("isViewable",this.model.get("viewabilityPercent")<=o),this.model.set("isViewable100",o>=this.model.get("100viewPercent")),this.model.set("isEligibleToStick",o<100),r<=o)return this.placeHolders[e]}}}])&&Re(t.prototype,i),s}(Oe);function Le(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i(5),i(5),i(5),s.a,i(5);var Fe=i(5),Be=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.log=new a.a({unitType:this.model.get("unitType"),className:"playerLoaderService",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this._createLoaders(),this._loadPlayer()}var t,i;return t=e,(i=[{key:"_createLoaders",value:function(){var e=this;this.loaders={SR:function(e){},AV:function(e){},DP:function(t){var i=e.model.get("player.urls.playerLocation");e.dependencies=[i+"/OvaMediaPlayer.js"],window.OvaMediaPlayer?t():Fe.loadJsArr(e.dependencies,t.bind(e))}}}},{key:"_loadPlayer",value:function(){var e=this.loaders[this.model.get("mobilePlayer")];this.model.get("isMobile")&&e?e(this._onPlayerLoaded.bind(this)):this.loaders.DP(this._onPlayerLoaded.bind(this))}},{key:"_onPlayerLoaded",value:function(){this.model.set("isPlayerLoaded",!0)}}])&&Le(t.prototype,i),e}();function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function We(e,t){return!t||"object"!==je(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $e=i(5),qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ze(e);if(t){var o=ze(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return We(this,i)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e.model)).model=e.model,t.log=new a.a({unitType:t.model.get("unitType"),className:"PlayPriorityHandler",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.isRvPriority=t.model.get("isRvPriority")&&t._isAllowedInFT(),t.isHadFirstSetAd=!1,t.detachToSlider=t.model.get("detachToSlider"),t.isStickyCardActive=t.model.get("stickyCard.isActive"),t.isDetachActive=t.detachToSlider&&(t.detachToSlider.isStartFromSlider||t.detachToSlider.isDetachToSlider),t.isForceDetachOnGotAd=(t.isDetachActive||t.isStickyCardActive)&&t.model.get("detachToSlider.forceDetach.isActive"),t._bindEvents(),t}return t=o,(i=[{key:"_isAllowedInFT",value:function(){return!!this.model.get("playPriority.isAllowInIframes")||this.model.get("frameType")===p.FRAME_TYPE.plainPage}},{key:"_bindEvents",value:function(){}},{key:"setNextAd",value:function(e){this.lastAd=e,this._isForceAdToDetach(e)?this._setReadyAd(e):this.isRvPriority&&!this.isHadFirstSetAd?this._handleRvPriority(e):this._setReadyAd(e)}},{key:"_isForceAdToDetach",value:function(e){if(!this.isForceDetachOnGotAd||this.model.get("hadStickyDetach"))return!1;var t=this.model.get("detachToSlider.forceDetach.restrictions.rv"),i="any"===t||t===e.adData.requiredViewability;return this.log.info("force ad detach:",{isForced:i,activeAdRV:e.adData.requiredViewability}),i}},{key:"_setReadyAd",value:function(e){e.onAdSetToUnits(),this.lastSetAdId=e.adId;var t=e.adData.requiredViewability;this.model.setNextAd(e),setTimeout(function(){this.model.set("isNextAdRV",t),this.model.set("hasReadyAd",!0)}.bind(this),0)}},{key:"_handleRvPriority",value:function(e){var t=!1;if(e.adData.requiredViewability)t=!0;else{var i=this._isAtDecisionPoint();t=this._shouldSetReadyAd(i)}t&&(this._setReadyAd(e),e._bringToFront(),this.isHadFirstSetAd=!0)}},{key:"_shouldSetReadyAd",value:function(e){return!!e&&(this.model.get("playPriority.isAlwaysWaitForRv")?!this.model.get("playerHasRvInQ"):!this.model.get("playerHasRvInQ")||this.model.get("isSkippedDistancePredict")||this._isLoaderInRequiredPercentage())}},{key:"_isAtDecisionPoint",value:function(){if(!this.model.get("playPriority.checkForRvPriority"))return!1;var e=this.model.get("playPriority.checkForRvPriority");return this[p.CHECK_FOR_RV_PRIORITY[e]].bind(this)()}},{key:"_reCheckAd",value:function(e){this.isHadFirstSetAd||(this.hasListener=!1,this.setNextAd(this.lastAd))}},{key:"hasReachedEligibility",value:function(){return!(!this.model.get("isEligibleToPlay")&&!this.model.get("hadEligibility"))||(this.hasListener?void 0:(this._waitForEligibility(),this.hasListener=!0,!1))}},{key:"_waitForEligibility",value:function(){this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_reCheckAd",isListenOnce:!0}])}},{key:"hasReachedPixelsFromSelector",value:function(){if(void 0===this.model.get("playPriority.pixelsFromSelector"))return!1;var e=$e.hasPassedPixelFromSelector(this.model.get("parentSelector"),this.model.get("scrollSelector"),this.model.get("playPriority.pixelsFromSelector"),this.model.get("isNeedValidateParentSelector"));return e||this.hasListener||(this.hasListener=!0,r.a.once("window:scroll:change",this._reCheckAd.bind(this))),e}},{key:"intersectionPercent",value:function(){if(void 0===this.model.get("playPriority.intersectionPercent"))return!1}},{key:"_activeSecondsToGetRVTime",value:function(){}},{key:"_secondsAfterGetAdRv",value:function(){}},{key:"beforeLoaderEnd",value:function(){return!!this._isLoaderInRequiredPercentage()||(this.createStateHandlers([{event:"loaderCurrCount",funcName:"_reCheckAd",isListenOnce:!0}]),!1)}},{key:"_isLoaderInRequiredPercentage",value:function(){return this.model.get("loaderCurrCount")>=this.model.get("playPriority.loaderPercent")}}])&&Ue(t.prototype,i),o}(s.a);function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ye(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ke(e,t){return!t||"object"!==Ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xe(e){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ze=i(5),Je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Xe(e);if(t){var o=Xe(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ke(this,i)}}(o);function o(e,t,i){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(r=n.call(this,e)).model=e,r.kibana=t,r.eligibilityService=i,r.log=new a.a({unitType:r.model.get("unitType"),className:"adsManager",version:r.model.get("version"),isDebug:r.model.get("isDebug")}),r.model.set("adState",c.a.readyState),r.model.set("getAdState",c.a.getAdState.notCalled),r.model.set("adManagerState",c.a.adManagerState.empty,{silent:!0}),r._createAdsList(),r.model.set("nextPredict",NaN),r.adId=0,r.currentAdIndex=-1,r.model.set("activeTag",!1),r.model.set("activeAd",!1),r.model.set("impressionCount",0),r.playPriorityHandler=new qe({model:r.model}),r._bindEvents(),u.a.supportTool=u.a.supportTool||{},u.a.supportTool.dp={},Ze.sendingEventToTaboolaBridge("sessionStart",r.model.get("unitName")),r}return t=o,(i=[{key:"_createAdsList",value:function(){for(var e in this.adsList={},f.a.RV_TYPES)this.adsList[f.a.RV_TYPES[e]]=[]}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"predictCounter",funcName:"adPredict"},{event:"getAdState:failed",funcName:"_onFailedToGetAd"},{event:"hasReadyAd:false",funcName:"_updateNextAd"},{event:"cancelRV:true",funcName:"_cancelAllRVCalls"},{event:"adState:playing",funcName:"_onFirstAdPlay",isListenOnce:!0},{event:"onadProgressionAfterBeginPredict",funcName:"_onadProgressionAfterBeginPredict"},{event:"onadProgressionBeforeEndPredictPredict",funcName:"_onadProgressionBeforeEndPredictPredict"},{event:"exploreMore",funcName:"_onExploreMore"}])}},{key:"adPredict",value:function(){var e=this;if(!(this._countReadyAdsByRV(!1,f.a.RV_TYPES.RV)>=this.model.get("maxVimpsInQueue")&&this._countReadyAdsByRV(!1,f.a.RV_TYPES.NON_RV)>=this.model.get("maxNonRvVimpsInQueue"))){var t=this.model.get("nextPredict");this.firstGetAdFired||(this.log.info("First Get Ad Fired"),this.model.set("firstGetAdFired",!0),this.firstGetAdFired=!0),this._checkIfAlreadyHas1InList(),Ze.isArray(t)?Ze.forEach(t,(function(t){(!e.alreadyHas1InList||e.alreadyHas1InList&&0===t)&&(e.createNewAd(t),e._checkIfAlreadyHas1InList())}),this):(!this.alreadyHas1InList||this.alreadyHas1InList&&0===t)&&this.createNewAd(t),"mp4Predict"===this.model.get("nextPredictName")?this.model.set("mp4Predict",!0):this.model.set("mp4Predict",!1)}}},{key:"createNewAd",value:function(e){var t=this.model.get("nextPredictName"),i=this.model.get("nextAdProperties");if(this.model.get("isAllowDuplicateKey")||!this.adsList[e].some((function(t,i,n){return(t.adQState===c.a.adQState.readyState||t.adQState===c.a.adQState.impression)&&t.getAdKey===e}))){this.model.set("adId",this.adId);var n=new j({model:this.model,ppKey:e,adId:this.adId,impressionCb:this.onAdImpression.bind(this),completeCb:this.onAdComplete.bind(this),kibana:this.kibana,predictName:t,getAdProperties:i});this.adsList[e].push(n),this.adId++}}},{key:"_checkIfAlreadyHas1InList",value:function(){var e=this;this.alreadyHas1InList=!1,Ze.forEach(this.adsList[f.a.RV_TYPES.RV],(function(t){if("multiAdPredict"!==e.model.get("nextPredictName"))return e.alreadyHas1InList=!0,!1}),this)}},{key:"onAdImpression",value:function(e){e.setActiveTag(),this._updateNextAd(),this.model.set("adManagerState",c.a.adManagerState.hasAds),this.model.get("hadReady")||this.model.get("isEligibilityNomination")||this.model.get("isRvPriority")||(this.eligibilityService?(this.eligibilityService._calculateEligibility(),this.model.get("isEligibleToPlay")?this._triggerReady():this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_triggerReady",isListenOnce:!0}])):this._triggerReady(),this.model.set("hadReady",!0));var t=e.getAdData();if("any"===e.getAdKey&&this._moveAdFromAnyQueue(e,t.requiredViewability),e.rv=t.requiredViewability,this.model.increaseCounter(t.requiredViewability?"adsList.rvAds":"adsList.nonRvAds"),!this.model.get("isEligibleToPlay")&&this.model.get("lostEligibilityTime")&&e.fireSkipVimp1EligibilityLost(t.requiredViewability),t.requiredViewability){var i=this.isPlayingAdNotRV();e.fireSkipVimp1Vimp0Playing(i)}}},{key:"_triggerReady",value:function(){r.a.trigger("ready")}},{key:"_moveAdFromAnyQueue",value:function(e,t){var i=this;Ze.each(this.adsList[f.a.RV_TYPES.ANY],(function(t,n){t.adId===e.adId&&i.adsList[f.a.RV_TYPES.ANY].splice(n,1)})),this.adsList[t?f.a.RV_TYPES.RV:f.a.RV_TYPES.NON_RV].push(e)}},{key:"isPlayingAdNotRV",value:function(){var e=!1;return Ze.size(this.adsList[f.a.RV_TYPES.NON_RV])>0&&Ze.forEach(this.adsList[f.a.RV_TYPES.NON_RV],(function(t){t.adState===c.a.adState.playing&&(e=!0)})),e}},{key:"onAdComplete",value:function(e,t){this._removeAd(e.adId,e.adData&&void 0!==e.adData.requiredViewability?e.adData.requiredViewability:e.getAdKey,!1),this.model.get("hasReadyAd")&&this.model.getStorage("nextAd").adId===e.adId&&this.model.set("hasReadyAd",!1),t&&!this.model.get("hasReadyAd")&&(this.model.set("lastAutoKilledPredict",e.getAdKey),this.model.set("adState",e.adState))}},{key:"close",value:function(){this.model.set("adManagerState",c.a.adManagerState.stopped),this.model.set("closeState",c.a.closeState.adManagerStop)}},{key:"pauseGetAds",value:function(){for(var e in this.model.set("adManagerState",c.a.adManagerState.paused),this.adsList)this.adsList[e]=[];this.model.set("hasReadyAd",!1)}},{key:"_cancelAllRVCalls",value:function(){Ze.forEach(this.adsList[f.a.RV_TYPES.RV],function(e){e.cancelGetAd(),this._removeAd(e.adId,f.a.RV_TYPES.RV,!0)}.bind(this)),this.model.set("cancelRV",!1)}},{key:"_removeAdsByKeyAndStatus",value:function(e,t){Ze.forEach(this.adsList[e],function(i){t.indexOf(i.getAdState)>-1&&(i.cancelGetAd(),this._removeAd(i.adId,e,!0))}.bind(this))}},{key:"_onFailedToGetAd",value:function(){var e,t=this.model.get("getAdCurrId");for(var i in this.adsList)e||(e=Ze.find(this.adsList[i],(function(e){return e.adId===t}),this));this.model.set("lastFailedPredictProperties",e.getAdProperties),this.model.set("lastFailedPredict",e.getAdKey),this._removeAd(t,e.adData&&void 0!==e.adData.requiredViewability?e.adData.requiredViewability:e.getAdKey,!0)}},{key:"_removeAd",value:function(e,t,i){var n=this,o=t?f.a.RV_TYPES.RV:f.a.RV_TYPES.NON_RV;Ze.size(this.adsList[o])>0&&(this.adsList[o]=this.adsList[o].filter((function(t){return t.adId===e&&n.model.decreaseCounter(t.rv?"adsList.rvAds":"adsList.nonRvAds"),t.adId!==e}))),0===this.countReadyAds(i)&&this.model.set("adManagerState",c.a.adManagerState.empty)}},{key:"_updateNextAd",value:function(){var e=this,t=[];for(var i in this.adsList)t=t.concat(this.adsList[i].filter((function(t){return t.adQState===c.a.adQState.impression&&!t.isUsed&&e._isAllowAd(t)})));var n=this._chooseBestAd(t),o=t[n];o&&(this.playPriorityHandler.setNextAd(o),o.getAdKey&&o.getAdKey===f.a.RV_TYPES.RV&&this._countReadyAdsByRV(!0,f.a.RV_TYPES.RV)>1&&o.oppsService.onAdPlayingNextAdReadyRV1());var r=o;if(this.model.get("hasReadyAd")){var s=this.model.get("playPriority.type");for(var i in this.adsList)Ze.each(this.adsList[i],function(e,t){n===t&&i==o.getAdKey||e.adQState===c.a.adQState.impression&&r&&r.getAdData&&("rpox"===s?e.reportRpoxSkip(r.getAdData()):"ppKey"===s&&e.reportPpKeySkip(r.getAdData()))}.bind(this))}}},{key:"_chooseBestAd",value:function(e){var t=this,i=0;if(1===Ze.size(e))return i;var n=this.model.get("playPriority.type")||"rpox";if("ppKey"===n)Ze.find(e,(function(e,n){e.getAdKey===t.model.get("playPriority.key")&&(i=n)}));else if("function"===n){var o=this.model.get("playPriority.func");i=o(e)}else"rpox"===n&&(i=this.priorityByRpox(e));return i}},{key:"priorityByRpox",value:function(e){var t=0,i=(this.model,0);return Ze.each(e,(function(e,n){e.rpox>=i&&(i=e.rpox,t=n)})),t}},{key:"_hasPlayingAd",value:function(){return!!this.model.get("activeTag")}},{key:"countReadyAds",value:function(e){var t=0;for(var i in this.adsList)t+=this._countReadyAdsByRV(e,i);return t}},{key:"_countReadyAdsByRV",value:function(e,t){var i=0;return Ze.forEach(this.adsList[t],(function(t){(e&&t.adQState!==c.a.adQState.readyState||t.adQState===c.a.adQState.impression)&&i++}),this),i}},{key:"_onFirstAdPlay",value:function(){this.model.set("hadPlayedAd",!0)}},{key:"_isAllowAd",value:function(e){return this._isAllowSingleAd(e)}},{key:"_isAllowSingleAd",value:function(e){var t=e.adTypeConfig&&e.adTypeConfig.singleAd&&e.adTypeConfig.singleAd.isPlacementSingleAd;return!(t&&this.model.get("hadPlayedAd")||this.model.get("isPreventNextAd")||t&&this._isAdTypeDropped(re.a.singleAd.name))}},{key:"_isAdTypeDropped",value:function(e){var t=this.model.get("droppedAdTypes");return!!Ze.isArray(t)&&0!==(t=t.filter((function(t){return e===t}))).length}},{key:"_onadProgressionAfterBeginPredict",value:function(){var e=this._getLastActiveAd();e[0]&&e[0].onadProgressionAfterBeginPredict()}},{key:"_onadProgressionBeforeEndPredictPredict",value:function(){var e=this._getLastActiveAd();e[0]&&e[0].onadProgressionBeforeEndPredictPredict()}},{key:"_getLastActiveAd",value:function(){var e=this;for(var t in this.adsList){var i=this.adsList[t].filter((function(t){return t.adId===e.model.get("lastActiveAd")}));if(i&&i[0])return i}return[]}},{key:"_onExploreMore",value:function(){this.model.get("exploreMoreConfig.clearAdsQ")&&this._removeAdsByKeyAndStatus(f.a.RV_TYPES.NON_RV,["gotAd","waiting","failed","stopped","finished"]);var e=this.model.get("exploreMoreConfig.maxNonRvVimpsInQueue");e&&this.model.set("maxNonRvVimpsInQueue",e)}}])&&Ye(t.prototype,i),o}(s.a);function et(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}!function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.log=new a.a({unitType:this.model.get("unitType"),className:"ObserverService",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.options=i,this.setObserver()}var t,i;t=e,(i=[{key:"observe",value:function(e){e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++)e[t].dataset.elViewPercent||this.observer.observe(e[t])}},{key:"unobserve",value:function(e){e=Array.isArray(e)?e:[e];for(var t=0;t<e.length;t++)this.observer.unobserve(e[t])}},{key:"setObserver",value:function(){this.setDefaults(),this.observer=new IntersectionObserver(this.observerCallback.bind(this),this.options);var e=this.options.targetEl;this.observe(e)}},{key:"setDefaults",value:function(){var e=this.options;e.threshold=e.threshold||[0,this.model.get("viewPercent")/100,this.model.get("viewabilityPercent")/100],e.rootMargin=e.rootMargin||"0px",e.targetEl=Array.isArray(e.targetEl)?e.targetEl:[e.targetEl]}},{key:"observerCallback",value:function(e,t){this.options.callback&&this.options.callback(e,t),e.forEach((function(e){e.target.dataset.elViewPercent=e.intersectionRatio.toString()}))}},{key:"getViewPercent",value:function(e){return 100*parseFloat(e.dataset.elViewPercent)}},{key:"isElIntersectingViewport",value:function(e){return this.getViewPercent(e)>0}},{key:"isElViewPercentReached",value:function(e){return this.getViewPercent(e)>this.model.get("viewPercent")}},{key:"isElViewabilityPercentReached",value:function(e){return this.getViewPercent(e)>this.model.get("viewabilityPercent")}}])&&et(t.prototype,i)}();i(5);s.a;i(5);function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ot(e,t){return!t||"object"!==tt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rt(e){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}s.a;var st=i(5),at=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=rt(e);if(t){var o=rt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ot(this,i)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).model=e,t.log=new a.a({unitType:t.model.get("unitType"),className:"GDPRManager",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._init(),t}return t=o,(i=[{key:"_init",value:function(){var e=window.__cmp,t=f.a.UNIT_TYPES[this.model.get("unitType")],i=t===f.a.UNIT_TYPES.EXPANDABLE||t===f.a.UNIT_TYPES.EXPANDABLE_MOBILE,n=t===f.a.UNIT_TYPES["300X600"]||t===f.a.UNIT_TYPES["300X600_MOBILE"];(i||n)&&!this.model.get("isStayInIframe")&&this._isInFriendlyIframe()&&(e=st.getTopWindow().__cmp),void 0!==e?(this.model.set("hasCMPonPage",!0),e("getConsentData",null,this._getConsentDataCB.bind(this))):(this.model.set("hasCMPonPage",!1),this.model.set("canStartPlayer",!0))}},{key:"_getConsentDataCB",value:function(e){var t=e.gdprApplies,i=e.consentData||"";this._setPlayerParams(t,i)}},{key:"_setPlayerParams",value:function(e,t){u.a.player?(u.a.player.set("gdprApplies",e),u.a.player.set("cdb",t)):(this.model.set("gdprApplies",e),this.model.set("consentDaisyBit",t),this.model.set("canStartPlayer",!0))}},{key:"_isInFriendlyIframe",value:function(){return this._isInIframe()&&cmTag.config.iframeData.isFriendlyIframe}},{key:"_isInIframe",value:function(){return cmTag.config.iframeData.inIframe||cmTag.config.iframeData.inDFP}}])&&it(t.prototype,i),o}(s.a);function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ut(e,t){return!t||"object"!==lt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ht(e){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(27);var pt,ft=i(5),mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ht(e);if(t){var o=ht(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ut(this,i)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e.model)).version=e.version,t.model=e.model,t.oppsulaLoaded=!1,t.log=new a.a({unitType:t.model.get("unitType"),className:"OppsulaManager",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.oppsArr=[],t._bindEvents(),t.serviceLoader=u.a.serviceLoader,t._loadService(),t}return t=o,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"isOppsulaLoaded:true",funcName:"_sendOppsFromArr"}])}},{key:"_loadService",value:function(){this.serviceLoader.get("oppsula",this.version,this._onOppsulaLoaded.bind(this),this._onLoadOppsulaError.bind(this))}},{key:"_onOppsulaLoaded",value:function(e){this.oppsula=new e(this.model),this.oppsulaLoaded=!0,this.log.info("Oppsula Loaded",this.oppsula),this._sendOppsFromArr()}},{key:"_onLoadOppsulaError",value:function(){this.log.error("Error while loading Oppsula from service loader")}},{key:"send",value:function(e){!0===this.oppsulaLoaded?this.oppsula.send(e):this.oppsArr.push(e)}},{key:"_sendOppsFromArr",value:function(){0!==this.oppsArr.length&&(ft.forEach(this.oppsArr,this.send,this),this.oppsArr=[])}}])&&ct(t.prototype,i),o}(s.a),gt=function(e){return pt||(pt=new mt(e)),pt};i(5);function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _t(e,t){return!t||"object"!==yt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wt(e){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}s.a;var Tt=i(5),St=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=wt(e);if(t){var o=wt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _t(this,i)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).model=e,t.log=new a.a({unitType:t.model.get("unitType"),className:"competitionDetector",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.competitionDetector=t.model.get("compToDetect"),t.competitionList=t._createCompetitionList(),t._startDetectCompetition(),t}return t=o,(i=[{key:"_createCompetitionList",value:function(){var e=[];return Tt.forEach(this.competitionDetector,(function(t){var i={};i.selector=t,i.isFound=!1,i.tries=0,e.push(i)})),e}},{key:"_startDetectCompetition",value:function(){Tt.forEach(this.competitionList,this._detectCompetition.bind(this))}},{key:"_detectCompetition",value:function(e){if(!e.isFound){var t=e.selector;e.tries++,document.querySelectorAll(t).length>0?(this.model.set("lastCompDetected",t),this.model.increaseCounter("compDetected"),e.isFound=!0):e.tries<=this.model.get("maxTriesForDetectingComp")&&setTimeout(this._detectCompetition.bind(this,e),1e3*this.model.get("timeBetweenDetectionCompSeconds"))}}}])&&vt(t.prototype,i),o}(s.a);function At(e){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Et(e,t){return(Et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ct(e,t){return!t||"object"!==At(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ot=i(5);!function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Et(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=kt(e);if(t){var o=kt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ct(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e)).model=e,t.adjacCardPlacement=t.model.get("adjacCardPlacement"),t.log=new a.a({unitType:t.model.get("unitType"),className:"organicCardInjector",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._bindEvents(),t}t=r,(i=[{key:"_bindEvents",value:function(){}},{key:"injectOrganicCard",value:function(e){if(this.adjacCardPlacement=this.model.get("adjacCardPlacement")||this.adjacCardPlacement,!this._isCardOrganic(this.adjacCardPlacement)&&!this.isOrganicCardInjected){this.organicContainer=Object(n.a)(e)[0];var t=Ot.getOrganicCard();if(!t)return this.log.error("missing mode can't inject organic"),!1;if(!this.organicContainer)return this.log.error("missing container to inject an organic card"),!1;var i=document.createElement("div");i.id="taboola-adjacent-organic-card",i.classList.add("tbl-feed-card"),i.dataset.cardIndex=this.adjacCardPlacement-.25,this.organicContainer.insertAdjacentElement("afterend",i),window._taboola=window._taboola||[];var o=this._getPlacementName();return this.isOrganicCardInjected=!0,this.model.set("isOrganicCardInjected",!0),_taboola.push({mode:t,container:"taboola-adjacent-organic-card",placement:o,target_type:"mix"}),!0}}},{key:"_getPlacementName",value:function(){var e=Object(n.a)(this.model.get("parentSelector"))[0];if(e&&e.dataset&&e.dataset.parentPlacementName)return e.dataset.parentPlacementName+" | Card 0"}},{key:"_isCardOrganic",value:function(e){var t=Object(n.a)('[data-card-index="'.concat(e,'"]'))[0];return!(!t||!t.querySelector(".trc-content-organic"))}}])&&Pt(t.prototype,i)}(s.a);function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vt(e,t){return(Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dt(e,t){return!t||"object"!==It(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xt(e){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(28);var Nt=i(5),Mt="tbl-data-mutation-observer",Lt={attributes:!0,childList:!0,characterData:!0,subtree:!0,attributeOldValue:!0,attributeFilter:["style"]},Ft=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=xt(e);if(t){var o=xt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Dt(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this)).model=e.model,t.globalModel=e.globalModel,t.log=new a.a({unitType:t.model.get("unitType"),className:t.constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._bindEvents(),t.validVideoClass=t.model.get("eligibilityValidator.validVideoClass")||["cm-vpaid-iframe","cm-ad-player","cm_video_content_video_element","_cm-loading","_cm-native-ad","_cm-background-filler","_cm-components-holder"],t.observers=[],t.observerThrottle=t.model.get("eligibilityValidator.observers.mutation.throttle")||200,t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"closeState:terminate",funcName:"_clearObservers"}]),this.model.get("videoValidator.isActive")&&(this.model.set("videoValidator.isActive",!1),this.createStateHandlers([{event:"adState:playing",funcName:"_triggerVideoValidation",isListenOnce:!0}]))}},{key:"_isElementTheTopMostElement",value:function(e){return this.elementData.topMostEl===e||this._isElementDecedentOfTopMostEl(e)||this._isValidVideoEl(this.elementData.topMostEl)||this._isValidElementInVideoPlaceholderOverlay(this.elementData.topMostEl)||this._isValidRboxElement(this.elementData.topMostEl)||this._isInlineUnitPushingDownTopMostEl(this.elementData.topMostEl)}},{key:"_isElementDecedentOfTopMostEl",value:function(e){return e.className&&this.elementData.topMostEl.querySelector&&!!this.elementData.topMostEl.querySelector(this._getQuerySelectorFromElementClassName(e))}},{key:"_isValidElementInVideoPlaceholderOverlay",value:function(e){var t=this.model.get("videoViewContainer");return Array.isArray(t)&&(t=t[0]),this.elementData.topMostEl.className&&t&&t.querySelector&&t.querySelector(this._getQuerySelectorFromElementClassName(this.elementData.topMostEl))}},{key:"_getQuerySelectorFromElementClassName",value:function(e){return".".concat(e.className.trim().replace(/\s+/g," ").split(" ").join("."))}},{key:"_isInlineUnitPushingDownTopMostEl",value:function(e){return"INLINE_INSTREAM"===this.model.get("unitType")&&"fixed"!==e.style.position}},{key:"_isValidRboxElement",value:function(e){for(;e.parentElement;){if(e.className.indexOf("trc_rbox_container")>-1)return!0;e=e.parentElement}return!1}},{key:"_handleTopElement",value:function(e){return this._clearObservers(),e}},{key:"_handleElementIsNotOnTop",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,n=this._calcEligiblePercent(e,this.elementData,i/100);return t&&!this._isEligiblePercentValid(n)&&(this._fireOverlayPixel(n),this._setMutationObserver(this._getElToObserve(this.elementData.topMostEl))),n}},{key:"getViewablePercentForNonFullyViewableUnits",value:function(e,t){try{return Nt.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled")&&!this.measured,"videoEligibilityValidationCalc",f.a.TRC_PERFORMANCE_ACTIONS.START),this._setElementEligibilityDataByViewabilityPercent(e),this._isElementTheTopMostElement(e)?this._handleTopElement(t):this._handleElementIsNotOnTop(e,this._isEligiblePercentValid(t),t)}catch(e){this.log.error(e)}finally{Nt.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled")&&!this.measured,"videoEligibilityValidationCalc",f.a.TRC_PERFORMANCE_ACTIONS.STOP),this.measured=!0}}},{key:"getViewablePercent",value:function(e){try{if(Object(n.a)(e).show(),this._setElementEligibilityData(e),this._isElementTheTopMostElement(e))return Object(n.a)(e).hide(),this._handleTopElement(100);var t=this._handleElementIsNotOnTop(e,!0);return Object(n.a)(e).hide(),t}catch(t){this.log.error(t),Object(n.a)(e).hide()}}},{key:"validateVideoIsTopEle",value:function(e){try{return this._setElementEligibilityData(e),this._isValidVideoEl(this.elementData.topMostEl)}catch(e){this.log.error(e)}}},{key:"_setElementEligibilityDataByViewabilityPercent",value:function(e){this.elementData={},this.elementData.elementBound=e.getBoundingClientRect(),this.elementData.elementBound.height=this.elementData.elementBound.height||this.model.get("height"),this.elementData.elementBound.width=this.elementData.elementBound.width||this.model.get("width"),this.elementData.samplePoint=this._getSamplePointByViewabilityPercent(e,this.elementData.elementBound),this.elementData.topMostEl=this._findTopMostEl(this.elementData.samplePoint.x,this.elementData.samplePoint.y)}},{key:"_findTopMostEl",value:function(e,t){for(var i=this._getTopMostElementAtPoint(e,t);i&&i.parentElement&&i.parentElement!==document.body&&this._isParentContainingChild(i);)i=i.parentElement;return i}},{key:"_isParentContainingChild",value:function(e){try{var t=e.getBoundingClientRect(),i=e.parentElement.getBoundingClientRect();return i.x<=t.x&&i.y<=t.y&&i.x+i.width>=t.x+t.width&&i.y+i.height>=t.y+t.height}catch(e){}return!1}},{key:"_setElementEligibilityData",value:function(e){this.elementData={},this.elementData.elementBound=e.getBoundingClientRect(),this.elementData.samplePoint=this._getSamplePoint(e,this.elementData.elementBound),this.elementData.topMostEl=this._getTopMostElementAtPoint(this.elementData.samplePoint.x,this.elementData.samplePoint.y)}},{key:"_isValidVideoEl",value:function(e){return!!this._isElementHasValidClasses(e)||this._isElementHasValidClasses(this._getVideoEl(e))}},{key:"_isElementHasValidClasses",value:function(e){for(var t in this.validVideoClass)if(Object(n.a)(e).hasClass(this.validVideoClass[t]))return!0;return!1}},{key:"_calcEligiblePercent",value:function(e,t,i){var n=this._getIntersectionRatio(e,this.elementData.elementBound,this.elementData.topMostEl),o=Math.max(100*(i-n),0);return this.log.warning("video ad is not the top most element",{validPercent:o}),o}},{key:"_isEligiblePercentValid",value:function(e){return e>=(this.model.get("viewabilityPercent")||100)}},{key:"_setMutationObserver",value:function(e){this._isSetObserver(e)&&(this.observer||this._initMutationObserver(),e.setAttribute(Mt,!0),this.mutationsObserver.observe(e,Lt))}},{key:"_initMutationObserver",value:function(){var e=Nt.throttle(this._onOverlayChange.bind(this),this.observerThrottle);this.mutationsObserver=new MutationObserver(e)}},{key:"_isSetObserver",value:function(e){var t=e&&e.getAttribute(Mt);return this.model.get("eligibilityValidator.observers.mutation.isActive")&&!t&&Nt.isObserverSupported("IntersectionObserver")}},{key:"_getElToObserve",value:function(e){if(this.model.get("eligibilityValidator.observers.mutation.isObserveParent")){var t=e.parentElement;if(["HTML"].indexOf(t.tagName)<0)return t}return e}},{key:"_fireOverlayPixel",value:function(e){this._setToModel("overlay",{overlayData:this._getOverlayData(this.elementData.topMostEl),actualEligiblePercent:parseInt(e)}),this._setToModel("overlayDetected",!0)}},{key:"_setToModel",value:function(e,t){this.model.set(e,t),this.globalModel&&this.globalModel.set(e,t)}},{key:"_getOverlayData",value:function(e){return"id@".concat(e.id,";cl@").concat(e.className).slice(0,100)}},{key:"_getVideoEl",value:function(e){var t=e.tagName.toLowerCase();return"video"===t?e:"iframe"===t?e.contentDocument&&e.contentDocument.querySelector&&e.contentDocument.querySelector("video"):e&&e.querySelector&&e.querySelector("video")}},{key:"_getTopMostElementAtPoint",value:function(e,t){return Nt.getTopWindow().document.elementFromPoint(e,t)}},{key:"_getSamplePoint",value:function(e,t){var i=Math.min(this.model.get("eligibilityValidator.yThreshold"),t.height)||10;return{x:t.x+t.width/2,y:t.y+t.height-i}}},{key:"_getSamplePointByViewabilityPercent",value:function(e,t){var i=(100-this.model.get("viewabilityPercent"))/100,n=t.height*i,o=t.width*i,r=Math.min(this.model.get("eligibilityValidator.yThreshold"),t.height)||10,s=Math.min(this.model.get("eligibilityValidator.xThreshold"),t.width)||10,a=t.x+t.width-o-s,l=t.y+t.height-n-r;return{x:Math.min(a,window.innerWidth-1),y:Math.min(l,window.innerHeight-1)}}},{key:"_getIntersectionRatio",value:function(e,t,i){var n=t.width*t.height;return this._getElementsIntersectionArea(i,e,t)/n}},{key:"_getElementsIntersectionArea",value:function(e,t,i){if(!e||!t)return 0;var n=e.getBoundingClientRect(),o=i||t.getBoundingClientRect(),r=n.left,s=n.top,a=n.left+n.width,l=n.top+n.height,c=o.left,d=o.top,u=o.left+o.width,h=o.top+o.height;return Math.max(0,Math.min(a,u)-Math.max(r,c))*Math.max(0,Math.min(l,h)-Math.max(s,d))}},{key:"_clearObservers",value:function(){Object(n.a)("[".concat(Mt,"]")).removeAttr(Mt),this.mutationsObserver&&this.mutationsObserver.disconnect()}},{key:"_onOverlayChange",value:function(e,t){var i=this;Nt.forEach(e,(function(e){var t=e.removedNodes&&Nt.contains(e.removedNodes,i.elementData.topMostEl);(e.target===i.elementData.topMostEl||t)&&i.model.increaseCounter("overlayMutation")}))}},{key:"_validateVideoPosition",value:function(){var e=this.model.get("containerViewPlaceHolder")||this.model.get("videoViewContainer");this.validateVideoIsTopEle(e)||this.model.set("misplacedVideoDetected",!0)}},{key:"_triggerVideoValidation",value:function(){var e=this;setTimeout((function(){e.model.get("adState")===c.a.adState.playing&&e._validateVideoPosition()}),this.model.get("videoValidator.timeToValidation")||500)}}])&&Rt(t.prototype,i),r}(s.a);i(5)},function(e,t){function i(e){window.cmTag=window.cmTag||{},e=e||{},this.unitType=e.unitType,this.className=this.className||e.className}i.prototype.info=function(e,t){this.hasLoggerMethod("info")&&window.cmTag.logger.info("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},i.prototype.debug=function(e,t){this.hasLoggerMethod("info")&&window.cmTag.logger.info("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},i.prototype.error=function(e,t){this.hasLoggerMethod("error")&&window.cmTag.logger.error("unit type: "+this.unitType+" class name: "+this.className+" - "+e,t)},i.prototype.hasLoggerMethod=function(e){return window.cmTag&&window.cmTag.logger&&window.cmTag.logger[e]&&"function"==typeof window.cmTag.logger[e]},e.exports=i},function(e,t){var i;function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o={singleAd:{name:"singleAd",playerType:"singleAd",priority:1,defaultConfigFile:"./SingleAd/DefaultSingleAdConfig",unitsConfigFiles:(i={FEED_MANAGER:"./SingleAd/units/SingleAdFeedManagerConfig",FEED_MANAGER_MOBILE:"./SingleAd/units/SingleAdFeedManagerConfig",WIDGET_ITEM:"./SingleAd/units/SingleAdWidgetItemConfig",WIDGET_ITEM_MOBILE:"./SingleAd/units/SingleAdWidgetItemConfig",INLINE_INSTREAM:"./SingleAd/units/SingleAdInlineConfig",INLINE_MOBILE:"./SingleAd/units/SingleAdInlineConfig"},n(i,"WIDGET_ITEM_MOBILE","./SingleAd/units/SingleAdWidgetItemConfig"),n(i,"SLIDER_INSTREAM","./SingleAd/units/SingleAdSliderConfig"),n(i,"SLIDER_MOBILE","./SingleAd/units/SingleAdSliderConfig"),i)},rv:{name:"rv",priority:3},adjacency:{name:"adjacency",playerType:"adjacencyAd",priority:2,defaultConfigFile:"./Adjacency/DefaultAdjacencyConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Adjacency/units/AdjacFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Adjacency/units/AdjacFeedManagerConfig.js",WIDGET_ITEM:"./Adjacency/units/AdjacencyWidgetItemConfig",WIDGET_ITEM_MOBILE:"./Adjacency/units/AdjacencyWidgetItemConfig",RECO_REEL_WIDGET:"./Adjacency/units/AdjacencyRecoReelWidgetConfig.js"}},replayable:{name:"replayable",defaultConfigFile:"./Replayable/DefaultReplayableConfig.js",unitsConfigFiles:{FEED_MANAGER:"./Replayable/units/ReplayableAdFeedManagerConfig.js",FEED_MANAGER_MOBILE:"./Replayable/units/ReplayableAdFeedManagerConfig.js",INLINE_INSTREAM:"./Replayable/units/ReplayableAdInlineConfig.js",INLINE_MOBILE:"./Replayable/units/ReplayableAdInlineConfig.js",WIDGET_ITEM:"./Replayable/units/ReplayableAdWidgetItemConfig.js",WIDGET_ITEM_MOBILE:"./Replayable/units/ReplayableAdWidgetItemConfig.js"},priority:4}};e.exports=o},function(e,t,i){"use strict";i.d(t,"e",(function(){return F})),i.d(t,"f",(function(){return $})),i.d(t,"l",(function(){return Z})),i.d(t,"n",(function(){return oe})),i.d(t,"p",(function(){return de})),i.d(t,"q",(function(){return ge})),i.d(t,"r",(function(){return Te})),i.d(t,"c",(function(){return v})),i.d(t,"j",(function(){return ke})),i.d(t,"g",(function(){return xe})),i.d(t,"k",(function(){return He})),i.d(t,"m",(function(){return tt})),i.d(t,"d",(function(){return Ye})),i.d(t,"i",(function(){return at})),i.d(t,"a",(function(){return Rt})),i.d(t,"b",(function(){return Pt})),i.d(t,"s",(function(){return Lt})),i.d(t,"h",(function(){return pt})),i.d(t,"o",(function(){return Wt})),i.d(t,"t",(function(){return Qt}));var n=i(6),o=i(4),r=i(2);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=i(5),h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=d(e);if(t){var o=d(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return c(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e.model)).model=e.model,t.onPredict=e.onPredict,t.adProperties=e.adProperties,t.currentKey=0,t.log=new o.a({unitType:t.model.get("unitType"),className:"basePredictService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._bindEvents(),t}return t=r,(i=[{key:"_bindEvents",value:function(){}},{key:"_setCuerrentKey",value:function(e){this.currentKey=u.last(e.split(".")),this.model.set("adsManagerLastPredictKey",this.currentKey)}},{key:"_predicted",value:function(e){if(this.model.set("lastPredictPoint",e),this.model.set("lastPredictPath",this.predictPath),this.model.get(this.predictPath+".isStartWF")&&this.startWf&&(this.log.info("startWF predicted"),this.startWf()),this._checkIsGet1OnlyOnAdLoaded()&&1===parseInt(e)&&!this.model.get("playerHasRvInQ"))return this.log.warning("no rv=1 in adLoaded skipping predict"),void this.model.set("isSkippedDistancePredict",!0);this.predictPath&&!this.model.get(this.predictPath+".isActive")||(this._logPredict(e),this.onPredict(e,this.log.className,this.adProperties))}},{key:"_checkIsGet1OnlyOnAdLoaded",value:function(){var e=this.model.get("predictors.isGet1OnlyAfterAdLoaded");return this.predictPath&&void 0!==this.model.get("".concat(this.predictPath,".isGet1OnlyAfterAdLoaded"))&&(e=this.model.get("".concat(this.predictPath,".isGet1OnlyAfterAdLoaded"))),e}},{key:"_logPredict",value:function(e){var t="predicted with key: "+e;this.adProperties?this.log.info(t+" with properties: ",this.adProperties):this.log.info(t)}}])&&a(t.prototype,i),r}(n.a);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=y(e);if(t){var o=y(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return g(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"autoKillPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint="predictors.autoKill.predictPoint",t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"adState:autoKill",funcName:"_onAutoKillPredict"}])}},{key:"_onAutoKillPredict",value:function(){setTimeout(this._predicted.bind(this,this.model.get("lastAutoKilledPredict")),0)}}])&&f(t.prototype,i),r}(h),b=i(0),_=i(3),w=i.n(_),T=i(5),S=function(e,t){return e.model=t,e.parentSelectorStr=void 0,e.model.get("permanentCard")?e.parentSelectorStr='[data-card-index="'.concat(e.model.get("permanentCard"),'"]'):e.model.get("startCard")>1?e.parentSelectorStr='[data-card-index="'.concat(e.model.get("startCard"),'"]'):e.model.get("predictors.isUseWidgetSelector")?e.parentSelectorStr=e.model.get("widgetSelector"):e.parentSelectorStr=e.model.get("parentSelector"),{getParentSelector:function(){if(e.parentSelectorStr){var t=e.parentSelectorStr.toString(),i=Object(b.a)(t);return e.model.get("predictors.isNeedValidateParentSelector")?T.getValidSelectorElements(i)[0]:i[0]}},calcPredicts:function(){var t=e.model.get(e.predictPoints);T.each(t,(function(t,i){e._calcPredict(t,i)}))}}},A=i(14);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=O(e);if(t){var o=O(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return k(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"baseDistancePredicts",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t}return t=r,(i=[{key:"_initPredict",value:function(e){this.predictPoint=e.predictPoint,this.predictKey=e.predictKey,this.startWf=e.startWfFunc,this.utils=S(this,this.model),this.scrollManager=new A.a,this._setParentSelector()}},{key:"_setParentSelector",value:function(){if(!this.isSelectorFound){var e=this.utils.getParentSelector();e?(this.isSelectorFound=!0,this.parentSelector=e,this.log.info("parentSelector found staring to predict viewability"),this._bindEvents(),this._calcPredict()):(this.log.info("no parentSelector can't predict distance waiting for parentSelector"),w.a.once("window:scroll:change",this._setParentSelector.bind(this)),this.model.listenToOnce(this.model,"change:parentSelector",this._setParentSelector.bind(this)))}}},{key:"_bindEvents",value:function(){this.parentSelector&&(window.taboolaBridge&&!this.registeredOnNotifyExternalRects&&(this.registeredOnNotifyExternalRects=!0,window.taboolaBridge.on("notifyExternalRects",this._calcPredict.bind(this))),w.a.once("window:scroll:change",this._calcPredict.bind(this)))}},{key:"_calcPredict",value:function(){}},{key:"_onDistancePredicted",value:function(e){if(this.maxPPS&&Math.abs(this.scrollManager.pps)>this.maxPPS)return this.log.warning("Distance Predicted, speed is too high",this.scrollManager.pps),void this.model.set("isSkippedDistancePredict",!0);this.log.warning("Distance Predicted, speed is OK",this.scrollManager.pps),this._predicted(e)}}])&&E(t.prototype,i),r}(h);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?N(e):t}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L=i(5),F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=M(e);if(t){var o=M(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return x(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"distancePercentPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.distancePercent",t.maxPPS=t.model.get("predictors.distancePercent.maxPPS"),t.utils=S(N(t),t.model),t._initPredict(e),t}return t=r,(i=[{key:"_calcPredict",value:function(){if(!this.isPredicted){var e=Object(b.a)(this.model.get("scrollSelector"))[0],t=void 0!==e,i=t?e.clientHeight:window.innerHeight,n=t?i+e.scrollTop:i+window.pageYOffset,o=100/(this.predictPoint||1),r=L.getTopOfEl(this.parentSelector),s=r+this.model.get("height")/(100/this.model.get("viewPercent")||1),a=i+(s-i)/o;this.model.get("logViewabilityCalc")&&this.log.info("\ntopParentSelector: "+r+",\neligibilityPoint: "+s+",\nstartPoint: "+i+",\nbottomViewPort: "+n+",\npredictionPoint: "+a+",\ncalc: predictionPoint <= bottomViewPort: "+(a<=n)),a<=n?(this.model.set("distancePercentPredictData",{topParentSelector:r,bottomViewPort:n,eligibilityPoint:s,startPoint:i,predictionPoint:this.predictionPoint,predictKey:this.predictKey}),this.isPredicted=!0,this._onDistancePredicted(this.predictKey)):this._bindEvents()}}}])&&V(t.prototype,i),r}(I);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e,t){return!t||"object"!==B(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var z=i(5),$=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=W(e);if(t){var o=W(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return H(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"distancePixelsPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.distancePixels",t.maxPPS=t.model.get("predictors.distancePixels.maxPPS"),t._initPredict(e),t}return t=r,(i=[{key:"_calcPredict",value:function(){this.isPredicted||(z.hasPassedPixelFromSelector(this.parentSelectorStr,this.model.get("scrollSelector"),this.predictPoint,this.model.get("predictors.isNeedValidateParentSelector"))?(this.model.set("distancePixelPredictData",{predictionPoint:this.predictionPoint,predictKey:this.predictKey}),this.isPredicted=!0,this._onDistancePredicted(this.predictKey)):this._bindEvents())}}])&&j(t.prototype,i),r}(I);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var X=i(5),Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=K(e);if(t){var o=K(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Q(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"getAdFailPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.allowedPredictPoints="predictors.getAdFail.allowedPredictPoints",t.keysToPredict=t.model.get(t.allowedPredictPoints),t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"getAdState:failed",funcName:"_onFailedToGetAd"}])}},{key:"_onFailedToGetAd",value:function(){var e=this.model.get("lastFailedPredict");this._shouldPredict(e)&&(this.adProperties=this.model.get("lastFailedPredictProperties"),setTimeout(this._predicted.bind(this,this.model.get("lastFailedPredict")),200))}},{key:"_shouldPredict",value:function(e){return Array.isArray(this.keysToPredict)?X.contains(this.keysToPredict,e):"any"===this.keysToPredict.toString()||this.keysToPredict===e}}])&&G(t.prototype,i),r}(h);function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e,t){return!t||"object"!==J(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ne(e);if(t){var o=ne(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ie(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"loadingPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint="predictors.loading.predictPoint",t.predictKey=t.model.get("predictors.loading.predictPoints"),t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"playerState:restarted",funcName:"_onLoadingClick"}])}},{key:"_incrementAd",value:function(){var e=this.model.get("predictors.loading.counterAd");e=e?++e:1,this.model.set("predictors.loading.counterAd",e)}},{key:"_onLoadingClick",value:function(){this._predicted(this.predictKey)}}])&&ee(t.prototype,i),r}(h);function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function le(e,t){return!t||"object"!==re(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ce(e);if(t){var o=ce(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return le(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"multiAdPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.adQState=e.predictPoint,t.predictKey=e.predictKey,t.predictPath="predictors.multiAd",t._bindPredictAdQState(),t}return t=r,(i=[{key:"_bindEvents",value:function(){}},{key:"_bindPredictAdQState",value:function(){var e=this.adQState;this.createStateHandlers([{event:"adQState:".concat(e),funcName:"_onPredictPoint"}])}},{key:"_allowPredict",value:function(){return this.model.get("isMultiAd")}},{key:"_onPredictPoint",value:function(){this._allowPredict()&&this._predicted(this.predictKey)}}])&&se(t.prototype,i),r}(h);function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=me(e);if(t){var o=me(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return fe(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"playerReadyPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.playerReady",t.startWf=e.startWfFunc,t.predictKey=t.model.get(t.predictPath+".predictPoint"),t.predictPoint=t.predictPath+".predictPoint",t}return t=r,(i=[{key:"_bindEvents",value:function(){"ready"===this.model.get("playerState")?this._onPlayerReady():this.createStateHandlers([{event:"playerState:ready",funcName:"_onPlayerReady",isListenOnce:!0}])}},{key:"_onPlayerReady",value:function(){this._predicted(this.predictKey)}}])&&he(t.prototype,i),r}(h);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _e(e,t){return!t||"object"!==ye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var Te=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=we(e);if(t){var o=we(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _e(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"repeatPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint="predictors.repeat.predictPoint",t.predictKey=t.model.get("predictors.repeat.predictPoints"),t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"repeatState:spinning",funcName:"_onRepeatSpinning"}])}},{key:"_incrementAd",value:function(){var e=this.model.get("predictors.repeat.counterAd");e=e?++e:1,this.model.set("predictors.repeat.counterAd",e)}},{key:"_allowPredict",value:function(){return!this.model.get("isMultiAd")}},{key:"_onRepeatSpinning",value:function(){this._allowPredict&&this._predicted(this.predictKey)}}])&&ve(t.prototype,i),r}(h);function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ee(e,t){return!t||"object"!==Se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ce(e);if(t){var o=Ce(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ee(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"firstScrollPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.firstScroll",t.predictPoints=t.predictPath+".predictPoints",t.predictKey=t.model.get(t.predictPath+".predictPoints"),t.startWf=e.startWfFunc,t.isPredicted=!1,t.model.get("isEligibleToPlay")?t._callPredict():t._onFirstScroll(),t}return t=r,(i=[{key:"_bindEvents",value:function(){w.a.once("window:scroll:change",this._onFirstScroll.bind(this)),this.createStateHandlers([{event:"isEligibleToPlay:true",funcName:"_callPredict"}])}},{key:"_onFirstScroll",value:function(){if(!this.isPredicted){var e=window.pageYOffset,t=5,i=Object(b.a)(this.model.get("scrollSelector"))[0];if(void 0!==i){var n=i.clientHeight;e=n+i.scrollTop,t=n+5}t<=e?this._callPredict():this._bindEvents()}}},{key:"_callPredict",value:function(){this.isPredicted||(this.isPredicted=!0,this._predicted(this.predictKey))}}])&&Ae(t.prototype,i),r}(h);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ie(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(s,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=De(e);if(t){var o=De(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ve(this,i)}}(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"emptyQueuePredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t._bindEmptyQueuePredict(),t}return t=s,(i=[{key:"_bindEvents",value:function(){}},{key:"_bindEmptyQueuePredict",value:function(){this.createStateHandlers([{event:"adManagerState:".concat(r.adManagerState.empty),funcName:"_onQEmpty"}])}},{key:"_allowPredict",value:function(){return this.model.get("isMultiAd")}},{key:"_onQEmpty",value:function(){this.model.get("getAdState")!==r.getAdState.gettingAd&&this._onPredictPoint()}},{key:"_onPredictPoint",value:function(){this._allowPredict()&&this._predicted(this.model.get("predictors.emptyQueue.predictPoints"))}}])&&Ie(t.prototype,i),s}(h),Ne=i(1),Me=i.n(Ne);function Le(e){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e,t){return!t||"object"!==Le(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var He=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(s,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ue(e);if(t){var o=Ue(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return je(this,i)}}(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"fullEligibilityPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint=e.predictPoint,t.predictKey=t.model.get("predictors.fullEligibility.predictPoints"),t.predictPath="predictors.fullEligibility",t.startWf=e.startWfFunc,t.hadGetAdRv=!1,t.maxPPS=t.model.get("predictors.fullEligibility.maxPPS"),t.scrollManager=new A.a,t._bindEvents(),t}return t=s,(i=[{key:"_bindEvents",value:function(){this.scrollManager&&(this.createStateHandlers([{event:"getAdState:".concat(r.getAdState.gettingAd),funcName:"_onGettingAd",isListenOnce:!0}]),this.model.get("frameType")===Me.a.FRAME_TYPE.plainPage?(w.a.once("window:scroll:change",this._calcPredict.bind(this)),this.scrollManager.registerForScrollEnd(this._calcPredict.bind(this))):this.calcPredictInterval=setInterval(this._calcPredict.bind(this),1e3*this.model.get("predictors.fullEligibility.checkPredictsSeconds")))}},{key:"_onGettingAd",value:function(){1!==this.model.get("lastGetAdKey")?this.createStateHandlers([{event:"getAdState:".concat(r.getAdState.gettingAd),funcName:"_onGettingAd",isListenOnce:!0}]):this.hadGetAdRv=!0}},{key:"_calcPredict",value:function(){this.hadGetAdRv||this.isPredicted||(this._canPredict()&&this.maxPPS&&Math.abs(this.scrollManager.pps)<this.maxPPS?(this.isPredicted=!0,this.calcPredictInterval&&(clearInterval(this.calcPredictInterval),this.calcPredictInterval=void 0),this.model.set("fullEligibilityPredicted",!0),this._predicted(this.predictKey)):w.a.once("window:scroll:change",this._calcPredict.bind(this)))}},{key:"_canPredict",value:function(){var e=this.model.get("adState")===r.adState.playing,t=this.model.get("isEligibleToPlay")&&this.model.get("isSkippedDistancePredict")&&!e;return t&&this._checkIsGet1OnlyOnAdLoaded()&&(t=t&&this.model.get("playerHasRvInQ")),t}}])&&Fe(t.prototype,i),s}(h);function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ze(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $e(e,t){return($e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$e(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ge(e);if(t){var o=Ge(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return qe(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"bForcePredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint="predictors.bForce.predictPoints",t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"canGetRv:true",funcName:"_onCanGetRv"}])}},{key:"_onCanGetRv",value:function(){this._predicted(this.model.get(this.predictPoint))}}])&&ze(t.prototype,i),r}(h);function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xe(e,t){return(Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ze(e,t){return!t||"object"!==Qe(t)&&"function"!=typeof t?Je(e):t}function Je(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function et(e){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var tt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xe(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=et(e);if(t){var o=et(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ze(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"intersectionPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPoint=e.predictPoint,t.predictKey=e.predictKey,t.predictPath="predictors.intersection",t.startWf=e.startWfFunc,t.utils=S(Je(t),t.model),t._setSelector(),t}return t=r,(i=[{key:"_initObserver",value:function(){var e={rootMargin:"0px",threshold:[0,this.predictPoint/100]};this.observer=new IntersectionObserver(this._observerCallback.bind(this),e),this.observer.observe(this.parentSelector)}},{key:"_setSelector",value:function(){if(!this.isSelectorFound){var e=this.utils.getParentSelector();e?(this.isSelectorFound=!0,this.selectorTimeOut&&(clearTimeout(this.selectorTimeOut),this.selectorTimeOut=void 0),this.parentSelector=e,this.log.info("parentSelector found staring to predict viewability"),this._bindEvents(),this._initObserver()):(this.log.info("no parentSelector can't predict distance waiting for parentSelector"),this.model.listenToOnce(this.model,"change:parentSelector",this._setSelector.bind(this)),this.selectorTimeOut=setTimeout(this._setSelector.bind(this),1e3))}}},{key:"_observerCallback",value:function(e,t){this.isPredicted||100*e[0].intersectionRatio>=this.predictPoint&&(this.isPredicted=!0,this._predicted(this.predictKey),this.observer.disconnect())}}])&&Ke(t.prototype,i),r}(h);function it(e){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rt(e,t){return!t||"object"!==it(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var at=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=st(e);if(t){var o=st(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rt(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"feedXPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.feedX",t.predictPoints=t.predictPath+".predictPoints",t.predictKey=t.model.get(t.predictPath+".predictPoints"),t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"feedxToggle",funcName:"_onFeedxToggle"}])}},{key:"_onFeedxToggle",value:function(){this.model.get("feedxToggle")%2==1&&this._predicted(this.predictKey)}}])&&nt(t.prototype,i),r}(h);function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ut(e,t){return!t||"object"!==lt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ht(e){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var pt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=ht(e);if(t){var o=ht(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ut(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:t.constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.feedContainerChanged",t.predictPoints=t.predictPath+".predictPoints",t.predictKey=t.model.get(t.predictPath+".predictPoints"),t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"feedContainerChanged",funcName:"_onFeedContainerChanged"}])}},{key:"_onFeedContainerChanged",value:function(){this._predicted(this.predictKey)}}])&&ct(t.prototype,i),r}(h);function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yt(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=vt(e);if(t){var o=vt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return yt(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"baseAdProgressionPredicts",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t}return t=r,(i=[{key:"_initPredict",value:function(e){this.requestedTime=e.predictPoint,this.predictKey=e.predictKey,this._bindPredictAdDuration()}},{key:"_bindPredictAdDuration",value:function(){this.createStateHandlers([{event:"activeAdCurrentTime",funcName:"_onPredictPoint"},{event:"lastActiveAd",funcName:"_onAdCompleted"}])}},{key:"_onPredictPoint",value:function(){this._allowPredict()&&this._predicted(this.predictKey)}},{key:"_allowPredict",value:function(){}},{key:"_onAdCompleted",value:function(){this.isPredicted=!1}}])&&mt(t.prototype,i),r}(h);function _t(e){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function St(e,t){return!t||"object"!==_t(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function At(e){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=At(e);if(t){var o=At(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return St(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"adProgressionBeforeEndPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.adProgressionBeforeEnd",t._initPredict(e),t}return t=r,(i=[{key:"_allowPredict",value:function(){if(this.isPredicted)return!1;var e=this.model.get("activeAdMaxTime"),t=this.model.get("activeAdCurrentTime");return!!(e&&t&&e-this.requestedTime<=t)&&(this.isPredicted=!0,this.model.increaseCounter("onadProgressionBeforeEndPredictPredict"),!0)}}])&&wt(t.prototype,i),r}(bt);function Et(e){return(Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ct(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e,t){return!t||"object"!==Et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=It(e);if(t){var o=It(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ot(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"adProgressionAfterBeginPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.adProgressionAfterBegin",t._initPredict(e),t}return t=r,(i=[{key:"_allowPredict",value:function(){if(this.isPredicted)return!1;var e=this.model.get("activeAdCurrentTime");return!!(e&&this.requestedTime<=e)&&(this.isPredicted=!0,this.model.increaseCounter("onadProgressionAfterBeginPredict"),!0)}}])&&Ct(t.prototype,i),r}(bt);function Vt(e){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xt(e,t){return(xt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nt(e,t){return!t||"object"!==Vt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mt(e){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xt(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Mt(e);if(t){var o=Mt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Nt(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"timePredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.time",t.modelKey=e.modelKey?e.modelKey:e.predictKey?"".concat(t.predictPath,".predictPoints.").concat(e.predictKey):t.predictPath,t.predictKey=e.predictKey||t.model.get("".concat(t.modelKey,".predictPoints")),t.isActive=t.model.get("".concat(t.modelKey,".isActive")),t.isActive?(t.length=1e3*t.model.get("".concat(t.modelKey,".lengthInSeconds")),t.length?(t.repeat=t.model.get("".concat(t.modelKey,".repeat"))||1,t._bindTimePredict(),t._startPredictTimer(),t):Nt(t)):Nt(t)}return t=r,(i=[{key:"_bindEvents",value:function(){}},{key:"_bindTimePredict",value:function(){this.createStateHandlers([{event:"time:".concat(this.predictPath),funcName:"_startPredictTimer"}])}},{key:"_canRepeatPredict",value:function(){return this.repeat>0}},{key:"_canStartTimer",value:function(){return!this.stopped&&this._canRepeatPredict()}},{key:"_startPredictTimer",value:function(){var e=this;this._canStartTimer()&&(this.timer&&(this.timer=clearTimeout(this.timer)),this.log.info("Starting timer",this.predictKey),this.timer=setTimeout((function(){--e.repeat,e._predicted(e.predictKey),e._startPredictTimer()}),this.length))}},{key:"stop",value:function(){this.log.info("Timer predict stopped"),this.timer=clearTimeout(this.timer),this.stopped=!0}}])&&Dt(t.prototype,i),r}(h);function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jt(e,t){return(jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ut(e,t){return!t||"object"!==Ft(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ht(e){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var Wt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ht(e);if(t){var o=Ht(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ut(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"mp4Predict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.mp4",t.predictKey=t.model.get(t.predictPath+".predictPoint"),t.predictPoint=t.predictPath+".predictPoint",t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"playerQueue",funcName:"_onPlayerQueueStatusChange"}])}},{key:"_onPlayerQueueStatusChange",value:function(){this.adsListFromPlayer=this.model.get("playerQueue"),this._allowPredict()&&(this._predicted(this.predictKey),this.model.stopListening(this.model,"change:playerQueue"))}},{key:"_allowPredict",value:function(){var e=this.adsListFromPlayer[this.adsListFromPlayer.length-1];return!0===e.rv&&"video"===e.mt}}])&&Bt(t.prototype,i),r}(h);function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gt(e,t){return!t||"object"!==zt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yt(e){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qt(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Yt(e);if(t){var o=Yt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Gt(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).log=new o.a({unitType:t.model.get("unitType"),className:"transitionPredict",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.predictPath="predictors.transition",t.isActive=t.model.get("".concat(t.predictPath,".isActive")),t.isActive?(t.predictPoints="".concat(t.predictPath,".predictPoints"),t.predictKey=e.predictKey,t.predictOptions=t.model.get("".concat(t.predictPoints,".").concat(t.predictKey)),t.predictOptions.container?(t.container=document.querySelector(t.predictOptions.container),t.container?(t.predictOptions.event=t.predictOptions.event||"start",t.predictOptions.requireEligibility=t.predictOptions.requireEligibility||!1,t.predictOptions.repeat=t.predictOptions.repeat||0,t.predictOptions.checkQueueForSameRv=t.predictOptions.checkQueueForSameRv||!1,t._startTransitionPredictor(),t):Gt(t)):Gt(t)):Gt(t)}return t=r,(i=[{key:"_bindEvents",value:function(){}},{key:"_startTransitionPredictor",value:function(){this.animationEventDetector=TRC.dom.detectAnimationEvent(this.container,this.predictOptions.event),this._bindedOnAnimationEvent=this._onAnimationEvent.bind(this,this.predictOptions.event),TRC.dom.on(this.container,this.animationEventDetector,this._bindedOnAnimationEvent)}},{key:"_onAnimationEvent",value:function(e){if(!this.stopped){var t=(new Date).getTime();this.lastPredicted&&t-this.lastPredicted<1e3||this._isRequireEligibilityMatch()&&(this._isQueueContainSameRv()||(this.lastPredicted=t,this._predicted(this.predictKey),--this.predictOptions.repeat<0&&(this.stopped=!0,TRC.dom.off(this.container,this.animationEventDetector,this._bindedOnAnimationEvent))))}}},{key:"_isRequireEligibilityMatch",value:function(){return!this.predictOptions.requireEligibility||this.model.get("isEligibleToPlay")}},{key:"_isQueueContainSameRv",value:function(){return!!this.predictOptions.checkQueueForSameRv&&this.model.get(0==this.predictKey?"adsList.nonRvAds":"adsList.rvAds")>0}}])&&$t(t.prototype,i),r}(h)},function(e,t,i){"use strict";function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}i.d(t,"a",(function(){return s}));var r=i(5),s=function(e,t){if(e.model&&r.isArray(t)){var i=function(e){var t,i=e.self,o=e.funcName,s=e.withBind,a=e.args;r.isString(o)&&r.isFunction(i[o])&&(s?(t=i[o]).bind.apply(t,[i].concat(n(a)))():i[o].apply(i,n(a)))};r.each(t,function(t){var n=t.event,o=t.funcName,s=t.isListenOnce,a=void 0!==s&&s,l=t.withBind,c=void 0===l||l;if(r.isArray(n)&&function(t){var n=t.event,o=t.funcName,s=t.isListenOnce,a=t.withBind,l=s?"listenToOnce":"listenTo",c=!0,d=!1,u=[];r.forEach(n,function(e){var t=e.split(":")[0],i=e.split(":")[1];u.push({eventName:t,stateName:i})}.bind(e));var h=function(t){if(!s||!d){var n=!0;r.forEach(u,(function(t){(void 0!==e.model.get(t.eventName)?e.model.get(t.eventName).toString():void 0)!==t.stateName&&(n=!1)})),n&&c?(c=!1,d=!0,i({self:e,funcName:o,withBind:a,args:arguments})):n||t()}};r.forEach(n,function(t){!function(e){var t=e.self,i=e.event,n=e.func,o=e.listen,r=e.isListenOnce,s=e.onEventNotEqual,a=i.split(":")[0],l=i.split(":")[1],c=function(){var e=function(){};r&&(e=function(){t.model.listenToOnce(t.model,"change:".concat(a),c)}),t.model.get(a).toString()===l?n.call(t,e):r?(s(),e()):s()}.bind(t);t.model[o](t.model,"change:".concat(a),c)}({self:e,func:h,event:t,withBind:a,listen:l,isListenOnce:s,onEventNotEqual:function(){c=!0}.bind(e)})}.bind(e))}({event:n,funcName:o,isListenOnce:a,withBind:c}),r.isString(n)&&r.isString(o)){var d=a?"listenToOnce":"listenTo";n.match(":")?function(e){var t=e.self,n=e.funcName,o=e.event,r=e.withBind,s=e.listen,a=e.isListenOnce,l=o.split(":")[0],c=o.split(":")[1],d=function(){t.model.get(l).toString()==c?i({self:t,funcName:n,withBind:r,args:arguments}):a&&t.model.listenToOnce(t.model,"change:".concat(l),d)}.bind(t);t.model[s](t.model,"change:".concat(l),d)}({self:e,funcName:o,event:n,withBind:c,listen:d,isListenOnce:a}):e.model[d](e.model,"change:".concat(n),function(){i({self:e,funcName:o,withBind:c,args:arguments})}.bind(e))}}.bind(e))}}},function(e,t,i){"use strict";var n=i(4),o=i(0);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s,a=i(5),l=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.conf=t,this.log=new n.a({unitType:"Manager",className:"ScrollManager",version:this.conf.version,isDebug:this.conf.isDebug}),this.log.info("Created"),this.window=i||window,this.$window=Object(o.a)(window),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),this.scrollElement=a.isEmpty(r)?this.window:Object(o.a)(r)[0],this.$scrollElement=Object(o.a)(this.scrollElement),this.timeBetweenEvents=100,this.lastTimeStamp=0,this.lastScrollTop=0,this.pps=0,this.ppsChange=0,this.vms=1/0,this.direction=1,this.maxMSBetweenEvents=2e3,this.scrollEndTimeout=500;var s=a.throttle(this.onScroll.bind(this),this.timeBetweenEvents);this.scrollElement.addEventListener("scroll",s)}var t,i;return t=e,(i=[{key:"onScroll",value:function(e){clearTimeout(this.scrollEnd);var t=e.timeStamp-this.lastTimeStamp;this.lastTimeStamp=e.timeStamp;var i=this.$scrollElement.scrollTop()-this.lastScrollTop;this.lastScrollTop=this.$scrollElement.scrollTop(),this.direction=i<0?-1:1,t<this.maxMSBetweenEvents&&this.changePPS(i/t*1e3),a.parseBool(this.conf.isLogScroll)&&this.log.info("onScroll - pps: "+this.direction*this.pps),this.scrollEnd=setTimeout(this.onScrollEnd.bind(this),this.scrollEndTimeout)}},{key:"onScrollEnd",value:function(){a.parseBool(this.conf.isLogScroll)&&this.log.warning("onScrollEnd"),this.changePPS(0),a.forEach(this.onScrollEndCBList,function(e){e()}.bind(this))}},{key:"changePPS",value:function(e){this.ppsChange=e-this.pps,this.pps=e,0===this.pps&&(this.vms=1/0),this.vms=this.windowHeight/this.pps*1e3,a.forEach(this.onScrollPPSChange,(function(e){setTimeout(e,0)}))}},{key:"registerForPPSChange",value:function(e){this.onScrollPPSChange=this.onScrollPPSChange||[];var t=this.onScrollPPSChange.indexOf(e);return-1!==t?t:this.onScrollPPSChange.push(e)-1}},{key:"deRegisterForPPSChange",value:function(e){var t=this.onScrollPPSChange.indexOf(e);this.onScrollPPSChange.splice(t,1)}},{key:"registerForScrollEnd",value:function(e){this.onScrollEndCBList=this.onScrollEndCBList||[];var t=this.onScrollEndCBList.indexOf(e);return-1!==t?t:this.onScrollEndCBList.push(e)-1}},{key:"deRegisterForScrollEnd",value:function(e){var t=this.onScrollEndCBList.indexOf(e);this.onScrollEndCBList.splice(t,1)}}])&&r(t.prototype,i),e}();t.a=function(e,t,i){return s||(s=new l(e,t,i)),s}},function(e,t,i){"use strict";var n=i(0),o=i(3),r=i.n(o),s=i(1),a=i.n(s);function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c,d=i(5),u=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.window=t||window,this.$window=Object(n.a)(window),this.windowHeight=this.$window.height(),this.windowWidth=this.$window.width(),this.setScrollableSelector(i),this._timeBetweenEvents=100,this.keyPressMap={17:!1,18:!1,84:!1,86:!1},this._setScrollListener(),this._setMouseMoveListener(),this._setKeyPressListener(),this._setTabViewListener(),this._setOrientationChangeListener(),this._setResizeListener(),this._setTaboolaReadMoreListener()}var t,i;return t=e,(i=[{key:"_setScrollListener",value:function(){var e=d.throttle(this._trigger.bind(this,"window:scroll:change"),this._timeBetweenEvents);this.scrollSelector.addEventListener("scroll",e)}},{key:"_setMouseMoveListener",value:function(){var e=d.throttle(this._trigger.bind(this,"window:mouse:move"),this._timeBetweenEvents);this.window.addEventListener("mousemove",e)}},{key:"_setKeyPressListener",value:function(){var e=this;this.window.addEventListener("keyup",(function(t){e._trigger.bind(e,"window:key:press"),t.keyCode in e.keyPressMap&&(e.keyPressMap[t.keyCode]=!1)})),this.window.addEventListener("keydown",(function(t){t.keyCode in e.keyPressMap&&(e.keyPressMap[t.keyCode]=!0,e.keyPressMap[17]&&e.keyPressMap[18]&&e.keyPressMap[84]&&e.keyPressMap[86]&&(r.a.trigger("supportTool:event","open"),e.keyPressMap[17]=e.keyPressMap[18]=e.keyPressMap[84]=e.keyPressMap[86]=!1))}))}},{key:"_setOrientationChangeListener",value:function(){var e=d.throttle(this._trigger.bind(this,"window:orientation:change"),this._timeBetweenEvents);window.addEventListener("orientationchange",e)}},{key:"_setResizeListener",value:function(){var e=d.throttle(this._handleResizeEvent.bind(this),this._timeBetweenEvents);window.addEventListener("resize",e)}},{key:"_setTabViewListener",value:function(){this.isTabOut=document.hidden,this.window.document.addEventListener("visibilitychange",this._handleVisibilityChange.bind(this)),this.window.addEventListener("focus",this._handleTabEvents.bind(this),!0),this.window.addEventListener("blur",this._handleTabEvents.bind(this),!0)}},{key:"_handleResizeEvent",value:function(e){var t=this.$window.height(),i=t-this.windowHeight;this.windowHeight=t;var n=this.$window.width(),o=n-this.windowWidth;this.windowWidth=n,this._trigger("window:resize:change",{heightChange:i,widthChange:o})}},{key:"_handleVisibilityChange",value:function(e){this.isTabOut=document.hidden,this._handleTabEvents(e)}},{key:"_handleTabEvents",value:function(e){this.isTabOut?this._trigger("window:tab:change",a.a.TAB_STATE.tabOut):"focus"===e.type?this._trigger("window:tab:change",a.a.TAB_STATE.focus):this._trigger("window:tab:change",a.a.TAB_STATE.blur)}},{key:"_trigger",value:function(e,t){r.a.trigger(e,t)}},{key:"_setTaboolaReadMoreListener",value:function(){window._taboola=window._taboola||[],_taboola.push({listenTo:"readmore.click",handler:function(){r.a&&r.a.trigger("taboola:readmore:click")}})}},{key:"setScrollableSelector",value:function(e){this.scrollSelector="document"===e?document:d.isEmpty(e)?this.window:Object(n.a)(e)[0]}}])&&l(t.prototype,i),e}();t.a=function(e,t){return c||(c=new u(e,t)),c}},function(e,t){e.exports='<div class="_cm-video-ad" ></div>'},function(e,t,i){"use strict";var n=i(4),o=i(2);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,i,r,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.log=new n.a({unitType:this.model.get("unitType"),className:"timerService",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.doneFunction=r||function(){},this.time=s||0,this.conditions=i||{startCondition:{stateToListen:"",state:""},pauseCondition:{stateToListen:"",state:""},continueCondition:{stateToListen:"",state:""},stopCondition:{stateToListen:"",state:""},isStartOnce:!1},this._startListeningToConditions(),this.timerState=o.readyState}var t,i;return t=e,(i=[{key:"_startListeningToConditions",value:function(){this.conditions.startCondition&&(this.conditions.isStartOnce?this.model.listenToOnce(this.model,"change:"+this.conditions.startCondition.state,this.start.bind(this)):this.model.listenTo(this.model,"change:"+this.conditions.startCondition.state,this.start.bind(this))),this.conditions.pauseCondition&&this.model.listenTo(this.model,"change:"+this.conditions.pauseCondition.state,this.pause.bind(this)),this.conditions.continueCondition&&this.model.listenTo(this.model,"change:"+this.conditions.continueCondition.state,this.continue.bind(this)),this.conditions.stopCondition&&this.model.listenTo(this.model,"change:"+this.conditions.stopCondition.state,this.stop.bind(this))}},{key:"start",value:function(e,t){this.conditions.startCondition.stateToListen!==t&&"any"!==this.conditions.startCondition.stateToListen||(this.timerState=o.timerState.working,this.stTime=(new Date).valueOf(),this.timeout=setTimeout(this.done.bind(this),this.time),this.timeLeft=this.time)}},{key:"pause",value:function(e,t){if(this.timerState===o.timerState.working&&(!t||this.conditions.pauseCondition.stateToListen===t)){this.timerState=o.timerState.paused,this._clearTimer();var i=(new Date).valueOf()-this.stTime;this.timeLeft-=i}}},{key:"continue",value:function(e,t){this.timerState===o.timerState.paused&&(!t||t&&this.conditions.continueCondition.stateToListen===t)&&(this.timerState=o.timerState.working,this.timeout=setTimeout(this.done.bind(this),this.timeLeft),this.stTime=(new Date).valueOf())}},{key:"stop",value:function(e,t,i,n){this.timeout&&(n||this.conditions.stopCondition.stateToListen===t)&&(this.timerState=o.timerState.stopped,this._clearTimer())}},{key:"done",value:function(){this.timerState=o.timerState.done,this.doneFunction(),this.timeout=void 0}},{key:"getTimerState",value:function(){return this.timerState}},{key:"_clearTimer",value:function(){clearTimeout(this.timeout),this.timeout=void 0}},{key:"isTimerActive",value:function(){return this.timerState===o.timerState.working||this.timerState===o.timerState.paused}}])&&r(t.prototype,i),e}();t.a=s},function(e,t,i){"use strict";var n=i(4),o=i(2),r=i.n(o),s=i(6),a=i(29),l=i(28);function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d,u=i(5),h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.log=new n.a({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")})}var t,i;return t=e,(i=[{key:"setReportingObserver",value:function(e){if(!this.reportingObserver&&u.isObserverSupported("ReportingObserver")){var t={types:this.model.get("reportingObserver.types"),buffered:!0};this.reportingObserver=new ReportingObserver(e.bind(this),t),this.reportingObserver.observe(),this._bindUnloadEvents(e)}}},{key:"_bindUnloadEvents",value:function(e){var t=this;window.addEventListener("unload",(function(i){var n=t.reportingObserver.takeRecords();e(n)}))}}])&&c(t.prototype,i),e}(),p=function(e){return d||(d=new h(e)),d},f=i(9),m=i(1),g=i.n(m);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?T(e):t}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=i(5),P=A.now().toString(),E={video:"._cm-video-ad"},C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(s,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=S(e);if(t){var o=S(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return w(this,i)}}(s);function s(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VideoView",r=arguments.length>2?arguments[2]:void 0;return v(this,s),(t=o.call(this,e)).eligibilityService=e.eligibilityService||{},t.log=new n.a({unitType:t.model.get("unitType"),className:i,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.model.set("videoAdId",t.videoAdId),t.currModel=r||t.model,t._setVolumeAnimationTrigger(),t._bindEvents(),t._bindBlockedByExternalUnitChange(),t.viewabiltyService=new l.a({model:t.model,onViewability:t._onViewability.bind(T(t))}),t._setVideoValidator(),t._initPerformanceMonitor(),t}return t=s,(i=[{key:"_bindEvents",value:function(){}},{key:"_initPerformanceMonitor",value:function(){this.currModel.get("reportingObserver.isActive")&&(this.performanceMonitor=new p(this.currModel),this.performanceMonitor.setReportingObserver(this.reportingObserverCB.bind(this)))}},{key:"reportingObserverCB",value:function(e){var t=this,i=this.currModel.get("reportingObserver.ids");i&&i.length>0&&(e=A.filter(e,(function(e){return e.body&&e.body.id&&A.contains(i,e.body.id)}))),this.activeAd?A.forEach(e,(function(e){t._setReportingObserverAdData(e),t.activeAd.oppsService.fireBeaconOpp("reportingObserver")})):this.model.get("pixels.reportingObserver.isFire")&&this._fireReportObserverPixel(e)}},{key:"_setReportingObserverAdData",value:function(e){this.activeAd.adData.rot=e.type,this.activeAd.adData.roid=e.body&&e.body.id,this.activeAd.adData.rom=e.body&&e.body.message}},{key:"_fireReportObserverPixel",value:function(e){var t=this;A.forEach(e,(function(e){var i={debug:"rot:".concat(e.type,"!roid:").concat(e.body.id,"!rom:").concat(e.body.message,"!")},n=t.model.getPixel("pixels.reportingObserver"),o=A.addParametersToUrl(n,i,-1===n.indexOf("?"));A.isSendBeaconSupported()&&navigator.sendBeacon(o)}))}},{key:"_setVolumeEvents",value:function(){this.currModel.on("change:volumeMuted",this._handleVolume.bind(this)),this.model.get("components.volume.isActive")&&this.currModel.on("change:onUnMuteClicked",this._fireUserAdUnmuted.bind(this)),this.currModel.get("autoplaySoundOn")?(this._bindOnHoverListeners(),this.checkVolumeStatus()):this.createStateHandlers([{event:"autoplaySoundOn:true",funcName:"_bindOnHoverListeners",isListenOnce:!0},{event:"autoplaySoundOn:true",funcName:"checkVolumeStatus",isListenOnce:!0}])}},{key:"checkVolumeStatus",value:function(){this.currModel.get("autoplaySoundOn")&&"on"===this.currModel.get("volume")?(this.log.info("Unmute first video because volume=on"),this.currModel.set("volumeMuted",!1)):this.currModel.set("volumeMuted",!0)}},{key:"hide",value:function(){this.$el.hide()}},{key:"show",value:function(){this.$el.show()}},{key:"close",value:function(){this.model.set("closeState",r.a.closeState.videoViewClosed)}},{key:"_customize",value:function(){var e=this.model.get("additionalCss");this.$el.css(A.toCssObj(e))}},{key:"_rePosition",value:function(e,t){this.$el.css(t)}},{key:"_onLoadingClick",value:function(){this.ui.video[0].id=this.videoAdId,this.replayAd()}},{key:"replayAd",value:function(){this.model.get("isReplayAd")&&this.repeatingAd&&(this.activeAd=this.repeatingAd,this.activeAd.vpaidWrapper.restartAd(),this._resizeRepeatingAd(),this.activeAd.setToModel("adQState",r.a.adQState.repeating,this.repeatingAd.adId),this.activeAd.setToModel("adState",r.a.adState.repeating,this.repeatingAd.adId)),this.model.set("isAdClosedByTimer",!1)}},{key:"_onLearnMoreClick",value:function(){this.repeatingAd&&this.repeatingAd.onLearnMoreClick()}},{key:"_onMouseEnter",value:function(){this.activeAd&&(this.activeAd.unmute(),this.currModel.set("volumeMuted",!1))}},{key:"_onMouseLeave",value:function(){this.activeAd&&(this.activeAd.mute(),this.currModel.set("volumeMuted",!0))}},{key:"_handleVolume",value:function(){this.activeAd&&(this.currModel.get("volumeMuted")?this.activeAd.mute():this.activeAd.unmute())}},{key:"_fireUserAdUnmuted",value:function(){this.currModel.get("onUnMuteClicked")&&this.activeAd&&this.activeAd.oppsService.fireUserAdUnmuted()}},{key:"onAdComplete",value:function(){this.setRepeatingAd(),this.activeAd=void 0,this.model.get("isMultiAd")?this.checkEligible():this.model.set("closeState",r.a.closeState.terminate)}},{key:"checkEligible",value:function(){this.model.get("isInTab")&&this.isEligibleToPlay()?(this.activeAd||this.getReadyAd(),this.activeAd&&this.playAd()):this.activeAd&&this.activeAd.pause()}},{key:"isEligibleToPlay",value:function(){return this.model.get("isEligibleToPlay")}},{key:"getReadyAd",value:function(){this.model.get("hasReadyAd")&&(this.model.get("volumeMuted")||this.model.get("wurfl.os.name")!==g.a.OS.IOS||this.model.set("volumeMuted",!0),this.activeAd=this.model.getNextAd(),-1===this.model.get("unitType").indexOf("RECO_REEL_WIDGET")&&this.model.set("aspectRatioNum",this.activeAd.getAspectRatioNum()),this.postGetAd())}},{key:"postGetAd",value:function(){}},{key:"playAd",value:function(){this.log.info("@@play ad",this.model.get("unitType")),this.activeAd&&(this.log.info("Play Ad !!!!",this.activeAd),this.activeAd.play(),this.activeAd.isUsed||(this.activeAd.isUsed=!0),this.model.get("components.volume.isActive")&&setTimeout(this._fireVolumeStateCheck.bind(this),0),this.viewabiltyService.updateActiveAd(this.activeAd))}},{key:"pauseAd",value:function(){this.activeAd&&this.activeAd.pause()}},{key:"_onViewability",value:function(){this.log.info("Viewability reached")}},{key:"_addDisclosureText",value:function(){(this.model.get("components.disclosureText.isActive")||this.model.get("detachToSlider.components.disclosureText.isActive"))&&(this.disclosureTextView=new a.a({model:this.model,container:this.el}),this.disclosureTextView.render())}},{key:"_fireVolumeStateCheck",value:function(){this._startAnimationOnce(),this._handleVolume(),this.currModel.trigger("lastVolumeStateCheck")}},{key:"_setVolumeAnimationTrigger",value:function(){var e=this;this._startAnimationOnce=A.once((function(){e.currModel.trigger("startVolumeAnimation")}))}},{key:"_unBindOnHoverListeners",value:function(){this.el.onmouseenter=null,this.el.onmouseleave=null}},{key:"_bindOnHoverListeners",value:function(){this.currModel.get("autoplaySoundOn")&&"onHover"===this.currModel.get("volume")&&!this.currModel.get("volumeUserInteraction")&&(this.el.onmouseenter=this._onMouseEnter.bind(this),this.el.onmouseleave=this._onMouseLeave.bind(this),this.currModel.on("change:volumeUserInteraction",this._unBindOnHoverListeners.bind(this)))}},{key:"setRepeatingAd",value:function(){this.model.get("isReplayAd")&&this.activeAd&&this.activeAd.vpaidWrapper.isReplayable?this.repeatingAd=this.activeAd:this.repeatingAd=null}},{key:"_bindBlockedByExternalUnitChange",value:function(){this.currModel.on("change:blockedByExternalUnit",this._onBlockedByExternalUnitChange.bind(this))}},{key:"_onBlockedByExternalUnitChange",value:function(){this.currModel.get("blockedByExternalUnit")?(this.pauseAd(),this.activeAd&&this.activeAd.fireAdOppOnce("adPausedOtherUnitIsPlaying")):this.checkEligible()}},{key:"_resizeRepeatingAd",value:function(){var e=this;setTimeout((function(){var t=e.isDetached?e.model.get("detachToSlider.width"):e.model.get("width"),i=e.isDetached?e.model.get("detachToSlider.height"):e.model.get("height");e.activeAd.vpaidWrapper.resizeAd(t,i)}),0)}},{key:"_setVideoValidator",value:function(){this.model.get("videoValidator.isActive")&&(this.eligibilityValidator=new f.e({model:this.model}))}},{key:"id",get:function(){return"_cm-css-reset"}},{key:"videoAdId",get:function(){return P}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=E},set:function(e){return this.UI=e}}])&&b(t.prototype,i),s}(s.b);t.a=C},function(e,t,i){"use strict";var n=i(6),o=i(0),r=i(4),s=i(67),a=i.n(s),l=i(68),c=i.n(l),d=i(8),u=i(1),h=i.n(u),p=i(2);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=i(5),_="_cm-native-ad",w={title:"._cm-native-ad-title",ctaButtone:"._cm-native-ad-cta-button",description:"._cm-native-ad-description",icon:"._cm-native-ad-icon",branding:"._cm-native-ad-branding",adChoice:"._cm-ad-choice",placeholder:"._cm-feed-manager-video-placeHolder",wrapper:"._cm-native-ad-bottom"},T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(s,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=v(e);if(t){var o=v(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return y(this,i)}}(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=n.call(this,e)).model=e.model,t.globalModel=e.globalModel,t.shouldHideBrandingText=e.shouldHideBrandingText||!1,t.shouldFitToSize=e.shouldFitToSize||!1,t.isMultiFloatingNASElements=e.isMultiFloatingNASElements||!1,e.additionalCss&&t._addAdditionalCss(e.additionalCss),t.log=new r.a({unitType:t.model.get("unitType"),className:constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.template=t._isTitleOnTop()?c.a:a.a,t.container=Object(o.a)(e.container),t.nativeAdMapping=t.globalModel.get("nativeAdMapping"),(t.model.get("stickyCard.isActive")||!t.model.get("detachToSlider.isStartFromSlider")&&!t.model.get("detachToSlider.isDetachToSlider"))&&(t.isSticky=!0,t._setToModel("floatingNAS.isActive",!1)),t.bindEvents(),t}return t=s,(i=[{key:"_setToModel",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.model.set(e,t,i),this.globalModel&&this.globalModel.set(e,t,i)}},{key:"_render",value:function(){this.renderTemplate(),this._adjustRTL(),this.$el.addClass(_),this.container.append(this.$el),this._addAdChoiceTitle(),this.rendered=!0}},{key:"_adjustRTL",value:function(){var e=this._getCssFromSelector(this.model.get("rboxCssSelectors.title"));e&&"rtl"===e.direction&&(this.ui.wrapper.css({"flex-direction":"row-reverse",direction:"ltr"}),this.ui.icon.addClass("_cm-native-ad-icon-rtl").removeClass("_cm-native-ad-icon"))}},{key:"bindEvents",value:function(){this.createStateHandlers([{event:"adNativeSettings",funcName:"_updateAdData"},{event:"repeatState:".concat(p.repeatState.hiding),funcName:"show"},{event:"loadingViewState:".concat(p.loadingViewState.hiding),funcName:"show"},{event:"floatingView:".concat(p.floatingView.detach),funcName:"detach"},{event:"floatingView:".concat(p.floatingView.attach),funcName:"attach"},{event:"floatingView:".concat(p.floatingView.postAttach),funcName:"postAttach"},{event:"floatingView:".concat(p.floatingView.permanentClosed),funcName:"permanentClosed"}])}},{key:"_updateAdData",value:function(){this.rendered||this._render(),this.adNativeSettings=this.model.get("adNativeSettings"),this._displayTitleOnTop(),this._setRandomTitle(),this._handleBranding(),this.isClickable=this.adNativeSettings.isClickable;var e=this.model.get("rboxCssSelectors.title");this._updateContainerViewTitleVisibility(),this._adjustDescFontToTitleFont(e),this._updateTitleContainerEl(this.ui.ctaButtone,this.adNativeSettings[this.nativeAdMapping.ctaButtone],"",this.model.get("customization.cta")),this._updateTitleContainerEl(this.ui.title,this.adNativeSettings[this.nativeAdMapping.title],e,this.model.get("customization.title")),this._updateTitleContainerEl(this.ui.description,this.adNativeSettings[this.nativeAdMapping.description],this.model.get("rboxCssSelectors.description"),this.model.get("customization.description")),this._updateTitleContainerEl(this.ui.branding,this.adNativeSettings[this.nativeAdMapping.branding],this.model.get("rboxCssSelectors.branding"),this.model.get("customization.branding")),this._updateIcon(this.adNativeSettings[this.nativeAdMapping.icon]),this._createFloatingNAS(),this._isSuperSlider()?this.hide():this.show(),this._fitToSize(),this.adDataUpdated=!0,this.model.trigger("nativeAdSettingsUpdated")}},{key:"_setRandomTitle",value:function(){this.model.get("getRandomNativeAdTitle")&&!this.adNativeSettings[this.nativeAdMapping.title]&&(this.adNativeSettings[this.nativeAdMapping.title]=b.getRandomFromList(this.model.get("randomTitlesList")))}},{key:"_displayTitleOnTop",value:function(){var e=this;this._isTitleOnTop()&&(this.model.set("isTitleOnTop",!0),this.model.set("getRandomNativeAdTitle",!1),this._displayTitleOnly(),Object(o.a)(this.ui.title).css({"max-width":"340px"}),setTimeout((function(){return Object(o.a)(e.ui.title).css({"max-width":"225px"})}),2e3))}},{key:"_isTitleOnTop",value:function(){return this.model.get("unitType").indexOf("RECO_REEL_WIDGET")>-1&&this.model.get("frameType")===h.a.FRAME_TYPE.amp&&this.model.get("showTitleOnTop")}},{key:"_handleBranding",value:function(){this.shouldHideBrandingText&&(this.containerHeight=this.containerHeight||Object(o.a)("._cm-widget-item").height(),this.model.trigger("change:customization.titleContainer.branding.displayState",this._hasNASTitle()?p.brandingDisplayState.hide:p.brandingDisplayState.show))}},{key:"_fitToSize",value:function(){if(this.shouldFitToSize)if(this.hasNAS=this._hasNASTitle(),this.hasNAS){if(!this.detached){this.fitToSizeDisplaying=h.a.NATIVE_AD.FIT_TO_SIZE.NONE;var e=this.model.get("videoPlaceholderSize");this.containerHeight&&e&&(this._canFitTitleAndDescription(e)?this._canFitTitleOnly(e)?(this.fitToSizeDisplaying=h.a.NATIVE_AD.FIT_TO_SIZE.TITLE,this._displayTitleOnly(),this.model.trigger("displayingNASTitleOnly")):this.hide():(this.fitToSizeDisplaying=h.a.NATIVE_AD.FIT_TO_SIZE.FULL,this.show(),this.model.trigger("displayingFullNAS")))}}else this.hide()}},{key:"_canFitTitleAndDescription",value:function(e){return Number(e.height)+this.$el.height()>=this.containerHeight}},{key:"_canFitTitleOnly",value:function(e){return Number(e.height)+this.ui.title.height()<this.containerHeight}},{key:"_displayTitleOnly",value:function(){this.ui.title.show(),this.ui.description.hide(),this.ui.ctaButtone.hide(),this.ui.branding.hide(),this.ui.icon.hide(),this.container.height(this.containerHeight)}},{key:"_isSuperSlider",value:function(){return this.model.get("detachToSlider.isStartFromSlider")&&this.model.get("detachToSlider.isDetachToSlider")}},{key:"_updateContainerViewTitleVisibility",value:function(){var e=this.adNativeSettings.title||this.adNativeSettings.ctatext||this.adNativeSettings.desc||this.adNativeSettings.sponsored,t=this.container.find("._cm-ad-title");e?(t.hide(),this.ui.adChoice.show()):(t.show(),this.ui.adChoice.hide())}},{key:"_adjustDescFontToTitleFont",value:function(e){var t=this.model.get("customization.description");if(!t)try{var i=parseInt(this._getCssFromSelector(e).fontSize);isNaN(i)||(t={},b.extend(t,{"font-size":i*h.a.NATIVE_AD.DESC_TITLE_FONT_RATIO+"px"}),this.model.set("customization.description",t))}catch(e){this.log.info("No title selector found - apply default values")}}},{key:"_updateTitleContainerEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(e.text(t),t)this._applyCssFromSelector(e,i,n),e.show();else{var o=e===this.ui.ctaButtone;o&&e.hide()}this._updateTitleContainerClickability(e)}},{key:"_applyCssFromSelector",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=b.pick(this._getCssFromSelector(t),h.a.CSS_PROPERTIES_FROM_RBOX);b.extend(n,i),e.css(b.toCssObj(n))}},{key:"_getCssFromSelector",value:function(e){if(!e)return{};var t="string"==typeof e?document.querySelector(e):e;return t&&getComputedStyle(t)}},{key:"_updateTitleContainerClickability",value:function(e){this.isClickable?(e[0].onclick=this._onClick.bind(this),e.css({cursor:"pointer"}),e.attr("role","link")):(e[0].onclick=null,e.css({cursor:"default"}),e.removeAttr("role"))}},{key:"_onClick",value:function(e){var t=e.target.getAttribute("data-click-name");this.model.set("nativeAdClick",t,{silent:!0}),this.model.trigger("change:nativeAdClick",t)}},{key:"_updateIcon",value:function(e){e?(this.iconImg||this._createIconImg(),this.iconImg.src=e,this._updateTitleContainerClickability(this.ui.icon),this.ui.icon.show()):this.ui.icon.hide()}},{key:"_createIconImg",value:function(){this.iconImg=document.createElement("img"),this.iconImg.className="_cm-native-ad-icon-img",this.iconImg.setAttribute("data-click-name","adIconClick"),this.iconImg.addEventListener("error",this._onError.bind(this)),this.ui.icon.css(b.toCssObj(b.extend({},this.model.get("customization.icon")))),this.ui.icon.append(this.iconImg)}},{key:"_onError",value:function(){this.log.error("can't load native ad icon"),this.ui.icon.hide()}},{key:"_addAdChoiceTitle",value:function(){this.model.get("components.adChoice.isActive")&&this.model.get("components.adChoice.title.isActive")&&(this.adChoice=new d.a({model:this.model,container:this.ui.adChoice,parent:this.el,type:h.a.AD_CHOICE_TYPE.TITLE}))}},{key:"_addAdditionalCss",value:function(e){Object(o.a)(this.el).addClass(e)}},{key:"hide",value:function(){this.$el.hide()}},{key:"show",value:function(){this._isSuperSlider()||this.$el.show()}},{key:"_createFloatingNAS",value:function(){this.globalModel.get("floatingNAS.isActive")&&(this.hasNAS=this._hasNASTitle(),this.hasNAS&&(this.isMultiFloatingNASElements&&this._removePreviousFloatingNASElement(),this.ui.floatingNAS={},this._createFloatingNASWrapper(),this._createFloatingNASTitle(),this._appendFloatingNAS()))}},{key:"_removePreviousFloatingNASElement",value:function(){this.ui.floatingNAS&&this.ui.floatingNAS.wrapper&&this.ui.floatingNAS.wrapper.parentElement.removeChild(this.ui.floatingNAS.wrapper)}},{key:"_createFloatingNASWrapper",value:function(){this.ui.floatingNAS.wrapper=document.createElement("div"),this.ui.floatingNAS.wrapper.className="".concat(w.wrapper.replace(/^\./,"")," _cm-native-ad-bottom-floating"),this.shouldFitToSize&&!this.detached&&Object(o.a)(this.ui.floatingNAS.wrapper).addClass("hide"),this.ui.floatingNAS.wrapper.style.width=this.model.get("detachToSlider.width")+"px"}},{key:"_createFloatingNASTitle",value:function(){this.ui.floatingNAS.title=this.ui.title[0].cloneNode(!0),this.ui.floatingNAS.title.className+=" _cm-native-ad-title-floating"}},{key:"_appendFloatingNAS",value:function(){this.ui.floatingNAS.wrapper.appendChild(this.ui.floatingNAS.title),this._getActiveAd().appendChild(this.ui.floatingNAS.wrapper)}},{key:"_getActiveAd",value:function(){return document.getElementsByClassName("_cm-ad-active")[0]||this.container.get(0)}},{key:"_getFloatingView",value:function(){return document.getElementsByClassName("_cm-floating-view")[0]}},{key:"_hasNASTitle",value:function(){return"string"==typeof this.adNativeSettings[this.nativeAdMapping.title]}},{key:"detach",value:function(){this.isSticky?this.hide():this.shouldFitToSize&&this.fitToSizeDisplaying===h.a.NATIVE_AD.FIT_TO_SIZE.NONE||(this.detached=!0,this.hasNAS&&(this.ui.floatingNAS.wrapper.style.width=this.model.get("detachToSlider.width")+"px",this.ui.floatingNAS.wrapper.className=this.ui.floatingNAS.wrapper.className.replace(" hide","")))}},{key:"attach",value:function(){this.isSticky||this.shouldFitToSize&&this.fitToSizeDisplaying===h.a.NATIVE_AD.FIT_TO_SIZE.NONE||this.hasNAS&&this.detached&&(this.ui.floatingNAS.wrapper.style.width=this.model.get("width")+"px")}},{key:"postAttach",value:function(){this.isSticky?this._displayFitToSizeNAS():this.shouldFitToSize&&this.fitToSizeDisplaying===h.a.NATIVE_AD.FIT_TO_SIZE.NONE||(this.hasNAS&&this.detached&&(this._handleActiveAdWithoutNAS(),this.ui.floatingNAS.wrapper.className+=" hide",this._displayFitToSizeNAS()),this.detached=!1)}},{key:"_displayFitToSizeNAS",value:function(){this.shouldFitToSize&&this.fitToSizeDisplaying!==h.a.NATIVE_AD.FIT_TO_SIZE.NONE&&(this.fitToSizeDisplaying===h.a.NATIVE_AD.FIT_TO_SIZE.TITLE?this._displayTitleOnly():this.fitToSizeDisplaying===h.a.NATIVE_AD.FIT_TO_SIZE.FULL&&this.show())}},{key:"triggerDetachIfRendered",value:function(){this.adDataUpdated&&this.model.trigger("nativeAdSettingsUpdated")}},{key:"getFloatingNASHeight",value:function(){return this.ui.floatingNAS&&this.ui.floatingNAS.wrapper?this.ui.floatingNAS.wrapper.getBoundingClientRect().height:0}},{key:"getNASHeight",value:function(){return this.shouldFitToSize&&this.fitToSizeDisplaying!==h.a.NATIVE_AD.FIT_TO_SIZE.NONE?this.fitToSizeDisplaying===h.a.NATIVE_AD.FIT_TO_SIZE.TITLE?this.ui.title.height():this.$el.height():0}},{key:"onAdComplete",value:function(){this.prevAdNAS=this.hasNAS,this.adDataUpdated=!1,this.hasNAS&&this.detached&&(this._handleFloatingViewWithoutNAS(),this._isSuperSlider()&&this._handleActiveAdWithoutNAS())}},{key:"onAdDisplayChange",value:function(){if(this.hasNAS&&this.detached){if(this.prevAdNAS&&this._isSuperSlider())return;this._handleFloatingViewWithNAS(),this._isSuperSlider()&&this._handleActiveAdWithNAS()}}},{key:"onAdSwapped",value:function(){this.hasNAS=this._hasNASTitle()||this._isActiveAdContainNAS(),this.detached&&this.hasNAS!==this.prevAdNAS&&(this.hasNAS?this._handleFloatingViewWithNAS():(this._handleFloatingViewWithoutNAS(),this._handleActiveAdWithNAS())),this.prevAdNAS=this.hasNAS}},{key:"_handleFloatingViewWithNAS",value:function(){var e=this._getFloatingView();e&&(e.style.bottom=parseInt(e.style.bottom)+this.getFloatingNASHeight()+"px")}},{key:"_handleFloatingViewWithoutNAS",value:function(){var e=this._getFloatingView();e&&(e.style.bottom=Math.max(parseInt(e.style.bottom)-this.getFloatingNASHeight(),0)+"px")}},{key:"_handleActiveAdWithNAS",value:function(){var e=this._getActiveAd();e&&(e.style.height=parseInt(e.style.height)+this.getFloatingNASHeight()+"px")}},{key:"_handleActiveAdWithoutNAS",value:function(){var e=this._getActiveAd();if(e){var t=parseInt(e.style.height);t>this.model.get("videoPlaceholderSize").height&&(e.style.height=t-this.getFloatingNASHeight()+"px")}}},{key:"_isActiveAdContainNAS",value:function(){var e=this._getActiveAd();return!!e&&e.getElementsByClassName("_cm-native-ad-bottom-floating").length>0}},{key:"permanentClosed",value:function(){this._isSuperSlider()&&this.hide()}},{key:"hideFloatingNAS",value:function(){this.detached&&this.ui.floatingNAS&&Object(o.a)(this.ui.floatingNAS.wrapper).addClass("hide")}},{key:"showFloatingNAS",value:function(){this.detached&&this.ui.floatingNAS&&Object(o.a)(this.ui.floatingNAS.wrapper).removeClass("hide")}},{key:"className",get:function(){return _}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=w},set:function(e){return this.UI=e}}])&&m(t.prototype,i),s}(n.b);t.a=T},function(e,t,i){"use strict";var n=i(0),o=i(4);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=i(5),a=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.oppsOptions=i,this.options={"auc-dast":void 0,dast:void 0,d:void 0,dp:void 0,os:void 0,pv:void 0,pt:void 0,rs:void 0,rst:void 0,st:void 0,sts:void 0,tms:void 0,vmt:void 0,vpd:void 0,vptd:void 0},this.options=s.extend(this.options,t),this.log=new o.a({className:"Opportunity Manager"}),this.pixelType={tagStarted:0,tagImpression:1,tagTimeout:2,tagError:4,playerClosed:7,AdVideoFirstQuartile:21,AdVideoMidpoint:22,AdVideoThirdQuartile:23,AdVideoComplete:24,viewability:30,firstImpression:99}}var t,i;return t=e,(i=[{key:"send",value:function(e,t){var i=this.isBillableEvent(e.rst)?this.oppsOptions.oppUrl:this.oppsOptions.nonBllbOppUrl;i+="?rst="+e.rst,e=s.extend({},this.options,{tms:Math.floor((new Date).getTime()/1e3)},e),t&&s.isSendBeaconSupported()?navigator.sendBeacon(i,JSON.stringify([e])):n.a.ajax({type:"POST",url:i,data:JSON.stringify([e]),contentType:"text/plain"})}},{key:"isBillableEvent",value:function(e){return this.oppsOptions.billableEvents.indexOf(e)>-1}}])&&r(t.prototype,i),e}();t.a=a},function(e,t,i){"use strict";var n=i(3),o=i.n(n),r=i(10),s=i.n(r),a=i(7),l=i.n(a),c=i(1),d=i.n(c),u=i(2),h=i.n(u),p=i(5);t.a=o.a.DeepModel.extend({STATE:{READY:0,GOT_AD:1,PLAYING:2,PAUSED:3,PAUSED_BY_USER:4,STOPPED_BY_USER:5,DETACHED:6,ATTACHED:7,DONE:8,PLAYER_READY:9,PLAYER_CLOSE:10,PLAYER_STOP:11,AD_STOPPED:12,OPT_OUT:13,OPEN_WITH_PAUSE:14,WAITING_FOR_EXPAND:15,REPEAT_STAND_BY:16,REPEAT_SPINNING:17,SKIPPED_BY_USER:18},defaults:{abTest:"",adMaxPlaySeconds:181,adTitle:"Video",adVolume:"auto",aspectRatio:"16:9",aspectRatioNum:"{{defaultAspectRatioNum}}",defaultAspectRatioNum:16/9,autoPlay:!0,baseReportD:"basebanner.com",oppsDataCenter:"la",cfr:0,country:"",clickTestSeconds:.5,defaultAdParameters:"",defaultTagTimeout:20,gaFactor:1e4,gaFrameSrc:"{{urls.base}}/release-r1/assets/ga.html#page={{gaVertical}}&category={{gaVertical}}",gaVertical:"source",height:0,interruptLoading:!0,ip:"",isAllowDuplicateKey:!0,isDebug:!1,isFirePixel:!0,isHideIframe:!1,isMobile:!1,isMobileMacros:!1,isPlayerViewable:!1,isProtectedInIframe:!0,isRepeat:!0,isResponsive:!0,isCallIDLE:!1,isShowOnAd:!1,isShowOnAdLocation:"begin",isSoundOnHover:!1,isUnitEligible:!1,isUnitViewable:!1,isUseObserver:!1,isUseNonNativeObserver:!1,kbnul:"//vidanalytics.taboola.com",lineItemId:"",loaderImage:"",logViewabilityCalc:!1,mfp:4,mobilePlayer:"DP",mobileSpriteTimeoutSeconds:20,mute:!0,noaop:2,noDebugReport:!1,openingEffect:0,originId:15,placement:"",playerContainer:"body",playerEndSeconds:0,playerVolume:0,printCurrentViewPercent:!1,predefinedSettings:{level:1},repeat:!0,retriesLWF:5,reportTimerSeconds:10,ronPercent:5,secondsBW:10,secondsInView:2,secondsLWF:.1,secondsToClose:0,secondsToCloseGlobal:0,sortOrderType:0,state:null,timeBetweenAds:1,totalTimeout:60,traceViewabilitySeconds:2,traceViewability100Seconds:2,ulog:[""],vastRetry:2,version:"158_allow_sec",vertical:"source",viewabilityPercent:50,volumeMuted:!0,wfManual:!1,volume:"onHover",width:0,maxVimpsInQueue:2,autoplayDetectorTimeoutSec:1,billableEvents:[1,21,22,23,24,25,30,32],useSwfVideoJs:!0,isPWOV:!1,frameType:d.a.FRAME_TYPE.plainPage,"100viewPercent":100,mpgclrslv:["gcdn.2mdn.net"],cnvsldrt:5,gtvid:"//cnv.tcsrv.com/getvid?url",playerTextAlign:!0,cookieMatchActive:!1,fmNoAboveSelector:"no-vabove",fmNoBelowSelector:"no-vbelow",vForce:{isActive:!1,getAdTimeoutSeconds:10},detach:{width:320,position:{horizontal:"right",vertical:"bottom"}},customization:{unitContainer:{},adTitle:{},placeHolder:{},playerView:{}},midrollCollapse:{isActive:!1,time:5},pixels:{D2DFallback:{id:31468623,type:5,isFire:!0},conversion:{id:31425418,type:2,isFire:!0},close:{id:31579687,type:5,isFire:!0},timeout:{id:31574457,type:5,isFire:!0},optOut:{id:31530958,type:5,isFire:!0},optOutNever:{id:31419288,type:5,isFire:!0},addImpresion:{id:31579657,type:5,isFire:!0},eligible:{id:31579697,type:16,isFire:!0},networkError:{type:42},lostEligibility:{type:43,isFire:!0},fraudDetection:{type:32},clickthrough:{type:44},error:{id:31608187,type:5,isFire:!0},quarterly1:{id:31608197,type:5,isFire:!0},quarterly2:{id:31608207,type:5,isFire:!0},quarterly3:{id:31608217,type:5,isFire:!0},complete:{id:31608237,type:5,isFire:!0},render:{id:31608177,type:5,isFire:!0},startWithABT:{id:31589837,type:45,isFire:!1},repeatClick:{type:46},renderOnDemand:{type:51},stopUnit:{type:52},getAdAny:{type:53,isFire:!1},getAdNoRV:{type:54,isFire:!1},getAd:{type:55,isFire:!1},secondsToCloseTimer:{type:56,isFire:!1},secondsToCloseGlobalTimer:{type:57,isFire:!1},midrollCollapseTimer:{type:58,isFire:!1},attach:{type:61},detach:{type:62},D2DClick:{type:63},D2DClickSuspicious:{type:68},TRCResetCloseUnit:{type:64},sliderFeedStartWithABT:{type:65},onParentSelectorLost:{type:66},adChoice:{type:67},noCMPonPage:{type:72},hasCMPonPage:{type:73,isFire:!0},rvHandlerTimerExpired:{type:74},onPlayerHasRVinQ:{type:75},skippedDistancePredict:{type:76},publisherVideoDetected:{type:78},publisherIframeVideoDetected:{type:79},compDetectedOnPage:{type:80},feedxToggle:{type:82},testPixels:{type:100},fullEligibilityPredict:{type:77,isFire:!1},progressLoaderInit:{type:83},progressLoaderMove:{type:84},progressLoaderClose:{type:85},organicCardInjected:{type:86},organicCardInjectionFail:{type:87},terminateOnResize:{type:89},unitDelayed:{type:93},unitLoadAfterDelay:{type:94},autoplaySoundOn:{type:95},generalError:{type:96},exploreMore:{type:98},passbackFunctionCalled:{type:99,isFire:!0},onUnitDimensionsFound:{type:116},onVideoResetCloseUnit:{type:117},forcedDetach:{type:118},unitLoaded:{type:120},unitLoadedWithFill:{type:121},feedHasNoCardsToOpen:{type:122},recoReelNotFound:{type:127,name:"recoReelNotFound",isFire:!0},misplacedVideoDetected:{type:132,isFire:!0},reportingObserver:{type:134,name:"reportingObserver",isFire:!1},overlayDetectedAfterImpression:{type:135,name:"overlayDetectedAfterImpression",isFire:!1,factor:0},validEligibility:{type:136,name:"validEligibility",isFire:!1},noAdjacInFirstWFs:{type:140,name:"noAdjacInFirstWFs",isFire:!0},url:"//conv{{dataCenter}}mp.{{baseReportD}}/st"},closeButton:{hasCloseButton:!0,secondsToCloseButton:5},urls:{base:"//vidstat.taboola.com",staticImage:""},player:{versions:{vplayer:"v12.1.1",content:"26_1_18m"},urls:{vplayerLocation:"{{urls.base}}/vpaid/vPlayer",vpaidLocation:"{{player.urls.vplayerLocation}}/vpaidjs/{{player.versions.vplayer}}/main-vpaid.js",playerLocation:"{{player.urls.vplayerLocation}}/player/{{player.versions.vplayer}}",contentVideosLocation:"//vidstat.taboola.com/vid",oppsBasePath:"//opps.{{baseReportD}}",nonBllbOppsBasePath:"//{{oppsDataCenter}}-vid-events.taboola.com",oppsRequest:"{{player.urls.oppsBasePath}}/OpportunityServlet",nonBllboppsRequest:"{{player.urls.nonBllbOppsBasePath}}/OpportunityServlet",wfBasePath:"//wf.{{baseReportD}}",domainWfBasePath:"//{{oppsDataCenter}}-wf.{{baseReportD}}",wfRequest:"{{player.urls.wfBasePath}}/VideoBidRequestHandlerServlet"},settings:{dlgverr:!0},b2b:1,bfFactor:15,hasAdControls:!0,hasBFeature:!0,hasControls:!0,isBypassFlash:!0,isFire99:!0,isFlashPlayer:!0,minVpaidRunTime:4},components:{D2DFallbackView:{pubId:127968,pubTagId:756668,height:"{{height}}",width:"{{width}}",location:"//15.{{baseReportD}}/WhiteLabelBidRequestHandlerServlet"},OptOut:{hasOptOut:!0,pubId:0,pubTagId:0,imageLocation:"{{urls.base}}/fp/img/closeVideo.png"},CloseButtonView:{hasCloseButton:!1,delay:1500,imageLocation:"{{urls.base}}/assets/x-close-24.png"},TimerView:{hasTimer:!1,time:3,countdownAction:"closeButton"},DetachButtonView:{hasDetuchView:!1,time:1,imageLocation:"{{urls.base}}/assets/ContractButton32.png"},Repeat:{isActive:!1,repalyIcon:"{{urls.base}}/assets/replay-button.svg",replayHoverIcon:"{{urls.base}}/assets/replay-button-hover.svg",learnMoreIcon:"{{urls.base}}/assets/learn-more-button.svg",learnMoreHoverIcon:"{{urls.base}}/assets/learn-more-button-hover.svg",backgroundImage:"{{urls.base}}/assets/blurry-image.png"},PosterView:{isActive:!1,imageLocation:"{{urls.base}}/img/play_image_4.jpg",defaultLocation:"{{urls.base}}/img/play_image_3.jpg"},Loading:{type:"img",imgUrl:"{{urls.base}}/assets/loading2.png",staticUrl:"{{urls.base}}/assets/repeat1.PNG"},contentVideo:{loadingImgae:"{{components.Loading.imgUrl}}",muteImgUrl:"{{urls.base}}/assets/video_controls/desk_muted2.svg",unmuteImgUrl:"{{urls.base}}/assets/video_controls/desk_playing2.svg",pauseImgUrl:"{{urls.base}}/assets/video_controls/pause2.svg"},contentCarousel:{backgroundImage:"{{urls.base}}/img/play_image_3.jpg"}},content:{playClicked:!0},noSoundBrowsers:{chrome:{minVersion:66},safari:{minVersion:11},firefox:{minVersion:66}},microServices:{base_url:"//vidstat.taboola.com/",async:!0,oppsula:{version:"1.2.8"},videoElement:{version:"2.2.17"},autoplayDetector:{version:"1.0.0"}},ms_data:{opps_base_path:"//{{oppsDataCenter}}-vid-events.taboola.com"},style:{videoBackgroundColor:"black"},isUseCrossUnitCommunication:!0,isObserveCrossUnitCommunication:!0,isUpdateCrossUnitCommunication:!0,blockedByExternalUnit:!1,playingNowString:"NOW <br/> PLAYING"},storage:{},initialize:function(){this.log=new s.a({unitType:this.get("unitType"),className:"BaseUnitModel"}),this._parseFrameType();var e=this.get("demo");e&&this.set("preset.demo",e),this.get("isDebug")&&this.set("preset.isDebug",1);var t=this.get("isFireAllPixels");t&&this.set("preset.isFireAllPixels",t);var i=this.get("predictorsPresets");i&&this.set("preset.predictorsPresets",i);var n=this._getSettingsByConditions();this.set(n.preset);var o=this._getPresets(l.a.pms);for(var r in this.log.info("Presets Settings: ",[o.weakerThenSetByCon,o.strongerThenSetByCon]),o.weakerThenSetByCon)this.set(o.weakerThenSetByCon[r].presetData);for(var a in this.set(n.settings),o.strongerThenSetByCon)this.set(o.strongerThenSetByCon[a].presetData);this._setUrlParameters(),this._processPushArray(),this.get("baseReport")&&this.get("oppsBasePath)")&&this.set("oppsBasePath",this.get("baseReport")),this.set("isUseObserverChanged",!1),this.get("isUseObserver")&&!p.isObserverSupported("IntersectionObserver",this.get("isUseNonNativeObserver"))&&(this.set("isUseObserver",!1),this.set("isUseObserverChanged",!0)),this.get("isUseObserverForCardLocator")&&!p.isObserverSupported("IntersectionObserver",this.get("isUseNonNativeObserver"))&&this.set("isUseObserverForCardLocator",!1),this.volume=this.get("volume"),this.set("volume","off"),this._bindEvents(),this.log.info("unit model created:",this.attributes),this._handleABTest(),this._handleLiteUnitPixels(),(this.get("isApiPassbackExist")||this.get("onPassback"))&&(this.set("dlywf",!1),this.set("player.settings.rvfrquesttsemttr","any")),"body"===String(this.get("videoContainerSelector")).toLowerCase()&&this.set("videoContainerSelector",!1),this._setQueriesFunctions(),this._setCrossUnitCommunication()},get:function(e){var t=o.a.DeepModel.prototype.get.call(this,e);if(!t||"string"!=typeof t)return t;for(var i=t.match(/\{\{(.*?)\}\}/g);i;){for(var n=0;n<i.length;n++){var r=i[n].substr(2,i[n].length-4),s=o.a.DeepModel.prototype.get.call(this,r);s||(s=""),t=t.replace(i[n],s)}i=t.match(/\{\{(.*?)\}\}/g)}return t},_setQueriesFunctions:function(){var e=this;p.forEach(d.a.UNIT_QUERY_LANGUAGE.SUPPORTED_CONFIG_FLAGS,(function(t){var i=e.get("".concat(t,".restrictions"));p.forEach(i,(function(i,n,o){var r="".concat(t,".restrictions.").concat(n),s=e.get("".concat(r,".queries"));if(s){var a=e.get("".concat(r,".default"));a=p.isBoolean(a)?a:'"'.concat(a,'"');var l=e._getQueryFunction(s,a);e.set("".concat(r,".decisionFunction"),l)}}))}))},_getQueryFunction:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n="";p.forEach(e,(function(e){n+=t._getQueryIfStatment(e)})),i=void 0!==i?"return ".concat(i,";"):"";var o="".concat(n,"\n").concat(i);return new Function("model","activeAd",o)},_getQueryIfStatment:function(e){var t=e.rule,i=e.valueIfTrue;return i=p.isBoolean(i)?i:'"'.concat(i,'"'),p.forEach(d.a.UNIT_QUERY_LANGUAGE.MAPPING,(function(e){t=t.split(e.search).join(e.replaceWith)}),this),"if(".concat(t,"){return ").concat(i,"};\n")},getPixel:function(e){!this.pixel&&this._createPixel();var t=this.get(e);if("pixels.conversion"===e&&o.a.trigger("global:creativeEvent",{type:"conversion"}),t.isFire)return this.pixel({type:t.type||"",pixelId:t.id,timestamp:Date.now(),subUnit:this.get("subUnitType")})},_createPixel:function(){var e=this.get("pixels.url")+"?cijs=convusmp&ttype={{type}}&cisd=convusmp&cipid="+this.get("cipid")+"&crid="+this.get("creativeId")+"&dast="+this.get("dast")+"&cmcv=&pix={{pixelId}}&cb={{timestamp}}&uv="+this.get("unitVersion")+"&tms={{timestamp}}&su={{subUnit}}";this.get("abTest")&&(e+="&abt="+this.get("abTest")),this.get("referrerUrl")&&(e+="&ru="+this.get("referrerUrl")),e+="&ft="+this.get("frameType"),e=this._addPixelParameter("tagCpmFloor","cft",e),e=this._addPixelParameter("unitId","blid",e),e=this._addPixelParameter("unitName","unm",e),e=this._addPixelParameter("debugKey1","dk1",e),e=this._addPixelParameter("debugKey2","dk2",e),e=this._addPixelParameter("order","order",e),this.pixel=p.template(e)},_addPixelParameter:function(e,t,i){return(this.get(e)||0===this.get(e)||!1===this.get(e))&&(i+="&"+t+"="+this.get(e)),i},getImpressionPixel:function(){this.get("player.isFire99")},_getSchedule:function(e,t,i){return{roll_type:e,url:this.get("player.urls.vpaidLocation"),volume:"on"===this.get("volume")?100:0,mute:"on"!==this.get("volume"),oid:this.get("originId"),mfp:this.get("mfp"),sortOrderType:this.get("sortOrderType"),ad_parameters:JSON.stringify(this.get("demandConfig")),pubid:t,tagid:i,defaultTagTimeout:this.get("defaultTagTimeout"),totaltimeout:this.get("totalTimeout"),noaop:this.get("noaop"),skip_vast:!0}},_handleABTest:function(){if(this.get("abTest")&&this.get("pixels.startWithABT.isFire")){window.cmTag.customDataForTest.startWithABT=!0;var e={debug:"pn:!sqg:!torgn:"+(window.performance.timeOrigin?window.performance.timeOrigin:"")+"!ts:"+Date.now()};p.firePixel(this.getPixel("pixels.startWithABT"),"AB Test started",e)}},_handleLiteUnitPixels:function(){p.firePixel(this.getPixel("pixels.unitLoaded"),"Unit loaded from lite unit",{mntl:this.get("preset.level")}),p.firePixel(this.getPixel("pixels.unitLoadedWithFill"),"Unit loaded from lite unit with fill")},_processPushArray:function(){var e=this.get("pushedArr")||[];"FEED_MANAGER"!==this.get("unitType")&&"INLINE_FEED"!==this.get("unitType")&&"MSN_WIDGET"!==this.get("unitType")&&"WIDGET_ITEM"!==this.get("unitType")||this._setFeedManagerSubType(e);var t={};if(e)for(var i in e.forEach((function(e){var i=Object.keys(e)[0];t[i]||(t[i]=[]),t[i].push(e[i])})),t){var n=t[i],o=this.get(i);o&&n.push(o);var r=n.sort().join("!");this.set(i,r)}},_setFeedManagerSubType:function(e){var t=this.get("stickyCard.isActive"),i=this.get("detachToSlider.isDetachBelow"),n=this.get("detachToSlider.isDetachAbove"),o=this.get("detachToSlider.isStartFromSlider"),r=this.get("detachToSlider.isDetachToSlider"),s="ufm";t||o||r?t||!o||r?t||o||!r?!t&&o&&r?s+="_vD":t&&i&&!n?s+="_vE":t&&!i&&n?s+="_vF":t&&i&&n&&(s+="_vG"):s+="_vC":s+="_vB":s+="_vA",e.push({abTest:s})},_removeSoundOnHover:function(){var e,t=this.get("wurfl.browser.name").toLowerCase(),i=this.get("wurfl.browser.version"),n=this.get("noSoundBrowsers");n&&n[t]&&(e=n[t].minVersion),i>=e&&this.set("volume","off")},setStorage:function(e,t){this.storage[e]=t},getStorage:function(e){return this.storage[e]},setNextAd:function(e){this.setStorage("nextAd",e)},getNextAd:function(){var e=this.getStorage("nextAd");return e&&(this.log.info("NEXT AD TYPE = "+parseInt(e.adData.requiredViewability?"1":"0"),e),e.isUsed=!0),this.setStorage("nextAd",void 0),setTimeout(this.set.bind(this,"hasReadyAd",!1),0),e},getNextAdRv:function(){var e=this.getStorage("nextAd");if(e)return e.adData.requiredViewability},peekNextAd:function(){return this.getStorage("nextAd")},_bindEvents:function(){this.on("change:getAdState",this._onAdImpression)},_onAdImpression:function(){"gotAd"!==this.get("getAdState")||this._gotAd||(this.log.info("Triggering filledImpression event."),o.a.trigger("filledImpression",{lineItemId:this.get("lineItemId"),placement:this.get("placement"),redId:this.get("redId")}),this._gotAd=!0)},_setUrlParameters:function(){for(var e,t,i,n=this._getWindow(),o=n.location.href.slice(n.location.href.indexOf("?")+1).split("&"),r=0;r<o.length;r++)0===(t=(e=o[r].split("="))[0]).indexOf("cm_")&&(t=t.slice(3),i=decodeURIComponent(e[1]),this.set(t,i))},_getWindow:function(){var e=this.get("isStayInIframe"),t=this.get("iframeData");return!0===e&&p.isInFriendlyIframe(t)||!p.getTopWindow?window:p.getTopWindow()},_getPresets:function(e){var t={strongerThenSetByCon:[],weakerThenSetByCon:[]},i=this.get("isMobile")?"Mobile":"Desktop";for(var n in this.get("preset")){var o=e.getPreset({key:n,value:this.get("preset.".concat(n)),unitType:this.get("unitName"),platform:i});o&&(o.strength>100?t.strongerThenSetByCon.push(o):t.weakerThenSetByCon.push(o))}return t.strongerThenSetByCon=p.sortBy(t.strongerThenSetByCon,"strength"),t.weakerThenSetByCon=p.sortBy(t.weakerThenSetByCon,"strength"),t},increaseCounter:function(e){var t=this.get(e);t?t++:t=1,this.set(e,t)},decreaseCounter:function(e){var t=this.get(e);!t||t<=0||(t--,this.set(e,t))},_parseFrameType:function(){var e=d.a.FRAME_TYPE.plainPage;void 0!==window.taboolaMobile?e=d.a.FRAME_TYPE.inApp:window.TRC&&window.TRC.isAMP?e=d.a.FRAME_TYPE.amp:p.isInIframe(this.get("iframeData"))&&(e=p.isInFriendlyIframe(this.get("iframeData"))?d.a.FRAME_TYPE.friendlyIframe:d.a.FRAME_TYPE.nonFriendlyIframe),this.set("frameType",e),this.set("player.settings.frameType",e)},_getSettingsByConditions:function(){var e={preset:{},settings:{}},t=this.get("settingsByConditions");if(t&&t.length>0)for(var i=0;i<t.length;i++){var n=t[i].conditions,o=t[i].settings;if(this._checkConditions(n))for(var r in o)-1!==r.indexOf("preset")?e.preset[r]=o[r]:e.settings[r]=o[r]}return e},_checkConditions:function(e){for(var t=!0,i=0;i<e.length;i++)if(e[i].val&&"function"==typeof e[i].val){var n=e[i].val(this);this.get(e[i].key)!==n&&(t=!1)}else this.get(e[i].key)!==e[i].val&&(t=!1);return t},fireUnitDelayedPixel:function(){p.firePixel(this.getPixel("pixels.unitDelayed"),"unit delayed")},fireUnitLoadAfterDelayPixel:function(){p.firePixel(this.getPixel("pixels.unitLoadAfterDelay"),"unit delayed")},isLoadcomponent:function(e,t){return this.get("displayFiller."+t)===e},appendArray:function(e,t,i){var n=this.get(e);p.isArray(n)||(n=[]),i&&n.includes(t)||(n.push(t),this.set(e,n))},handleAutoPlayData:function(e){this.log.info("autoplayDetector returned",e),this.set("AutoPlayDetectorData",e),e&&e.unmuted&&e.unmuted.supported?(this.set("volume",this.volume),this.set("autoplaySoundOn",!0)):(this.set("volume","off"),this.set("autoplaySoundOn",!1)),this.log.info("Unit set volume to: ",this.get("volume"))},_setStickyCardParams:function(){this.set("detachToSlider.isDetachAbove",!1),this.set("detachToSlider.isDetachBelow",!0),this.set("detachToSlider.isDetachToSlider",!0),this.set("detachToSlider.isStartFromSlider",!1),this.set("animation.detach",150)},_setCrossUnitCommunication:function(){if(this.get("isUseCrossUnitCommunication")){if(0===document.querySelectorAll("._cm-communication-input").length){var e=document.createElement("div");e.className="_cm-communication-input",e.setAttribute("data-unit-info",""),document.querySelector("body").appendChild(e)}this._observeCrossUnitCommunication()}},_observeCrossUnitCommunication:function(){if(this.get("isObserveCrossUnitCommunication")){var e=document.querySelector("._cm-communication-input");this.crossUnitCommunicatioObserver=new MutationObserver(this._updateCrossUnitData.bind(this)),this.crossUnitCommunicatioObserver.observe(e,{attributes:!0,childList:!1,subtree:!1}),this.on("closeState:".concat(h.a.closeState.terminate),this._stopCrossUnitCommunicationObserver),this._updateCrossUnitData()}},_updateCrossUnitCommunication:function(e){this.get("isUseCrossUnitCommunication")&&this.get("isUpdateCrossUnitCommunication")&&document.querySelector("._cm-communication-input").setAttribute("data-cross-unit-info",JSON.stringify(e))},_updateCrossUnitData:function(e,t){var i=document.querySelector("._cm-communication-input").dataset.crossUnitInfo;i&&i.unit!==this.get("unitType")&&this.set("crossUnitInfo",JSON.parse(i))},_stopCrossUnitCommunicationObserver:function(){this.crossUnitCommunicatioObserver.disconnect()}})},function(e,t){e.exports='<div class="_cm-ad-title"></div>\n<div class="_cm-inline-video">\n</div>'},function(e,t){e.exports='<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- Generator: Adobe Illustrator 22.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<svg version="1.1" id="_x2014__x5F_1" xmlns="http://www.w3.org/2000/svg"\n     xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 99 99" xml:space="preserve">\n      <style type="text/css">.st0 {\n          fill: #FFFFFF;\n      }</style>\n    <g>\n     <g stroke="null" id="svg_1">\n      <g stroke="null" id="svg_2">\n       <path stroke="null" id="svg_3" d="m82.77256,91.4817c-1.64243,0 -3.25444,-0.644 -4.50148,-1.9964l-65.57555,-69.42328c-2.49406,-2.6404 -2.49406,-6.92301 0,-9.56341c2.49406,-2.6404 6.53931,-2.6404 9.03337,0l65.57555,69.45548c2.49406,2.6404 2.49406,6.92301 0,9.56341c-1.24703,1.3202 -2.88946,1.9642 -4.53189,1.9642z" class="st0"/>\n      </g>\n      <g stroke="null" id="svg_4">\n       <path stroke="null" id="svg_5" d="m17.19702,91.4817c-1.64243,0 -3.25444,-0.644 -4.50148,-1.9964c-2.49406,-2.6404 -2.49406,-6.92301 0,-9.56341l65.57555,-69.42328c2.49406,-2.6404 6.53931,-2.6404 9.03337,0c2.49406,2.6404 2.49406,6.92301 0,9.56341l-65.57555,69.45548c-1.24703,1.3202 -2.88946,1.9642 -4.53189,1.9642z" class="st0"/>\n      </g>\n     </g>\n    </g>\n</svg>'},function(e,t,i){"use strict";var n=i(21),o=i(2),r=i(27),s=(i(12),i(1)),a=i.n(s),l=i(0),c=(i(3),i(5));t.a=n.a.extend({defaults:l.a.extend(!0,{},n.a.prototype.defaults,{bfFactor:0,isMultiAd:!0,kibanaEventsToSend:"all",runWfWhenEmpty:!0,viewPercent:20,wfDynamicPause:!1,isCheckTopParentSelectorLost:!0,predictors:{isGet1OnlyAfterAdLoaded:!1,autoKill:{isActive:!0},bForce:{isActive:!1,predictPoints:1},getAdFail:{isActive:!0,allowedPredictPoints:"any"},multiAd:{isActive:!0,predictPoints:{}},emptyQueue:{isActive:!0,predictPoints:"any"},loading:{isActive:!0,predictPoints:"any"},repeat:{isActive:!0,predictPoints:"any"},playerReady:{isActive:!0,predictPoint:0},distancePercent:{isActive:!1,predictPoints:{}},distancePixels:{isActive:!1,predictPoints:{}},firstScroll:{isActive:!1,predictPoints:0},fullEligibility:{isActive:!1,predictPoints:1,maxPPS:1,checkPredictsSeconds:.5},intersection:{isActive:!1},feedX:{isActive:!0,predictPoints:"any"}},playPriority:{type:"ppKey",key:1,checkForRvPriority:"onEligibility"},vForce:{isActive:!0,getAdTimeoutSeconds:60,secondsToGetAdFail:{0:60,1:60}},player:{urls:{blankLocation:"{{player.urls.contentVideosLocation}}/blackScreen60.mp4",contentLocation:"{{urls.base}}/content{{player.versions.content}}.js",contentImagesLocation:"{{player.urls.contentVideosLocation}}/img"},hasAdControls:!0,settings:{queue_size:6,max_ready_vpaid:3,mprdct:.025,isMultiVpaidUnit:!1},playlist:[]},rboxCssSelectors:{title:".video-label.video-title",description:".video-label.video-description",branding:".video-label-box .branding"},secondsToWaitForRV:5,timeBetweenDetectionCompSeconds:5,maxTriesForDetectingComp:10,renderLearnMore:!0,nativeAdMapping:{title:"title",ctaButtone:"ctatext",description:"desc",branding:"sponsored",icon:"icon"},isViewableAMP:!1,isUseAmpObserver:!1}),initialize:function(){n.a.prototype.initialize.call(this),this.set("player.playlist",[{url:this.get("player.urls.blankLocation"),name:"Blank",title:"Blank",type:"video/mp4"}]),this.get("isEligibilityNomination")&&(this._initBforce(),this.RvHandler=new r.a(this)),this.get("frameType")!==a.a.FRAME_TYPE.plainPage?(window.taboolaBridge||(this.set("predictors.distancePixels.isActive",!1),this.set("predictors.distancePixels.isStartWF",!1)),this.set("predictors.distancePercent.isActive",!1),this.set("predictors.distancePercent.isStartWF",!1)):(this.set("predictors.intersection.isActive",!1),this.set("predictors.intersection.isStartWF",!1)),window.category=this.get("category"),c.loadJs(this.get("player.urls.contentLocation"),this._onContentLoad.bind(this))},_initBforce:function(){this.set("startListenToEligibility",!1),this.listenTo(this,"change:preEligibility",this._onPreEligibility.bind(this)),this.listenTo(this,"change:playerHasRvInQ",this._onHasPotentialAd.bind(this)),this.listenTo(this,"change:gotNonRvAd",this._onHasPotentialAd.bind(this))},_onHasPotentialAd:function(){this.get("rvHandlerState")!==o.rvHandlerState.working&&this.get("preEligibility")&&(this.get("playerHasRvInQ")?this.RvHandler.onPreEligibility():this.get("gotNonRvAd")&&this.set("startListenToEligibility",!0))},_onPreEligibility:function(){this.get("rvHandlerState")!==o.rvHandlerState.working&&(this.get("playerHasRvInQ")?this.RvHandler.onPreEligibility():this.get("gotNonRvAd")&&this.set("startListenToEligibility",!0))},getScheduleArr:function(){var e=[];return e.push(this._getSchedule("pre-roll",this.get("pubId"),this.get("pubTagId"))),e},_onContentLoad:function(){window.playlist.forEach((function(e,t,i){i[t].image=this.get("player.urls.contentImagesLocation")+"/"+e.image,i[t].title=e.title.replace(/([A-Z])/g,"$1").replace(/^./,(function(e){return e.toUpperCase()})),i[t].url=this.get("player.urls.contentVideosLocation")+"/"+i[t].filename,i[t].name=i[t].filename,i[t].type="video/mp4"}),this),this.set("player.playlist",window.playlist)},isVerticalVideoEnabled:function(e){return(e||this.get("videoPlaceholderSize.width"))<=this.get("verticalWidthThreshold")}})},function(e,t,i){"use strict";var n=i(21),o=i(0),r=(i(1),i(5));t.a=n.a.extend({defaults:o.a.extend(!0,{},n.a.prototype.defaults,{contentLoadType:"content",category:"travel",isPlaylist:!1,secondsBW:17,isMultiAd:!0,contentCallback:function(){},pixels:{D2DFallback:{id:31468623,type:5,isFire:!0}},player:{urls:{contentLocation:"{{urls.base}}/content{{player.versions.content}}.js",contentImagesLocation:"{{player.urls.contentVideosLocation}}/img"},settings:{queue_size:6,max_ready_vpaid:3,mprdct:.025},playlist:[]},components:{D2DFallbackView:{location:"//15.{{baseReportD}}/WhiteLabelBidRequestHandlerServlet",width:0,height:0},ClickTrough:{isActive:!1}}}),initialize:function(){n.a.prototype.initialize.call(this),"mrss"===this.get("contentLoadType")?o.a.ajax({url:this.get("player.urls.contentLocation"),dataType:"xml",success:this._onMrssLoad.bind(this)}):"direct"===this.get("contentLoadType")?this.set("player.playlist",[{id:0,title:"",link:"",url:this.get("player.urls.contentLocation")||this.get("pVideoUrl"),type:"video/mp4",image:""}]):(window.category=this.get("category"),r.loadJs(this.get("player.urls.contentLocation"),this._onContentLoad.bind(this))),this.set("pubId",this.get("preroll.pubId")),this.set("pubTagId",this.get("preroll.pubTagId"))},_onMrssLoad:function(e){var t=[];Object(o.a)(e).find("item").each((function(e,i){i=Object(o.a)(i);var n={};n.id=e,n.title=i.find("title").text(),n.link=i.find("link").text(),n.url=i.find("media\\:content,content").attr("url"),n.type=i.find("media\\:content,content").attr("type"),n.image=i.find("media\\:thumbnail,thumbnail").attr("url"),t.push(n)})),this.set("player.playlist",t)},_onContentLoad:function(){window.playlist.forEach((function(e,t,i){i[t].image=this.get("player.urls.contentImagesLocation")+"/"+e.image,i[t].title=e.title.replace(/([A-Z])/g,"$1").replace(/^./,(function(e){return e.toUpperCase()})),i[t].url=this.get("player.urls.contentVideosLocation")+"/"+i[t].filename,i[t].name=i[t].filename,i[t].type="video/mp4"}),this),this.set("player.playlist",window.playlist)},getScheduleArr:function(){var e=[];return e.push(this._getSchedule("pre-roll",this.get("preroll.pubId"),this.get("preroll.pubTagId"))),e.push(this._getSchedule("mid-roll",this.get("midroll.pubId"),this.get("midroll.pubTagId"))),e.push(this._getSchedule("post-roll",this.get("postroll.pubId"),this.get("postroll.pubTagId"))),e}})},function(e,t,i){"use strict";i.r(t);var n=i(4),o=i(6),r=i(11),s=i.n(r);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h(e);if(t){var o=h(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u(this,i)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p,f=i(5),m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a,e);var t,o,r=d(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this)).model=e.model||{},t.log=new n.a({unitType:t.model.get("unitType"),className:constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.configHierarchy=t._getConfigHierarchy(),t}return t=a,(o=[{key:"_getConfigHierarchy",value:function(){return f.sortBy(s.a,(function(e){return e.priority})).reverse()}},{key:"getConfig",value:function(e){var t={};for(var i in this.configHierarchy){var n=this.configHierarchy[i].name,o=e[n],r=s.a[n];o&&r&&(this.log.info("creating config for",n),f.extend(t,this._getDefaultConfig(n)),f.extend(t,this._getUnitConfig(n)))}return t}},{key:"getConfigForKey",value:function(e){var t={},i=s.a[e]&&s.a[e].name;return i&&(this.log.info("creating config for",i),f.extend(t,this._getDefaultConfig(i)),f.extend(t,this._getUnitConfig(i))),t}},{key:"_getDefaultConfig",value:function(e){var t=s.a[e].defaultConfigFile;return this.loadFile(t)}},{key:"_getUnitConfig",value:function(e){var t=this.model.get("unitType"),i=s.a[e]&&s.a[e].unitsConfigFiles,n=i&&i[t];return this.loadFile(n)}},{key:"loadFile",value:function(e){if(e)return i(82)("./".concat(e.replace("./","").replace(".js",""))).default}}])&&l(t.prototype,o),a}(o.a);t.default=function(e){return p||(p=new m(e)),p}},function(e,t,i){"use strict";var n=i(4),o=i(2),r=i(6),s=(i(7),i(14));function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h(e);if(t){var o=h(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u(this,i)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a,e);var t,i,r=d(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).model=e,t.log=new n.a({unitType:t.model.get("unitType"),className:"RvHandler",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.model.set("rvHandlerState",o.readyState),t.maxPPS=t.model.get("predictors.bForce.maxPPS"),t.scrollManager=new s.a,t._bindEvents(),t}return t=a,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"gotRvAd:true",funcName:"_gotRvAd"}])}},{key:"onPreEligibility",value:function(){var e=this.maxPPS&&Math.abs(this.scrollManager.pps)>this.maxPPS,t=this.model.get("rvHandlerState")!==o.rvHandlerState.working;if(e)return this.log.warning("Scroll speed is too high",this.scrollManager.pps),void this.scrollManager.registerForPPSChange(this._onPPSChange.bind(this));if(t){this.model.set("rvHandlerState",o.rvHandlerState.working),this.model.set("canGetRv",!0);var i=1e3*this.model.get("secondsToWaitForRV");this._startTimer(i)}}},{key:"_onPPSChange",value:function(){this.maxPPS&&Math.abs(this.scrollManager.pps)<=this.maxPPS&&(this.log.info("Scroll speed decreased - continue with bForce flow"),this.scrollManager.deRegisterForPPSChange(this._onPPSChange),this._onPPSDecreased())}},{key:"_onPPSDecreased",value:function(){this.model.get("lostEligibilityTime")?(this.log.info("lostEligibility - checking if gotNonRvAd",this.model.get("gotNonRvAd")),this.model.get("gotNonRvAd")&&(this.log.info("got non-RV ad - start listening to eligibility"),this.model.set("startListenToEligibility",!0))):(this.log.info("isEligibleToPlay - calling onPreEligibility"),this.onPreEligibility())}},{key:"_startTimer",value:function(e){this.model.set("rvHandlerTimerExpired",!1),this.timeout=setTimeout(this._onFailToGetAd.bind(this),e)}},{key:"_onFailToGetAd",value:function(){this.model.set("canGetRv",!1),this.model.set("playerHasRvInQ",!1),this.model.set("rvHandlerTimerExpired",!0),this.model.set("rvHandlerState",o.rvHandlerState.idle),this.log.info("Timer over - failed getting RV ad"),this.model.get("adManagerState")===o.adManagerState.hasAds&&this.model.set("startListenToEligibility",!0)}},{key:"_gotRvAd",value:function(){clearTimeout(this.timeout),this.timeout=void 0,this.model.set("rvHandlerState",o.rvHandlerState.idle),this.model.set("startListenToEligibility",!0),this.log.info("Got RV Ad - started listening to eligibility")}}])&&l(t.prototype,i),a}(r.a);t.a=p},function(e,t,i){"use strict";i(0),i(3);var n=i(6),o=i(4),r=i(2),s=i(1);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=h(e);if(t){var o=h(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u(this,i)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(a,e);var t,i,n=d(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=n.call(this,e.model)).model=e.model,t.log=new o.a({unitType:t.model.get("unitType"),className:"viewabilityService",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.timers={},t.isAmp=t.model.get("frameType")===s.FRAME_TYPE.amp&&t.model.get("isUseAmpObserver"),t.onViewability=e.onViewability||function(){},t}return t=a,(i=[{key:"updateActiveAd",value:function(e){this.activeAdId!==e.adId&&(this.activeAd||this._bindEvents(),this.activeAd=e,this.activeAdId=e.adId,this.activeAd.supportVideoCurrentTimeEvents&&this.model.get("isUseNewViewabilityCalc")?this._bindPlay():this._startViewabilityTimers())}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"activeAdCurrentTime",funcName:"_checkViewability"},{event:"isViewable:true",funcName:"_updateViewabilityTimes"},{event:"isViewable100",funcName:"_update100ViewabilityTime"},{event:"videoViewState:".concat(r.videoViewState.detached),funcName:"_update100ViewabilityTime"}]),this.isAmp&&this.createStateHandlers([{event:"isViewableAMP:true",funcName:"_updateAMPViewabilityTime"},{event:"isViewableAMP:false",funcName:"_onNoViewabilityAMP"}])}},{key:"_bindPlay",value:function(){this.model.get("adState")===r.adState.playing?this._startTestingViewability():this.createStateHandlers([{event:"adState:".concat(r.adState.playing),funcName:"_startTestingViewability",isListenOnce:!0}])}},{key:"_startTestingViewability",value:function(){this._updateViewabilityTimes(),this._checkViewability(),this._bindPause()}},{key:"_updateViewabilityTimes",value:function(){this._updateViewabilityTime(),this._updateOneSecViewabilityTime(),this._update100ViewabilityTime(),this.isAmp&&this._updateAMPViewabilityTime()}},{key:"_updateViewabilityTime",value:function(){if(this.model.get("isViewable")||this.model.get("videoViewState")===r.videoViewState.detached){var e=this.model.get("activeAdCurrentTime");this.activeAdViewabilityTime=e+this.model.get("traceViewabilitySeconds")}else this.activeAdViewabilityTime=void 0}},{key:"_updateOneSecViewabilityTime",value:function(){if(this.model.get("isViewable")||this.model.get("videoViewState")===r.videoViewState.detached){var e=this.model.get("activeAdCurrentTime");this.activeAdOneSecViewabilityTime=e+1}else this.activeAdOneSecViewabilityTime=void 0}},{key:"_update100ViewabilityTime",value:function(){if(this.model.get("isViewable100")||this.model.get("videoViewState")===r.videoViewState.detached){var e=this.model.get("activeAdCurrentTime");this.activeAd100ViewabilityTime=e+this.model.get("traceViewabilitySeconds")}else this.activeAd100ViewabilityTime=void 0}},{key:"_updateAMPViewabilityTime",value:function(){if(this.model.get("isViewableAMP")){var e=this.model.get("activeAdCurrentTime");this.activeAdAMPiewabilityTime=e+this.model.get("traceViewabilitySeconds")}else this.activeAdAMPiewabilityTime=void 0}},{key:"_checkViewability",value:function(){if(this.activeAd){var e=this.model.get("activeAdCurrentTime");this._checkNormalViewability(e),this._checkOneSecViewability(e),this._check100Viewability(e),this.isAmp&&this._checkAmpViewability(e)}}},{key:"_checkNormalViewability",value:function(e){this._testViewability(this.model.get("isViewable"),e,this.activeAdViewabilityTime,this.activeAd.isViewed)&&this._onViewability()}},{key:"_checkOneSecViewability",value:function(e){this._testViewability(this.model.get("isViewable"),e,this.activeAdOneSecViewabilityTime,this.activeAd.isViewedOneS)&&this._onViewabilityOneS()}},{key:"_check100Viewability",value:function(e){this._testViewability(this.model.get("isViewable100"),e,this.activeAd100ViewabilityTime,this.activeAd.isViewed100)&&this._onViewability100()}},{key:"_checkAmpViewability",value:function(e){this._testViewabilityAMP(this.model.get("isViewableAMP"),e,this.activeAdAMPiewabilityTime,this.activeAd.isViewedAMP)&&this._onViewabilityAMP()}},{key:"_testViewability",value:function(e,t,i,n){return(e||this.model.get("videoViewState")===r.videoViewState.detached)&&t>=i&&!n}},{key:"_testViewabilityAMP",value:function(e,t,i,n){return e&&t>=i&&!n}},{key:"_bindPause",value:function(){this.model.get("adState")===r.adState.paused?this._stopAllViewability():this.createStateHandlers([{event:"adState:".concat(r.adState.paused),funcName:"_stopAllViewability",isListenOnce:!0}])}},{key:"_stopAllViewability",value:function(){this._bindPlay()}},{key:"_onViewability",value:function(){this.activeAd&&(this.isAmp||this.activeAd.onViewability(),this.onViewability())}},{key:"_onViewabilityOneS",value:function(){this.activeAd&&this.activeAd.onViewabilityOneS()}},{key:"_onViewability100",value:function(){this.activeAd&&this.activeAd.onViewability100()}},{key:"_onViewabilityAMP",value:function(){this.activeAd&&this.activeAd.onViewability()}},{key:"_onNoViewabilityAMP",value:function(){this.activeAd&&this.activeAd.onNoViewabilityAMP()}},{key:"_startViewabilityTimers",value:function(){this.model.get("isViewable")||this.model.get("videoViewState")===r.videoViewState.detached?this._startViewabilityTime():this.createStateHandlers([{event:"isViewable:true",funcName:"_startViewabilityTime"},{event:"isViewable:false",funcName:"_clearViewabilityTime"},{event:"videoViewState:detached",funcName:"_startViewabilityTime",isListenOnce:!0}]),(this.model.get("isViewable100")||this.model.get("videoViewState")===r.videoViewState.detached)&&this._startViewability100Time(),this.createStateHandlers([{event:"videoViewState:detached",funcName:"_startViewability100Time",isListenOnce:!0},{event:"isViewable100:true",funcName:"_startViewability100Time"},{event:"isViewable100:false",funcName:"_clearViewability100"},{event:"adState:".concat(r.adState.paused),funcName:"clearAllViewabilityTimers",isListenOnce:!0}]),this.isAmp&&this.createStateHandlers([{event:"isViewableAMP:true",funcName:"_startViewabilityAMPTime"},{event:"isViewableAMP:false",funcName:"_clearViewabilityAMP"}])}},{key:"_startViewabilityTime",value:function(){if(!this.activeAd.isViewed&&this.activeAd){var e=this.model.get("traceViewabilitySeconds");this._startViewabilityTimer(s.TIMER_NAMES.viewability,this._onViewabilityOld.bind(this),e),this._startViewabilityTimer(s.TIMER_NAMES.viewabilityOneS,this._onViewabilityOneSOld.bind(this),1),this.isAmp&&(this.model.get("isViewableAMP")?this._startViewabilityTimer(s.TIMER_NAMES.viewabilityAMP,this._onViewabilityAMPOLD.bind(this),e):this._onNoViewabilityAMP())}}},{key:"_startViewability100Time",value:function(){if(!this.activeAd.isViewed&&this.activeAd){var e=this.model.get("traceViewability100Seconds");this._startViewabilityTimer(s.TIMER_NAMES.viewability100,this._onViewability100Old.bind(this),e)}}},{key:"_startViewabilityAMPTime",value:function(){if(!this.activeAd.isViewed&&this.activeAd){var e=this.model.get("traceViewabilitySeconds");this._startViewabilityTimer(s.TIMER_NAMES.viewabilityAMP,this._onViewabilityAMPOld.bind(this),e)}}},{key:"_startViewabilityTimer",value:function(e,t,i){this.timers[e]||(this.timers[e]=setTimeout(t,1e3*i))}},{key:"clearAllViewabilityTimers",value:function(){this._clearViewabilityTime(),this._clearViewability100(),this.isAmp&&this._clearViewabilityAMP()}},{key:"_clearViewabilityTime",value:function(){this._clearViewabilityTimer(s.TIMER_NAMES.viewability),this._clearViewabilityTimer(s.TIMER_NAMES.viewabilityOneS)}},{key:"_clearViewability100",value:function(){this._clearViewabilityTimer(s.TIMER_NAMES.viewability100)}},{key:"_clearViewabilityAMP",value:function(){this._clearViewabilityTimer(s.TIMER_NAMES.viewabilityAMP),this._onNoViewabilityAMPOLD()}},{key:"_clearViewabilityTimer",value:function(e){this.timers[e]&&(clearTimeout(this.timers[e]),this.timers[e]=void 0)}},{key:"_onViewabilityAMPOLD",value:function(){this.timers[s.TIMER_NAMES.viewabilityAMP]=void 0,this.activeAd.onViewability()}},{key:"_onNoViewabilityAMPOLD",value:function(){this.timers[s.TIMER_NAMES.viewabilityAMP]=void 0,this.activeAd.onNoViewabilityAMP()}},{key:"_onViewabilityOld",value:function(){this.timers[s.TIMER_NAMES.viewability]=void 0,this.isAmp||this.activeAd.onViewability()}},{key:"_onViewabilityOneSOld",value:function(){this.timers[s.TIMER_NAMES.viewabilityOneS]=void 0,this.activeAd.onViewabilityOneS()}},{key:"_onViewability100Old",value:function(){this.timers[s.TIMER_NAMES.viewability100]=void 0,this.activeAd.onViewability100()}},{key:"_onViewabilityAMPOld",value:function(){this.timers[s.TIMER_NAMES.viewabilityAMP]=void 0,this.activeAd.onViewability()}}])&&l(t.prototype,i),a}(n.a);t.a=p},function(e,t,i){"use strict";var n=i(13),o=i(62),r=i.n(o),s=i(3),a=(i(5),i(10));t.a=s.View.extend({className:"_cm-disc-text",id:"_cm-css-reset",initialize:function(e){this.log=new a({unitType:e.unitType,className:"disclosureTextView"}),this.disclosureText=r.a,this.container=e.container,this._rendered=!1,this._bindEvents(),this.createStateHandlers=n.a},render:function(){this._rendered||(this._rendered=!0,this.container.appendChild(this.el),"detached"===this.model.get("videoViewState")?this.model.get("detachToSlider.components.disclosureText.isActive")?this.show():this.hide():this.model.get("components.disclosureText.isActive")?this.show():this.hide())},_bindEvents:function(){(this.model.get("detachToSlider.isStartFromSlider")||this.model.get("detachToSlider.isDetachToSlider"))&&this.listenTo(this.model,"change:videoViewState",this._onVideoViewStateChange)},_onVideoViewStateChange:function(e,t){switch(t){case"detached":0==this.model.get("detachToSlider.components.disclosureText.isActive")?this.hide():this.show();break;case"attached":this.model.get("components.disclosureText.isActive")?this.show():this.hide()}},hide:function(){this.$el.hide()},show:function(){var e="detached"===this.model.get("videoViewState")?this.model.get("detachToSlider.components.disclosureText.text"):this.model.get("components.disclosureText.text");this.$el[0].innerHTML="",this.$el.append(this.disclosureText.replace("{text}",e)),this.$el.show()}})},function(e,t,i){"use strict";var n=i(6),o=i(8),r=i(2),s=i(1),a=i.n(s),l=i(4),c=i(0),d=i(64),u=i.n(d);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=i(5),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(s,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g(e);if(t){var o=g(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return m(this,i)}}(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=n.call(this,e)).log=new l.a({unitType:t.model.get("unitType"),className:"ContentVideoView",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.model=e.model,t.container=e.container,t.$el.css({display:"none"}),t.isHidden=!0,Object(c.a)(t.container).append(t.$el),t._addContentStyleObserver(),t.contentTimer=null,t.model.get("repeat")&&t.model.set("components.contentVideo.isRepeat",!0),t.handleMouseActivity(),t.bindRenderShowEvents(),t}return t=s,(i=[{key:"bindRenderShowEvents",value:function(){var e=[];this.model.get("displayFiller.beforeAd")===a.a.DISPLAY_FILLER.BEFORE_AD.CONTENT&&e.push({event:"player.playlist",funcName:"render"}),this.model.get("displayFiller.betweenAds")===a.a.DISPLAY_FILLER.BETWEEN_ADS.CONTENT&&e.push({event:"adQState:completed",funcName:"render"}),this.model.get("displayFiller.onTimeout")===a.a.DISPLAY_FILLER.ON_TIMEOUT.CONTENT&&e.push({event:"closeTimer:midrollCollapse",funcName:"render"}),e.length>0&&e.push({event:"closeState",funcName:"onCloseState"}),this.createStateHandlers(e)}},{key:"render",value:function(){this.model.get("hasReadyAd")&&!this.model.get("timeBetweenAds")||(this.log.info("Content is being loaded!"),this.video||(this.$el.append(u.a),this.el.id="_cm-css-reset",this._customize(),this.playList=this.model.get("player.playlist"),this.currentTrackIndex=0,this.initVideo(),this._addVideoControls(),this.initLoadingBackground(),this.bindEvents()),this.show())}},{key:"_addVideoControls",value:function(){this.videoControls=new o.d({container:this.el,model:this.model,video:this.video})}},{key:"bindEvents",value:function(){this.createStateHandlers([{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"mute:true",funcName:"mute"},{event:"mute:false",funcName:"unMute"},{event:"content.playClicked:true",funcName:"play"},{event:"content.pauseClicked:true",funcName:"pause"},{event:"adQState:q0",funcName:"hide"},{event:"adState:playing",funcName:"hide"},{event:"blockedByExternalUnit:true",funcName:"pause"},{event:"blockedByExternalUnit:false",funcName:"play"}])}},{key:"initVideo",value:function(){this.video=this.$el.find("video")[0],this.model.get("contentClickUrl")&&(this.video.onclick=this.contentClickThru.bind(this),this.video.style.cursor="pointer"),this.video.src=this.playList[this.currentTrackIndex].url,this.video.addEventListener("ended",this.onEnd.bind(this)),this.video.addEventListener("loadeddata",this.onLoaded.bind(this)),this.video.addEventListener("playing",this.onPlaying.bind(this)),this.video.muted=!0,this.video.setAttribute("muted",""),this.video.setAttribute("playsinline","")}},{key:"initLoadingBackground",value:function(){this.$loadingImg=this.$el.find("._cm-background-loading"),-1!==!this.$loadingImg.index()?this.$loadingImg.css({backgroundImage:'url("'.concat(this.model.get("components.contentVideo.X"),'")')}):this.log.warning("No loading background found!")}},{key:"show",value:function(){this.isTerminated||(this.model.set("content.isContentPlay",!0),this.log.info("Content video show"),this.isHidden=!1,this.$el.css({display:"block"}),this.play())}},{key:"hide",value:function(){this.isTerminated||(this.model.set("content.isContentPlay",!1),this.log.info("Content video hide"),this.isHidden=!0,this.$el.css({display:"none"}),this.pause())}},{key:"play",value:function(){var e=this;if(this.video){if(this.model.get("content.playClicked")||!this.model.get("content.pauseClicked")){this.model.set("content.playClicked",!1),this.model.set("content.startProgressBar",!0);var t=this.video.play();this.model.set("isExternalComponentBlockingAdFromPlay",!0,{silent:!0}),void 0!==t?t.catch((function(t){e.model.set("isExternalComponentBlockingAdFromPlay",!1),e.log.info("Auto-play was prevented",t)})).then((function(){e.log.info("Auto-play content video started"),e.isHidden||e.model.set("content.isContentPlay",!0),e.contentTimer=setTimeout((function(){e.model.set("isExternalComponentBlockingAdFromPlay",!1)}),1e3*e.getTimeoutBeforeOrBetweenAds())})):this.model.set("isExternalComponentBlockingAdFromPlay",!1)}}else this.log.warning("Play was called without video render!")}},{key:"getTimeoutBeforeOrBetweenAds",value:function(){var e=this.model.get("isFirstAd");return"content"===this.model.get("displayFiller.beforeAd")&&e&&this.model.get("timeBeforeFirstAd")>0?this.model.get("timeBeforeFirstAd"):"content"===this.model.get("displayFiller.betweenAds")&&!e&&this.model.get("timeBetweenAds")>0?this.model.get("timeBetweenAds"):0}},{key:"pause",value:function(){this.video?(this.model.set("content.startProgressBar",!1),this.video.pause()):this.log.warning("Pause was called without video render!")}},{key:"mute",value:function(){this.video.muted=!0,this.video.setAttribute("muted",""),this.model.set("mute",!0)}},{key:"unMute",value:function(){this.video.muted=!1,this.video.removeAttribute("muted"),this.model.set("mute",!1)}},{key:"onLoaded",value:function(){this.$loadingImg&&this.$loadingImg.hide()}},{key:"onPlaying",value:function(){this.model.get("components.contentVideo.isActive")&&this.model.get("displayFiller.beforeAd")===a.a.DISPLAY_FILLER.BEFORE_AD.CONTENT&&this.model.trigger("contentReadySliderShow")}},{key:"onEnd",value:function(){this.isTerminated||(this.$loadingImg&&this.$loadingImg.show(),this.model.get("components.contentVideo.isRepeat")&&(this.playList.length-1===this.currentTrackIndex&&(this.currentTrackIndex=-1),this.video.src=this.playList[++this.currentTrackIndex].url,this.model.set("content.isContentPlay",!1),clearTimeout(this.contentTimer),this.model.set("isExternalComponentBlockingAdFromPlay",!1,{silent:!0}),this.play()))}},{key:"handleMouseActivity",value:function(){"onHover"===this.model.get("volume")&&(this.el.onmouseenter=this.onMouseEnter.bind(this),this.el.onmouseleave=this.onMouseLeave.bind(this))}},{key:"onMouseEnter",value:function(){this.unMute()}},{key:"onMouseLeave",value:function(){this.mute()}},{key:"contentClickThru",value:function(){window.open(this.model.get("contentClickUrl"))}},{key:"_customize",value:function(){var e=this.model.get("components.contentVideo.additionalCss");this.$el.css(y.toCssObj(e))}},{key:"checkEligible",value:function(){this.isEligibleToPlay()?this.play():this.pause()}},{key:"isEligibleToPlay",value:function(){return!this.isHidden&&!this.model.get("blockedByExternalUnit")&&(this.model.get("isInTab")?!!this.model.get("isEligibleToPlay")||this.model.get("videoViewState")===r.videoViewState.detached:this.model.get("videoViewState")===r.videoViewState.detached&&"play"===this.model.get("detachToSlider").onOutOfView)}},{key:"onCloseState",value:function(){this.isTerminated||(this.model.get("closeState")!==r.closeState.terminate&&this.model.get("closeState")!==r.closeState.adManagerStop?this.model.isLoadcomponent("content","onTimeout")?this.video?this.show():this.render():this.hide():this.terminate())}},{key:"terminate",value:function(){this.log.info("Terminate"),this.isTerminated||(clearTimeout(this.contentTimer),this.model.set("isExternalComponentBlockingAdFromPlay",!1,{silent:!0}),this.isTerminated=!0,this.video&&(this.hide(),this.mute(),this.video.removeAttribute("src"),this.video.load(),this._destroy()),this.log.info("Content is terminated."))}},{key:"_destroy",value:function(){this.video.removeEventListener("ended",this.onEnd),this.video.removeEventListener("loadeddata",this.onLoaded),this.video.removeEventListener("playing",this.onPlaying),this.mo&&this.mo.disconnect(),this.container&&this.container.parentElement&&this.container.parentElement.removeChild(this.container),this.container=this.mo=void 0}},{key:"_addContentStyleObserver",value:function(){var e=this,t=this.$el[0];t&&window.MutationObserver&&(this.mo=new window.MutationObserver((function(){"none"!==t.style.display&&e.isHidden&&(t.style.display="none")})),this.mo.observe(t,{attributes:!0,attributeFilter:["style"]}))}},{key:"className",get:function(){return"_cm-content-video"}}])&&p(t.prototype,i),s}(n.b);t.a=v},function(e,t,i){"use strict";var n=i(6),o=i(0),r=i(1),s=i.n(r);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=i(5),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=u(e);if(t){var o=u(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return d(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).model=e.model,t.events=s.a.KIBANA_EVENTS,t.startTime=e.startTime,t.predictors=e.predictors,t.adsList=[],t.getAdCount=0,t.impressionCount=0,t.dirtyAds=[],t._createEventList(),t}return t=r,(i=[{key:"_getAd",value:function(e){this.createAd(e.adId),this.getAdCount++;var t="any"===e.getAdKey?10:e.getAdKey,i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:e.eventTime-this.startTime,getAdTime:e.eventTime,getAdCount:this.getAdCount,predictPointKey:t,predictName:e.predictName,isInTab:this.model.get("isInTab"),topParentSelector:e.scrollData.topParentSelector};this.model.get("distancePercentPredictData")&&"distancePercentPredict"===e.predictName&&h.extend(i,this.model.get("distancePercentPredictData")),this.model.get("distancePixelPredictData")&&"distancePixelsPredict"===e.predictName&&h.extend(i,this.model.get("distancePixelPredictData")),h.extend(i,this._checkIsFirstGetAdType(e.getAdKey)),this._addDataToAd(this.events.getAd,e.adId,i,{hadImpression:!1,getAdKey:t}),this.isFirstGetAd&&(this.isFirstGetAd=!1)}},{key:"_checkIsFirstGetAdType",value:function(e){var t={isFirstGetAd:!1,isFirstNonRv:!1,isFirstRv:!1};return void 0===this.isFirstGetAd&&(t.isFirstGetAd=!0,this.isFirstGetAd=!1),0===e&&void 0===this.isFirstNonRv?(t.isFirstNonRv=!0,this.isFirstNonRv=!1):1===e&&void 0===this.isFirstRv&&(t.isFirstRv=!0,this.isFirstRv=!1),t}},{key:"_gotAd",value:function(e){this.createAd(e.adId),this.impressionCount++;var t={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:e.eventTime-this.adsList[e.adId].getAd.getAdTime,adImpressionTime:e.eventTime,scrollPercentageFromSelector:e.scrollData.scrollPercentageFromSelector,bottomViewPort:e.scrollData.bottomViewPort,topParentSelector:e.scrollData.topParentSelector,isInTab:this.model.get("isInTab"),isFirstImpression:1===this.impressionCount,isFirstRv:this.adsList[e.adId].getAd.isFirstRv,isFirstNonRv:this.adsList[e.adId].getAd.isFirstNonRv};t.hadLostEligibility=!!this.model.get("lostEligibilityTime"),this.model.get("lostEligibilityTime")&&(t.timeFromLostEligibility=e.eventTime-this.model.get("lostEligibilityTime")),h.extend(t,e);var i={hadImpression:!0,lineItemId:e.lineItemId,requiredViewability:e.requiredViewability};t.isFirstRv?(i.hadRvVimp=!0,this.hadRvVimp=!0):t.isFirstNonRv&&(i.hadNonRvVimp=!0,this.hadNonRvVimp=!0),e.requiredViewability?i.hadNonRvVimpBefore=this.hadNonRvVimp||!1:i.hadRvVimpBefore=this.hadRvVimp||!1,this._addDataToAd(this.events.gotAd,e.adId,t,i)}},{key:"_adPlay",value:function(e){this.createAd(e.adId);var t=!this.adsList[e.adId].hadConversion,i={timeFromAdImpression:e.eventTime-this.adsList[e.adId].gotAd.adImpressionTime,adPlayTime:e.eventTime,isInTab:this.model.get("isInTab"),isFirstConversion:!this.hadConversion,playPauseReason:this.model.get("playPauseReason")};h.extend(i,e);var n={hadConversion:!0};t&&(n.conversionTime=e.eventTime,this._addDataToAd(this.events.conversion,e.adId,i,n)),i.isFirstPlayForAd=t,this._addDataToAd(this.events.adPlay,e.adId,i,n),this.hadConversion||(this.hadConversion=!0)}},{key:"_adPaused",value:function(e){this.createAd(e.adId);var t={isInTab:this.model.get("isInTab"),pauseReason:e.pauseReason,playPauseReason:"pauseOnAdImpression"!==e.pauseReason?this.model.get("playPauseReason"):e.pauseReason};this.adsList[e.adId].conversionTime?t.timeFromAdPlay=e.eventTime-this.adsList[e.adId].conversionTime:t.timeFromAdImpression=e.eventTime-this.adsList[e.adId].gotAd.adImpressionTime,h.extend(t,e),this._addDataToAd(this.events.adPaused,e.adId,t)}},{key:"_viewability",value:function(e){this.createAd(e.adId);var t={timeFromAdPlay:e.eventTime-this.adsList[e.adId].conversionTime};h.extend(t,e),this._addDataToAd(this.events.viewability,e.adId,t,{hadViewability:!0})}},{key:"_completed",value:function(e){this.createAd(e.adId);var t={timeFromAdPlay:e.eventTime-this.adsList[e.adId].conversionTime};h.extend(t,e),this._addDataToAd(this.events.adComplete,e.adId,t,{isCompleted:!0})}},{key:"_continueAd",value:function(e){}},{key:"createAd",value:function(e){var t=this.adsList[e];return t||((t={adId:e,_id:h.generateGuid(10),countChanges:0,hadImpression:!1,hadConversion:!1,abTest:this.model.get("abTest"),pageUrl:window.location.href}).conf=this._createConf(),this.adsList[e]=t),t}},{key:"_createConf",value:function(){return{predictors:this.predictors,detachToSlider:this.model.get("detachToSlider"),unitType:this.model.get("unitType"),version:this.model.get("version")}}},{key:"_createEventList",value:function(){this.adEvents={},this.adEvents[this.events.getAd]=this._getAd.bind(this),this.adEvents[this.events.gotAd]=this._gotAd.bind(this),this.adEvents[this.events.viewability]=this._viewability.bind(this),this.adEvents[this.events.adPlay]=this._adPlay.bind(this),this.adEvents[this.events.adPaused]=this._adPaused.bind(this),this.adEvents[this.events.adComplete]=this._completed.bind(this),this.adEvents[this.events.continueAd]=this._continueAd.bind(this)}},{key:"pushEvent",value:function(e,t){this.adEvents[e]&&this.adEvents[e](t)}},{key:"_addDataToAd",value:function(e,t,i,n){var o=this.adsList[t];o[e]?h.isArray(o[e])?o[e].push(i):o[e]=[o[e],i]:o[e]=i,o.redId=this.model.get("redId"),o.abTest=this.model.get("abTest"),this._addCardData(i,n),h.extend(o,n),o.countChanges++,this.adsList[t]=o,this.dirtyAds[t]=!0}},{key:"_addCardData",value:function(e,t){if(e.cardNumber){var i=this._getCardInfo(e.cardNumber);e.scrollData=e.scrollData||{},h.extend(e.scrollData,i),t&&(t.cardInfo=t.cardInfo||{},h.extend(t.cardInfo,i))}}},{key:"_getCardInfo",value:function(e){var t=("#cm_place_holder_"+e).replace(".",""),i=Object(o.a)(t)[0],n=h.getTopOfEl(i),r=window.innerHeight+window.pageYOffset;return{distanceToEligibility:n-r,eligibilityPercentage:r/n*100,cardTopPixels:n,cardNumber:e}}},{key:"getAdsData",value:function(){return{adsList:this.adsList}}},{key:"saveAdsData",value:function(e){this.adsList.length&&h.forEach(this.adsList,function(t,i){t.hadImpression&&this.dirtyAds[i]&&(this.dirtyAds[i]=!1,o.a.ajax({type:"POST",url:e+"/putes/units-ads-analytics",data:JSON.stringify(h.extend(t,{timestamp:(new Date).toISOString()})),contentType:"text/plain"}))}.bind(this))}}])&&l(t.prototype,i),r}(n.a);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=i(5),_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(r,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=v(e);if(t){var o=v(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return y(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).model=e.model,t.getAdCount=0,t.impressionCount=0,t.isFirstImpression=!0,t.isFirstPlay=!0,t.isFirstPauseAfterPlay=!0,t.isFirstisEligiblilty=!0,t.hadLostEligibility=!1,t.eventsToSend=t.model.get("kibanaEventsToSend")||"all",t.isDirty=!1,t.changesCount=0,t.totalData={_id:b.generateGuid(10),redId:t.model.get("redId")},t.startTime=t._getCurrentTime(),t._createAdsEvents(),t.kibanaAdsService=new p({model:t.model,startTime:t.startTime,predictors:t._parsePredicts(t.model.get("predictors"))}),t._start(),t._bindEvents(),t}return t=r,(i=[{key:"_start",value:function(){this._saveDataToStorage(s.a.KIBANA_EVENTS.start,{isEligible:this.model.get("isEligibleToPlay")||!1,startTime:this.startTime,pageUrl:window.location.href,selector:this.model.get("parentSelector")?this.model.get("parentSelector").toString():"",predictors:this._parsePredicts(this.model.get("predictors")),viewPercent:this.model.get("viewPercent"),viewabilityPercent:this.model.get("viewabilityPercent"),creativeId:this.model.get("creativeId"),unitType:this.model.get("unitType"),abTest:this.model.get("abTest"),playerType:this.model.get("mobilePlayer"),playerVersions:this.model.get("player.versions"),urlPrefix:this.model.get("urlPrefix"),version:this.model.get("version"),vForce:this.model.get("vForce"),isInTab:this.model.get("isInTab"),detachToSlider:this.model.get("detachToSlider"),scrollSelector:this.model.get("scrollSelector"),isUseObserver:this.model.get("isUseObserver"),isUseObserverChanged:this.model.get("isUseObserverChanged"),documentReadyState:this.model.get("documentReadyState"),lineItemId:this.model.get("lineItemId"),isAMP:window.TRC&&window.TRC.isAMP,isEligibilityNomination:this.model.get("isEligibilityNomination")||!1,secondsToWaitForRV:this.model.get("secondsToWaitForRV")},!0)}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"renderWasCalled:true",funcName:"_onRenderCalled"},{event:"getAdState:failed",funcName:"_getAdFailed"},{event:"isEligibleToPlay:true",funcName:"_onFirstEligibility"},{event:"closeState:closeButtonClicked",funcName:"_closeButtonClicked"},{event:"getAdState:stopped",funcName:"_unitClosedByMidRollTimeOut"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"},{event:"playerWidthLost:true",funcName:"_onLostPlayerSize"},{event:"playerHeightLost:true",funcName:"_onLostPlayerSize"},{event:"invalidCDBobject",funcName:"_onInvalidCDBobject"},{event:"playerHasRvInQ",funcName:"_onPlayerHasRvInQ"},{event:"rvHandlerState",funcName:"_onRvHandlerStateChange"},{event:"rvHandlerTimerExpired",funcName:"_onRvHandlerTimerExpired"}])}},{key:"_getCurrentTime",value:function(){return(new Date).getTime()}},{key:"_onRenderCalled",value:function(){this.renderCallTime=this._getCurrentTime();var e={isEligible:this.model.get("isEligibleToPlay"),timeFromAdImpression:this.renderCallTime-this.adImpressionTime,isInTab:this.model.get("isInTab")};this._saveDataToStorage(s.a.KIBANA_EVENTS.renderWasCalled,e)}},{key:"_getAdFailed",value:function(){this.getAdFailTime=this._getCurrentTime();var e={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:this.getAdFailTime-this.getAdTime,isInTab:this.model.get("isInTab"),width:this.model.get("width"),height:this.model.get("height")};this._saveDataToStorage(s.a.KIBANA_EVENTS.getAdFailed,e)}},{key:"getAdCalled",value:function(e){this.getAdCount++,this.getAdTime=this._getCurrentTime();var t=this._getTopParentSelector();t=t||-999;var i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.getAdTime-this.startTime,getAdCount:this.getAdCount,predictPointKey:"any"===e.getAdKey?10:e.getAdKey,predictName:e.predictName,isInTab:this.model.get("isInTab"),topParentSelector:t,adId:e.adId};this.model.get("distancePercentPredictData")&&"distancePercentPredict"===e.predictName&&b.extend(i,this.model.get("distancePercentPredictData")),this.model.get("distancePixelPredictData")&&"distancePixelsPredict"===e.predictName&&b.extend(i,this.model.get("distancePixelPredictData")),this._saveDataToStorage(s.a.KIBANA_EVENTS.getAd,i)}},{key:"gotAd",value:function(e){this.isFirstImpression=!1,this.adImpressionTime=this._getCurrentTime();var t=this._calcScrollPercentage(),i={isEligible:this.model.get("isEligibleToPlay"),timeFromGetAd:this.adImpressionTime-this.getAdTime,scrollPercentageFromSelector:t.scrollPercentageFromSelector,bottomViewPort:t.bottomViewPort,topParentSelector:t.topParentSelector,isInTab:this.model.get("isInTab")};i.hadLostEligibility=!!this.model.get("lostEligibilityTime"),this.model.get("lostEligibilityTime")&&(i.timeFromLostEligibility=this.adImpressionTime-this.model.get("lostEligibilityTime")),this.playerHadRvInQTime&&this.model.get("gotRvAd")&&(i.timeFromPlayerHasRV=this.adImpressionTime-this.playerHadRvInQTime),e&&b.extend(i,e),this._saveDataToStorage(s.a.KIBANA_EVENTS.gotAd,i,!1),this.impressionCount++}},{key:"adPlaying",value:function(e){this.hadPlay=!0,this.adPlayingTime=this._getCurrentTime();var t={timeFromAdImpression:this.adPlayingTime-this.adImpressionTime,isInTab:this.model.get("isInTab"),isFirstPlay:this.isFirstPlay};e&&b.extend(t,e),this.isFirstPlay=!1,this._saveDataToStorage(s.a.KIBANA_EVENTS.adPlay,t)}},{key:"adPaused",value:function(e){if(this.hadPlay){this.adPausedAfterPlayTime=this._getCurrentTime();var t={timeFromAdPlay:this.adPausedAfterPlayTime-this.adPlayingTime,isInTab:this.model.get("isInTab"),pauseReason:e.pauseReason};e&&b.extend(t,e),this._saveDataToStorage(s.a.KIBANA_EVENTS.adPaused,t)}}},{key:"_onFirstEligibility",value:function(){if(this.isFirstisEligiblilty){this.isFirstisEligiblilty=!1,this.firstEligibilityTime=this._getCurrentTime();var e={timeFromStart:this.firstEligibilityTime-this.startTime};this._saveDataToStorage(s.a.KIBANA_EVENTS.firstEligibility,e)}}},{key:"_closeButtonClicked",value:function(){this._unitClose(s.a.KIBANA_EVENTS.unitCloseByUser)}},{key:"_unitClosedByMidRollTimeOut",value:function(){this._unitClose(s.a.KIBANA_EVENTS.unitClosedByMidRollTimeOut)}},{key:"_unitClose",value:function(e){this.closeTime=this._getCurrentTime();var t={impressionCount:this.impressionCount,timeFromAdPlay:this.closeTime-this.adPlayingTime};this._saveDataToStorage(e,t,!0),clearInterval(this.updateTimer),this.updateTimer=void 0}},{key:"onViewability",value:function(e){this.viewabilityTime=this._getCurrentTime();var t={timeFromAdPlay:this.viewabilityTime-this.adPlayingTime};e&&b.extend(t,e),this._saveDataToStorage(s.a.KIBANA_EVENTS.viewability,t,!1)}},{key:"onD2DClick",value:function(e,t){var i={isTrusted:e,isNewTab:t};this._saveDataToStorage(EVENTS.D2DClick,i,!1)}},{key:"_onParentSelectorLost",value:function(){this.lostTime=this._getCurrentTime();var e=this._getTopParentSelector();e=e||-999;var t={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.lostTime-this.startTime,isInTab:this.model.get("isInTab"),topParentSelector:e,isTop0Left0:this.model.get("top0Left0")};this._saveDataToStorage(s.a.KIBANA_EVENTS.topParentSelectorLost,t,!0)}},{key:"_onLostPlayerSize",value:function(){var e=s.a.KIBANA_EVENTS.playerHeightLost;this.model.get("playerWidthLost")&&(e=s.a.KIBANA_EVENTS.playerWidthLost),this.lostTime=this._getCurrentTime();var t=this._calcScrollPercentage();t.topParentSelector=t.topParentSelector?t.topParentSelector:-999;var i={isEligible:this.model.get("isEligibleToPlay"),timeFromStart:this.lostTime-this.startTime,isInTab:this.model.get("isInTab"),scrollPercentageFromSelector:t.scrollPercentageFromSelector,bottomViewPort:t.bottomViewPort,topParentSelector:t.topParentSelector};this._saveDataToStorage(e,i)}},{key:"_getTopParentSelector",value:function(){var e=this.model.get("parentSelector");return e=b.isArray(e)?e[0]:e,e=Object(o.a)(e)[0],b.getTopOfEl(e)}},{key:"_calcScrollPercentage",value:function(){var e=this._getTopParentSelector();e=e||-999;var t=window.innerHeight+window.pageYOffset;return{scrollPercentageFromSelector:t/e*100,topParentSelector:e,bottomViewPort:t}}},{key:"_onInvalidCDBobject",value:function(){var e=s.a.KIBANA_EVENTS.invalidCDBobject,t=this._getCurrentTime(),i={cdbObject:this.model.get("invalidCDBobject"),timeFromStart:t-this.startTime};this._saveDataToStorage(e,i)}},{key:"_onRvHandlerStateChange",value:function(e,t){var i=s.a.KIBANA_EVENTS.rvHandlerState,n={rvHandlerState:t,timeFromStart:this._getCurrentTime()-this.startTime,gotRvAd:this.model.get("gotRvAd"),gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(i,n)}},{key:"_onPlayerHasRvInQ",value:function(e,t){var i=s.a.KIBANA_EVENTS.playerHasRvInQ,n=this._getCurrentTime();this.playerHadRvInQTime=n;var o={rvHandlerState:this.model.get("rvHandlerState"),timeFromStart:n-this.startTime,gotRvAd:this.model.get("gotRvAd"),gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(i,o)}},{key:"_onRvHandlerTimerExpired",value:function(){var e=s.a.KIBANA_EVENTS.rvHandlerTimerExpired,t={timeFromStart:this._getCurrentTime()-this.startTime,gotNonRvAd:this.model.get("gotNonRvAd")};this._saveDataToStorage(e,t)}},{key:"_parsePredicts",value:function(e){var t=o.a.extend(!0,{},e);return"any"===t.playerReady.predictPoint&&(t.playerReady.predictPoint=10),t}},{key:"_createAdsEvents",value:function(){this.adEvents={},this.adEvents[s.a.KIBANA_EVENTS.getAd]=this.getAdCalled.bind(this),this.adEvents[s.a.KIBANA_EVENTS.gotAd]=this.gotAd.bind(this),this.adEvents[s.a.KIBANA_EVENTS.viewability]=this.onViewability.bind(this),this.adEvents[s.a.KIBANA_EVENTS.adPlay]=this.adPlaying.bind(this),this.adEvents[s.a.KIBANA_EVENTS.adPaused]=this.adPaused.bind(this)}},{key:"adEvent",value:function(e,t){var i={eventTime:this._getCurrentTime(),scrollData:this._calcScrollPercentage()};b.extend(t,i),this.kibanaAdsService.pushEvent(e,t),this.adEvents[e]&&this.adEvents[e](t)}},{key:"_saveDataToStorage",value:function(e,t,i){("all"===this.eventsToSend||b.contains(this.eventsToSend,e))&&(this.totalData[e]?b.isArray(this.totalData[e])?this.totalData[e].push(t):this.totalData[e]=[this.totalData[e],t]:this.totalData[e]=t,i?this._saveDataToLogServer(i):this.isDirty=!0)}},{key:"_saveDataToLogServer",value:function(e){if(e||this.isDirty){this.changesCount++,this.totalData.redId=this.model.get("redId"),this.totalData.countChanges=this.changesCount,this.totalData.abTest=this.model.get("abTest"),this.totalData.age=this._getCurrentTime()-this.startTime;var t=this.model.get("kbnul");this.kibanaAdsService.saveAdsData(t),o.a.ajax({type:"POST",url:t+"/putes/unitsanalytics",data:JSON.stringify(b.extend(this.totalData,{timestamp:(new Date).toISOString()})),contentType:"text/plain"}),this.isDirty=!1,this.updateTimer||(this.updateTimer=setInterval(this._saveDataToLogServer.bind(this),1e3*this.model.get("reportTimerSeconds")))}}}])&&m(t.prototype,i),r}(n.a);t.a=_},function(e,t,i){"use strict";var n=i(1),o=i.n(n);function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s,a=i(5),l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adsList=[],this.listeners=[],this.registerIndex=0,this.model=t}var t,i;return t=e,(i=[{key:"updateAdsList",value:function(e){e&&!a.isEmpty(e)?(this.adsList=e.items,this._notifyListeners(e)):(this.model.set("generalErrorData",1),this.model.increaseCounter("generalError"))}},{key:"_notifyListeners",value:function(e){var t=this;this.isPlayerHasRvInQ(e);var i=[];this.listeners.forEach((function(e){var n=t._findAdsByStatusAndType(e.type,e.typeValue,e.status,e.cb);e.isListenOnce&&n&&i.push(e.index)})),i.forEach((function(e){return t.unregisterToPlayerQueueStatusChange(e)}))}},{key:"_findAdsByStatusAndType",value:function(e,t,i,n){var r=this,s=!1,l=[];return this.adsList.forEach((function(n){(!e||r[e]&&r[e](n,t))&&(!i||o.a.AD_STATUS[i]&&n.vw&&n.vw.st===o.a.AD_STATUS[i])&&(l.push(n),s=!0)})),s&&a.isFunction(n)&&n(l),s}},{key:"singleAd",value:function(e,t){return!!(t&&e.sa||!t&&!e.sa)}},{key:"adjacency",value:function(e,t){return!!(t&&e.adjc||!t&&!e.adjc)}},{key:"registerIsPlayerHasRvInQ",value:function(e){this.isPlayerHasRvInQCb=e}},{key:"isPlayerHasRvInQ",value:function(e){this.isPlayerHasRvInQCb&&e.requiredViewabilityCount&&this.isPlayerHasRvInQCb()}},{key:"registerToPlayerQueueStatusChange",value:function(e){var t=e.type,i=e.typeValue,n=e.status,r=void 0===n?o.a.AD_STATUS.new:n,s=e.cb,a=e.isListenOnce,l={type:t,typeValue:i,status:r,cb:s,isListenOnce:void 0!==a&&a,index:this.registerIndex};return this.registerIndex=this.registerIndex+1,this.listeners.push(l),l.index}},{key:"unregisterToPlayerQueueStatusChange",value:function(e){this.listeners=this.listeners.filter((function(t){return t.index!==e}))}}])&&r(t.prototype,i),e}();t.a=function(e){return s||(s=new l(e)),s}},function(e,t,i){"use strict";var n=i(4),o=i(6),r=i(2),s=i.n(r),a=i(17),l=i(3),c=i.n(l),d=i(9);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=i(5),v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=g(e);if(t){var o=g(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return f(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e)).model=e.model,t.model.get("msnWebComponentsEnabled")||t.model.set("height",y.getVideoHeight(t.model.get("width"))),t.log=new n.a({unitType:t.model.get("unitType"),className:t.constructor.name||"UnitController",version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.containerView=void 0,t.videoView=void 0,t.adService=void 0,t.playerService=void 0,t.isClosedByUser=!1,t.createStateHandlers([{event:"closeState",funcName:"handleCloseState"},{event:"topParentSelectorLost:true",funcName:"_onParentSelectorLost"}]),t.model.listenTo(t.model,"ad:stoppedByUser",t.terminate.bind(m(t),!0)),t._createTimers(),setTimeout(function(){this.competitionDetector=new d.b(this.model)}.bind(m(t)),0),t}return t=r,(i=[{key:"_createTimers",value:function(){if(this.model.get("isMultiAd")&&this.model.get("midrollTimeout")>0){var e={startCondition:{stateToListen:s.a.adManagerState.empty,state:"adManagerState"},stopCondition:{stateToListen:s.a.adManagerState.hasAds,state:"adManagerState"}};this.getAdTimer=new a.a(this.model,e,this.terminate.bind(this,!1,"midrollCollapse"),1e3*this.model.get("midrollTimeout"))}else if(this.model.get("isMultiAd")&&this.model.get("secondsToCloseFeed")>0){var t={startCondition:{stateToListen:s.a.adManagerState.empty,state:"adManagerState"},stopCondition:{stateToListen:s.a.adManagerState.hasAds,state:"adManagerState"}};this.getAdTimer=new a.a(this.model,t,this.pause.bind(this,"midrollCollapse"),1e3*this.model.get("secondsToCloseFeed"))}var i=this.model.get("secondsToClose");if(i>0){var n={startCondition:{stateToListen:!0,state:"firstGetAdFired"},stopCondition:{stateToListen:s.a.adQState.impression,state:"adQState"},isStartOnce:!0};this.secondsToCloseTimer=new a.a(this.model,n,this.terminate.bind(this,!1,"secondsToClose"),1e3*i)}var o=this.model.get("secondsToCloseGlobal");if(o>0){var r={startCondition:{stateToListen:"",state:""}};"showReplay"===this.model.get("onTimerClose")?this.secondsToCloseGlobalTimer=new a.a(this.model,r,this.pause.bind(this,"secondsToCloseGlobal"),1e3*this.model.get("secondsToCloseGlobal")):this.secondsToCloseGlobalTimer=new a.a(this.model,r,this.terminate.bind(this,!1,"secondsToCloseGlobal"),1e3*o),this.secondsToCloseGlobalTimer.start(this.model,"")}this._createSecondsToPassbackTimer()}},{key:"terminate",value:function(e,t){this.log.info("Terminate reason: "+t),this.isClosedByUser=e,this._setTimerReason(t),this.model.set("closeState",s.a.closeState.terminate)}},{key:"_setTimerReason",value:function(e){this.model.set("closeTimer",e)}},{key:"handleCloseState",value:function(e,t){switch(this.log.info("handleCloseState",t),c.a.trigger("global:closeState:changed"),t){case s.a.closeState.terminate:this.containerView?this.containerView.close(this.isClosedByUser):this.model.set("closeState",s.a.closeState.containerViewClosed);break;case s.a.closeState.containerViewClosed:this.nativeAdView&&this.nativeAdView.hide(),this.videoView?this.videoView.close(this.isClosedByUser):this.model.set("closeState",s.a.closeState.videoViewClosed);break;case s.a.closeState.videoViewClosed:this.adService?this.adService.close():this.model.set("closeState",s.a.closeState.adManagerStop);break;case s.a.closeState.adManagerStop:this.playerService&&(this.playerService.close(),this._stopListening())}}},{key:"_stopListening",value:function(){this.model.off(),c.a.off()}},{key:"pause",value:function(e){this._setTimerReason(e),this.adService&&this.adService.pauseGetAds()}},{key:"_onParentSelectorLost",value:function(){this.overKill("parentSelectorLost")}},{key:"overKill",value:function(e){this.log.info("overKill reason: "+e),this.adService&&this.adService.pauseGetAds(),this.adsManager&&this.adsManager.pauseGetAds(),this.model.set("closeState",s.a.closeState.terminate),this._setTimerReason(e)}},{key:"_createSecondsToPassbackTimer",value:function(){this.model.get("secondsToPassback")&&(this.passBackTimer=new a.a(this.model,{startCondition:{stateToListen:"",state:""},stopCondition:{stateToListen:!0,state:"isFirstAdLoaded"}},this._triggerPassback.bind(this,"Passback"),1e3*this.model.get("secondsToPassback")),this.passBackTimer.start(this.model,""))}},{key:"_triggerPassback",value:function(){this.model.get("isFirstAdLoaded")||(this.log.info("Passback timer done"),c.a.trigger("global:passback",{isApiPassbackExist:this.model.get("isApiPassbackExist")}),this.model.set("closeState",s.a.closeState.terminate))}}])&&h(t.prototype,i),r}(o.a);t.a=v},function(e,t,i){"use strict";function n(e,t,i){return(n=o()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return i&&r(o,i.prototype),o}).apply(null,arguments)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.d(t,"a",(function(){return x}));var a=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"instance"in this.constructor)throw new Error("Cannot instantiate more than one '".concat(this.constructor.name,"'"));if("Singleton"==this.constructor.name)throw new Error("Cannot instantiate abstract class 'Singleton'");this.constructor.instance=this}var t,i;return t=e,i=[{key:"getInstance",value:function(){return"instance"in this||this.create.apply(this,arguments),this.instance}},{key:"create",value:function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return n(e,i)}}],null&&s(t.prototype,null),i&&s(t,i),e}();function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,i){return(c=p()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return i&&u(o,i.prototype),o}).apply(null,arguments)}function d(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(a,e);var t,i,n,o,r,s=(t=a,i=p(),function(){var e,n=f(t);if(i){var o=f(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return h(this,e)});function a(e,t){var i,n,o,r,l,c,d;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(i=s.call(this)).version=e,i.isGa=t,i.isGa&&(window.ga&&"function"==typeof window.ga||(n=window,o=document,r="script","//www.google-analytics.com/analytics.js",l="ga",n.GoogleAnalyticsObject=l,n.ga=n.ga||function(){(n.ga.q=n.ga.q||[]).push(arguments)},n.ga.l=1*new Date,c=o.createElement(r),d=o.getElementsByTagName(r)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",d.parentNode.insertBefore(c,d),window.ga("create","UA-66399520-1","auto"),window.ga("send","pageview")),i._setup()),i}return n=a,r=[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return c(a,t)}}],(o=[{key:"_setup",value:function(){window.ga("create","UA-66399520-1","auto",{name:"cmGa"}),window.ga("cmGa.send","pageview")}},{key:"send",value:function(e,t){this.isGa&&window.ga("cmGa.send","event",e+" "+this.version,t,location.host)}}])&&d(n.prototype,o),r&&d(n,r),a}(a),g=i(0);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t,i){return(v=T()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return i&&_(o,i.prototype),o}).apply(null,arguments)}function b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(a,e);var t,i,n,o,r,s=(t=a,i=T(),function(){var e,n=S(t);if(i){var o=S(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return w(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this)}return n=a,r=[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return v(a,t)}}],(o=[{key:"send",value:function(e,t,i){i||(i="ul");var n=JSON.stringify({timestamp:(new Date).toISOString(),type:e,data:t});g.a.ajax({type:"POST",url:"//vidanalytics.taboola.com/putes/"+i,data:n,contentType:"text/plain"})}}])&&b(n.prototype,o),r&&b(n,r),a}(a);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t,i){return(E=R()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return i&&O(o,i.prototype),o}).apply(null,arguments)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D=i(5),x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(a,e);var t,i,n,o,r,s=(t=a,i=R(),function(){var e,n=V(t);if(i){var o=V(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return I(this,e)});function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.addTrace,n=void 0!==i&&i,o=t.isDebug,r=void 0!==o&&o,l=t.isConsole,c=void 0===l?r:l,d=t.isSaveLog,u=void 0===d?r:d,h=t.extraLogGA,p=void 0!==h&&h,f=t.version,g=t.isGA;return C(this,a),(e=s.call(this)).addTrace=n,e.isDebug=D.parseBool(r),e.isConsole=D.parseBool(c),e.isSaveLog=D.parseBool(u),e.isGA=D.parseBool(g),e.extraLogGA=p,e._ga=m.getInstance(f,e.isGA),e._ul=A.getInstance(),e.dataIndexName="units_debug_logs",e.isDebug&&(window.cmLogs=window.cmLogs||[]),e.initModel={},e}return n=a,r=[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return E(a,t)}}],(o=[{key:"pushLog",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(window.cmLogs.push({ts:(new Date).getTime(),message:e,obj:t}),"cmTag: init"===e&&(this.initModel=t,this.initModel["debugDataStore.indexName"]&&(this.dataIndexName=this.initModel["debugDataStore.indexName"]),console.log("cmTag: init obj:",JSON.stringify(t)),this.sessionID=this.getUniqSessionId(),this.showSessionID()),this.initModel["debugDataStore.isActive"]&&this.sendToServer(e,t))}},{key:"info",value:function(e,t){this.isDebug&&this._hasConsoleMethod("info")&&(console.info("cmTag: ".concat(e),t),this.pushLog("cmTag: ".concat(e),t),this.addTrace&&this._hasConsoleMethod("trace")&&console.trace())}},{key:"debug",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: RoyalBlue",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"error",value:function(e,t){this._hasConsoleMethod("error")&&(console.error("cmTag: ".concat(e),t),this.pushLog("cmTag: ".concat(e),t))}},{key:"ga",value:function(e,t,i){return this.extraLogGA&&this.info("GA extra log",{unitType:e,action:t,version:i}),this._ga.send(e,t,i)}},{key:"ul",value:function(e,t,i){return this._ul.send(e,t,i)}},{key:"success",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: green",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"important",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: purple",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"warning",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: orange",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"pixel",value:function(e,t){this.isDebug&&this._hasConsoleMethod("log")&&(console.log("%ccmTag: ".concat(e),"color: #00A0B2",t),this.pushLog("cmTag: ".concat(e),t))}},{key:"sendToServer",value:function(e,t){var i="no data";try{var n=JSON.stringify(t);t&&(i=n)}catch(e){}var o="".concat(this.initModel["player.settings.kbnul"],"/putes/").concat(this.dataIndexName);g.a.ajax({type:"POST",url:o,data:JSON.stringify({message:e,dataObject:i,timestamp:(new Date).toISOString(),sessionID:this.sessionID}),contentType:"text/plain"})}},{key:"getUniqSessionId",value:function(){return"".concat(this.getRandomNumber()).concat(this.getRandomNumber()).concat(this.getRandomNumber())}},{key:"showSessionID",value:function(){var e=document.createElement("div");e.setAttribute("id","_cm-session-id-div"),e.setAttribute("style","background: black; color: wheat; position: fixed; top: 0; left: 0;z-index:999999999");var t=document.createTextNode("SessionID: ".concat(this.sessionID)),i=document.createElement("button");i.innerHTML="X",i.addEventListener("click",(function(){document.querySelector("#_cm-session-id-div").remove()})),e.appendChild(t),e.appendChild(i),document.querySelector("body").appendChild(e)}},{key:"getRandomNumber",value:function(){return Math.floor(10*Math.random())}},{key:"_hasConsoleMethod",value:function(e){return console&&console[e]&&"function"==typeof console[e]}}])&&k(n.prototype,o),r&&k(n,r),a}(a)},function(e,t){e.exports='<div id="_cm-css-reset" class="_cm-repeat-div">\n    <div class="_cm-repeat-view-wrapper">\n        <div class="_cm-repeat-buttons-wrapper">\n            <img class="_cm-repeat-button"></img>\n            <img class="_cm-repeat-button-hover"></img>\n        </div>\n        <div class="_cm-learn-more-buttons-wrapper">\n            <img class="_cm-learn-more-button"></img>\n            <img class="_cm-learn-more-button-hover"></img>\n        </div>\n    </div>\n</div>'},function(e,t,i){window,e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}({"./index.js":function(e,t,i){"use strict";var n=i("./options.js"),o=i("./utils.js"),r=function(e,t){if("trc"===n.mcrsrvcsnmspc)try{return window.TRC[e][t]}catch(e){}if("cmTag"===n.mcrsrvcsnmspc)try{return window.cmTag.config.ms[e][t]}catch(e){}return null};e.exports={get:function(e,t,i,s){e=o.cleanServiceName(e),t=t||function(e){return n.serviceDefaultVersion[e]}(e);var a=r(e,t);if(a)i&&i(a);else{var l=document.createElement("script"),c=o.setUrlPrefix(n.base_url);l.async=n.async,l.type="text/javascript",l.src=c+(/.*\/$/g.test(c)?"":"/")+e+"/"+t+"/"+e+".js",l.onload=function(){document.head.removeChild(l);try{i&&i(r(e,t))}catch(e){s&&s()}},l.onerror=function(){document.head.removeChild(l),s&&s()},document.head.appendChild(l)}},init:function(e){for(var t in n)e.hasOwnProperty(t)&&(n[t]=e[t])}}},"./options.js":function(e,t,i){"use strict";e.exports={base_url:"//vidstat.taboola.com/",async:!0,mcrsrvcsnmspc:"trc",serviceDefaultVersion:{oppsula:"1.0.1"}}},"./utils.js":function(e,t,i){"use strict";e.exports={setUrlPrefix:function(e){return"string"!=typeof e||0!==(e=e.replace(/^(http[s]?:|ftp:)/g,"")).indexOf("//")&&(e="//"+e),e},cleanServiceName:function(e){return e.replace(/.js$/,"")}}},0:function(e,t,i){e.exports=i("./index.js")}})},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){"use strict";i.r(t),t.default={"stickyCard.isActive":!1,"stickyCard.restrictions.adTypeNotAllowed":!0,disableDetachForSession:!0}},function(e,t,i){"use strict";i.r(t),t.default={setAdConfigAfter:"onAdSetToUnits",revertAfter:"_adVideoEnd",isNeedAdjacCard:!0,adjacCardPlacement:1}},function(e,t,i){"use strict";i.r(t),t.default={isReplayAd:!0,isMultiAd:!1}},function(e,t,i){"use strict";i.r(t),t.default={setAdConfigAfter:"onAdSetToUnits",isTakeoverWidget:!0,isForceDontDie:!0,"detachToSlider.isDetachToSlider":!1,isMultiAd:!1,isReplayAd:!0,isKeepViewOnMidroll:!0}},function(e,t,i){"use strict";i.r(t),t.default={}},function(e,t,i){"use strict";i.r(t),t.default={setAdConfigAfter:"setSubModel",isReplayable:!0}},function(e,t,i){"use strict";i.r(t),t.default={isReplayable:!0}},function(e,t,i){"use strict";i.r(t),t.default={isReplayable:!0}},function(e,t,i){"use strict";i.r(t),t.default={isMultiAd:!1}},function(e,t,i){"use strict";i.r(t),t.default={setAdConfigAfter:"setSubModel",isPlacementSingleAd:!0,"continueToPlayInNexCard.isActive":!1}},function(e,t,i){"use strict";i.r(t),t.default={isMultiAd:!1,isReplayAd:!0}},function(e,t,i){"use strict";i.r(t),t.default={isReplayAd:!0}},function(e,t,i){"use strict";i.r(t),t.default={setAdConfigAfter:"onAdSetToUnits",stopPredicts:!0,isKeepViewOnMidroll:!0,isKeepUnitOnMidroll:!0,isPlacementSingleAd:!0,isReplayAd:!0,isPreventNextAd:!0}},function(e,t,i){var n=i(3),o=i(5),r=i(10),s=i(97);e.exports=n.View.extend({className:"_cm-brand-logo",events:{"click ":"_onClick"},initialize:function(e){this.log=new r({unitType:e.unitType,className:"branLogoView"}),this.model=e.model,this.container=e.container,this.options=this.model.get("components.BrandLogo")||{},this.options.imageSrc=this.model.get("components.BrandLogo.imageSrc"),this.openUrl=this._getOpenUrl(),this.render(),this.componentsVisibilityListener=e.componentsVisibilityListener,this.componentsVisibilityListener&&this._setComponentsVisibilityListener()},render:function(){this.template=o.template(s),this.$el.append(this.template(this.options)),this.options.style&&this.$el.css(this.options.style),this.options.imageStyle&&this.$el.find("a>img").css(this.options.imageStyle),this.container.appendChild(this.el)},_onClick:function(){window.open(this.openUrl,"_blank")},_getOpenUrl:function(){var e=this.model.get("clickUrl"),t=this.options.logoLander,i=this.options.fallBackClickUrl,n=this._getClickUrlQueryStrings(t);return e&&e.length>0&&-1===e.indexOf("_#")?decodeURIComponent(e)+encodeURIComponent(i)+n:i+n},_getClickUrlQueryStrings:function(e){return"?ttype=1&cipid="+this.model.get("cipid")+"&ttype=1&crid="+this.model.get("creativeId")+"&dast="+this.model.get("dast")+"&tgtf="+encodeURIComponent(e)},_setComponentsVisibilityListener:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()},_onComponentsVisibilityChange:function(){this.model.get(this.componentsVisibilityListener)?this.show():this.hide()},hide:function(){this.$el.hide()},show:function(){this.$el.show()}})},function(e,t,i){var n=i(3),o=(i(5),i(10));e.exports=n.View.extend({className:"_cm-detach",events:{"click ":"_onClick"},initialize:function(e){this.log=new o({unitType:e.unitType,className:"detachButtonView"}),this.container=e.container,this._rendered=!1},render:function(){if(!this._rendered){var e=this.model.get("components.DetachButtonView.imageLocation");this.$el.css("background-image",'url("'+e+'") !important'),this.container.appendChild(this.el)}},_onClick:function(){this.$el.trigger("cm:detach:click")},hide:function(){this.$el.hide()}})},function(e,t,i){"use strict";var n=i(3);e.exports=n.DeepModel.extend({defaults:{id:0,filename:"",image:"",title:"",vidlength:"",active:!1,clicked:!1}})},function(e,t){e.exports='<div class="_cm-ad-loading-progress-container">\n    <div class="_cm-ad-loading-progress-bar-container">\n        <div class="_cm-ad-loading-progress-title">\n            <span class="_cm-ad-loading-progress_title_span"></span>\n            <span class="_cm-ad-loading-progress_percent_span">0%</span>\n        </div>\n        <div class="_cm-ad-loading-progress-bar">\n            <div class="_cm-ad-loading-progress-bar-loaded">\n            </div>\n        </div>\n    </div>\n</div>'},function(e,t,i){var n=i(3),o=i(5),r=i(10),s=i(106);e.exports=n.View.extend({className:"_cm-click-blocker-container",initialize:function(e){this.log=new r({unitType:e.unitType,className:"clickBlockerView"}),this.options=e,this.model=e.model,this.container=e.container,this.render()},render:function(){this.template=o.template(s),this.$el.append(this.template(this.options)),this.SetClickBlockerDivStyle(),this.options.style&&this.$el.css(this.options.style),this.container.appendChild(this.el)},SetClickBlockerDivStyle:function(){var e=this;this.containerDimentions=this.container.getBoundingClientRect();var t=this.$el.children();t.forEach((function(t){return e.setBasicBlockerDivStyle(t)}));var i=this.model.get("components.ClickBlocker.blockPercent.vertical"),n=this.model.get("components.ClickBlocker.blockPercent.horizontal");t[0].style.height=this.containerDimentions.height*i+"px",t[1].style.height=this.containerDimentions.height*i+"px",t[2].style.width=this.containerDimentions.width*n+"px",t[3].style.width=this.containerDimentions.width*n+"px"},setBasicBlockerDivStyle:function(e){e.style.width=this.containerDimentions.width+"px",e.style.height=this.containerDimentions.height+"px"}})},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t.model,this.subModel=t.subModel?t.subModel:null,this.observerOptions={root:null,rootMargin:"0px",threshold:this.buildThresholdList()},this.createObserver()}var t,n;return t=e,(n=[{key:"createObserver",value:function(){this.intersectionObserver=new IntersectionObserver(function(e){var t=this;e.map((function(e){t.updateModel("isViewableAMP",e.intersectionRatio>.5)}))}.bind(this),this.observerOptions)}},{key:"startObserver",value:function(e){this.updateModel("isViewableAMP",!1),this.intersectionObserver.observe(e)}},{key:"stopObserver",value:function(e){this.intersectionObserver.unobserve(e),this.intersectionObserver.disconnect()}},{key:"buildThresholdList",value:function(){for(var e=[],t=1;t<=20;t++){var i=t/20;e.push(i)}return e.push(0),e}},{key:"updateModel",value:function(e,t){null!=this.subModel&&this.subModel.set(e,t),this.subModel.set(e,t)}}])&&i(t.prototype,n),e}();e.exports=n},function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i(1);var o=i(83),r=(i(5),i(89)),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opions=t}var t,i;return t=e,(i=[{key:"getPreset",value:function(e){var t=e.key,i=e.value,n=e.unitType,s=e.platform;if(o[t]&&o[t][i]){var a=o[t],l=o[t].strength||1,c=o[t].atr||{};return c=r(c,a[i].atr),a[i]&&a[i].units&&(c=this._getFromUnits(c,a[i].units,n,s)||c),{presetData:c,strength:l}}}},{key:"_getFromUnits",value:function(e,t,i,n){if(t[i]){var o=t[i].atr||{};return e=r(e,o),t[i].platform&&(e=this._getByPlatform(e,t[i].platform,n)||e),e}}},{key:"_getByPlatform",value:function(e,t,i){if(t[i]){var n=t[i].atr||{};return r(e,n)}}}])&&n(t.prototype,i),e}();e.exports=s},function(e,t){e.exports='<div class="_cm-floating-components-placeholder">\n</div>\n<div class="_cm-fixed-components-wrapper">\n</div>\n'},function(e,t){e.exports='<div class="_cm-loading-div">\n</div>'},function(e,t,i){"use strict";var n=i(3),o=i(53);e.exports=n.Collection.extend({model:o})},function(e,t){e.exports='<ul class="_cm-playlist-list">\n</ul>'},function(e,t){e.exports='<div class="title text opt-out-hidden">{text}</div>'},function(e,t){e.exports='<img src="{{urls.staticImage}}">\n'},function(e,t){e.exports='<div class="cm_video_content_wrapper">\n    <div class="_cm-background-loading"></div>\n    <video class="cm_video_content_video_element"></video>\n</div>\n'},function(e,t){e.exports='<div class="_cm-skip-ad-border">\n    <div class="_cm-skip-ad-text">{{skipAdText}}</div>\n    <div class="_cm-skip-ad-icon">\n        <svg width="14" height="12" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 200">\n            <line x1="2" y1="2" x2="98" y2="110" style="stroke:#FFFEFD;stroke-width:40" />\n            <line x1="2" y1="198" x2="98" y2="90" style="stroke:#FFFEFD;stroke-width:40" />\n            Sorry, your browser does not support inline SVG.\n        </svg>\n</div>'},function(e,t){e.exports='<div class="video_controls video_controls_main_area">\n    <div class="cm_video_controls_progressbar_area">\n        <div class="cm_video_controls_progressbar_bg white_bg"></div>\n        <div class="cm_video_controls_progressbar blue_bg"></div>\n    </div>\n    <div class="cm_video_controls_mute interactive">\n        <div class="cm_video_controls_volume display_mute"></div>\n        <div class="cm_video_controls_volume display_unmute"></div>\n    </div>\n    <div class="cm_video_controls_playpause interactive show">\n        <div class="pause show"></div>\n        <div class="play hide"></div>\n    </div>\n</div>\n'},function(e,t){e.exports='<div class="_cm-native-ad-bottom">\n    <div class="_cm-native-ad-title" data-click-name="adTitleClick"></div>\n    <div class="_cm-native-ad-cta-wrapper">\n        <div class="_cm-native-ad-cta-button" data-click-name="adCtaButtonClick"></div>\n    </div>\n    <div class="_cm-native-ad-description" data-click-name="adDescriptionClick"></div>\n    <div class="_cm-native-ad-icon">\n    </div>\n    <div class="_cm-native-ad-branding" data-click-name="adBrandingClick"></div>\n    <div class="_cm-ad-choice"></div>\n</div>'},function(e,t){e.exports='<div class="_cm-native-ad-top">\n    <div class="_cm-native-ad-title" data-click-name="adTitleClick"></div>\n    <div class="_cm-native-ad-cta-wrapper">\n        <div class="_cm-native-ad-cta-button" data-click-name="adCtaButtonClick"></div>\n    </div>\n    <div class="_cm-native-ad-description" data-click-name="adDescriptionClick"></div>\n    <div class="_cm-native-ad-icon">\n    </div>\n    <div class="_cm-native-ad-branding" data-click-name="adBrandingClick"></div>\n    <div class="_cm-ad-choice"></div>\n</div>'},function(e,t){e.exports='<div class="_cm-msn-native-ad-top">\n    <div class="_cm-native-ad-title" data-click-name="adTitleClick"></div>\n</div>'},function(e,t){e.exports='<div class="_cm-content-carousel-items-container-wrapper">\n    <div class="_cm-content-carousel-items-container">\n    </div>\n</div>\n<div class=\'_cm-content-carousel-arrows\'>\n    <div class="_cm-content-carousel-arrow _cm-content-carousel-arrow-left">\n        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M0.999999 12L7 6.5L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"  transform="rotate(-180 4,6.5) "/>\n        </svg>\n    </div>\n    <div class="_cm-content-carousel-arrow _cm-content-carousel-arrow-right">\n        <svg width="8" height="13" viewBox="0 0 8 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M0.999999 12L7 6.5L0.999999 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n    </div>\n</div>\n<div class="_cm-content-carousel-blocker">\n\n</div>\n'},function(e,t){e.exports='<img src="{{image}}" height="70" width="120" class="_cm-content-carousel-item-image" />\n<div class="_cm-content-carousel-item-description {{selected}}">\n    {{title}}\n</div>\n<div class="_cm-content-carousel-item-play-icon {{selected}}">\n    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM6 12V4L11.5 8L6 12Z" fill="white"/>\n    </svg>\n</div>\n<div class="_cm-content-carousel-item-playing-now {{selected}}">\n    {{playingNowString}}\n</div>'},function(e,t){e.exports='<div class="_cm-components-wrapper">\n</div>\n'},function(e,t,i){"use strict";i.r(t);var n=i(1),o=i.n(n),r=i(0);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=i(5),l=a.flatten;a.mixin({parseBool:function(e){return"true"===e||!0===e||1===e||"1"===e},hasFlash:function(){return void 0===navigator.plugins||0==navigator.plugins.length?function(){try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){return!1}}():!!navigator.plugins["Shockwave Flash"]},el:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=document.createElement(e);for(var n in t)null!=t[n]&&(i[n]=t[n]);return i},loadJs:function(e,t){return document.head.appendChild(a.el("script",{src:e,onload:t}))},loadCss:function(e,t){return document.head.appendChild(a.el("link",{href:e,onload:t,rel:"stylesheet",type:"text/css"}))},loadJsArr:function(e,t){var i;t&&(i=e.length);for(var n=0;n<e.length;n++)e[n].indexOf(".css")>-1?a.loadCss(e[n],o):a.loadJs(e[n],o);function o(){0==--i&&t()}},getUrlVars:function(e){for(var t,i=[],n=(e=e||window).location.href.slice(e.location.href.indexOf("?")+1).split("&"),o=0;o<n.length;o++)t=n[o].split("="),i.push(t[0]),i[t[0]]=t[1];return i},firePixelConditional:function(e,t,i,n){e&&a.firePixel(t,i,n)},firePixel:function(e,t,i){e&&(i&&(e=a.addParametersToUrl(e,i,-1===e.indexOf("?"))),cmTag.logger.pixel("firing pixel: "+t+" url: "+e),document.createElement("IMG").src=e)},fireIframePixel:function(e,t){if(e){cmTag.logger.pixel("firing pixel: "+t+" url: "+e);var i=document.createElement("iframe");i.src=e,i.style.display="none";var n=document.getElementsByTagName("body")[0];n||(n=document.getElementsByTagName("html")[0]),n||(n=document.getElementsByTagName("div")[0]),n?n.appendChild(i):cmTag.logger.debug("fireIframePixel","Failed to fire iframe pixel.")}else cmTag.logger.pixel("fireIframePixel","Url empty.")},getViewabilityPercent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.offsetHeight,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.offsetWidth,n=e.getBoundingClientRect(),o={top:Math.max(0,n.top),bottom:Math.min(a.viewport().height,n.bottom),left:Math.max(0,n.left),right:Math.min(a.viewport().width,n.right)};return 100*(o.bottom-o.top)*(o.right-o.left)/(t*i)},isVisible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.offsetHeight,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.offsetWidth,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return a.getViewabilityPercent(e,t,i)>=n},viewport:function(){return{get height(){return a.viewport().object.document.documentElement.clientHeight},get width(){return a.viewport().object.document.documentElement.clientWidth},get object(){return top}}},getVideoHeight:function(e){var t=parseInt(9/16*e);return isNaN(t)?0:t},getVideoWidth:function(e){var t=parseInt(16/9*e);return isNaN(t)?0:t},getVideoBestSize:function(e,t){var i=this.getVideoHeight(e);return t>=i?t=i:e=this.getVideoWidth(t),{width:e,height:t}},getVideoHeightByRatio:function(e,t){var i=parseInt(1/t*e);return isNaN(i)?0:i},getVideoWidthByRatio:function(e,t){var i=parseInt(t*e);return isNaN(i)?0:i},isElementInHead:function(e){if(!e)return!1;for(;e!==document.body&&e!==document.head;)e=e.parentNode;return e===document.head},getViewPercent:function(e,t,i,n){var o,s=a.isEmpty(n)?Object(r.a)(this.getTopWindow()):Object(r.a)(n);o=window.taboolaBridge&&window.taboolaBridge.active?this.calcViewportPositionInApp(n):{top:0,left:0,right:s.width(),bottom:s.height()};var l=Number(i)||0,c=Number(t)||0,d=e.getBoundingClientRect(),u={top:d.top,left:d.left};if(u.right=u.left+c,u.bottom=u.top+l,o.right<u.left||o.left>u.right||o.bottom<u.top||o.top>u.bottom)return 0;var h=Math.min(1,(u.bottom-o.top)/l),p=Math.min(1,(o.bottom-u.top)/l);return Math.min(1,(u.right-o.left)/c)*Math.min(1,(o.right-u.left)/c)*h*p*100},isViewable:function(e,t,i,n){var o=a.getViewPercent(e,t,i);return!(o<=0)&&o>=(n||100)},getViewPercentageDeltas:function(e,t,i){var n=Object(r.a)(window),o={top:n.scrollTop(),left:n.scrollLeft()};o.right=o.left+n.width(),o.bottom=o.top+n.height();var s=Number(i)||0,a=Number(t)||0,l=Object(r.a)(e).offset();return l.right=l.left+a,l.bottom=l.top+s,{top:Math.min(1,(l.bottom-o.top)/s),bottom:Math.min(1,(o.bottom-l.top)/s),left:Math.min(1,(l.right-o.left)/a),right:Math.min(1,(o.right-l.left)/a)}},getValidSelectorElements:function(e,t,i){var n=[];return t=t||100,i=i||0,e&&a.isArray(e)&&(n=a.filter(e,(function(e){var n=e.getBoundingClientRect();return n.width>=t&&n.height>=i&&!a.has(o.a.INVALID_SELECTOR_TAG_NAMES,e.tagName)}))),n},filterObject:function(e,t){if(e){for(var i={},n=0;n<t.length;n++){var o=e[t[n]];void 0!==o&&(i[t[n]]=o)}return i}},assignWithoutUndefinedValues:function(e,t){for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e},stripObject:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;if(e){var s={};for(var l in e)if(!(l in t)){var c=e[l];n&&a.isElement(c)||i&&a.isFunction(c)||(o&&!a.isFunction(c)&&a.isObject(c)&&(c=r>0?this.stripObject(c,[],i,n,o,r--):"{stripElements} - value is Object, but max depth reached."),s[l]=c)}return s}},arrayToObj:function(e){if(e){for(var t={},i=0;i<e.length;i++)void 0!==e[i]&&(t[i]=e[i]);return t}},getTopOfEl:function(e){if(e){var t=e,i=0;if(document.getElementById||document.all)do{for(e.offsetLeft,e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent,t=a.getParentNode(t);t!=e;)t.scrollLeft,i-=t.scrollTop,t=a.getParentNode(t)}while(e&&e.offsetParent);else document.layers&&(i+=e.y,e.x);return i}},getParentNode:function(e){return e.parentNode&&e.parentNode.host?e.parentNode.host:e.parentNode},getLeftOfEl:function(e){return window.pageXOffset+e.getBoundingClientRect().left},PrefixedEvent:function(e,t,i,n){i=i.toLowerCase(),a.each(["webkit","moz","MS","o",""],(function(o){e[t](o+i,n)}))},oneAnimationEnd:function(e,t){var i=a.debounce(t,200);this.PrefixedEvent(e,"one","transitionend",i),this.PrefixedEvent(e,"one","animationend",i)},addParametersToUrl:function(e,t,i){var n=e;return n+=i?"?":"&",r.a.each(t,(function(e,t){void 0!==t&&""!==t&&(n+=e+"="+t+"&")})),n},skipTransitionCss:function(e,t){e.addClass("none-transition"),e.css(t),this.flushCss(e[0]),e.removeClass("none-transition")},flushCss:function(e){e.offsetHeight},getTopWindow:function(){var e=window;try{for(;e.document!==e.top.document;)e=e.top;return e}catch(e){return window}},isInIframe:function(e){return!!e&&(e.inIframe||e.inDFP)},isInFriendlyIframe:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cmTag.config.iframeData;return!!e&&this.isInIframe(e)&&e.isFriendlyIframe},hideDFPIframe:function(e){if(this.isInFriendlyIframe(e)){e.iframe.style.display="none";for(var t=e.iframe.parentNode;a.some(o.a.DFP_KEYWORDS,(function(e){return-1!==t.id.indexOf(e)}));)t.style.display="none",t=t.parentNode}},onceDocReady:function(e){return/complete|loaded|interactive/.test(document.readyState)&&document.body?e():Object(r.a)("document").one("DOMContentLoaded",e),this},crc32:function(e){if(!e||"string"!=typeof e)return 0;var t;void 0===t&&(t=0);var i=0;t^=-1;for(var n=0,o=(e=this.utf8Encode(e)).length;n<o;n++)i=255&(t^e.charCodeAt(n)),t=t>>>8^"0x"+"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".substr(9*i,8);return-1^t},utf8Encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},isMouseOver:function(e){return 0!==e.filter(":hover").length},rollNumbers:function(e){return!!e&&100*Math.random()<e},isFactor:function(e){return a.isNumber(e)&&e===a.random(1,e)},sendMail:function(e,t,i){function n(){emailjs.init("user_kHlYxxusLRTxC6yr3PjQl"),emailjs.send("gmail","units_support",e).then(t,i)}t=t||function(){},i=i||function(){},window.emailjs?n():a.loadJs("//cdn.emailjs.com/dist/email.min.js",n)},isValidEmail:function(e){return!0},toCssObj:function(e){return"string"==typeof e?JSON.parse(e):e},isLayerVisible:function(e){function t(e,t){return window.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle?e.currentStyle[t]:void 0}return function e(i,n,o,r,s,a,l){var c=i.parentNode;return!!function(e){for(;e=e.parentNode;)if(e===document)return!0;return!1}(i)&&(9===c.nodeType||"0"!==t(i,"opacity")&&"none"!==t(i,"display")&&"hidden"!==t(i,"visibility")&&(void 0!==n&&void 0!==o&&void 0!==r&&void 0!==s&&void 0!==a&&void 0!==l||(n=i.offsetTop,s=i.offsetLeft,r=n+i.offsetHeight,o=s+i.offsetWidth,a=i.offsetWidth,l=i.offsetHeight),!c||("hidden"!==t(c,"overflow")&&"scroll"!==t(c,"overflow")||!(s+2>c.offsetWidth+c.scrollLeft||s+a-2<c.scrollLeft||n+2>c.offsetHeight+c.scrollTop||n+l-2<c.scrollTop))&&(i.offsetParent===c&&(s+=c.offsetLeft,n+=c.offsetTop),e(c,n,o,r,s,a,l))))}(e)},getOffset:function(e,t){if(e&&Array.isArray(e)&&e[0]&&(e=e[0]),e){if(1===t)return Object(r.a)(e).offset();var i=e,n=e,o=0,s=0;if(document.getElementById||document.all)do{for(s+=e.offsetLeft-e.scrollLeft,o+=e.offsetTop-e.scrollTop,e=e.offsetParent,n=a.getParentNode(n);n&&n!=e;)s-=n.scrollLeft,o-=n.scrollTop,n=a.getParentNode(n)}while(e&&e.offsetParent);else document.layers&&(o+=e.y,s+=e.x);return{top:o,left:Object(r.a)(i).offset().left||s}}},flatten:function(e){var t={};for(var i in e)t[i]=e[i];return t},cssObjToString:function(e){var t=!!document.documentMode,i=!t&&!!window.StyleMedia,n=window.navigator.userAgent.indexOf("Firefox")>-1;return(t||i||n)&&(e=this.flatten(e)),JSON.stringify(e)},isModel:function(e,t,i){return i?i.model.get(e)===t:this.model.get(e)===t},generateGuid:function(e,t){var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),n=[],o=0;for(t=t||i.length,e=e||22,o=0;o<e;o++)n[o]=i[0|Math.random()*t];return n.join("")},isObserverSupported:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=window[e],n=void 0!==i,o=!1;n&&(o=-1!==i.toString().indexOf("[native code]"));var r=o||t&&n;return r},isHeightValid:function(e){var t=!0;return e||(t=!1),t},isWidthValid:function(e){var t=!0;return e||(t=!1),t},setTrcObserver:function(e){s(TRC.intersections)&&TRC.intersections.observe&&TRC.intersections.observe(e)},dispatchTRC:function(e){TRC&&TRC.dispatch&&(TRC.dispatch(e),cmTag.logger&&cmTag.logger.info&&cmTag.logger.info("dispatched TRC event: ".concat(e)))},dispatchTRCWithPayload:function(e,t){TRC&&TRC.dispatch&&(TRC.dispatch(e,t),cmTag.logger&&cmTag.logger.info&&cmTag.logger.info("dispatched TRC event: ".concat(e)))},getOffsetWithContainer:function(e,t,i){if(!i)return this.getOffset(e,t);var n=this.getOffset(e,t),o=this.getOffset(Object(r.a)(i));return{top:n.top-o.top,left:n.left-o.left}},getIframeDocument:function(e){try{if(e.tagName&&"iframe"==e.tagName.toLowerCase())return e.contentWindow.console.error&&(e.contentWindow.console.error=function(){}),e.contentDocument}catch(e){return null}},DOMIterator:function(e,t,i,n){var o=this;try{var r=this.getIframeDocument(e)||e;if(!r)return;r.querySelectorAll(t).forEach((function(e){o.DOMIterator(e,t,i,n)})),i(r.querySelectorAll(n))}catch(e){}},isBrowserIE11:function(e){return-1!==e.name.indexOf("ie")&&11===e.version},forceElementRedrawWithBorderChange:function(e,t,i){if(this.isBrowserIE11(e)&&!i){var n=Object(r.a)(t);n&&n.css&&(n.css("border","1px solid transparent"),setTimeout(function(){n&&n.css&&n.css("border","none")}.bind(n)))}},hasPassedPixelFromSelector:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;if(e){var o=e.toString(),s=Object(r.a)(o),a=s;n&&(a=this.getValidSelectorElements(s));var l=a[0];if(t=Object(r.a)(t)[0],window.taboolaBridge){var c=taboolaBridge.data,d=c.boundingClientRect.top-c.rootBounds.bottom,u=d<i;return cmTag.logger.info("###hasPassedPixelsFromSelector"+u+" - "+d+"/"+i),u}var h=void 0!==t,p=h?t.clientHeight:window.innerHeight,f=h?p+t.scrollTop:p+window.pageYOffset,m=i,g=this.getTopOfEl(l),y=g-m;return y<=f}},getViewportHeight:function(e){return void 0!==(e=Object(r.a)(e)[0])?e.clientHeight:window.innerHeight},calcViewportPositionInApp:function(e){var t=window.taboolaBridge.data,i=t.boundingClientRect;return{top:i.y<0?0-i.y:0,left:0,right:i.width,bottom:i.y>t.rootBounds.height?0:Math.abs(i.y-t.rootBounds.height)}},getOrganicCard:function(){var e=TRCImpl.boxes||{};for(var t in e){var i=e[t]||{},n=i.isFeedCard,o=!1;if(i.itemsTypes&&i.itemsTypes["is-organic"]&&(o=i.itemsTypes["is-organic"]),o&&n&&i.boxes.length)return i.mode}},getRootElementFontSize:function(){return parseFloat(getComputedStyle(document.documentElement).fontSize)},convertRem:function(e){return e*this.getRootElementFontSize()},flattenArray:function(e,t){return l(e,t,!1)},offsetFromBottomOfViewPort:function(e){return e.getBoundingClientRect().top-(window.innerHeight||document.documentElement.clientHeight)},sendingEventToTaboolaBridge:function(e,t){window.taboolaBridge&&window.taboolaBridge.emit("videoEvent",{type:e,value:t})},recoReelPlayStateAnimation:function(e,t,i){var n=Object(r.a)('[data-progress-bar-index="'.concat(t,'"] .tbl-progress-runner'),e)[0],o=Object(r.a)(".videoCube_".concat(t+1,"_child .thumbBlock"),e)[0];n&&(n.style.webkitAnimationPlayState=i,n.style.animationPlayState=i),o&&(o.style.webkitAnimationPlayState=i,o.style.animationPlayState=i)},getRandomFromList:function(e){return!(e.length<1)&&e[Math.floor(Math.random()*e.length)]},isSendBeaconSupported:function(){return!(!navigator||!a.isFunction(navigator.sendBeacon))},getSubUnitType:function(e){var t=e.isSticky,i=e.isDetachBelow,n=e.isDetachAbove,r=e.isStartFromSlider,s=e.isDetachToSlider;return t||!r||s?t||r||!s?!t&&r&&s?o.a.SUB_UNIT_TYPE.SUPER_SLIDER:t&&i&&!n?o.a.SUB_UNIT_TYPE.STICKY_BELOW:t&&!i&&n?o.a.SUB_UNIT_TYPE.STICKY_ABOVE:t&&i&&n?o.a.SUB_UNIT_TYPE.STICKY_BELOW_ABOVE:void 0:o.a.SUB_UNIT_TYPE.DETACH_TO_SLIDER:o.a.SUB_UNIT_TYPE.START_FROM_SLIDER},trcPerformanceMeasurement:function(e,t,i){try{if(e&&a.isTRCPerformanceEnabled()){var n="".concat(t).concat(i);window.TRC.performance.mark(n,null,"","",t,window.TRC.PerfEvenType[i.toUpperCase()])}}catch(e){}},isTRCPerformanceEnabled:function(){return window.TRC&&window.TRC.performance&&window.TRC.performance.mark},copyCSSFromPlaceholder:function(e,t,i){if(e&&t&&i&&0!==i.length){var n=window.getComputedStyle(t),o={};a.forEach(i,(function(e){o[e]=n[e]})),e.css(o)}}})},function(e,t,i){var n=i(5);n.mixin({createVpaidLog:function(e,t){var i=null,o=e,r=e.model,s=Date.now(),a=!1,l=["conversion","soundViolation","timeout","bfRon","adPlayTimeout","vastFilterdByRegex","queExpierd","queTrimmed","tagError","tagFlashError","vpaidFlashClientError","queueTrimmed","tillAdstartTimeout","timeoutAutoKill","error_vpaidGeneralError","error_vpaidLoadError","error_vpaidLoadTimeout","error_vpaidInitAdError","error_vpaidInitAdTimeout","error_vpaidStartAdError","error_vpaidStartAdTimeout","error_vpaidPlayError","adStopped"],c={BfRon:!0};delete t.conversionPixels,t.dp=(t.lp&&t.lp.length>0?t.lp[0]:"").replace(/http:\/\/|.com|https:\/\/|.com/g,"")||"na";var d={tag:t,created:(new Date).toISOString(),dp:t.dp,status:"new",unitType:r.get("unitType"),connectionType:-1},u=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(u){var h=u.type||-1;d.connectionType=h}d.hasFetch=Boolean(window.fetch),d.url=window.location.href,screen&&(d.screen={},d.screen.Size=screen.width+"X"+screen.height||-1,d.screen.PixelDepth=screen.pixelDepth||-1,d.screen.orientation=screen.orientation?screen.orientation.type:"not-found");var p=r.get("session_started")||Date.now(),f=function(e,t){(function(){if(null!==i)return i;var e=parseInt(r.get("gaFactor"))||1e3;if(1===e)return i=!0;e>100&&(e=100),r.get("abTest")&&(e=50);var t,n=(0,t=e,Math.floor(Math.random()*(t-0+1))+0);return i=n===e})()&&function(e,t){var i=o.version,n=r.get("abTest")||"",s=new XMLHttpRequest,a=r.get("kbnul");s.open("POST",a+"/putes/mobileanalytics",!0);var l={event:e,timestamp:(new Date).toISOString(),version:i,abTest:n};l=Object.assign(l,t),s.send(JSON.stringify(l))}(e,t)},m=function(e){var t=r.get(d.dp+e)||0,i=r.get(d.tag.lineItemId+e)||0;r.set(d.dp+e,t+1),r.set(d.tag.lineItemId+e,i+1)};return{push:function(e,t){if(d){t=t||{},e.indexOf("Error")>-1||"event_SoundViolation"===e?d.status=function(e,t){return"error_"+(t.errType?t.errType:e)}(e,t):this.eventToStatus.hasOwnProperty(e)&&"conversion"!==d.status?d.status=this.eventToStatus[e]:c.hasOwnProperty(e)&&(d["is"+e]=!0);var i=Date.now()-p,n=Date.now()-s;if(t.time=n,t.globalTime=i,d.hasOwnProperty(e))return Array.isArray(!d[e])||(d[e]=[d[e]]),void d[e].push(t);d[e]=t,-1!==l.indexOf(d.status)&&function(){if(!a){var e=d.tag;a=!0,m(".tries"),"conversion"===d.status?(m(".conversions"),r.set(d.dp+".failsRow",0),r.set(e.lineItemId+".failsRow",0)):(m(".fails"),m(".failsRow"));var t=r.get(d.dp)||{fails:0,failsRow:0,conversions:0},i=Object.assign(r.get(e.lineItemId.toString()),{fails:0,failsRow:0,conversions:0});t.lineItems=t.lineItems||[],i.conversions=t.conversions=t.conversions||0,i.fails=t.fails=t.fails||0,i.failsRow=t.failsRow=t.failsRow||0,-1===t.lineItems.indexOf(e.lineItemId)&&t.lineItems.push(e.lineItemId),d.dpLog=t;var n=r.get("lineItems")||[];-1===n.indexOf(e.lineItemId)&&(n.push(e.lineItemId),r.set("lineItems",n)),r.set(e.lineItemId,i)}}()}},saveToDb:function(){if(d){var e;try{e=n.getLoopTime()}catch(e){}e&&(d.loopTime=e),f("VpaidLog",d),t=null,d=null}},eventToStatus:{event_AdImpression:"conversion",event_SoundViolation:"soundViolation",vpaidGeneralError:"vpaidGeneralError",vpaidLoadError:"vpaidLoadError",vpaidLoadTimeout:"vpaidLoadTimeoutError",vpaidInitAdError:"vpaidInitAdError",vpaidInitAdTimeout:"vpaidInitAdTimeoutError",vpaidStartAdError:"vpaidStartAdError",vpaidStartAdTimeout:"vpaidStartAdTimeoutError",vpaidPlayError:"vpaidPlayError",event_AdLoaded:"adLoaded",fetchVast:"fetchVast",adStopped:"adStopped"}}}})},function(e,t,i){var n,o,r;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=i(5),l=i(3);(function(){var e,t,i,n,o,r,s,c=[].slice;i=function(e){var t,n;return!a.isObject(e)||a.isFunction(e)||e instanceof l.Collection||e instanceof l.Model?e:a.isDate(e)?new Date(e.getTime()):a.isRegExp(e)?new RegExp(e.source,e.toString().replace(/.*\//,"")):e instanceof HTMLElement||e.nodeType&&1===e.nodeType?e:e instanceof CSSStyleDeclaration?JSON.stringify(s(e)):(n=a.isArray(e||a.isArguments(e)),t=function(e,t,o){return n?e.push(i(t)):e[o]=i(t),e},a.reduce(e,t,n?[]:{}))},s=function(e){var t=!!document.documentMode,i=!t&&!!window.StyleMedia;if(!t&&!i)return e;var n={};for(var o in e)n[o]=e[o];return n},r=function(e){return null!=e&&(e.prototype==={}.prototype||e.prototype===Object.prototype)&&a.isObject(e)&&!a.isArray(e)&&!a.isFunction(e)&&!a.isDate(e)&&!a.isRegExp(e)&&!a.isArguments(e)},t=function(e){return a.filter(a.keys(e),(function(t){return r(e[t])}))},e=function(e){return a.filter(a.keys(e),(function(t){return a.isArray(e[t])}))},o=function(i,n,r){var s,l,c,d,u,h,p,f;if(null==r&&(r=20),r<=0)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),a.extend(i,n);for(l=function(e){return n[e]=o(i[e],n[e],r-1)},u=0,p=(d=a.intersection(t(i),t(n))).length;u<p;u++)l(d[u]);for(s=function(e){return n[e]=a.union(i[e],n[e])},h=0,f=(c=a.intersection(e(i),e(n))).length;h<f;h++)s(c[h]);return a.extend(i,n)},n=function(){var e,t,n,r;if(n=2<=arguments.length?c.call(arguments,0,r=arguments.length-1):(r=0,[]),t=arguments[r++],a.isNumber(t)||(n.push(t),t=20),n.length<=1)return n[0];if(t<=0)return a.extend.apply(this,n);for(e=n.shift();n.length>0;)e=o(e,i(n.shift()),t);return e},a.mixin({deepClone:i,isBasicObject:r,basicObjects:t,arrays:e,deepExtend:n})}).call(this),o=[i(5),i(3)],void 0===(r="function"==typeof(n=function(t,i){function n(e){var i={},o=d.keyPathSeparator;for(var r in e){var s=e[r];if(s&&s.constructor===Object&&!t.isEmpty(s)){var a=n(s);for(var l in a){var c=a[l];i[r+o+l]=c}}else i[r]=s}return i}function o(e,i,n){for(var o=d.keyPathSeparator,r=i.split(o),s=e,a=0,l=r.length;a<l;a++){if(n&&!t.has(s,r[a]))return!1;if(null==(s=s[r[a]])&&a<l-1&&(s={}),void 0===s)return!!n||s}return!!n||s}function r(e,i,n,o){o=o||{};for(var r=d.keyPathSeparator,s=i.split(r),a=e,l=0,c=s.length;l<c&&void 0!==a;l++){var u=s[l];l===c-1?o.unset?delete a[u]:a[u]=n:(void 0!==a[u]&&t.isObject(a[u])||(a[u]={}),a=a[u])}}function a(e){var i={};return"object"!==s(e)?e:(t.each(e,(function(e,t,n){i[t]=l(e)})),i)}function l(e){if(e&&"["===e[0]&&"]"===e[e.length-1]){var i;try{i=JSON.parse(e)}catch(t){i=e}e=i}if(t.isArray(e)){var n=[];return t.each(e,(function(e){n.push(l(e))})),n}return"object"!==s(e)||t.isElement(e)?"true"===e||!0===e||"false"!==e&&!1!==e&&(""===e||isNaN(e)?e:Number(e)):a(e)}function c(e,t){r(e,t,null,{unset:!0})}var d=i.Model.extend({constructor:function(e,i){var n,o=e||{};this.cid=t.uniqueId("c"),this.attributes={},i&&i.collection&&(this.collection=i.collection),i&&i.parse&&(o=this.parse(o,i)||{}),(n=t.result(this,"defaults"))&&(o=t.deepExtend({},n,o)),this.set(o,i),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(e){return t.deepClone(this.attributes)},get:function(e){return o(this.attributes,e)},set:function(e,i,l){var u,h,p,f,m,g,y,v;if(null==e)return this;if("object"===s(e)?(h=e,l=i||{}):(h={})[e]=i,h=a(h),l||(l={}),!this._validate(h,l))return!1;for(u in p=l.unset,m=l.silent,f=[],g=this._changing,this._changing=!0,g||(this._previousAttributes=t.deepClone(this.attributes),this.changed={}),v=this.attributes,y=this._previousAttributes,this.idAttribute in h&&(this.id=h[this.idAttribute]),h=n(h))i=h[u],t.isEqual(o(v,u),i)||f.push(u),t.isEqual(o(y,u),i)?c(this.changed,u):r(this.changed,u,i),p?c(v,u):r(v,u,i);if(!m){f.length&&(this._pending=!0);for(var b=d.keyPathSeparator,_=0,w=f.length;_<w;_++){e=f[_],this.trigger("change:"+e,this,o(v,e),l);for(var T=e.split(b),S=T.length-1;S>0;S--){var A=t.first(T,S).join(b),P=A+b+"*";this.trigger("change:"+P,this,o(v,A),l),this.trigger("change:"+A,this,o(v,e),l)}}}if(g)return this;if(!m)for(;this._pending;)this._pending=!1,this.trigger("change",this,l);return this._pending=!1,this._changing=!1,this},clear:function(e){var i={},o=n(this.attributes);for(var r in o)i[r]=void 0;return this.set(i,t.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!t.isEmpty(this.changed):void 0!==o(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&n(this.changed);var i=this._changing?this._previousAttributes:this.attributes;e=n(e),i=n(i);var o,r=!1;for(var s in e)t.isEqual(i[s],o=e[s])||((r||(r={}))[s]=o);return r},previous:function(e){return null!=e&&this._previousAttributes?o(this._previousAttributes,e):null},previousAttributes:function(){return t.deepClone(this._previousAttributes)}});return d.keyPathSeparator=".",i.DeepModel=d,e.exports=d,i})?n.apply(t,o):n)||(e.exports=r)},function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=i(5),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i;return t=e,(i=[{key:"addUnit",value:function(e,t){o.isEmpty(window.TRC.videoUnitList)&&(window.TRC.videoUnitList={}),this.unitsList=window.TRC.videoUnitList||{},this.unitsList[e]=t,window.TRC.videoUnitList=this.unitsList,this._listenUnitsEvents(e)}},{key:"_listenUnitsEvents",value:function(e){this.unitsList[e].on("change:isUnitEligible",this._onUnitEligibilityChange.bind(this,e))}},{key:"_onUnitEligibilityChange",value:function(e,t,i){o.size(this.unitsList)>1&&(!0===i||!1===i)&&this._decidePlayOrPause()}},{key:"_decidePlayOrPause",value:function(){var e=this,t=[];o.each(this.unitsList,(function(i){var n=i.get("redId"),o="CUSTOM"==e._getUnitType(n);e._isUnitEligibleToPlay(n)?t.push({redId:n,viewPercent:i.get("unitViewablePercent"),isCustomVideo:o}):o&&e._pauseUnit(n)})),t.length>0&&(t=this._sortViewableUnits(t),o.each(t,(function(t,i){0===i?e._playUnit(t.redId):t.isCustomVideo&&e._pauseUnit(t.redId)})))}},{key:"_sortViewableUnits",value:function(e){return e.sort((function(e,t){return e.isCustomVideo===t.isCustomVideo?t.viewPercent-e.viewPercent:!e.isCustomVideo&&t.isCustomVideo?-1:1}))}},{key:"_pauseUnit",value:function(e){this.unitsList[e].set("multiUnitManager.state","pause")}},{key:"_playUnit",value:function(e){this.unitsList[e].set("multiUnitManager.state","play")}},{key:"_isUnitEligibleToPlay",value:function(e){return this.unitsList[e].get("isEligibleToPlay")||this.unitsList[e].get("isUnitEligible")||this.unitsList[e].get("isUnitViewable")}},{key:"_isUnitAllowToPlay",value:function(e){return"pause"!=this.unitsList[e].get("multiUnitManager.state")&&this._isUnitEligibleToPlay(e)}},{key:"_isUnitPlaying",value:function(e){return this.unitsList[e].get("generalPlayingUnitState")}},{key:"_getUnitType",value:function(e){return this.unitsList[e].get("unitType")}}])&&n(t.prototype,i),e}();cmTag.multiUnitManager=cmTag.multiUnitManager||new r,e.exports=cmTag.multiUnitManager},function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=i(3),r=i(5),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callBacks={},this._mapCallbackNames(),this._setCallbacks(t)}var t,i;return t=e,(i=[{key:"_setCallbacks",value:function(e){this.isValidCallback(e,this.callbackNames.conversion)&&(this.callBacks.onConversion=e.onConversion,o.on("global:creativeEvent",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.conversion))),this.isValidCallback(e,this.callbackNames.fill)&&(this.callBacks.onFilledImpression=e.onFilledImpression,o.on("filledImpression",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.fill))),this.isValidCallback(e,this.callbackNames.impression)&&(this.callBacks.onImpression=e.onImpression,o.on("onImpression",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.impression))),this.isValidCallback(e,this.callbackNames.play)&&(this.callBacks.onPlay=e.onPlay,o.on("global:adState:playing",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.play))),this.isValidCallback(e,this.callbackNames.terminate)&&(this.callBacks.onTerminate=e.onTerminate,o.once("global:closeState:changed",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.terminate))),this.isValidCallback(e,this.callbackNames.passback)&&(this.callBacks.onPassback=e.onPassback,o.once("global:passback",this._onGlobalCreativeEvent.bind(this,e,this.callbackNames.passback)))}},{key:"_onGlobalCreativeEvent",value:function(e,t,i){t=t||{},this.callBacks[t.type]&&this.callBacks[t.type](i),t.name&&TRC&&TRC.dispatch&&TRC.dispatch("api::video."+t.name,e)}},{key:"isValidCallback",value:function(e,t){if("string"==typeof e[t.type]){var i=this._getCallbackFunction(e[t.type]),n=new Function("additionalData",i);delete e[t.type],Object.defineProperty(e,t.type,{value:n})}return!(!r.isFunction(e[t.type])&&!this._isApiCallbackExist(t.name))}},{key:"_getCallbackFunction",value:function(e){var t=e.substr(e.indexOf("{")+1);return t.substr(0,t.lastIndexOf("}"))}},{key:"_isApiCallbackExist",value:function(e){if(TRC&&TRC._taboolaClone)for(var t=0;t<TRC._taboolaClone.length;t++)if(TRC._taboolaClone[t].listenTo=="video."+e)return!0;return!1}},{key:"_mapCallbackNames",value:function(){this.callbackNames={conversion:{type:"onConversion",name:"conversion"},fill:{type:"onFilledImpression",name:"fill"},impression:{type:"onImpression",name:"impression"},play:{type:"onPlay",name:"play"},terminate:{type:"onTerminate",name:"terminate"},passback:{type:"onPassback",name:"passback"}}}}])&&n(t.prototype,i),e}();e.exports=s},function(e,t,i){e.exports={beforeCMTag:i(79)}},function(e,t,i){var n=i(5),o=i(1),r=i(80),s=i(81);e.exports=function(e){n.trcPerformanceMeasurement(e.trcPerformanceMeasurementEnabled,"videoBeforeCMTagNativeCode",o.TRC_PERFORMANCE_ACTIONS.START),r.set("Function","bind"),r.set("Event","constructor",!0),r.set("Array","forEach",!1),r.set("Array","every",!1),r.setWindowFunctions(e.nativeFunctions),n.trcPerformanceMeasurement(e.trcPerformanceMeasurementEnabled,"videoBeforeCMTagNativeCode",o.TRC_PERFORMANCE_ACTIONS.STOP),new s,window.cmTag.customDataForTest={startWithABT:!1},e.gaFactor&&n.isFactor(parseInt(e.gaFactor))&&window.addEventListener("error",(function(t){try{if(-1==t.filename.indexOf("infra/cmTag"))return;var i={timestamp:(new Date).toISOString(),message:t.message,lineNum:t.lineno,fullUrl:window.location.href,userAgent:window.navigator.userAgent,firedStartWithABT:window.cmTag.customDataForTest.startWithABT,unitType:e.unitType};t.error&&(i.callStack=t.error.stack);var n=new XMLHttpRequest;n.open("POST","//vidanalytics.taboola.com/putes/cm_units_error_logs",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded");var o=JSON.stringify(i);n.send(o)}catch(t){}}))}},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=null,o=function(e){return/\{\s*\[native code\]\s*\}/.test(""+e)},r=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n||(n=this),n}var t,r;return t=e,(r=[{key:"set",value:function(e,t,i){o(window[e])&&o(window[e].prototype[t])||(this.iframe||this.createIframe(),this.iframe.contentWindow[e].prototype[t]&&(window[e].prototype||(window[e]=function(){}),window[e].prototype[t]=this.iframe.contentWindow[e].prototype[t],i&&(window[e]=this.iframe.contentWindow[e])))}},{key:"setWindowFunctions",value:function(e){e&&(this.iframe||this.createIframe(),e.split(",").forEach(function(e){var t=e.split(".");this.setWindowNestedFunctions(window,t)}.bind(this)))}},{key:"createIframe",value:function(){this.iframe=document.createElement("iframe"),this.iframe.style.width=0,this.iframe.style.height=0,this.iframe.style.visibility="hidden",this.iframe.style.display="none",document.body.appendChild(this.iframe)}},{key:"setWindowNestedFunctions",value:function(e,t){var i=t.shift();0==t.length?e[i]=this.iframe.contentWindow[i]:this.setWindowNestedFunctions(e[i],t)}}])&&i(t.prototype,r),e}();e.exports=new r},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.arrayFrom()}var t,n;return t=e,(n=[{key:"arrayFrom",value:function(){var e,t,i,n;Array.from||(Array.from=(e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},i=Math.pow(2,53)-1,n=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),i)},function(e){var i=this,o=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,s=arguments.length>1?arguments[1]:void 0;if(void 0!==s){if(!t(s))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(r=arguments[2])}for(var a,l=n(o.length),c=t(i)?Object(new i(l)):new Array(l),d=0;d<l;)a=o[d],c[d]=s?void 0===r?s(a,d):s.call(r,a,d):a,d+=1;return c.length=l,c}))}}])&&i(t.prototype,n),e}();e.exports=n},function(e,t,i){var n={"./AdTypeConfig":11,"./AdTypeConfig.js":11,"./AdTypeTranslator":26,"./AdTypeTranslator.js":26,"./Adjacency/DefaultAdjacencyConfig":38,"./Adjacency/DefaultAdjacencyConfig.js":38,"./Adjacency/units/AdjacFeedManagerConfig":39,"./Adjacency/units/AdjacFeedManagerConfig.js":39,"./Adjacency/units/AdjacencyRecoReelWidgetConfig":40,"./Adjacency/units/AdjacencyRecoReelWidgetConfig.js":40,"./Adjacency/units/AdjacencyWidgetItemConfig":41,"./Adjacency/units/AdjacencyWidgetItemConfig.js":41,"./Replayable/DefaultReplayableConfig":42,"./Replayable/DefaultReplayableConfig.js":42,"./Replayable/units/ReplayableAdFeedManagerConfig":43,"./Replayable/units/ReplayableAdFeedManagerConfig.js":43,"./Replayable/units/ReplayableAdInlineConfig":44,"./Replayable/units/ReplayableAdInlineConfig.js":44,"./Replayable/units/ReplayableAdWidgetItemConfig":45,"./Replayable/units/ReplayableAdWidgetItemConfig.js":45,"./SingleAd/DefaultSingleAdConfig":46,"./SingleAd/DefaultSingleAdConfig.js":46,"./SingleAd/units/SingleAdFeedManagerConfig":47,"./SingleAd/units/SingleAdFeedManagerConfig.js":47,"./SingleAd/units/SingleAdInlineConfig":48,"./SingleAd/units/SingleAdInlineConfig.js":48,"./SingleAd/units/SingleAdSliderConfig":49,"./SingleAd/units/SingleAdSliderConfig.js":49,"./SingleAd/units/SingleAdWidgetItemConfig":50,"./SingleAd/units/SingleAdWidgetItemConfig.js":50};function o(e){var t=r(e);return i(t)}function r(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=r,e.exports=o,o.id=82},function(e,t,i){var n={};n.demo=i(84),n.level=i(85),n.isFireAllPixels=i(86),n.predictorsPresets=i(87),n.isDebug=i(88),e.exports=n},function(e,t){e.exports={strength:101,atr:{},1:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1,mntmbtwfs:999,mintimwf:999e3,mxtmbtwfs:999,time_between_waterfall:999}},onOutOfView:"pause",isPWOV:!1,noaop:1}},2:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":779408,"midroll.pubId":133128,"midroll.pubTagId":779408,"postroll.pubId":133128,"postroll.pubTagId":779408,pubId:133128,pubTagId:779408,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},3:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1184655,"midroll.pubId":133128,"midroll.pubTagId":1184655,"postroll.pubId":133128,"postroll.pubTagId":1184655,pubId:133128,pubTagId:1184655,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},isPWOV:!1}},4:{atr:{isDebug:!0,originId:15,"preroll.pubId":133128,"preroll.pubTagId":1046821,"midroll.pubId":133128,"midroll.pubTagId":1046821,"postroll.pubId":133128,"postroll.pubTagId":1046821,pubId:133128,pubTagId:1046821,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause"}},5:{atr:{originId:15,"preroll.pubId":133128,"preroll.pubTagId":1633025,"midroll.pubId":133128,"midroll.pubTagId":1633025,"postroll.pubId":133128,"postroll.pubTagId":1633025,pubId:133128,pubTagId:1633025,player:{settings:{mprdct:0,cmbopps:!1,encwfrs:!1}},onOutOfView:"pause",isPWOV:!1}}}},function(e,t){var i={atr:{},platform:{Desktop:{atr:{}},Mobile:{atr:{secondsBW:20}}}},n={strength:1,atr:{},101:{atr:{pubId:165757,pubTagId:946347,preroll:{pubId:165757,pubTagId:946347},midroll:{pubId:165757,pubTagId:946347},postroll:{pubId:165757,pubTagId:946347}}},2:{atr:{secondsToClose:120,secondsBW:20}},3:{atr:{secondsToClose:120,pubId:208401,pubTagId:1047981,preroll:{pubId:208401,pubTagId:1047981},midroll:{pubId:208401,pubTagId:1047981},postroll:{pubId:208401,pubTagId:1047981}},units:{FEED_MANAGER:i,INLINE_INSTREAM_OLD:i,INLINE_INSTREAM_VFORCE:i,SLIDER_INSTREAM:i,SLIDER_OUTSTREAM:i,WIDGET_ITEM:i}},4:{atr:{pubId:292045,pubTagId:1565025,preroll:{pubId:292045,pubTagId:1565025},midroll:{pubId:292045,pubTagId:1565025},postroll:{pubId:292045,pubTagId:1565025}}},5:{atr:{pubId:383725,pubTagId:2077655,preroll:{pubId:383725,pubTagId:2077655},midroll:{pubId:383725,pubTagId:2077655},postroll:{pubId:383725,pubTagId:2077655}}}};e.exports=n},function(e,t){e.exports={strength:101,atr:{},1:{atr:{pixels:{startWithABT:{isFire:!0},getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0},secondsToCloseTimer:{isFire:!0},secondsToCloseGlobalTimer:{isFire:!0},midrollCollapseTimer:{isFire:!0}}}},2:{atr:{pixels:{getAdAny:{isFire:!0},getAdNoRV:{isFire:!0},getAd:{isFire:!0}}}}}},function(e,t){e.exports={strength:101,1:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}},2:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!1},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}},firstScroll:{isActive:!0,predictPoints:[0,0]}}}},3:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q0"}}},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},4:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},5:{atr:{predictors:{multiAd:{isActive:!1},playerReady:{isActive:!0,predictPoint:"any"},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},99:{atr:{predictors:{autoKill:{isActive:!1},getAdFail:{isActive:!1},multiAd:{isActive:!1},loading:{isActive:!1},repeat:{isActive:!1},playerReady:{isActive:!1},distancePercent:{isActive:!1},distancePixels:{isActive:!1},firstScroll:{isActive:!1}}}},101:{atr:{predictors:{multiAd:{isActive:!0,predictPoints:{any:{qState:"q1"}}},playerReady:{isActive:!0,predictPoint:0},distancePixels:{isActive:!0,predictPoints:{1:{pixelsFromSelectors:10}}}}}}}},function(e,t){e.exports={strength:102,1:{atr:{player:{settings:{encwfrs:!1}}}}}},function(e,t,i){"use strict";(function(t){function i(e){return e instanceof t||e instanceof Date||e instanceof RegExp}function n(e){if(e instanceof t){var i=t.alloc?t.alloc(e.length):new t(e.length);return e.copy(i),i}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw new Error("Unexpected situation")}function o(e){var t=[];return e.forEach((function(e,r){"object"==typeof e&&null!==e?Array.isArray(e)?t[r]=o(e):i(e)?t[r]=n(e):t[r]=s({},e):t[r]=e})),t}function r(e,t){return"__proto__"===t?void 0:e[t]}var s=e.exports=function(){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];var e,t,a=arguments[0],l=Array.prototype.slice.call(arguments,1);return l.forEach((function(l){"object"!=typeof l||null===l||Array.isArray(l)||Object.keys(l).forEach((function(c){return t=r(a,c),(e=r(l,c))===a?void 0:"object"!=typeof e||null===e?void(a[c]=e):Array.isArray(e)?void(a[c]=o(e)):i(e)?void(a[c]=n(e)):"object"!=typeof t||null===t||Array.isArray(t)?void(a[c]=s({},e)):void(a[c]=s(t,e))}))})),a}}).call(this,i(90).Buffer)},function(e,t,i){"use strict";(function(e){var n=i(91),o=i(92),r=i(93);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return c(this,e,t,i)}function c(e,t,i,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,n){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===i&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,i):new Uint8Array(t,i,n),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t),e}(e,t,i,n):"string"==typeof t?function(e,t,i){if("string"==typeof i&&""!==i||(i="utf8"),!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|f(t,i),o=(e=a(e,n)).write(t,i);return o!==n&&(e=e.slice(0,o)),e}(e,t,i):function(e,t){if(l.isBuffer(t)){var i=0|p(t.length);return 0===(e=a(e,i)).length||t.copy(e,0,0,i),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?a(e,0):h(e,t);if("Buffer"===t.type&&r(t.data))return h(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(d(t),e=a(e,t<0?0:0|p(t)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function h(e,t){var i=t.length<0?0:0|p(t.length);e=a(e,i);for(var n=0;n<i;n+=1)e[n]=255&t[n];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return H(e).length;default:if(n)return U(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,i);case"utf8":case"utf-8":return E(this,t,i);case"ascii":return k(this,t,i);case"latin1":case"binary":return O(this,t,i);case"base64":return P(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function y(e,t,i,n,o){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=o?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(o)return-1;i=e.length-1}else if(i<0){if(!o)return-1;i=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:v(e,t,i,n,o);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):v(e,[t],i,n,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,i,n,o){var r,s=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,i/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var d=-1;for(r=i;r<a;r++)if(c(e,r)===c(t,-1===d?0:r-d)){if(-1===d&&(d=r),r-d+1===l)return d*s}else-1!==d&&(r-=r-d),d=-1}else for(i+l>a&&(i=a-l),r=i;r>=0;r--){for(var u=!0,h=0;h<l;h++)if(c(e,r+h)!==c(t,h)){u=!1;break}if(u)return r}return-1}function b(e,t,i,n){i=Number(i)||0;var o=e.length-i;n?(n=Number(n))>o&&(n=o):n=o;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");n>r/2&&(n=r/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[i+s]=a}return s}function _(e,t,i,n){return W(U(t,e.length-i),e,i,n)}function w(e,t,i,n){return W(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function T(e,t,i,n){return w(e,t,i,n)}function S(e,t,i,n){return W(H(t),e,i,n)}function A(e,t,i,n){return W(function(e,t){for(var i,n,o,r=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(i=e.charCodeAt(s))>>8,o=i%256,r.push(o),r.push(n);return r}(t,e.length-i),e,i,n)}function P(e,t,i){return 0===t&&i===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,i))}function E(e,t,i){i=Math.min(e.length,i);for(var n=[],o=t;o<i;){var r,s,a,l,c=e[o],d=null,u=c>239?4:c>223?3:c>191?2:1;if(o+u<=i)switch(u){case 1:c<128&&(d=c);break;case 2:128==(192&(r=e[o+1]))&&(l=(31&c)<<6|63&r)>127&&(d=l);break;case 3:r=e[o+1],s=e[o+2],128==(192&r)&&128==(192&s)&&(l=(15&c)<<12|(63&r)<<6|63&s)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:r=e[o+1],s=e[o+2],a=e[o+3],128==(192&r)&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&r)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(d=l)}null===d?(d=65533,u=1):d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|1023&d),n.push(d),o+=u}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);for(var i="",n=0;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=C));return i}(n)}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,i){return c(null,e,t,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,i){return function(e,t,i,n){return d(t),t<=0?a(e,t):void 0!==i?"string"==typeof n?a(e,t).fill(i,n):a(e,t).fill(i):a(e,t)}(null,e,t,i)},l.allocUnsafe=function(e){return u(null,e)},l.allocUnsafeSlow=function(e){return u(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,n=t.length,o=0,r=Math.min(i,n);o<r;++o)if(e[o]!==t[o]){i=e[o],n=t[o];break}return i<n?-1:n<i?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=l.allocUnsafe(t),o=0;for(i=0;i<e.length;++i){var s=e[i];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):m.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,i,n,o){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||i>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=i)return 0;if(n>=o)return-1;if(t>=i)return 1;if(this===e)return 0;for(var r=(o>>>=0)-(n>>>=0),s=(i>>>=0)-(t>>>=0),a=Math.min(r,s),c=this.slice(n,o),d=e.slice(t,i),u=0;u<a;++u)if(c[u]!==d[u]){r=c[u],s=d[u];break}return r<s?-1:s<r?1:0},l.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},l.prototype.indexOf=function(e,t,i){return y(this,e,t,i,!0)},l.prototype.lastIndexOf=function(e,t,i){return y(this,e,t,i,!1)},l.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var o=this.length-t;if((void 0===i||i>o)&&(i=o),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var r=!1;;)switch(n){case"hex":return b(this,e,t,i);case"utf8":case"utf-8":return _(this,e,t,i);case"ascii":return w(this,e,t,i);case"latin1":case"binary":return T(this,e,t,i);case"base64":return S(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,i);default:if(r)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),r=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function k(e,t,i){var n="";i=Math.min(e.length,i);for(var o=t;o<i;++o)n+=String.fromCharCode(127&e[o]);return n}function O(e,t,i){var n="";i=Math.min(e.length,i);for(var o=t;o<i;++o)n+=String.fromCharCode(e[o]);return n}function I(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);for(var o="",r=t;r<i;++r)o+=j(e[r]);return o}function R(e,t,i){for(var n=e.slice(t,i),o="",r=0;r<n.length;r+=2)o+=String.fromCharCode(n[r]+256*n[r+1]);return o}function V(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,i,n,o,r){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<r)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function x(e,t,i,n){t<0&&(t=65535+t+1);for(var o=0,r=Math.min(e.length-i,2);o<r;++o)e[i+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function N(e,t,i,n){t<0&&(t=4294967295+t+1);for(var o=0,r=Math.min(e.length-i,4);o<r;++o)e[i+o]=t>>>8*(n?o:3-o)&255}function M(e,t,i,n,o,r){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function L(e,t,i,n,r){return r||M(e,0,i,4),o.write(e,t,i,n,23,4),i+4}function F(e,t,i,n,r){return r||M(e,0,i,8),o.write(e,t,i,n,52,8),i+8}l.prototype.slice=function(e,t){var i,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=l.prototype;else{var o=t-e;i=new l(o,void 0);for(var r=0;r<o;++r)i[r]=this[r+e]}return i},l.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||V(e,t,this.length);for(var n=this[e],o=1,r=0;++r<t&&(o*=256);)n+=this[e+r]*o;return n},l.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||V(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},l.prototype.readUInt8=function(e,t){return t||V(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||V(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||V(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||V(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||V(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||V(e,t,this.length);for(var n=this[e],o=1,r=0;++r<t&&(o*=256);)n+=this[e+r]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||V(e,t,this.length);for(var n=t,o=1,r=this[e+--n];n>0&&(o*=256);)r+=this[e+--n]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readInt8=function(e,t){return t||V(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||V(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(e,t){t||V(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(e,t){return t||V(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||V(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||V(e,4,this.length),o.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||V(e,4,this.length),o.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||V(e,8,this.length),o.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||V(e,8,this.length),o.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,i,n){e=+e,t|=0,i|=0,n||D(this,e,t,i,Math.pow(2,8*i)-1,0);var o=1,r=0;for(this[t]=255&e;++r<i&&(o*=256);)this[t+r]=e/o&255;return t+i},l.prototype.writeUIntBE=function(e,t,i,n){e=+e,t|=0,i|=0,n||D(this,e,t,i,Math.pow(2,8*i)-1,0);var o=i-1,r=1;for(this[t+o]=255&e;--o>=0&&(r*=256);)this[t+o]=e/r&255;return t+i},l.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*i-1);D(this,e,t,i,o-1,-o)}var r=0,s=1,a=0;for(this[t]=255&e;++r<i&&(s*=256);)e<0&&0===a&&0!==this[t+r-1]&&(a=1),this[t+r]=(e/s>>0)-a&255;return t+i},l.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*i-1);D(this,e,t,i,o-1,-o)}var r=i-1,s=1,a=0;for(this[t+r]=255&e;--r>=0&&(s*=256);)e<0&&0===a&&0!==this[t+r+1]&&(a=1),this[t+r]=(e/s>>0)-a&255;return t+i},l.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,i){return L(this,e,t,!0,i)},l.prototype.writeFloatBE=function(e,t,i){return L(this,e,t,!1,i)},l.prototype.writeDoubleLE=function(e,t,i){return F(this,e,t,!0,i)},l.prototype.writeDoubleBE=function(e,t,i){return F(this,e,t,!1,i)},l.prototype.copy=function(e,t,i,n){if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var o,r=n-i;if(this===e&&i<t&&t<n)for(o=r-1;o>=0;--o)e[o+t]=this[o+i];else if(r<1e3||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<r;++o)e[o+t]=this[o+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+r),t);return r},l.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var r;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(r=t;r<i;++r)this[r]=e;else{var s=l.isBuffer(e)?e:U(new l(e,n).toString()),a=s.length;for(r=0;r<i-t;++r)this[r+t]=s[r%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var i;t=t||1/0;for(var n=e.length,o=null,r=[],s=0;s<n;++s){if((i=e.charCodeAt(s))>55295&&i<57344){if(!o){if(i>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&r.push(239,191,189);continue}o=i;continue}if(i<56320){(t-=3)>-1&&r.push(239,191,189),o=i;continue}i=65536+(o-55296<<10|i-56320)}else o&&(t-=3)>-1&&r.push(239,191,189);if(o=null,i<128){if((t-=1)<0)break;r.push(i)}else if(i<2048){if((t-=2)<0)break;r.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;r.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return r}function H(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,i,n){for(var o=0;o<n&&!(o+i>=t.length||o>=e.length);++o)t[o+i]=e[o];return o}}).call(this,i(37))},function(e,t,i){"use strict";t.byteLength=function(e){var t=c(e),i=t[0],n=t[1];return 3*(i+n)/4-n},t.toByteArray=function(e){var t,i,n=c(e),s=n[0],a=n[1],l=new r(function(e,t,i){return 3*(t+i)/4-i}(0,s,a)),d=0,u=a>0?s-4:s;for(i=0;i<u;i+=4)t=o[e.charCodeAt(i)]<<18|o[e.charCodeAt(i+1)]<<12|o[e.charCodeAt(i+2)]<<6|o[e.charCodeAt(i+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;return 2===a&&(t=o[e.charCodeAt(i)]<<2|o[e.charCodeAt(i+1)]>>4,l[d++]=255&t),1===a&&(t=o[e.charCodeAt(i)]<<10|o[e.charCodeAt(i+1)]<<4|o[e.charCodeAt(i+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t),l},t.fromByteArray=function(e){for(var t,i=e.length,o=i%3,r=[],s=16383,a=0,l=i-o;a<l;a+=s)r.push(d(e,a,a+s>l?l:a+s));return 1===o?(t=e[i-1],r.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[i-2]<<8)+e[i-1],r.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),r.join("")};for(var n=[],o=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)n[a]=s[a],o[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function d(e,t,i){for(var o,r,s=[],a=t;a<i;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(r=o)>>18&63]+n[r>>12&63]+n[r>>6&63]+n[63&r]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,i,n,o){var r,s,a=8*o-n-1,l=(1<<a)-1,c=l>>1,d=-7,u=i?o-1:0,h=i?-1:1,p=e[t+u];for(u+=h,r=p&(1<<-d)-1,p>>=-d,d+=a;d>0;r=256*r+e[t+u],u+=h,d-=8);for(s=r&(1<<-d)-1,r>>=-d,d+=n;d>0;s=256*s+e[t+u],u+=h,d-=8);if(0===r)r=1-c;else{if(r===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),r-=c}return(p?-1:1)*s*Math.pow(2,r-n)},t.write=function(e,t,i,n,o,r){var s,a,l,c=8*r-o-1,d=(1<<c)-1,u=d>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:r-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+u>=1?h/l:h*Math.pow(2,1-u))*l>=2&&(s++,l/=2),s+u>=d?(a=0,s=d):s+u>=1?(a=(t*l-1)*Math.pow(2,o),s+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,o),s=0));o>=8;e[i+p]=255&a,p+=f,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;e[i+p]=255&s,p+=f,s/=256,c-=8);e[i+p-f]|=128*m}},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t){e.exports='<div class="_cm-panel-heading">\n    <strong>\n        <span>Taboola Video Support</span>\n    </strong>\n    <strong class="_cm-close-button">x</strong>\n</div>\n\n<div class="_cm-panel-body">\n    <div class="_cm-panel-header">Use this form to report an issue with Taboola Video. </div>\n    <div class="_cm-panel-row">\n        <label>Name:</label>\n        <input type="text" class="_cm-panel-name">\n    </div>\n    <div class="_cm-panel-row">\n        <label>Email:</label>\n        <input type="email" class="_cm-panel-email">\n    </div>\n    <div class="_cm-panel-row">\n        <label>Details:</label>\n        <textarea  class="_cm-panel-details"></textarea>\n    </div>\n    <div class="_cm-panel-row">\n       <input type="button" class="_cm-panel-submit" value="Send">\n    </div>\n\n    <div class="_cm-panel-notifications">\n        <div class="_cm-panel-notifications-sending">Sending message, please wait. </div>\n        <div class="_cm-panel-notifications-success">Thank you! Your message has been successfully sent. </div>\n        <div class="_cm-panel-notifications-error">Error - Something went wrong... Your message was not sent.  </div>\n    </div>\n</div>'},function(e,t,i){"use strict";i.r(t);var n=i(24),o=i(0);t.default=n.a.extend({defaults:o.a.extend(!0,{},n.a.prototype.defaults,{isMobile:!0,mobilePlayer:"DP",timeBetweenAds:1,isPlaylist:!1,contentLoadType:"content",animation:{onTransitionOpen:!0},adMaxPlaySeconds:99999999,bfFactor:0,noaop:5,runWfWhenEmpty:!1,isMultiAd:!0,onOutOfView:"pause",viewPercent:20,isSelectorFound:!1,volume:"off",midrollTimeout:10,suppressContentZindex:!0,unitTitle:"",vForce:{isActive:!0},category:"blankwhiteHD",pubId:198827,pubTagId:1020237,preroll:{pubId:198827,pubTagId:1020237},midroll:{pubId:198827,pubTagId:1020237},postroll:{pubId:198827,pubTagId:1020237},secondsBW:1,rescan:{isActive:!0,intervalSeconds:5},kibanaEventsToSend:"all",isNeedValidateParentSelector:!0,predictors:{isNeedValidateParentSelector:!0,getAdFail:{isActive:!0},multiAd:{isActive:!0,predictPoints:{}},loading:{isActive:!0,predictPoints:"any"},repeat:{isActive:!0,predictPoints:"any"},playerReady:{isActive:!0,predictPoint:0},distancePercent:{isActive:!1,predictPoints:{}},distancePixels:{isActive:!1,predictPoints:{}},firstScroll:{isActive:!1,predictPoints:0}},playPriority:{type:"ppKey",key:1},components:{Loading:{type:"img",imgUrl:"{{urls.base}}/assets/loading2.png"},TimerView:{time:3},OptOut:{hasOptOut:!1},ClickTrough:{isActive:!1},adChoice:{isActive:!0,fallbackUrl:"https://popup.taboola.com/en",icon:"//cdn.taboola.com/static/c5/c5ef96bc-30ab-456a-b3d5-a84f367c6a46.svg",title:{isActive:!1,text:"Sponsored Video by Taboola",style:{},logoStyle:{},adViewStyle:{}},videoAd:{isActive:!0,text:"Ad",style:{},logoStyle:{}},slider:{isActive:!1,text:"Ad",style:{},logoStyle:{}}},volume:{isActive:!1,expandedText:"Unmute",timeToMinimize:2e3,style:{border:{},mute:{},unmute:{},text:{}}},contentCarousel:{isActive:!0,height:70}},player:{hasControls:!1,settings:{vakll:24e4,time_between_waterfall:1,mintimwf:1e4,bfFactor:0,ad_loaded_method:!0,wf_manual:!1,wf_dynmc_ps:!1,vforce2:"vforce2",max_ready_vpaid:2,mprdct:.015}},detachToSlider:{isStartFromSlider:!1,isDetachToSlider:!1,isDetachAbove:!1,isDetachBelow:!0,width:250,height:250,position:{horizontal:"right",vertical:"bottom",horizontalOffset:0,verticalOffset:0},liquidSize:{isActive:!1,widthPercent:33,minWidth:200,heightPercent:30,maxHeight:350},customCss:null,animation:!0,hasCloseButton:!0}}),getScheduleArr:function(){var e=[];return e.push(this._getSchedule("pre-roll",this.get("preroll.pubId"),this.get("preroll.pubTagId"))),e.push(this._getSchedule("mid-roll",this.get("midroll.pubId"),this.get("midroll.pubTagId"))),e.push(this._getSchedule("post-roll",this.get("postroll.pubId"),this.get("postroll.pubTagId"))),e}})},function(e,t,i){"use strict";i.r(t);var n=i(24),o=i(0);t.default=n.a.extend({defaults:o.a.extend(!0,{},n.a.prototype.defaults,{contentLoadType:"content",isPlaylist:!1,animation:{onTransitionOpen:!0},adMaxPlaySeconds:99999999,category:"blankwhiteHD",timeBetweenAds:1,bfFactor:0,noaop:5,wfDynamicPause:!1,wfManual:!1,runWfWhenEmpty:!0,isMultiAd:!0,onOutOfView:"pause",viewPercent:20,isSelectorFound:!1,wf_manual:!1,suppressContentZindex:!0,midrollTimeout:10,secondsBW:17,unitTitle:"",pubId:198827,pubTagId:1020237,preroll:{pubId:198827,pubTagId:1020237},midroll:{pubId:198827,pubTagId:1020237},postroll:{pubId:198827,pubTagId:1020237},rescan:{isActive:!0,intervalSeconds:5},kibanaEventsToSend:"all",isNeedValidateParentSelector:!0,predictors:{isNeedValidateParentSelector:!0,getAdFail:{isActive:!0},multiAd:{isActive:!0,predictPoints:{}},loading:{isActive:!0,predictPoints:"any"},repeat:{isActive:!0,predictPoints:"any"},playerReady:{isActive:!0,predictPoint:0},distancePercent:{isActive:!1,predictPoints:{}},distancePixels:{isActive:!1,predictPoints:{}},firstScroll:{isActive:!1,predictPoints:0}},playPriority:{type:"ppKey",key:1},vForce:{isActive:!0,getAdTimeoutSeconds:60},components:{Loading:{type:"img",imgUrl:"{{urls.base}}/assets/loading2.png"},ClickTrough:{isActive:!1},adChoice:{isActive:!0,fallbackUrl:"https://popup.taboola.com/en",icon:"//cdn.taboola.com/static/c5/c5ef96bc-30ab-456a-b3d5-a84f367c6a46.svg",title:{isActive:!1,text:"Sponsored Video by Taboola",style:{},logoStyle:{},adViewStyle:{}},videoAd:{isActive:!0,text:"Ad",style:{},logoStyle:{}},slider:{isActive:!1,text:"Ad",style:{},logoStyle:{}}},volume:{isActive:!1,expandedText:"Unmute",timeToMinimize:2e3,style:{border:{},mute:{},unmute:{},text:{}}},contentCarousel:{isActive:!0,height:70},CloseButtonView:{hasCloseButton:!0}},player:{hasControls:!1,playlist:[{filename:"whitecontent.mp4",id:93,image:"//vidstat.taboola.com/vid/img/whiteImage.png",name:"whitecontent.mp4",title:"BlackScreen",type:"video/mp4",url:"//vidstat.taboola.com/vid/whitecontent.mp4",vidlength:30}],settings:{vakll:24e4,time_between_waterfall:1,mintimwf:1e4,bfFactor:0,bf_factor:0,ad_loaded_method:!0,wf_manual:!1,wf_dynmc_ps:!1,vforce2:"vforce2",max_ready_vpaid:2}},detachToSlider:{isStartFromSlider:!1,isDetachToSlider:!1,isDetachAbove:!1,isDetachBelow:!0,width:350,height:350,position:{horizontal:"right",vertical:"bottom",horizontalOffset:0,verticalOffset:0},liquidSize:{isActive:!1,widthPercent:33,minWidth:200,heightPercent:30,maxHeight:350},customCss:null,animation:!0,hasCloseButton:!0}}),getScheduleArr:function(){var e=[];return e.push(this._getSchedule("pre-roll",this.get("preroll.pubId"),this.get("preroll.pubTagId"))),e.push(this._getSchedule("mid-roll",this.get("midroll.pubId"),this.get("midroll.pubTagId"))),e.push(this._getSchedule("post-roll",this.get("postroll.pubId"),this.get("postroll.pubTagId"))),e}})},function(e,t){e.exports='<a href="javascript:void(0);" >\n    <img src="{{imageSrc}}">\n</a>'},function(e,t){e.exports='<iframe style="width: 100%; height: 100%;" frameborder="0" border="0"\n        padding="0" scrolling="no" marginwidth="0" marginheight="0"></iframe>'},function(e,t){e.exports='<div class="_cm-opt-out">\n    <div class="_cm-opt-button"></div>\n    <div class="_cm-opt-dialog">\n        <div id="" class="_cm-opt-message">\n            Never show me Video ads\n        </div>\n        <textarea class="_cm-opt-text" placeholder="What was the problem with this ad?"></textarea>\n        <div>\n            <button type="button" class="_cm-cancel">Cancel</button>\n            <button type="button" class="_cm-submit">Send</button>\n        </div>\n    </div>\n</div>'},function(e,t){e.exports='<li class="_cm-playlist-item">\n    <img class="_cm-playlist-img" src="{{image}}">\n    <span class="_cm-playlist-text">{{title}}</span>\n</li>'},function(e,t){e.exports='<div class="_cm-timer-circle">\n    <div class="_cm-timer-mask _cm-timer-full">\n        <div class="_cm-timer-fill"></div>\n    </div>\n    <div class="_cm-timer-mask _cm-timer-half">\n        <div class="_cm-timer-fill"></div>\n        <div class="_cm-timer-fill _cm-timer-fix"></div>\n    </div>\n</div>\n<div class="_cm-timer-inset">\n    <span></span>\n</div>'},function(e,t){e.exports='<span class="_cm-branding-view-title-text">{{titleContainer.titleText}}</span>\n<span class="_cm-branding-view-branding-text">{{titleContainer.BrandingText}}</span>'},function(e,t){e.exports='<a class="_cm-ad-choice-text" target="_blank">{{text}}</a>\n<a class="_cm-ad-choice-logo" target="_blank"></a>'},function(e,t){e.exports={"AR-EG":"","AR-AE":"","AR-SA":"","CS-CZ":"Reklama","DA-DK":"Annonce","DE-DE":"Anzeige","DE-AT":"Anzeige","DE-CH":"Anzeige","EL-GR":"Ad","EN-AE":"Ad","EN-AU":"Ad","EN-CA":"Ad","EN-GB":"Ad","EN-IE":"Ad","EN-IN":"Ad","EN-SG":"Ad","EN-PH":"Ad","EN-MY":"Ad","EN-NZ":"Ad","EN-US":"Ad","EN-ZA":"Ad","EN-XL":"Ad","ES-ES":"Publicidad","ES-AR":"Patrocinado","ES-CO":"Patrocinado","ES-CL":"Patrocinado","ES-PE":"Patrocinado","ES-MX":"Patrocinado","ES-US":"Patrocinado","ES-XL":"Patrocinado","ES-VE":"Patrocinado","EN-ID":"Ad","FI-FI":"Mainos","FR-FR":"Sponsoris","FR-BE":"Sponsoris","FR-CA":"Pub","FR-CH":"Sponsoris","HE-IL":"","HI-IN":"","HU-HU":"Hird.","ID-ID":"Ad","IT-IT":"Ann.","JA-JP":"PR","KO-KR":"AD","NB-NO":"Annonse","NL-NL":"Adv","NL-BE":"Adv","PL-PL":"Reklama","PT-BR":"Publicidade","PT-PT":"Pub","RU-RU":"","SV-SE":"Annons","TH-TH":"Ad","TR-TR":"R","VI-VN":"Ad","ZH-CN":"","ZH-TW":"","ZH-HK":""}},function(e,t){e.exports='<div class="_cm-volume-border">\n    <svg class="_cm-volume-mute" data-name="_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 351.22 266.75">\n        <defs>\n            <style>.cls-1 {\n                fill: #fff;\n            }</style>\n        </defs>\n        <g id="_Group_" data-name="&lt;Group&gt;">\n            <g id="_Group_2" data-name="&lt;Group&gt;">\n                <path class="cls-1"\n                      d="M338,185.84c-.48-3.15-1.39-6.11-5.31-7.4H330c-3.63.93-6.33,3-8.93,5.29L249.59,246H170.26c-7.93,0-14.35,5.59-14.35,12.5V370.1c0,6.9,6.42,12.5,14.35,12.5h85.1l66.91,58.27a19,19,0,0,0,6,3.71c3.92,1.44,7.13.29,8.73-3.12a14.33,14.33,0,0,0,1.22-6.29V189.22A22.39,22.39,0,0,0,338,185.84Z"\n                      transform="translate(-155.91 -178.44)"/>\n            </g>\n        </g>\n        <path class="cls-1"\n              d="M486.13,381.62a20.93,20.93,0,0,1-14.85-6.15l-97.62-97.62a21,21,0,1,1,29.69-29.7L501,345.77a21,21,0,0,1-14.85,35.85Z"\n              transform="translate(-155.91 -178.44)"/>\n        <path class="cls-1"\n              d="M388.5,381.62a21,21,0,0,1-14.84-35.85l97.62-97.62a21,21,0,1,1,29.7,29.7l-97.63,97.62A20.93,20.93,0,0,1,388.5,381.62Z"\n              transform="translate(-155.91 -178.44)"/>\n    </svg>\n\n    <svg class="_cm-volume-unmute" data-name="_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 311.81 266.75">\n        <defs>\n            <style>.cls-1 {\n                fill: #fff;\n            }</style>\n        </defs>\n        <g id="_Group_" data-name="&lt;Group&gt;">\n            <path id="_Path_" data-name="&lt;Path&gt;" class="cls-1"\n                  d="M465.85,290.12A124.1,124.1,0,0,0,453.19,253a127.55,127.55,0,0,0-21.66-29.51c-3.38-3.47-7.4-5.23-12.25-4.6a13.27,13.27,0,0,0-11.5,9.27c-1.87,5.38-.66,10.26,3.23,14.43,1,1.05,2,2,2.95,3.1a96.67,96.67,0,0,1,25.09,55.19,95.28,95.28,0,0,1-1.17,29.52,96.57,96.57,0,0,1-26.52,50.23,13.74,13.74,0,0,0-4.23,12.12,13.25,13.25,0,0,0,9.2,11.27c5.3,1.85,10.15.74,14.31-3.08.82-.74,1.57-1.56,2.33-2.36a125,125,0,0,0,34.74-87.88A131.18,131.18,0,0,0,465.85,290.12Z"\n                  transform="translate(-155.91 -178.44)"/>\n            <path id="_Path_2" data-name="&lt;Path&gt;" class="cls-1"\n                  d="M420.23,307.35a87,87,0,0,0-6.32-28.82A88,88,0,0,0,395,249.69a14,14,0,0,0-24.29,11.22,16.39,16.39,0,0,0,4.73,8.92c13.86,14.79,19.22,32.3,16.05,52.27a58.5,58.5,0,0,1-16.83,32.54A14,14,0,0,0,388.48,378c3.13-.88,5.44-2.88,7.6-5.18,16.05-17.16,23.94-37.57,24.15-61C420.23,310.31,420.29,308.83,420.23,307.35Z"\n                  transform="translate(-155.91 -178.44)"/>\n            <path id="_Path_3" data-name="&lt;Path&gt;" class="cls-1"\n                  d="M338,185.84c-.48-3.15-1.39-6.11-5.31-7.4H330c-3.63.93-6.33,3-8.93,5.29L249.59,246H170.26c-7.93,0-14.35,5.59-14.35,12.5V370.1c0,6.9,6.42,12.5,14.35,12.5h85.1l66.91,58.27a19,19,0,0,0,6,3.71c3.92,1.44,7.13.29,8.73-3.12a14.33,14.33,0,0,0,1.22-6.29V189.22A22.39,22.39,0,0,0,338,185.84Z"\n                  transform="translate(-155.91 -178.44)"/>\n        </g>\n    </svg>\n\n    <div class="_cm-volume-text">{{expandedText}}</div>\n</div>\n'},function(e,t){e.exports='<div class="_cm-click-blocker _cm-click-blocker-top"></div>\n<div class="_cm-click-blocker _cm-click-blocker-bottom"></div>\n<div class="_cm-click-blocker _cm-click-blocker-left"></div>\n<div class="_cm-click-blocker _cm-click-blocker-right"></div>'},function(e,t){!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="./",i(i.s=1)}([function(e,t,i){"use strict";var n,o="object"==typeof Reflect?Reflect:null,r=o&&"function"==typeof o.apply?o.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};n=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}((e.exports=a).EventEmitter=a).prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function d(e,t,i,n){var o,r,s;if("function"!=typeof i)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i);if(void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),r=e._events),s=r[t]),void 0===s)s=r[t]=i,++e._eventsCount;else if("function"==typeof s?s=r[t]=n?[i,s]:[s,i]:n?s.unshift(i):s.push(i),0<(o=c(e))&&s.length>o&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=s.length,function(e){console&&console.warn&&console.warn(e)}(a)}return e}function u(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},o=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,r(this.listener,this.target,e))}.bind(n);return o.listener=i,n.wrapFn=o}function h(e,t,i){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?i?[o.listener||o]:[o]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(o):f(o,o.length)}function p(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function f(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var s;if(0<t.length&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var c=l.length,d=f(l,c);for(i=0;i<c;++i)r(d[i],this,t)}return!0},a.prototype.on=a.prototype.addListener=function(e,t){return d(this,e,t,!1)},a.prototype.prependListener=function(e,t){return d(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,u(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,u(this,e,t)),this},a.prototype.off=a.prototype.removeListener=function(e,t){var i,n,o,r,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(o=-1,r=i.length-1;0<=r;r--)if(i[r]===t||i[r].listener===t){s=i[r].listener,o=r;break}if(o<0)return this;0===o?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,o),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var o,r=Object.keys(i);for(n=0;n<r.length;++n)"removeListener"!==(o=r[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;0<=n;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return h(this,e,!0)},a.prototype.rawListeners=function(e){return h(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return 0<this._eventsCount?n(this._events):[]}},function(e,t,i){e.exports=i(2)},function(e,t,i){"use strict";function n(e,t,i,n){var o="alt_"+t;e.hasOwnProperty(o)||(e[o]="",Object.defineProperty(e,t,{get:function(){return i?i():this[o]},set:function(i){this[o]=i,n&&n(i)&&e.setAttribute(t,i)}}))}function o(e){return void 0===e}i.r(t);var r,s=i(0),a="Android",l="iOS",c="Fire OS";function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var u=(d(r={},a,{"Chrome Mobile":53,Chromium:53,"Firefox Mobile":49,"Firefox Focus":49,Android:7,"Android Webkit":7,"Amazon Silk Browser":71,"Facebook on Android":void 0,"Opera Mobile":void 0,"Opera Mini":void 0,"MIUI Browser":void 0,"Yandex browser":void 0,"UC Browser":void 0,"Samsung Browser":void 0,Edge:void 0,Opera:void 0}),d(r,l,{"Firefox on iOS":7}),d(r,c,{"Amazon Silk Browser":71}),r);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(){function e(t){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,p(e).call(this))).params=t,i.os=i.params.userAgent.os.name,i.osVersion=i.params.userAgent.os.version,i.browserName=i.params.userAgent.browser.name,i.browserMajorVersion=i.params.userAgent.browser.version,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(e,s.EventEmitter),function(e,t,i){t&&function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t)}(e,[{key:"isAutoplaySupported",value:function(){var e=this._isAutoplaySupportedByOS();e&&this.os===a&&(e=!this._isDataSaverOn()),this._emitDetectionResult(e)}},{key:"_isAutoplaySupportedByOS",value:function(){return this.os===a?this.isAutoplaySupportedAndroid():this.os===c?this.isAutoplaySupportedFireOS():this.os===l&&this.isAutoplaySupportedIOS()}},{key:"isAutoplaySupportedIOS",value:function(){if(this.osVersion<10)return!1;var e=this._isAutoplaySupportedOnBrowser(u.iOS);return!!o(e)||e}},{key:"_isAutoplaySupportedOnBrowser",value:function(e){if(e.hasOwnProperty(this.browserName))return o(e[this.browserName])||this.browserMajorVersion>=e[this.browserName]}},{key:"isAutoplaySupportedAndroid",value:function(){var e=this._isAutoplaySupportedOnBrowser(u[a]);return!o(e)&&e}},{key:"isAutoplaySupportedFireOS",value:function(){var e=this._isAutoplaySupportedOnBrowser(u[c]);return!o(e)&&e}},{key:"_isDataSaverOn",value:function(){return this.params.canvas.dataSaverServerSide}},{key:"_emitDetectionResult",value:function(e){this.emit("detectIsAutoplaySupported",e)}}]),e}(),g="content",y={decodeUrl:!1,secureMediaFiles:!1,isMobile:!1,autoplay:!0,userAgent:{},isMultiVpaidUnit:!1,logToBI:function(){},videoState:g,canvas:{onCanvasUsage:function(){},dataSaverServerSide:!1,dataSaverUrl:"//vidutils.taboola.com",disableWebGl:!1,parent:document.body,defaultVolume:.4,aspectRatio:"16:9",canvasLoadRate:5,mpegServerBaseUrl:"//mpg.taboola.com/getts?url",ignoreAutoplayDetection:!1,additionalCss:{},repeat:!1}};function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var b={Player:null,VideoElement:null,BitBuffer:null,Source:{},Demuxer:{},Decoder:{},Renderer:{},AudioOutput:{},Now:function(){return window.performance?window.performance.now()/1e3:Date.now()/1e3},CreateVideoElements:function(){for(var e=document.querySelectorAll(".jsmpeg"),t=0;t<e.length;t++)new b.VideoElement(e[t])},Fill:function(e,t){if(e.fill)e.fill(t);else for(var i=0;i<e.length;i++)e[i]=t}};function _(e){var t=e.dataset.url;if(!t)throw"VideoElement has no `data-url` attribute";function i(e,t){for(var i in t)e.style[i]=t[i]}this.container=e,i(this.container,{display:"inline-block",position:"relative",minWidth:"80px",minHeight:"80px"}),this.canvas=document.createElement("canvas"),this.canvas.width=960,this.canvas.height=540,i(this.canvas,{display:"block",width:"100%"}),this.container.appendChild(this.canvas),this.playButton=document.createElement("div"),this.playButton.innerHTML=_.PLAY_BUTTON,i(this.playButton,{zIndex:2,position:"absolute",top:"0",bottom:"0",left:"0",right:"0",maxWidth:"75px",maxHeight:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.playButton);var n={canvas:this.canvas};for(var o in e.dataset)try{n[o]=JSON.parse(e.dataset[o])}catch(t){n[o]=e.dataset[o]}if(this.player=new b.Player(t,n),!n.poster||n.autoplay||this.player.options.streaming||(n.decodeFirstFrame=!1,this.poster=new Image,this.poster.src=n.poster,this.poster.addEventListener("load",this.posterLoaded),i(this.poster,{display:"block",zIndex:1,position:"absolute",top:0,left:0,bottom:0,right:0}),this.container.appendChild(this.poster)),this.player.options.streaming||this.container.addEventListener("click",this.onClick.bind(this)),(n.autoplay||this.player.options.streaming)&&(this.playButton.style.display="none"),this.player.audioOut&&!this.player.audioOut.unlocked){var r=this.container;(n.autoplay||this.player.options.streaming)&&(this.unmuteButton=document.createElement("div"),this.unmuteButton.innerHTML=_.UNMUTE_BUTTON,i(this.unmuteButton,{zIndex:2,position:"absolute",bottom:"10px",right:"20px",width:"75px",height:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.unmuteButton),r=this.unmuteButton),this.unlockAudioBound=this.onUnlockAudio.bind(this,r),r.addEventListener("touchstart",this.unlockAudioBound,!1),r.addEventListener("click",this.unlockAudioBound,!0)}}function w(e,t){this.options=t||{},e.match(/^wss?:\/\//)?(this.source=new b.Source.WebSocket(e,t),t.streaming=!0):(!1!==t.progressive?this.source=new b.Source.AjaxProgressive(e,t):this.source=new b.Source.Ajax(e,t),t.streaming=!1),this.maxAudioLag=t.maxAudioLag||.25,this.loop=!1!==t.loop,this.autoplay=!!t.autoplay||t.streaming,this.onFinished=t.onfinished,this.demuxer=new b.Demuxer.TS(t),this.source.connect(this.demuxer),!1!==t.video&&(this.video=new b.Decoder.MPEG1Video(t),this.renderer=!t.disableGl&&b.Renderer.WebGL.IsSupported()?new b.Renderer.WebGL(t):new b.Renderer.Canvas2D(t),this.demuxer.connect(b.Demuxer.TS.STREAM.VIDEO_1,this.video),this.video.connect(this.renderer)),!1!==t.audio&&b.AudioOutput.WebAudio.IsSupported()&&(this.audio=new b.Decoder.MP2Audio(t),this.audioOut=new b.AudioOutput.WebAudio(t),this.demuxer.connect(b.Demuxer.TS.STREAM.AUDIO_1,this.audio),this.audio.connect(this.audioOut)),Object.defineProperty(this,"currentTime",{get:this.getCurrentTime,set:this.setCurrentTime}),Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),(this.unpauseOnShow=!1)!==t.pauseWhenHidden&&document.addEventListener("visibilitychange",this.showHide.bind(this)),this.source.start(),this.autoplay&&this.play()}function T(e,t){"object"===v(e)?(this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.byteLength=this.bytes.length):(this.bytes=new Uint8Array(e||1048576),this.byteLength=0),this.mode=t||T.MODE.EXPAND,this.index=0}function S(e,t){this.url=e,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.onReadyCblk=t.onload,this.errHandler=t.errHndlr}function A(e,t){this.url=e,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.fileSize=0,this.loadedSize=0,this.chunkSize=t.chunkSize||1048576,this.isLoading=!1,this.loadStartTime=0,this.throttled=!1!==t.throttled}function P(e,t){this.url=e,this.socket=null,this.callbacks={connect:[],data:[]},this.destination=null,this.reconnectInterval=t.reconnectInterval||5,this.shouldAttemptReconnect=!!this.reconnectInterval,this.completed=!1,this.established=!1,this.progress=0}function E(e){this.bits=null,this.leftoverBytes=null,this.guessVideoFrameEnd=!0,this.pidsToStreamIds={},this.pesPacketInfo={},this.startTime=0,this.currentTime=0}function C(e){this.destination=null,this.canPlay=!1,this.collectTimestamps=!e.streaming,this.timestamps=[],this.timestampIndex=0,this.startTime=0,this.decodedTime=0,Object.defineProperty(this,"currentTime",{get:this.getCurrentTime})}function k(e){b.Decoder.Base.call(this,e);var t=e.videoBufferSize||524288,i=e.streaming?b.BitBuffer.MODE.EVICT:b.BitBuffer.MODE.EXPAND;this.bits=new b.BitBuffer(t,i),this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.currentFrame=0,this.decodeFirstFrame=!1!==e.decodeFirstFrame}function O(e){b.Decoder.Base.call(this,e);var t=e.audioBufferSize||131072,i=e.streaming?b.BitBuffer.MODE.EVICT:b.BitBuffer.MODE.EXPAND;this.bits=new b.BitBuffer(t,i),this.left=new Float32Array(1152),this.right=new Float32Array(1152),this.sampleRate=44100,this.D=new Float32Array(1024),this.D.set(O.SYNTHESIS_WINDOW,0),this.D.set(O.SYNTHESIS_WINDOW,512),this.V=new Float32Array(1024),this.U=new Int32Array(32),this.VPos=0,this.allocation=[new Array(32),new Array(32)],this.scaleFactorInfo=[new Uint8Array(32),new Uint8Array(32)],this.scaleFactor=[new Array(32),new Array(32)],this.sample=[new Array(32),new Array(32)];for(var n=0;n<2;n++)for(var o=0;o<32;o++)this.scaleFactor[n][o]=[0,0,0],this.sample[n][o]=[0,0,0]}function I(e){this.canvas=e.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0;var t={preserveDrawingBuffer:!!e.preserveDrawingBuffer,alpha:!1,depth:!1,stencil:!1,antialias:!1};if(this.gl=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t),!this.gl)throw new Error("Failed to get WebGL Context");var i=this.gl,n=null,o=i.createBuffer(),r=new Float32Array([0,0,0,1,1,0,1,1]);i.bindBuffer(i.ARRAY_BUFFER,o),i.bufferData(i.ARRAY_BUFFER,r,i.STATIC_DRAW),this.program=this.createProgram(I.SHADER.VERTEX_IDENTITY,I.SHADER.FRAGMENT_YCRCB_TO_RGBA),n=i.getAttribLocation(this.program,"vertex"),i.enableVertexAttribArray(n),i.vertexAttribPointer(n,2,i.FLOAT,!1,0,0),this.textureY=this.createTexture(0,"textureY"),this.textureCb=this.createTexture(1,"textureCb"),this.textureCr=this.createTexture(2,"textureCr"),this.loadingProgram=this.createProgram(I.SHADER.VERTEX_IDENTITY,I.SHADER.FRAGMENT_LOADING),n=i.getAttribLocation(this.loadingProgram,"vertex"),i.enableVertexAttribArray(n),i.vertexAttribPointer(n,2,i.FLOAT,!1,0,0),this.shouldCreateUnclampedViews=!this.allowsClampedTextureData()}function R(e){this.canvas=e.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0,this.context=this.canvas.getContext("2d")}function V(e){this.context=V.CachedContext=V.CachedContext||new(window.AudioContext||window.webkitAudioContext),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.destination=this.gain,this.startTime=0,this.buffer=null,this.wallclockStartTime=0,this.volume=1,this.enabled=!0,this.unlocked=!V.NeedsUnlocking(),Object.defineProperty(this,"enqueuedTime",{get:this.getEnqueuedTime})}"complete"===document.readyState?b.CreateVideoElements():document.addEventListener("DOMContentLoaded",b.CreateVideoElements),b.VideoElement=(_.prototype.onUnlockAudio=function(e,t){this.unmuteButton&&(t.preventDefault(),t.stopPropagation()),this.player.audioOut.unlock(function(){this.unmuteButton&&(this.unmuteButton.style.display="none"),e.removeEventListener("touchstart",this.unlockAudioBound),e.removeEventListener("click",this.unlockAudioBound)}.bind(this))},_.prototype.onClick=function(e){this.player.isPlaying?(this.player.pause(),this.playButton.style.display="block"):(this.player.play(),this.playButton.style.display="none",this.poster&&(this.poster.style.display="none"))},_.PLAY_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 200 200" alt="Play video"><circle cx="100" cy="100" r="90" fill="none" stroke-width="15" stroke="#fff"/><polygon points="70, 55 70, 145 145, 100" fill="#fff"/></svg>',_.UNMUTE_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 75 75"><polygon class="audio-speaker" stroke="none" fill="#fff" points="39,13 22,28 6,28 6,47 21,47 39,62 39,13"/><g stroke="#fff" stroke-width="5"><path d="M 49,50 69,26"/><path d="M 69,50 49,26"/></g></svg>',_),b.Player=(w.prototype.showHide=function(e){"hidden"===document.visibilityState?(this.unpauseOnShow=this.wantsToPlay,this.pause()):this.unpauseOnShow&&this.play()},w.prototype.play=function(e){this.isPlaying=!0,this.startTime=b.Now()-this.currentTime,this.animationId=requestAnimationFrame(this.update.bind(this)),this.wantsToPlay=!0},w.prototype.pause=function(e){cancelAnimationFrame(this.animationId),this.wantsToPlay=!1,this.isPlaying=!1,this.audio&&this.audio.canPlay&&(this.audioOut.stop(),this.seek(this.currentTime))},w.prototype.getVolume=function(){return this.audioOut?this.audioOut.volume:0},w.prototype.setVolume=function(e){this.audioOut&&(this.audioOut.volume=e)},w.prototype.stop=function(e){this.pause(),this.seek(0),this.video&&!1!==this.options.decodeFirstFrame&&this.video.decode()},w.prototype.seek=function(e){var t=this.audio&&this.audio.canPlay?this.audio.startTime:this.video.startTime;this.video&&this.video.seek(e+t),this.audio&&this.audio.seek(e+t),this.startTime=b.Now()-e},w.prototype.getCurrentTime=function(){return this.audio&&this.audio.canPlay?this.audio.currentTime-this.audio.startTime:this.video.currentTime-this.video.startTime},w.prototype.setCurrentTime=function(e){this.seek(e)},w.prototype.update=function(){this.isPlaying&&(this.animationId=requestAnimationFrame(this.update.bind(this)),this.source.established?this.options.streaming?this.updateForStreaming():this.updateForStaticFile():this.renderer&&this.renderer.renderProgress(this.source.progress))},w.prototype.updateForStreaming=function(){if(this.video&&this.video.decode(),this.audio){for(;this.audioOut.enqueuedTime>this.maxAudioLag&&(this.audioOut.resetEnqueuedTime(),this.audioOut.enabled=!1),this.audio.decode(););this.audioOut.enabled=!0}},w.prototype.updateForStaticFile=function(){var e=this,t=!1,i=0;if(this.audio&&this.audio.canPlay){for(;!t&&this.audio.decodedTime-this.audio.currentTime<.25;)t=!this.audio.decode();this.video&&this.video.currentTime<this.audio.currentTime&&(t=!this.video.decode()),i=this.demuxer.currentTime-this.audio.currentTime}else if(this.video){var n=b.Now()-this.startTime+this.video.startTime,o=n-this.video.currentTime,r=1/this.video.frameRate;this.video&&0<o&&(2*r<o&&(this.startTime+=o),t=!this.video.decode()),i=this.demuxer.currentTime-n}this.source.resume(i),t&&this.source.completed&&(this.loop?this.seek(0):(this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){e.onFinished()}),500),this.pause()))},w),b.BitBuffer=(T.prototype.resize=function(e){var t=new Uint8Array(e);0!==this.byteLength&&(this.byteLength=Math.min(this.byteLength,e),t.set(this.bytes,0,this.byteLength)),this.bytes=t,this.index=Math.min(this.index,this.byteLength<<3)},T.prototype.evict=function(e){var t=this.index>>3,i=this.bytes.length-this.byteLength;if(this.index===this.byteLength<<3||i+t<e)return this.byteLength=0,void(this.index=0);0!=t&&(this.bytes.copyWithin?this.bytes.copyWithin(0,t,this.byteLength):this.bytes.set(this.bytes.subarray(t,this.byteLength)),this.byteLength=this.byteLength-t,this.index-=t<<3)},T.prototype.write=function(e){var t="object"===v(e[0]),i=0,n=this.bytes.length-this.byteLength;if(t)for(var o=i=0;o<e.length;o++)i+=e[o].byteLength;else i=e.byteLength;if(n<i)if(this.mode===T.MODE.EXPAND){var r=Math.max(2*this.bytes.length,i-n);this.resize(r)}else this.evict(i);if(t)for(o=0;o<e.length;o++)this.appendSingleBuffer(e[o]);else this.appendSingleBuffer(e)},T.prototype.appendSingleBuffer=function(e){e=e instanceof Uint8Array?e:new Uint8Array(e),this.bytes.set(e,this.byteLength),this.byteLength+=e.length},T.prototype.findNextStartCode=function(){for(var e=this.index+7>>3;e<this.byteLength;e++)if(0==this.bytes[e]&&0==this.bytes[e+1]&&1==this.bytes[e+2])return this.index=e+4<<3,this.bytes[e+3];return this.index=this.byteLength<<3,-1},T.prototype.findStartCode=function(e){for(var t=0;;)if((t=this.findNextStartCode())===e||-1===t)return t;return-1},T.prototype.nextBytesAreStartCode=function(){var e=this.index+7>>3;return e>=this.byteLength||0==this.bytes[e]&&0==this.bytes[1+e]&&1==this.bytes[2+e]},T.prototype.peek=function(e){for(var t=this.index,i=0;e;){var n=8-(7&t),o=n<e?n:e,r=n-o;i=i<<o|(this.bytes[t>>3]&255>>8-o<<r)>>r,t+=o,e-=o}return i},T.prototype.read=function(e){var t=this.peek(e);return this.index+=e,t},T.prototype.skip=function(e){return this.index+=e},T.prototype.rewind=function(e){this.index=Math.max(this.index-e,0)},T.prototype.has=function(e){return(this.byteLength<<3)-this.index>=e},T.MODE={EVICT:1,EXPAND:2},T),b.Source.Ajax=(S.prototype.connect=function(e){this.destination=e},S.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&200===this.request.status&&(this.onLoad(this.request.response),this.onReadyCblk()),500!==this.request.status&&502!==this.request.status||this.errHandler({err:"error status ".concat(this.request.status," received for url:").concat(this.url)})}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("GET",this.url),this.request.responseType="arraybuffer",this.request.send()},S.prototype.resume=function(e){},S.prototype.abort=function(){this.request.abort()},S.prototype.onProgress=function(e){this.progress=e.loaded/e.total},S.prototype.onLoad=function(e){this.established=!0,this.completed=!0,this.progress=1,this.destination&&this.destination.write(e)},S),b.Source.AjaxProgressive=(A.prototype.connect=function(e){this.destination=e},A.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&(this.fileSize=parseInt(this.request.getResponseHeader("Content-Length")),this.loadNextChunk())}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("HEAD",this.url),this.request.send()},A.prototype.resume=function(e){!this.isLoading&&this.throttled&&e<8*this.loadTime+2&&this.loadNextChunk()},A.prototype.abort=function(){this.request.abort()},A.prototype.loadNextChunk=function(){var e=this.loadedSize,t=Math.min(this.loadedSize+this.chunkSize-1,this.fileSize-1);e>=this.fileSize?this.completed=!0:(this.isLoading=!0,this.loadStartTime=b.Now(),this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&200<=this.request.status&&this.request.status<300?this.onChunkLoad(this.request.response):this.request.readyState===this.request.DONE&&this.loadFails++<3&&this.loadNextChunk()}.bind(this),0===e&&(this.request.onprogress=this.onProgress.bind(this)),this.request.open("GET",this.url+"?"+e+"-"+t),this.request.setRequestHeader("Range","bytes="+e+"-"+t),this.request.responseType="arraybuffer",this.request.send())},A.prototype.onProgress=function(e){this.progress=e.loaded/e.total},A.prototype.onChunkLoad=function(e){this.established=!0,this.progress=1,this.loadedSize+=e.byteLength,this.loadFails=0,this.isLoading=!1,this.destination&&this.destination.write(e),this.loadTime=b.Now()-this.loadStartTime,this.throttled||this.loadNextChunk()},A),b.Source.WebSocket=(P.prototype.connect=function(e){this.destination=e},P.prototype.abort=function(){this.shouldAttemptReconnect=!1,this.socket.close()},P.prototype.start=function(){this.shouldAttemptReconnect=!!this.reconnectInterval,this.progress=0,this.established=!1,this.socket=new WebSocket(this.url),this.socket.binaryType="arraybuffer",this.socket.onmessage=this.onMessage.bind(this),this.socket.onopen=this.onOpen.bind(this),this.socket.onerror=this.onClose.bind(this),this.socket.onclose=this.onClose.bind(this)},P.prototype.resume=function(e){},P.prototype.onOpen=function(){this.progress=1,this.established=!0},P.prototype.onClose=function(){this.shouldAttemptReconnect&&setTimeout(function(){this.start()}.bind(this),1e3*this.reconnectInterval)},P.prototype.onMessage=function(e){this.destination&&this.destination.write(e.data)},P),b.Demuxer.TS=(E.prototype.connect=function(e,t){this.pesPacketInfo[e]={destination:t,currentLength:0,totalLength:0,pts:0,buffers:[]}},E.prototype.write=function(e){if(this.leftoverBytes){var t=e.byteLength+this.leftoverBytes.byteLength;this.bits=new b.BitBuffer(t),this.bits.write([this.leftoverBytes,e])}else this.bits=new b.BitBuffer(e);for(;this.bits.has(1504);)this.parsePacket();var i=this.bits.byteLength-(this.bits.index>>3);this.leftoverBytes=0<i?this.bits.bytes.subarray(this.bits.index>>3):null},E.prototype.parsePacket=function(){var e=188+(this.bits.index>>3);if(71!==this.bits.read(8))throw"Sync Token not found";this.bits.read(1);var t=this.bits.read(1),i=(this.bits.read(1),this.bits.read(13)),n=(this.bits.read(2),this.bits.read(2)),o=(this.bits.read(4),this.pidsToStreamIds[i]);if(t&&o&&(m=this.pesPacketInfo[o])&&m.currentLength&&this.packetComplete(m),1&n){if(2&n){var r=this.bits.read(8);this.bits.skip(r<<3)}if(t&&this.bits.nextBytesAreStartCode()){this.bits.skip(24),o=this.bits.read(8),this.pidsToStreamIds[i]=o;var s=this.bits.read(16);this.bits.skip(8);var a=this.bits.read(2);this.bits.skip(6);var l=this.bits.read(8),c=this.bits.index+(l<<3);if(m=this.pesPacketInfo[o]){var d=0;if(2&a){this.bits.skip(4);var u=this.bits.read(3);this.bits.skip(1);var h=this.bits.read(15);this.bits.skip(1);var p=this.bits.read(15);this.bits.skip(1),d=(1073741824*u+32768*h+p)/9e4,this.currentTime=d,-1===this.startTime&&(this.startTime=d)}var f=s?s-l-3:0;this.packetStart(m,d,f)}this.bits.index=c}var m;if(o&&(m=this.pesPacketInfo[o])){var g=this.bits.index>>3,y=!t&&2&n;(this.packetAddData(m,g,e)||this.guessVideoFrameEnd&&y)&&this.packetComplete(m)}}this.bits.index=e<<3},E.prototype.packetStart=function(e,t,i){e.totalLength=i,e.currentLength=0,e.pts=t},E.prototype.packetAddData=function(e,t,i){return e.buffers.push(this.bits.bytes.subarray(t,i)),e.currentLength+=i-t,0!==e.totalLength&&e.currentLength>=e.totalLength},E.prototype.packetComplete=function(e){e.destination.write(e.pts,e.buffers),e.totalLength=0,e.currentLength=0,e.buffers=[]},E.STREAM={PACK_HEADER:186,SYSTEM_HEADER:187,PROGRAM_MAP:188,PRIVATE_1:189,PADDING:190,PRIVATE_2:191,AUDIO_1:192,VIDEO_1:224,DIRECTORY:255},E),b.Decoder.Base=(C.prototype.connect=function(e){this.destination=e},C.prototype.write=function(e,t){this.collectTimestamps&&(0===this.timestamps.length&&(this.startTime=e,this.decodedTime=e),this.timestamps.push({index:this.bits.byteLength<<3,time:e})),this.bits.write(t),this.canPlay=!0},C.prototype.seek=function(e){if(this.collectTimestamps){for(var t=this.timestampIndex=0;t<this.timestamps.length&&!(this.timestamps[t].time>e);t++)this.timestampIndex=t;var i=this.timestamps[this.timestampIndex];i?(this.bits.index=i.index,this.decodedTime=i.time):(this.bits.index=0,this.decodedTime=this.startTime)}},C.prototype.decode=function(){this.advanceDecodedTime(0)},C.prototype.advanceDecodedTime=function(e){if(this.collectTimestamps){for(var t=-1,i=this.timestampIndex;i<this.timestamps.length&&!(this.timestamps[i].index>this.bits.index);i++)t=i;if(-1!==t&&t!==this.timestampIndex)return this.timestampIndex=t,void(this.decodedTime=this.timestamps[this.timestampIndex].time)}this.decodedTime+=e},C.prototype.getCurrentTime=function(){return this.decodedTime},C),b.Decoder.MPEG1Video=(((k.prototype=Object.create(b.Decoder.Base.prototype)).constructor=k).prototype.write=function(e,t){if(b.Decoder.Base.prototype.write.call(this,e,t),!this.hasSequenceHeader){if(-1===this.bits.findStartCode(k.START.SEQUENCE))return!1;this.decodeSequenceHeader(),this.decodeFirstFrame&&this.decode()}},k.prototype.decode=function(){return!!this.hasSequenceHeader&&(-1!==this.bits.findStartCode(k.START.PICTURE)?(this.decodePicture(),this.advanceDecodedTime(1/this.frameRate),!0):(this.bits.byteLength,this.bits.index,!1))},k.prototype.readHuffman=function(e){for(var t=0;0<=(t=e[t+this.bits.read(1)])&&0!==e[t];);return e[t+2]},k.prototype.frameRate=30,k.prototype.decodeSequenceHeader=function(){var e=this.bits.read(12),t=this.bits.read(12);if(this.bits.skip(4),this.frameRate=k.PICTURE_RATE[this.bits.read(4)],this.bits.skip(30),e===this.width&&t===this.height||(this.width=e,this.height=t,this.initBuffers(),this.destination&&this.destination.resize(e,t)),this.bits.read(1)){for(var i=0;i<64;i++)this.customIntraQuantMatrix[k.ZIG_ZAG[i]]=this.bits.read(8);this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.bits.read(1)){for(i=0;i<64;i++){var n=k.ZIG_ZAG[i];this.customNonIntraQuantMatrix[n]=this.bits.read(8)}this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}this.hasSequenceHeader=!0},k.prototype.initBuffers=function(){this.intraQuantMatrix=k.DEFAULT_INTRA_QUANT_MATRIX,this.nonIntraQuantMatrix=k.DEFAULT_NON_INTRA_QUANT_MATRIX,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.currentY=new Uint8ClampedArray(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new Uint8ClampedArray(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new Uint8ClampedArray(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new Uint8ClampedArray(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new Uint8ClampedArray(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new Uint8ClampedArray(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer)},k.prototype.currentY=null,k.prototype.currentCr=null,k.prototype.currentCb=null,k.prototype.pictureType=0,k.prototype.forwardY=null,k.prototype.forwardCr=null,k.prototype.forwardCb=null,k.prototype.fullPelForward=!1,k.prototype.forwardFCode=0,k.prototype.forwardRSize=0,k.prototype.forwardF=0,k.prototype.decodePicture=function(e){if(this.currentFrame++,this.bits.skip(10),this.pictureType=this.bits.read(3),this.bits.skip(16),!(this.pictureType<=0||this.pictureType>=k.PICTURE_TYPE.B)){if(this.pictureType===k.PICTURE_TYPE.PREDICTIVE){if(this.fullPelForward=this.bits.read(1),this.forwardFCode=this.bits.read(3),0===this.forwardFCode)return;this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}for(var t=0;(t=this.bits.findNextStartCode())===k.START.EXTENSION||t===k.START.USER_DATA;);for(;t>=k.START.SLICE_FIRST&&t<=k.START.SLICE_LAST;)this.decodeSlice(255&t),t=this.bits.findNextStartCode();if(-1!==t&&this.bits.rewind(32),this.destination&&this.destination.render(this.currentY,this.currentCr,this.currentCb),this.pictureType===k.PICTURE_TYPE.INTRA||this.pictureType===k.PICTURE_TYPE.PREDICTIVE){var i=this.forwardY,n=this.forwardY32,o=this.forwardCr,r=this.forwardCr32,s=this.forwardCb,a=this.forwardCb32;this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=i,this.currentY32=n,this.currentCr=o,this.currentCr32=r,this.currentCb=s,this.currentCb32=a}}},k.prototype.quantizerScale=0,k.prototype.sliceBegin=!1,k.prototype.decodeSlice=function(e){for(this.sliceBegin=!0,this.macroblockAddress=(e-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.bits.read(5);this.bits.read(1);)this.bits.skip(8);for(;this.decodeMacroblock(),!this.bits.nextBytesAreStartCode(););},k.prototype.macroblockAddress=0,k.prototype.mbRow=0,k.prototype.mbCol=0,k.prototype.macroblockType=0,k.prototype.macroblockIntra=!1,k.prototype.macroblockMotFw=!1,k.prototype.motionFwH=0,k.prototype.motionFwV=0,k.prototype.motionFwHPrev=0,k.prototype.motionFwVPrev=0,k.prototype.decodeMacroblock=function(){for(var e=0,t=this.readHuffman(k.MACROBLOCK_ADDRESS_INCREMENT);34===t;)t=this.readHuffman(k.MACROBLOCK_ADDRESS_INCREMENT);for(;35===t;)e+=33,t=this.readHuffman(k.MACROBLOCK_ADDRESS_INCREMENT);if(e+=t,this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=e;else{if(this.macroblockAddress+e>=this.mbSize)return;for(1<e&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureType===k.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));1<e;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),e--;this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth;var i=k.MACROBLOCK_TYPE[this.pictureType];this.macroblockType=this.readHuffman(i),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!=(16&this.macroblockType)&&(this.quantizerScale=this.bits.read(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb));for(var n=0!=(2&this.macroblockType)?this.readHuffman(k.CODE_BLOCK_PATTERN):this.macroblockIntra?63:0,o=0,r=32;o<6;o++)0!=(n&r)&&this.decodeBlock(o),r>>=1},k.prototype.decodeMotionVectors=function(){var e,t,i=0;this.macroblockMotFw?(0!==(e=this.readHuffman(k.MOTION))&&1!==this.forwardF?(i=this.bits.read(this.forwardRSize),t=(Math.abs(e)-1<<this.forwardRSize)+i+1,e<0&&(t=-t)):t=e,this.motionFwHPrev+=t,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),0!==(e=this.readHuffman(k.MOTION))&&1!==this.forwardF?(i=this.bits.read(this.forwardRSize),t=(Math.abs(e)-1<<this.forwardRSize)+i+1,e<0&&(t=-t)):t=e,this.motionFwVPrev+=t,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureType===k.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},k.prototype.copyMacroblock=function(e,t,i,n,o){var r,s,a,l,c,d,u,h,p,f,m,g,y,v,b,_,w,T,S,A=this.currentY32,P=this.currentCb32,E=this.currentCr32;if(s=(r=this.codedWidth)-16,a=e>>1,l=t>>1,c=1==(1&e),d=1==(1&t),u=((this.mbRow<<4)+l)*r+(this.mbCol<<4)+a,p=(h=this.mbRow*r+this.mbCol<<2)+(r<<2),c)if(d)for(;h<p;){for(m=i[u]+i[u+r],u++,f=0;f<4;f++)y=m+(g=i[u]+i[u+r])+2>>2&255,y|=(m=i[++u]+i[u+r])+g+2<<6&65280,y|=m+(g=i[++u]+i[u+r])+2<<14&16711680,m=i[++u]+i[u+r],u++,y|=m+g+2<<22&4278190080,A[h++]=y;h+=s>>2,u+=s-1}else for(;h<p;){for(m=i[u++],f=0;f<4;f++)y=m+(g=i[u++])+1>>1&255,y|=(m=i[u++])+g+1<<7&65280,y|=m+(g=i[u++])+1<<15&16711680,y|=(m=i[u++])+g+1<<23&4278190080,A[h++]=y;h+=s>>2,u+=s-1}else if(d)for(;h<p;){for(f=0;f<4;f++)y=i[u]+i[u+r]+1>>1&255,y|=i[++u]+i[u+r]+1<<7&65280,y|=i[++u]+i[u+r]+1<<15&16711680,y|=i[++u]+i[u+r]+1<<23&4278190080,u++,A[h++]=y;h+=s>>2,u+=s}else for(;h<p;){for(f=0;f<4;f++)y=i[u],y|=i[++u]<<8,y|=i[++u]<<16,y|=i[++u]<<24,u++,A[h++]=y;h+=s>>2,u+=s}if(s=(r=this.halfWidth)-8,a=e/2>>1,l=t/2>>1,c=1==(e/2&1),d=1==(t/2&1),u=((this.mbRow<<3)+l)*r+(this.mbCol<<3)+a,p=(h=this.mbRow*r+this.mbCol<<1)+(r<<1),c)if(d)for(;h<p;){for(v=n[u]+n[u+r],w=o[u]+o[u+r],u++,f=0;f<2;f++)_=v+(b=n[u]+n[u+r])+2>>2&255,S=w+(T=o[u]+o[u+r])+2>>2&255,_|=(v=n[++u]+n[u+r])+b+2<<6&65280,S|=(w=o[u]+o[u+r])+T+2<<6&65280,_|=v+(b=n[++u]+n[u+r])+2<<14&16711680,S|=w+(T=o[u]+o[u+r])+2<<14&16711680,v=n[++u]+n[u+r],w=o[u]+o[u+r],u++,_|=v+b+2<<22&4278190080,S|=w+T+2<<22&4278190080,E[h]=_,P[h]=S,h++;h+=s>>2,u+=s-1}else for(;h<p;){for(v=n[u],w=o[u],u++,f=0;f<2;f++)_=v+(b=n[u])+1>>1&255,S=w+(T=o[u++])+1>>1&255,_|=(v=n[u])+b+1<<7&65280,S|=(w=o[u++])+T+1<<7&65280,_|=v+(b=n[u])+1<<15&16711680,S|=w+(T=o[u++])+1<<15&16711680,_|=(v=n[u])+b+1<<23&4278190080,S|=(w=o[u++])+T+1<<23&4278190080,E[h]=_,P[h]=S,h++;h+=s>>2,u+=s-1}else if(d)for(;h<p;){for(f=0;f<2;f++)_=n[u]+n[u+r]+1>>1&255,S=o[u]+o[u+r]+1>>1&255,_|=n[++u]+n[u+r]+1<<7&65280,S|=o[u]+o[u+r]+1<<7&65280,_|=n[++u]+n[u+r]+1<<15&16711680,S|=o[u]+o[u+r]+1<<15&16711680,_|=n[++u]+n[u+r]+1<<23&4278190080,S|=o[u]+o[u+r]+1<<23&4278190080,u++,E[h]=_,P[h]=S,h++;h+=s>>2,u+=s}else for(;h<p;){for(f=0;f<2;f++)_=n[u],S=o[u],_|=n[++u]<<8,S|=o[u]<<8,_|=n[++u]<<16,S|=o[u]<<16,_|=n[++u]<<24,S|=o[u]<<24,u++,E[h]=_,P[h]=S,h++;h+=s>>2,u+=s}},k.prototype.dcPredictorY=0,k.prototype.dcPredictorCr=0,k.prototype.dcPredictorCb=0,k.prototype.blockData=null,k.prototype.decodeBlock=function(e){var t,i=0;if(this.macroblockIntra){var n,o;if(0<(o=e<4?(n=this.dcPredictorY,this.readHuffman(k.DCT_DC_SIZE_LUMINANCE)):(n=4===e?this.dcPredictorCr:this.dcPredictorCb,this.readHuffman(k.DCT_DC_SIZE_CHROMINANCE)))){var r=this.bits.read(o);this.blockData[0]=0!=(r&1<<o-1)?n+r:n+(-1<<o|r+1)}else this.blockData[0]=n;e<4?this.dcPredictorY=this.blockData[0]:4===e?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,t=this.intraQuantMatrix,i=1}else t=this.nonIntraQuantMatrix;for(var s,a,l,c=0;;){var d=0,u=this.readHuffman(k.DCT_COEFF);if(1===u&&0<i&&0===this.bits.read(1))break;65535===u?(d=this.bits.read(6),0===(c=this.bits.read(8))?c=this.bits.read(8):128===c?c=this.bits.read(8)-256:128<c&&(c-=256)):(d=u>>8,c=255&u,this.bits.read(1)&&(c=-c));var h=k.ZIG_ZAG[i+=d];i++,c<<=1,this.macroblockIntra||(c+=c<0?-1:1),0==(1&(c=c*this.quantizerScale*t[h]>>4))&&(c-=0<c?1:-1),2047<c?c=2047:c<-2048&&(c=-2048),this.blockData[h]=c*k.PREMULTIPLIER_MATRIX[h]}e<4?(s=this.currentY,l=this.codedWidth-8,a=this.mbRow*this.codedWidth+this.mbCol<<4,0!=(1&e)&&(a+=8),0!=(2&e)&&(a+=this.codedWidth<<3)):(s=4===e?this.currentCb:this.currentCr,l=(this.codedWidth>>1)-8,a=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),this.macroblockIntra?1===i?(k.CopyValueToDestination(this.blockData[0]+128>>8,s,a,l),this.blockData[0]=0):(k.IDCT(this.blockData),k.CopyBlockToDestination(this.blockData,s,a,l),b.Fill(this.blockData,0)):1===i?(k.AddValueToDestination(this.blockData[0]+128>>8,s,a,l),this.blockData[0]=0):(k.IDCT(this.blockData),k.AddBlockToDestination(this.blockData,s,a,l),b.Fill(this.blockData,0)),i=0},k.CopyBlockToDestination=function(e,t,i,n){for(var o=0;o<64;o+=8,i+=n+8)t[i+0]=e[o+0],t[i+1]=e[o+1],t[i+2]=e[o+2],t[i+3]=e[o+3],t[i+4]=e[o+4],t[i+5]=e[o+5],t[i+6]=e[o+6],t[i+7]=e[o+7]},k.AddBlockToDestination=function(e,t,i,n){for(var o=0;o<64;o+=8,i+=n+8)t[i+0]+=e[o+0],t[i+1]+=e[o+1],t[i+2]+=e[o+2],t[i+3]+=e[o+3],t[i+4]+=e[o+4],t[i+5]+=e[o+5],t[i+6]+=e[o+6],t[i+7]+=e[o+7]},k.CopyValueToDestination=function(e,t,i,n){for(var o=0;o<64;o+=8,i+=n+8)t[i+0]=e,t[i+1]=e,t[i+2]=e,t[i+3]=e,t[i+4]=e,t[i+5]=e,t[i+6]=e,t[i+7]=e},k.AddValueToDestination=function(e,t,i,n){for(var o=0;o<64;o+=8,i+=n+8)t[i+0]+=e,t[i+1]+=e,t[i+2]+=e,t[i+3]+=e,t[i+4]+=e,t[i+5]+=e,t[i+6]+=e,t[i+7]+=e},k.IDCT=function(e){for(var t,i,n,o,r,s,a,l,c,d,u,h,p,f,m,g,y,v,b=0;b<8;++b)t=e[32+b],i=e[16+b]+e[48+b],n=e[40+b]-e[24+b],s=e[8+b]+e[56+b],a=e[24+b]+e[40+b],c=(p=(473*(o=e[8+b]-e[56+b])-196*n+128>>8)-(r=s+a))-(362*(s-a)+128>>8),f=(d=(l=e[0+b])-t)+(u=(362*(e[16+b]-e[48+b])+128>>8)-i),m=(h=l+t)+i,g=d-u,y=h-i,v=-c-(473*n+196*o+128>>8),e[0+b]=r+m,e[8+b]=p+f,e[16+b]=g-c,e[24+b]=y-v,e[32+b]=y+v,e[40+b]=c+g,e[48+b]=f-p,e[56+b]=m-r;for(b=0;b<64;b+=8)t=e[4+b],i=e[2+b]+e[6+b],n=e[5+b]-e[3+b],s=e[1+b]+e[7+b],a=e[3+b]+e[5+b],c=(p=(473*(o=e[1+b]-e[7+b])-196*n+128>>8)-(r=s+a))-(362*(s-a)+128>>8),f=(d=(l=e[0+b])-t)+(u=(362*(e[2+b]-e[6+b])+128>>8)-i),m=(h=l+t)+i,g=d-u,y=h-i,v=-c-(473*n+196*o+128>>8),e[0+b]=r+m+128>>8,e[1+b]=p+f+128>>8,e[2+b]=g-c+128>>8,e[3+b]=y-v+128>>8,e[4+b]=y+v+128>>8,e[5+b]=c+g+128>>8,e[6+b]=f-p+128>>8,e[7+b]=m-r+128>>8},k.PICTURE_RATE=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],k.ZIG_ZAG=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),k.DEFAULT_INTRA_QUANT_MATRIX=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),k.DEFAULT_NON_INTRA_QUANT_MATRIX=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),k.PREMULTIPLIER_MATRIX=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),k.MACROBLOCK_ADDRESS_INCREMENT=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),k.MACROBLOCK_TYPE_INTRA=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),k.MACROBLOCK_TYPE_PREDICTIVE=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),k.MACROBLOCK_TYPE_B=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),k.MACROBLOCK_TYPE=[null,k.MACROBLOCK_TYPE_INTRA,k.MACROBLOCK_TYPE_PREDICTIVE,k.MACROBLOCK_TYPE_B],k.CODE_BLOCK_PATTERN=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),k.MOTION=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),k.DCT_DC_SIZE_LUMINANCE=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),k.DCT_DC_SIZE_CHROMINANCE=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),k.DCT_COEFF=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),k.PICTURE_TYPE={INTRA:1,PREDICTIVE:2,B:3},k.START={SEQUENCE:179,SLICE_FIRST:1,SLICE_LAST:175,PICTURE:0,EXTENSION:181,USER_DATA:178},k),b.Decoder.MP2Audio=(((O.prototype=Object.create(b.Decoder.Base.prototype)).constructor=O).prototype.decode=function(){var e=this.bits.index>>3;if(e>=this.bits.byteLength)return!1;var t=this.decodeFrame(this.left,this.right);return this.bits.index=e+t<<3,!!t&&(this.destination&&this.destination.play(this.sampleRate,this.left,this.right),this.advanceDecodedTime(this.left.length/this.sampleRate),!0)},O.prototype.getCurrentTime=function(){var e=this.destination?this.destination.enqueuedTime:0;return this.decodedTime-e},O.prototype.decodeFrame=function(e,t){var i=this.bits.read(11),n=this.bits.read(2),o=this.bits.read(2),r=!this.bits.read(1);if(i!==O.FRAME_SYNC||n!==O.VERSION.MPEG_1||o!==O.LAYER.II)return 0;var s=this.bits.read(4)-1;if(13<s)return 0;var a=this.bits.read(2),l=O.SAMPLE_RATE[a];if(3===a)return 0;n===O.VERSION.MPEG_2&&(a+=4,s+=14);var c=this.bits.read(1),d=(this.bits.read(1),this.bits.read(2)),u=0;u=d===O.MODE.JOINT_STEREO?this.bits.read(2)+1<<2:(this.bits.skip(2),d===O.MODE.MONO?0:32),this.bits.skip(4),r&&this.bits.skip(16);var h=144e3*O.BIT_RATE[s]/(l=O.SAMPLE_RATE[a])+c|0,p=0,f=0;if(n===O.VERSION.MPEG_2)p=2,f=30;else{var m=d===O.MODE.MONO?0:1,g=O.QUANT_LUT_STEP_1[m][s];f=63&(p=O.QUANT_LUT_STEP_2[g][a]),p>>=6}f<u&&(u=f);for(var y=0;y<u;y++)this.allocation[0][y]=this.readAllocation(y,p),this.allocation[1][y]=this.readAllocation(y,p);for(y=u;y<f;y++)this.allocation[0][y]=this.allocation[1][y]=this.readAllocation(y,p);var v=d===O.MODE.MONO?1:2;for(y=0;y<f;y++){for(_=0;_<v;_++)this.allocation[_][y]&&(this.scaleFactorInfo[_][y]=this.bits.read(2));d===O.MODE.MONO&&(this.scaleFactorInfo[1][y]=this.scaleFactorInfo[0][y])}for(y=0;y<f;y++){for(var _=0;_<v;_++)if(this.allocation[_][y]){var w=this.scaleFactor[_][y];switch(this.scaleFactorInfo[_][y]){case 0:w[0]=this.bits.read(6),w[1]=this.bits.read(6),w[2]=this.bits.read(6);break;case 1:w[0]=w[1]=this.bits.read(6),w[2]=this.bits.read(6);break;case 2:w[0]=w[1]=w[2]=this.bits.read(6);break;case 3:w[0]=this.bits.read(6),w[1]=w[2]=this.bits.read(6)}}d===O.MODE.MONO&&(this.scaleFactor[1][y][0]=this.scaleFactor[0][y][0],this.scaleFactor[1][y][1]=this.scaleFactor[0][y][1],this.scaleFactor[1][y][2]=this.scaleFactor[0][y][2])}for(var T=0,S=0;S<3;S++)for(var A=0;A<4;A++){for(y=0;y<u;y++)this.readSamples(0,y,S),this.readSamples(1,y,S);for(y=u;y<f;y++)this.readSamples(0,y,S),this.sample[1][y][0]=this.sample[0][y][0],this.sample[1][y][1]=this.sample[0][y][1],this.sample[1][y][2]=this.sample[0][y][2];for(y=f;y<32;y++)this.sample[0][y][0]=0,this.sample[0][y][1]=0,this.sample[0][y][2]=0,this.sample[1][y][0]=0,this.sample[1][y][1]=0,this.sample[1][y][2]=0;for(var P=0;P<3;P++){for(this.VPos=this.VPos-64&1023,_=0;_<2;_++){O.MatrixTransform(this.sample[_],P,this.V,this.VPos),b.Fill(this.U,0);for(var E=512-(this.VPos>>1),C=this.VPos%128>>1;C<1024;){for(var k=0;k<32;++k)this.U[k]+=this.D[E++]*this.V[C++];C+=96,E+=32}for(C=1120-C,E-=480;C<1024;){for(k=0;k<32;++k)this.U[k]+=this.D[E++]*this.V[C++];C+=96,E+=32}for(var I=0===_?e:t,R=0;R<32;R++)I[T+R]=this.U[R]/2147418112}T+=32}}return this.sampleRate=l,h},O.prototype.readAllocation=function(e,t){var i=O.QUANT_LUT_STEP_3[t][e],n=O.QUANT_LUT_STEP4[15&i][this.bits.read(i>>4)];return n?O.QUANT_TAB[n-1]:0},O.prototype.readSamples=function(e,t,i){var n=this.allocation[e][t],o=this.scaleFactor[e][t][i],r=this.sample[e][t],s=0;if(n){if(63===o)o=0;else{var a=o/3|0;o=O.SCALEFACTOR_BASE[o%3]+(1<<a>>1)>>a}var l=n.levels;n.group?(s=this.bits.read(n.bits),r[0]=s%l,s=s/l|0,r[1]=s%l,r[2]=s/l|0):(r[0]=this.bits.read(n.bits),r[1]=this.bits.read(n.bits),r[2]=this.bits.read(n.bits));var c=65536/(l+1)|0;s=((l=(l+1>>1)-1)-r[0])*c,r[0]=s*(o>>12)+(s*(4095&o)+2048>>12)>>12,s=(l-r[1])*c,r[1]=s*(o>>12)+(s*(4095&o)+2048>>12)>>12,s=(l-r[2])*c,r[2]=s*(o>>12)+(s*(4095&o)+2048>>12)>>12}else r[0]=r[1]=r[2]=0},O.MatrixTransform=function(e,t,i,n){var o,r,s,a,l,c,d,u,h,p,f,m,g,y,v,b,_,w,T,S,A,P,E,C,k,O,I,R,V,D,x,N,M;o=e[0][t]+e[31][t],r=.500602998235*(e[0][t]-e[31][t]),s=e[1][t]+e[30][t],a=.505470959898*(e[1][t]-e[30][t]),l=e[2][t]+e[29][t],c=.515447309923*(e[2][t]-e[29][t]),d=e[3][t]+e[28][t],u=.53104259109*(e[3][t]-e[28][t]),h=e[4][t]+e[27][t],p=.553103896034*(e[4][t]-e[27][t]),f=e[5][t]+e[26][t],m=.582934968206*(e[5][t]-e[26][t]),g=e[6][t]+e[25][t],y=.622504123036*(e[6][t]-e[25][t]),v=e[7][t]+e[24][t],b=.674808341455*(e[7][t]-e[24][t]),_=e[8][t]+e[23][t],w=.744536271002*(e[8][t]-e[23][t]),T=e[9][t]+e[22][t],S=.839349645416*(e[9][t]-e[22][t]),A=e[10][t]+e[21][t],P=.972568237862*(e[10][t]-e[21][t]),E=e[11][t]+e[20][t],C=1.16943993343*(e[11][t]-e[20][t]),k=e[12][t]+e[19][t],O=1.48416461631*(e[12][t]-e[19][t]),I=e[13][t]+e[18][t],R=2.05778100995*(e[13][t]-e[18][t]),V=e[14][t]+e[17][t],D=3.40760841847*(e[14][t]-e[17][t]),M=o+(x=e[15][t]+e[16][t]),x=.502419286188*(o-x),o=s+V,V=.52249861494*(s-V),s=l+I,I=.566944034816*(l-I),l=d+k,k=.64682178336*(d-k),d=h+E,E=.788154623451*(h-E),h=f+A,A=1.06067768599*(f-A),f=g+T,T=1.72244709824*(g-T),g=v+_,_=5.10114861869*(v-_),v=M+g,g=.509795579104*(M-g),M=o+f,o=.601344886935*(o-f),f=s+h,h=.899976223136*(s-h),s=l+d,d=2.56291544774*(l-d),l=v+s,v=.541196100146*(v-s),s=M+f,f=1.30656296488*(M-f),M=l+s,l=.707106781187*(l-s),s=v+f,s+=v=.707106781187*(v-f),f=g+d,g=.541196100146*(g-d),d=o+h,h=1.30656296488*(o-h),o=f+d,d=.707106781187*(f-d),f=g+h,o+=f+=g=.707106781187*(g-h),f+=d,d+=g,h=x+_,x=.509795579104*(x-_),_=V+T,V=.601344886935*(V-T),T=I+A,A=.899976223136*(I-A),I=k+E,E=2.56291544774*(k-E),k=h+I,h=.541196100146*(h-I),I=_+T,T=1.30656296488*(_-T),_=k+I,I=.707106781187*(k-I),k=h+T,T=.707106781187*(h-T),h=x+E,x=.541196100146*(x-E),E=V+A,A=1.30656296488*(V-A),V=h+E,E=.707106781187*(h-E),h=x+A,_+=V+=h+=x=.707106781187*(x-A),V+=k+=T,k+=h+=E,h+=I,I+=E+=x,E+=T,T+=x,A=r+(N=10.1900081235*(e[15][t]-e[16][t])),r=.502419286188*(r-N),N=a+D,a=.52249861494*(a-D),D=c+R,R=.566944034816*(c-R),c=u+O,u=.64682178336*(u-O),O=p+C,p=.788154623451*(p-C),C=m+P,P=1.06067768599*(m-P),m=y+S,S=1.72244709824*(y-S),y=b+w,b=5.10114861869*(b-w),w=A+y,y=.509795579104*(A-y),A=N+m,N=.601344886935*(N-m),m=D+C,C=.899976223136*(D-C),D=c+O,O=2.56291544774*(c-O),c=w+D,w=.541196100146*(w-D),D=A+m,m=1.30656296488*(A-m),A=c+D,D=.707106781187*(c-D),c=w+m,m=.707106781187*(w-m),w=y+O,O=.541196100146*(y-O),y=N+C,C=1.30656296488*(N-C),N=w+y,y=.707106781187*(w-y),w=O+C,N+=w+=C=.707106781187*(O-C),w+=y,O=y+C,y=r+b,r=.509795579104*(r-b),b=a+S,a=.601344886935*(a-S),S=R+P,P=.899976223136*(R-P),R=u+p,p=2.56291544774*(u-p),u=y+R,y=.541196100146*(y-R),R=b+S,S=1.30656296488*(b-S),b=u+R,R=.707106781187*(u-R),u=y+S,S=.707106781187*(y-S),y=r+p,r=.541196100146*(r-p),p=a+P,P=1.30656296488*(a-P),a=y+p,p=.707106781187*(y-p),y=r+P,A+=b+=a+=y+=r=.707106781187*(r-P),b+=N,N+=a+=u+=S,a+=c+=m,c+=u+=y+=p,u+=w,w+=y+=R,y+=D,D+=R+=p+=r,R+=O,O+=p+=S,p+=m,m+=S+=r,S+=C,C+=r,i[n+48]=-M,i[n+49]=i[n+47]=-A,i[n+50]=i[n+46]=-_,i[n+51]=i[n+45]=-b,i[n+52]=i[n+44]=-o,i[n+53]=i[n+43]=-N,i[n+54]=i[n+42]=-V,i[n+55]=i[n+41]=-a,i[n+56]=i[n+40]=-s,i[n+57]=i[n+39]=-c,i[n+58]=i[n+38]=-k,i[n+59]=i[n+37]=-u,i[n+60]=i[n+36]=-f,i[n+61]=i[n+35]=-w,i[n+62]=i[n+34]=-h,i[n+63]=i[n+33]=-y,i[n+32]=-l,i[n+0]=l,i[n+31]=-D,i[n+1]=D,i[n+30]=-I,i[n+2]=I,i[n+29]=-R,i[n+3]=R,i[n+28]=-d,i[n+4]=d,i[n+27]=-O,i[n+5]=O,i[n+26]=-E,i[n+6]=E,i[n+25]=-p,i[n+7]=p,i[n+24]=-v,i[n+8]=v,i[n+23]=-m,i[n+9]=m,i[n+22]=-T,i[n+10]=T,i[n+21]=-S,i[n+11]=S,i[n+20]=-g,i[n+12]=g,i[n+19]=-C,i[n+13]=C,i[n+18]=-x,i[n+14]=x,i[n+17]=-r,i[n+15]=r,i[n+16]=0},O.FRAME_SYNC=2047,O.VERSION={MPEG_2_5:0,MPEG_2:2,MPEG_1:3},O.LAYER={III:1,II:2,I:3},O.MODE={STEREO:0,JOINT_STEREO:1,DUAL_CHANNEL:2,MONO:3},O.SAMPLE_RATE=new Uint16Array([44100,48e3,32e3,0,22050,24e3,16e3,0]),O.BIT_RATE=new Uint16Array([32,48,56,64,80,96,112,128,160,192,224,256,320,384,8,16,24,32,40,48,56,64,80,96,112,128,144,160]),O.SCALEFACTOR_BASE=new Uint32Array([33554432,26632170,21137968]),O.SYNTHESIS_WINDOW=new Float32Array([0,-.5,-.5,-.5,-.5,-.5,-.5,-1,-1,-1,-1,-1.5,-1.5,-2,-2,-2.5,-2.5,-3,-3.5,-3.5,-4,-4.5,-5,-5.5,-6.5,-7,-8,-8.5,-9.5,-10.5,-12,-13,-14.5,-15.5,-17.5,-19,-20.5,-22.5,-24.5,-26.5,-29,-31.5,-34,-36.5,-39.5,-42.5,-45.5,-48.5,-52,-55.5,-58.5,-62.5,-66,-69.5,-73.5,-77,-80.5,-84.5,-88,-91.5,-95,-98,-101,-104,106.5,109,111,112.5,113.5,114,114,113.5,112,110.5,107.5,104,100,94.5,88.5,81.5,73,63.5,53,41.5,28.5,14.5,-1,-18,-36,-55.5,-76.5,-98.5,-122,-147,-173.5,-200.5,-229.5,-259.5,-290.5,-322.5,-355.5,-389.5,-424,-459.5,-495.5,-532,-568.5,-605,-641.5,-678,-714,-749,-783.5,-817,-849,-879.5,-908.5,-935,-959.5,-981,-1000.5,-1016,-1028.5,-1037.5,-1042.5,-1043.5,-1040,-1031.5,1018.5,1e3,976,946.5,911,869.5,822,767.5,707,640,565.5,485,397,302.5,201,92.5,-22.5,-144,-272.5,-407,-547.5,-694,-846,-1003,-1165,-1331.5,-1502,-1675.5,-1852.5,-2031.5,-2212.5,-2394,-2576.5,-2758.5,-2939.5,-3118.5,-3294.5,-3467.5,-3635.5,-3798.5,-3955,-4104.5,-4245.5,-4377.5,-4499,-4609.5,-4708,-4792.5,-4863.5,-4919,-4958,-4979.5,-4983,-4967.5,-4931.5,-4875,-4796,-4694.5,-4569.5,-4420,-4246,-4046,-3820,-3567,3287,2979.5,2644,2280.5,1888,1467.5,1018.5,541,35,-499,-1061,-1650,-2266.5,-2909,-3577,-4270,-4987.5,-5727.5,-6490,-7274,-8077.5,-8899.5,-9739,-10594.5,-11464.5,-12347,-13241,-14144.5,-15056,-15973.5,-16895.5,-17820,-18744.5,-19668,-20588,-21503,-22410.5,-23308.5,-24195,-25068.5,-25926.5,-26767,-27589,-28389,-29166.5,-29919,-30644.5,-31342,-32009.5,-32645,-33247,-33814.5,-34346,-34839.5,-35295,-35710,-36084.5,-36417.5,-36707.5,-36954,-37156.5,-37315,-37428,-37496,37519,37496,37428,37315,37156.5,36954,36707.5,36417.5,36084.5,35710,35295,34839.5,34346,33814.5,33247,32645,32009.5,31342,30644.5,29919,29166.5,28389,27589,26767,25926.5,25068.5,24195,23308.5,22410.5,21503,20588,19668,18744.5,17820,16895.5,15973.5,15056,14144.5,13241,12347,11464.5,10594.5,9739,8899.5,8077.5,7274,6490,5727.5,4987.5,4270,3577,2909,2266.5,1650,1061,499,-35,-541,-1018.5,-1467.5,-1888,-2280.5,-2644,-2979.5,3287,3567,3820,4046,4246,4420,4569.5,4694.5,4796,4875,4931.5,4967.5,4983,4979.5,4958,4919,4863.5,4792.5,4708,4609.5,4499,4377.5,4245.5,4104.5,3955,3798.5,3635.5,3467.5,3294.5,3118.5,2939.5,2758.5,2576.5,2394,2212.5,2031.5,1852.5,1675.5,1502,1331.5,1165,1003,846,694,547.5,407,272.5,144,22.5,-92.5,-201,-302.5,-397,-485,-565.5,-640,-707,-767.5,-822,-869.5,-911,-946.5,-976,-1e3,1018.5,1031.5,1040,1043.5,1042.5,1037.5,1028.5,1016,1000.5,981,959.5,935,908.5,879.5,849,817,783.5,749,714,678,641.5,605,568.5,532,495.5,459.5,424,389.5,355.5,322.5,290.5,259.5,229.5,200.5,173.5,147,122,98.5,76.5,55.5,36,18,1,-14.5,-28.5,-41.5,-53,-63.5,-73,-81.5,-88.5,-94.5,-100,-104,-107.5,-110.5,-112,-113.5,-114,-114,-113.5,-112.5,-111,-109,106.5,104,101,98,95,91.5,88,84.5,80.5,77,73.5,69.5,66,62.5,58.5,55.5,52,48.5,45.5,42.5,39.5,36.5,34,31.5,29,26.5,24.5,22.5,20.5,19,17.5,15.5,14.5,13,12,10.5,9.5,8.5,8,7,6.5,5.5,5,4.5,4,3.5,3.5,3,2.5,2.5,2,2,1.5,1.5,1,1,1,1,.5,.5,.5,.5,.5,.5]),O.QUANT_LUT_STEP_1=[[0,0,1,1,1,2,2,2,2,2,2,2,2,2],[0,0,0,0,0,0,1,1,1,2,2,2,2,2]],O.QUANT_LUT_STEP_2=[[(O.QUANT_TAB={A:91,B:94,C:8,D:12}).C,O.QUANT_TAB.C,O.QUANT_TAB.D],[O.QUANT_TAB.A,O.QUANT_TAB.A,O.QUANT_TAB.A],[O.QUANT_TAB.B,O.QUANT_TAB.A,O.QUANT_TAB.B]],O.QUANT_LUT_STEP_3=[[68,68,52,52,52,52,52,52,52,52,52,52],[67,67,67,66,66,66,66,66,66,66,66,49,49,49,49,49,49,49,49,49,49,49,49,32,32,32,32,32,32,32],[69,69,69,69,52,52,52,52,52,52,52,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36]],O.QUANT_LUT_STEP4=[[0,1,2,17],[0,1,2,3,4,5,6,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17],[0,1,3,5,6,7,8,9,10,11,12,13,14,15,16,17],[0,1,2,4,5,6,7,8,9,10,11,12,13,14,15,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],O.QUANT_TAB=[{levels:3,group:1,bits:5},{levels:5,group:1,bits:7},{levels:7,group:0,bits:3},{levels:9,group:1,bits:10},{levels:15,group:0,bits:4},{levels:31,group:0,bits:5},{levels:63,group:0,bits:6},{levels:127,group:0,bits:7},{levels:255,group:0,bits:8},{levels:511,group:0,bits:9},{levels:1023,group:0,bits:10},{levels:2047,group:0,bits:11},{levels:4095,group:0,bits:12},{levels:8191,group:0,bits:13},{levels:16383,group:0,bits:14},{levels:32767,group:0,bits:15},{levels:65535,group:0,bits:16}],O),b.Renderer.WebGL=(I.prototype.resize=function(e,t){this.width=0|e,this.height=0|t,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.useProgram(this.program),this.gl.viewport(0,0,this.width,this.height)},I.prototype.createTexture=function(e,t){var i=this.gl,n=i.createTexture();return i.bindTexture(i.TEXTURE_2D,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.uniform1i(i.getUniformLocation(this.program,t),e),n},I.prototype.createProgram=function(e,t){var i=this.gl,n=i.createProgram();return i.attachShader(n,this.compileShader(i.VERTEX_SHADER,e)),i.attachShader(n,this.compileShader(i.FRAGMENT_SHADER,t)),i.linkProgram(n),i.useProgram(n),n},I.prototype.compileShader=function(e,t){var i=this.gl,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS))throw new Error(i.getShaderInfoLog(n));return n},I.prototype.allowsClampedTextureData=function(){var e=this.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.LUMINANCE,1,1,0,e.LUMINANCE,e.UNSIGNED_BYTE,new Uint8ClampedArray([0])),0===e.getError()},I.prototype.renderProgress=function(e){var t=this.gl,i=t.getUniformLocation(this.loadingProgram,"progress");t.uniform1f(i,e),t.drawArrays(t.TRIANGLE_STRIP,0,4)},I.prototype.render=function(e,t,i){if(this.enabled){var n=this.gl,o=this.width+15>>4<<4,r=this.height,s=o>>1,a=r>>1;this.shouldCreateUnclampedViews&&(e=new Uint8Array(e.buffer),t=new Uint8Array(t.buffer),i=new Uint8Array(i.buffer)),this.updateTexture(n.TEXTURE0,this.textureY,o,r,e),this.updateTexture(n.TEXTURE1,this.textureCb,s,a,t),this.updateTexture(n.TEXTURE2,this.textureCr,s,a,i),n.drawArrays(n.TRIANGLE_STRIP,0,4)}},I.prototype.updateTexture=function(e,t,i,n,o){var r=this.gl;r.activeTexture(e),r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,i,n,0,r.LUMINANCE,r.UNSIGNED_BYTE,o)},I.IsSupported=function(){try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas");return!(!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}},I.SHADER={FRAGMENT_YCRCB_TO_RGBA:["precision mediump float;","uniform sampler2D textureY;","uniform sampler2D textureCb;","uniform sampler2D textureCr;","varying vec2 texCoord;","mat4 rec601 = mat4(","1.16438,  0.00000,  1.59603, -0.87079,","1.16438, -0.39176, -0.81297,  0.52959,","1.16438,  2.01723,  0.00000, -1.08139,","0, 0, 0, 1",");","void main() {","float y = texture2D(textureY, texCoord).r;","float cb = texture2D(textureCb, texCoord).r;","float cr = texture2D(textureCr, texCoord).r;","gl_FragColor = vec4(y, cr, cb, 1.0) * rec601;","}"].join("\n"),FRAGMENT_LOADING:["precision mediump float;","uniform float progress;","varying vec2 texCoord;","void main() {","float c = ceil(progress-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),VERTEX_IDENTITY:["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n")},I),b.Renderer.Canvas2D=(R.prototype.resize=function(e,t){this.width=0|e,this.height=0|t,this.canvas.width=this.width,this.canvas.height=this.height,this.imageData=this.context.getImageData(0,0,this.width,this.height),b.Fill(this.imageData.data,255)},R.prototype.renderProgress=function(e){var t=this.canvas.width,i=this.canvas.height,n=this.context;n.fillStyle="#222",n.fillRect(0,0,t,i),n.fillStyle="#fff",n.fillRect(0,i-i*e,t,i*e)},R.prototype.render=function(e,t,i){this.YCbCrToRGBA(e,t,i,this.imageData.data),this.context.putImageData(this.imageData,0,0)},R.prototype.YCbCrToRGBA=function(e,t,i,n){if(this.enabled)for(var o,r,s,a,l,c=this.width+15>>4<<4,d=c>>1,u=0,h=c,p=c+(c-this.width),f=0,m=d-(this.width>>1),g=0,y=4*this.width,v=4*this.width,b=this.width>>1,_=this.height>>1,w=0;w<_;w++){for(var T=0;T<b;T++){o=t[f],r=i[f],f++,s=o+(103*o>>8)-179,a=(88*r>>8)-44+(183*o>>8)-91,l=r+(198*r>>8)-227;var S=e[u++],A=e[u++];n[g]=S+s,n[g+1]=S-a,n[g+2]=S+l,n[g+4]=A+s,n[g+5]=A-a,n[g+6]=A+l,g+=8;var P=e[h++],E=e[h++];n[y]=P+s,n[y+1]=P-a,n[y+2]=P+l,n[y+4]=E+s,n[y+5]=E-a,n[y+6]=E+l,y+=8}u+=p,h+=p,g+=v,y+=v,f+=m}},R),b.AudioOutput.WebAudio=(V.prototype.play=function(e,t,i){if(this.enabled){if(!this.unlocked){var n=b.Now();return this.wallclockStartTime<n&&(this.wallclockStartTime=n),void(this.wallclockStartTime+=t.length/e)}this.gain.gain.value=this.volume;var o=this.context.createBuffer(2,t.length,e);o.getChannelData(0).set(t),o.getChannelData(1).set(i);var r=this.context.createBufferSource();r.buffer=o,r.connect(this.destination);var s=this.context.currentTime,a=o.duration;this.startTime<s&&(this.startTime=s,this.wallclockStartTime=b.Now()),r.start(this.startTime),this.startTime+=a,this.wallclockStartTime+=a}},V.prototype.stop=function(){this.gain.gain.value=0},V.prototype.getEnqueuedTime=function(){return Math.max(this.wallclockStartTime-b.Now(),0)},V.prototype.resetEnqueuedTime=function(){this.startTime=this.context.currentTime,this.wallclockStartTime=b.Now()},V.prototype.unlock=function(e){if(this.unlocked)e&&e();else{this.unlockCallback=e;var t=this.context.createBuffer(1,1,22050),i=this.context.createBufferSource();i.buffer=t,i.connect(this.destination),i.start(0),setTimeout(this.checkIfUnlocked.bind(this,i,0),0)}},V.prototype.checkIfUnlocked=function(e,t){e.playbackState===e.PLAYING_STATE||e.playbackState===e.FINISHED_STATE?(this.unlocked=!0,this.unlockCallback&&(this.unlockCallback(),this.unlockCallback=null)):t<10&&setTimeout(this.checkIfUnlocked.bind(this,e,t+1),100)},V.NeedsUnlocking=function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},V.IsSupported=function(){return window.AudioContext||window.webkitAudioContext},V.CachedContext=null,V);var D=function(e,t){return new b.Player(e,t)};function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L=function(){function e(t,i){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,N(e).call(this))).video=t,n.params=i,n.target=n.params.canvas.parent,n.logToBI=n.params.logToBI,n.playingEventTimeout=n.params.canvas.playingEventTimeout||100,n.createCanvas(),n.modifyVideo(t),n.shouldAutoPlay=!1,n.canvasCss=i.canvas.additionalCss||{},n.bypass=!1,n.clntRedirRslvWhiteList=n.params.clientRedirRslvWhiteList||[],n.ready=!1,n.loop=!1,n.vidAttr={},t.muted=!0,n.status="LOADING",n._addCanvasProgressPrecentageProperty(),n._addCanvasCurrentTimeProperty(),n._addCanvasMethods(),n.quartiles=[{event:"AdVideoFirstQuartile",percentage:.25},{event:"AdVideoMidpoint",percentage:.5},{event:"AdVideoThirdQuartile",percentage:.75}],n.logToBI("canvas",{ctor:!0}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(e,s.EventEmitter),function(e,t,i){t&&function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t)}(e,[{key:"_addCanvasProgressPrecentageProperty",value:function(){Object.defineProperty(this,"progressPrecentage",{get:function(){return this.video.currentTime/this.video.duration}})}},{key:"_addCanvasCurrentTimeProperty",value:function(){Object.defineProperty(this,"currentTime",{get:function(){return this.video.currentTime}})}},{key:"_addCanvasMethods",value:function(){this._addMuteButtonClickedMethod(),this._addPlayButtonClickedMethod(),this._addResizeMethod(),this._addUseResumeCallbackMethod(),this._addEmitStartAdMethod(),this._addShowCanvasMethod(),this._addHideCanvasMethod()}},{key:"_addMuteButtonClickedMethod",value:function(){var e=this;this.video.muteButtonClicked=function(){e.muteButtonClick()}}},{key:"_addPlayButtonClickedMethod",value:function(){var e=this;this.video.playButtonClicked=function(){e.playButtonClick()}}},{key:"_addResizeMethod",value:function(){var e=this;this.video.resize=function(){var t=1<arguments.length?arguments:arguments[0],i=t[0],n=t[1],o=t[2];o&&(e.params.canvas.aspectRatio=o),e.onResize(i,n)}}},{key:"_addUseResumeCallbackMethod",value:function(){var e=this;this.video.useResumeCallback=function(){return e}}},{key:"_addEmitStartAdMethod",value:function(){var e=this;this.video.emitStartAd=function(){return e.emitStartAd()}}},{key:"_addShowCanvasMethod",value:function(){var e=this;this.video.showCanvas=function(){return e.show()}}},{key:"_addHideCanvasMethod",value:function(){var e=this;this.video.hideCanvas=function(){return e.hide()}}},{key:"emitStartAd",value:function(){var e=this;this.stratAdCalled=!0,this._playTimeout=setTimeout((function(){e._play()}),2e3)}},{key:"backToVideoTag",value:function(e){var t=this;if(!this.bypass&&this.src){this.bypass=!0;var i=this.jsmpeg.currentTime,n=this.video.style,o=this.video.parentElement||this.target,r=parseInt(this.canvas.style.zIndex),s=this.jsmpeg.loop;this.newVid=o.insertBefore(document.createElement("video"),this.canvas),this.newVid.className="mc-loud-video",this.newVid.setAttribute("playsinline",""),this.newVid.setAttribute("autoplay",""),s&&this.newVid.setAttribute("loop",""),this.newVid.style.height=n.height,this.newVid.style.width=n.width,this.newVid.style.top=n.top?n.top:"0",this.newVid.style.left=n.left?n.left:"0",this.newVid.style.background="#000000",this.newVid.style.zIndex=r,this.newVid.style.display="none",this.newVid.src=this.src,this.newVid.volume="muteChanged"===e.type?this.params.canvas.defaultVolume:0,this.newVid.muted=0===this.newVid.volume,this.newVid.addEventListener("ended",(function(e){t._dispatchEvent("ended")}),!1),this.newVid.addEventListener("click",(function(e){t._dispatchEvent("click",e)})),this.newVid.addEventListener("durationchange",(function n(){if(0!==t.newVid.duration){t.newVid.removeEventListener("durationchange",n);var o=t.jsmpeg&&0<t.jsmpeg.currentTime?t.jsmpeg.currentTime:i;(0===t.newVid.currentTime||t.newVid.currentTime<o)&&(t.newVid.currentTime=o,t.newVid.addEventListener("timeupdate",(function i(){t.newVid.currentTime>o&&(t.newVid.removeEventListener("timeupdate",i),t.tuTicker=clearInterval(t.tuTicker),t.jsmpeg.stop(),t.jsmpeg=void 0,t.newVid.style.display="block",t.canvas.style.display="none",t.video.style.display="none","playChanged"!==e.type&&!t.video.paused||t._pause(),t._dispatchEvent("newVidCreated",t.newVid))})))}})),this.newVid.addEventListener("timeupdate",(function(){t._dispatchEvent("timeupdate")})),this.newVid.currentTime=i,this.newVid.play().then((function(){t.newVid.currentTime=i})),this.isCanvasFinished=!1}}},{key:"mpegFinish",value:function(){this.isCanvasFinished||(this._dispatchEvent("ended"),this.isCanvasFinished=!0)}},{key:"onLoad",value:function(){if(!this.loaded){this.loaded=!0;var e=parseInt(this.video.width),t=parseInt(this.video.height);this.onResize(e,t),this.ready=!0,this.emit("ready"),this.emit("canplay"),this._dispatchEvent("loadedmetadata")}}},{key:"createCanvas",value:function(){var e=this,t=document.createElement("canvas");t.className="mc-canvas",this.params.isMultiVpaidUnit&&function(e,t){e.className.indexOf(t)<0&&(e.className+=" ".concat(t)),e.className=e.className.split(" ").join(" ")}(t,"multi-vpaids");var i=this.video.parentElement||this.target;this.canvas=i.appendChild(t),i.className+=" mpegcnv",i._appendChild=i.appendChild,i.appendChild=function(t){i.insertBefore(t,e.canvas)},this.video&&this.video._addEventListener("resize",(function(t){e.onResize(t.target.clientWidth,t.target.clientHeight)})),this.canvas.addEventListener("click",(function(t){e._dispatchEvent("click",t)}))}},{key:"_getAspectRatio",value:function(){var e=this.params.canvas.aspectRatio;if(e&&e.indexOf(":")){var t=e.split(":");if(2===t.length&&t[0]&&t[1])return t}return!1}},{key:"onResize",value:function(e,t){var i,n;if(e||t){var o=this._getAspectRatio();if(o?e?(t=t||this.video.clientHeight,n=e,i=Math.floor(parseFloat(e)*parseInt(o[1])/parseInt(o[0]))):(e=this.video.clientWidth,i=t,n=Math.floor(parseFloat(t)*parseInt(o[0])/parseInt(o[1]))):(n=e,i=t),this.newVid)this.newVid.style.width="".concat(e,"px"),this.newVid.style.height="".concat(t,"px");else if(this.jsmpeg&&this.canvas){var r=this.video.videoWidth/this.video.videoHeight,s=e/t;this.canvas.style.position="absolute",this.canvas.style.top="0px",r<=1&&1<s?this._rescaleVerticalToWide(e,t):(this.canvas.style.left="0px",this.canvas.style.width=n+"px",this.canvas.style.height=i+"px",this.canvas.style.marginTop=(t-i)/2+"px",this.canvas.style.marginLeft=(e-n)/2+"px")}this.height=t,this.width=e}}},{key:"_rescaleVerticalToWide",value:function(e,t){var i=this.video.videoHeight/t,n=this.video.videoWidth/i,o=(e-n)/2;this.canvas.style.width=n+"px",this.canvas.style.height=t+"px",this.canvas.style.left=o+"px",this.canvas.parentElement&&this.canvas.parentElement.parentElement&&(this.canvas.parentElement.parentElement.style.backgroundColor="black")}},{key:"hookMethod",value:function(e,t,i){this.hooks||(this.hooks=[]),this.hooks[t]=e[t];var n=this;e[t]=function(){var e={};if(i(arguments,e)){if(!n.hooks.hasOwnProperty(t)||"function"!=typeof n.hooks[t])return!1;var o=n.hooks[t].apply(this,arguments);return e.res?e.res:o}}}},{key:"subscribe",value:function(e,t){this.on(e,t)}},{key:"unsubscribe",value:function(e,t){this.off(e,t)}},{key:"_dispatchEvent",value:function(e,t){var i={};i.type=e,i.data=t||{},this.emit(e,i)}},{key:"errHndlr",value:function(e){this.logToBI("jsmpegError",e),this.video.destroy()}},{key:"isUrlInRslvWhiteList",value:function(e){if(!this.clntRedirRslvWhiteList.length)return!0;for(var t=0;t<this.clntRedirRslvWhiteList.length;++t)if(-1<e.indexOf(this.clntRedirRslvWhiteList[t]))return!0;return!1}},{key:"setSrc",value:function(e){if((e=e.trim())&&!this.hasVidUrl){this.logToBI("canvasUrl",{url:e},!1,!1),this.hasVidUrl=!0,this.video&&this.video._vidSetAttr("src",e),this.src=e;var t=this.params.canvas.canvasLoadRate,i=parseInt(this.video.clientWidth),n=parseInt(this.video.clientHeight),o={loadeReadyRate:t,canvas:this.canvas,audio:!1,centerVertically:!0,autoplay:this.shouldAutoPlay,loop:this.loop||!1,pcy:n,pcx:i,onload:this.onLoad.bind(this),errHndlr:this.errHndlr.bind(this),onfinished:this.mpegFinish.bind(this),progressive:!1,canvasCss:this.canvasCss,disableGl:this.params.canvas.disableWebGl},r=this.params.canvas.mpegServerBaseUrl+"="+encodeURIComponent(e);return(/\.mpg$/.test(e)||/\.mpeg$/.test(e))&&(r=e),this.jsmpeg=new D(r,o,this),this._setVideoDuration(this.src),!1}}},{key:"_play",value:function(){var e=this;this.blockActions||(clearTimeout(this._playTimeout),this._timeUpdateTicker(),this.ready?(this.newVid?this.newVid.play():this.jsmpeg.play(),setTimeout((function(){e._dispatchEvent("playing")}),this.playingEventTimeout),this.status="PLAYING",this._render()):this.on("ready",(function(){e._dispatchEvent("play"),e._play()})))}},{key:"_timeUpdateTicker",value:function(){var e=this;clearInterval(this.tuTicker),this.tuTicker=setInterval((function(){e._dispatchEvent("timeupdate"),0<e.quartiles.length&&e.video.currentTime/e.video.duration>=e.quartiles[0].percentage&&e.logToBI("canvas_quartiles",{event:e.quartiles.shift().event})}),250)}},{key:"_pause",value:function(){this.stopped||(this.status="PAUSED",this._render(),this.newVid?this.newVid.pause():this.jsmpeg&&this.jsmpeg.pause(),this.tuTicker&&(this.tuTicker=clearInterval(this.tuTicker)))}},{key:"muteButtonClick",value:function(e){if(!this.stopped){var t=!!this.newVid&&!this.newVid.muted;this.logToBI("canvasMuteToggle",{muted:t}),this.newVid?(this.newVid.volume=t?0:this.params.canvas.defaultVolume,this.newVid.muted=0===this.newVid.volume):this.backToVideoTag({type:"muteChanged"})}}},{key:"playButtonClick",value:function(e){if(!this.stopped){var t="PLAYING"===this.status?"PAUSED":"PLAYING";if(this.logToBI("canvasPlayToggle",{status:t,view:this.newVid?"newVid":"canvas"}),this.status=t,this.newVid){var i=this.newVid||this.jsmpeg;"PLAYING"===this.status?i.play():i.pause(),this._render()}else this.backToVideoTag({type:"playChanged"})}}},{key:"modifyVideo",value:function(e){var t=this;this.stopped||(e._vidSetAttr=e.setAttribute,e.getAttribute=function(e,i){return t.vidAttr[e]},e.setAttribute=function(i,n){if(!t.stopped)return t.vidAttr[i]=n,"volume"===i&&(t._volume=n),t.logToBI("hookSetAttribute",{key:i,val:n}),"src"===i?void t.setSrc(n):e._vidSetAttr(i,n)},this.hookMethod(e,"play",(function(){if(!t.stopped)return t._play(),setTimeout((function(){t._dispatchEvent("playing")}),t.playingEventTimeout),!1})),this.hookMethod(e,"pause",(function(){if(!t.stopped)return t._pause(),t._dispatchEvent("pause"),!0})),this.hookMethod(e,"stop",(function(){if(!t.stopped)return t.jsmpeg.stop(),!0})),n(e,"paused",(function(){return"PAUSED"===t.status}),null),n(e,"src",(function(){return t.src}),this.setSrc.bind(this)),n(this.video,"volume",(function(){return t.newVid?t.newVid.volume:t._volume}),(function(e){return t._volume=e,!0})),n(e,"currentTime",(function(){var e=t.newVid||t.jsmpeg;return e?e.currentTime:0}),(function(e){t.newVid?t.newVid.currentTime=e:t.jsmpeg.seek(e)})),n(e,"ended",(function(){return t.newVid?t.newVid.ended:t.isCanvasFinished}),null),n(e,"duration",(function(){if(t.duration)return t.duration}),(function(e){t.duration=e})))}},{key:"_setVideoDuration",value:function(e){var t=this,i=document.createElement("video");i.src=e,i.addEventListener("loadedmetadata",(function(){t.video&&(t.video.duration=i.duration),i.src="",i=void 0})),i.load()}},{key:"_render",value:function(){this.newVid||this.canvas}},{key:"hide",value:function(){this.stopped||(this.canvas.style.display="none",this._render())}},{key:"show",value:function(){this.stopped||(this.canvas.style.display="block",this._render())}},{key:"removeDomMember",value:function(e){e.parentNode.removeChild(e)}},{key:"restartAd",value:function(){var e=this;this.stopped||(this.newVid?(this.newVid.currentTime=0,this.newVid.play()):this.jsmpeg&&(this.blockActions=!0,this.jsmpeg.stop(),setTimeout((function(){e.jsmpeg.play()}),20),setTimeout((function(){e.blockActions=!1}),2e3)))}},{key:"destroy",value:function(){if(this.stopped)this.logToBI("canvasDuplicatedDestroy",{});else{this.stopped=!0,clearTimeout(this._playTimeout),clearInterval(this.tuTicker),this.jsmpeg=void 0;var e=this._events;for(var t in e)this.removeAllListeners(t);this.removeDomMember(this.canvas),this.canvas=void 0}}}]),e}();var F=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=document.createElement("video"),this.params=t,this._addVideoTagMethods(),this._addVideoTagProperties(),this._addVideoTagAttributes(),this.video}return function(e,t,i){t&&function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t)}(e,[{key:"_addVideoTagMethods",value:function(){this._addClearVideoSourcesMethod(),this._addRestartMethod(),this._addAppendSourceMethod(),this._addAppendVideoSourcesMethod(),this._addProtectVideoPauseMethod(),this._addGetSrcMethod(),this._addHookMutedPropertyMethod(),this._addSupressErrorEventsMethod(),this._addDispatchEventMethod(),this._addSubscribeMethod(),this._addUnsubscribeMethod()}},{key:"_addClearVideoSourcesMethod",value:function(){this.video.clearVideoSources=function(){for(;this.childNodes.length;)this.removeChild(this.childNodes[0])}}},{key:"_addRestartMethod",value:function(){this.video.restart=function(){this.currentTime=0,this.play()}}},{key:"_addAppendSourceMethod",value:function(){this.video.appendSource=function(e,t){if(this.forceCanvas)this.setAttribute("src",e),this.setAttribute("type",t);else{var i=document.createElement("source");i.src=e,i.setAttribute("type",t),this.appendChild(i)}this.relevantSources++}}},{key:"_addAppendVideoSourcesMethod",value:function(){var e=this;this.video.appendVideoSources=function(t){var i=null;e.video.clearVideoSources();for(var n=0;n<t.length;n++){var o=t[n],r=o.url;e.video.canPlayType(o.originalType)&&(e.params.decodeUrl&&(r=decodeURI(r)),e.params.secureMediaFiles&&(r=r.replace("http:","https:")),i||((i=o).mediaUrl=r),e.video.appendSource(r,o.originalType))}return i}}},{key:"_addProtectVideoPauseMethod",value:function(){this.video.protectPause=function(){this._play=this.play,this.play=function(){this.resumeInvoked&&this._play()}}}},{key:"_addGetSrcMethod",value:function(){this.video.getSrc=function(){return this.src||this.currentSrc||""}}},{key:"_addHookMutedPropertyMethod",value:function(){this.params.isMobile&&(this.video.hookMutedProperty=function(){this.__defineSetter__("_muted",this.__lookupSetter__("muted")),this.__defineSetter__("muted",(function(e){if(this.mutedChangeByUserGesture)return this._muted=e,void this.__defineSetter__("muted",this.__lookupSetter__("_muted"));this._muted=!0}))})}},{key:"_addSupressErrorEventsMethod",value:function(){this.video.supressErrorEvents=function(){this.__addEventListener=this.addEventListener,this.addEventListener=function(e,t){"error"!==e&&this.__addEventListener(e,t)}}}},{key:"_addDispatchEventMethod",value:function(){this.video._dispatchEvent=function(e,t){var i=document.createEvent("Event");i.initEvent(e,!0,!0),i.data=t||{},this.dispatchEvent(i)}}},{key:"_addSubscribeMethod",value:function(){this.video.subscribe=function(e,t){this.addEventListener(e,t,!0)}}},{key:"_addUnsubscribeMethod",value:function(){this.video.unsubscribe=function(e,t){this.removeEventListener(e,t,!0)}}},{key:"_addVideoTagProperties",value:function(){this._addTbVersionProperty(),this._addProgressPrecentageProperty(),this._addRemainingTimeProperty(),this._addRelevantSourcesProperty(),this._addBufferSizeProperty(),this._addResumeInvokedProperty(),this._addMutedChangeByUserGestureProperty(),this._hookSrcProperty()}},{key:"_addTbVersionProperty",value:function(){Object.defineProperty(this.video,"TB__VERSION",{get:function(){return"2.2.17"}})}},{key:"_addProgressPrecentageProperty",value:function(){Object.defineProperty(this.video,"progressPrecentage",{get:function(){return this.currentTime/this.duration}})}},{key:"_addRemainingTimeProperty",value:function(){Object.defineProperty(this.video,"remainingTime",{get:function(){return this.duration-this.currentTime}})}},{key:"_addRelevantSourcesProperty",value:function(){Object.defineProperty(this.video,"relevantSources",{get:function(){return this._relevantSources||0},set:function(e){this._relevantSources=e}})}},{key:"_addBufferSizeProperty",value:function(){Object.defineProperty(this.video,"bufferSize",{get:function(){if(this.buffered)return 0===this.buffered.length||0!==this.buffered.start(0)?0:this.buffered.end(0)-this.buffered.start(0)}})}},{key:"_addResumeInvokedProperty",value:function(){Object.defineProperty(this.video,"resumeInvoked",{get:function(){return this._resumeInvoked||!1},set:function(e){this._resumeInvoked=e}})}},{key:"_addMutedChangeByUserGestureProperty",value:function(){this.params.isMobile&&Object.defineProperty(this.video,"mutedChangeByUserGesture",{get:function(){return this._mutedChangeByUserGesture||!1},set:function(e){this._mutedChangeByUserGesture=e}})}},{key:"_hookSrcProperty",value:function(){var e=this;n(this.video,"src",null,(function(t){return!(""==t&&!e.video.removeSrc)}))}},{key:"_addVideoTagAttributes",value:function(){this.params.isMobile&&(this.video.muted=!0,this.video.setAttribute("muted",""),this.video.setAttribute("playsinline",""),"iOS"===this.params.userAgent.os.name&&this.video.removeAttribute("autoplay",""))}}]),e}();function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}var j=y,U=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._initVideoElementParams(t),this.video=new F(this.params),this._overrideVideoAddEventListener(),this._initVideoMobileParams(),this._addVideoElementProperties(),this._addVideoElementMethods(),this._addTimeupdateEvents(),this._loopThroughMediaSources(),this.video.videoState=t.videoState||g,this.video}return function(e,t,i){t&&function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t)}(e,[{key:"_initVideoElementParams",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};this.params=B({},j,t),this.params.canvas=B({},j.canvas,t.canvas),this.params.secureMediaFiles=this.params.secureMediaFiles&&"https:"===window.location.protocol}},{key:"_initVideoMobileParams",value:function(){if(this.params.isMobile)if(this.params.logToBI("videoElement",{forceCanvas:this.params.canvas.force},!1,!1),this.params.canvas.force){if(this._isAutoplayContent())return;this._initCanvas()}else this._shouldDetectAutoplay()&&this._detectAutoplay()}},{key:"_isAutoplayContent",value:function(){return this.params.videoState===g&&this.params.canvas.useAutoplayForContent}},{key:"_shouldDetectAutoplay",value:function(){return this.params.isMobile&&!this.params.canvas.ignoreAutoplayDetection}},{key:"_detectAutoplay",value:function(){var e=new m(this.params);e.on("detectIsAutoplaySupported",this._onIsAutoplaySupportedDetected.bind(this)),e.isAutoplaySupported()}},{key:"_onIsAutoplaySupportedDetected",value:function(e){this.params.logToBI("videoElement",{isAutoplaySupported:e},!1,!1),e||this._initCanvas()}},{key:"_initCanvas",value:function(){this.canvasInited||(this.canvasInited=!0,this.video.forceCanvas=!0,this.canvas=new L(this.video,this.params),this._handleEventListenersVideoToCanvas(),this._registerToCanvasEvents(),this.params.canvas.onCanvasUsage())}},{key:"_overrideVideoAddEventListener",value:function(){this.eventsCb={};var e=this;this.video._addEventListener=this.video.addEventListener,this.video.addEventListener=function(t,i,n){e._addEventCb(t,i),this._addEventListener(t,i,n)}}},{key:"_addEventCb",value:function(e,t){this.eventsCb[e]=this.eventsCb[e]||[],this.eventsCb[e].push(t)}},{key:"_handleEventListenersVideoToCanvas",value:function(){this._removeListenersFrom(this.video),this._addListenersTo(this.canvas),this._overrideAddEventListener(this.canvas)}},{key:"_removeListenersFrom",value:function(e){for(var t in this.eventsCb){var i=!0,n=!1,o=void 0;try{for(var r,s=this.eventsCb[t][Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;e.unsubscribe(t,a)}}catch(e){n=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}}}},{key:"_addListenersTo",value:function(e){for(var t in this.eventsCb){var i=!0,n=!1,o=void 0;try{for(var r,s=this.eventsCb[t][Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;e.subscribe(t,a)}}catch(e){n=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}}}},{key:"_overrideAddEventListener",value:function(e){var t=this;this.video.addEventListener=function(i,n){t._addEventCb(i,n),e.subscribe(i,n)}}},{key:"_addGetSrcMethod",value:function(){this.video.getSrc=function(){return this.src||this.currentSrc||""}}},{key:"_registerToCanvasEvents",value:function(){this._registerToCanvasNewVidCreatedEvent()}},{key:"_registerToCanvasNewVidCreatedEvent",value:function(){var e=this;this._onNewVidCreated=function(t){var i=t.data;i.style.pointerEvents="all",i.style.zIndex=i.style.zIndex||e.zIndex,e.newVidCreated=!0,e._removeCanvasMethods(),e._unregisterFromCanvasEvents(),e.video._dispatchEvent("canvasToVideo",{videoElement:i}),e.params.logToBI("canvasToVideo",{newVidCreated:!0})},this.canvas.on("newVidCreated",this._onNewVidCreated)}},{key:"_addMuteButtonClickedMethod",value:function(){var e=this;this.video.muteButtonClicked=function(){e.canvas&&e.canvas.muteButtonClick()}}},{key:"_addPlayButtonClickedMethod",value:function(){var e=this;this.video.playButtonClicked=function(){e.canvas&&e.canvas.playButtonClick()}}},{key:"_addResizeMethod",value:function(){var e=this,t=arguments;this.video.resize=function(){if(e.canvas){var i=1<t.length?t:t[0],n=i[0],o=i[1],r=i[2];r&&(e.params.canvas.aspectRatio=r),e.canvas.onResize(n,o)}}}},{key:"_addUseResumeCallbackMethod",value:function(){var e=this;this.video.useResumeCallback=function(){return e.canvas}}},{key:"_addEmitStartAdMethod",value:function(){var e=this;this.video.emitStartAd=function(){return e.canvas.emitStartAd()}}},{key:"_addShowCanvasMethod",value:function(){var e=this;this.video.showCanvas=function(){return e.canvas.show()}}},{key:"_addHideCanvasMethod",value:function(){var e=this;this.video.hideCanvas=function(){return e.canvas.hide()}}},{key:"_addVideoElementProperties",value:function(){this._addVideoStateProperty(),this._addForceCanvasProperty(),this._addBufferingProperty()}},{key:"_addVideoStateProperty",value:function(){Object.defineProperty(this.video,"videoState",{get:function(){return this._videoState||g},set:function(e){this._videoState=e}})}},{key:"_addForceCanvasProperty",value:function(){if(this.params.isMobile){var e=this.video.forceCanvas||!1;Object.defineProperty(this.video,"forceCanvas",{get:function(){return this._forceCanvas||e},set:function(e){this._forceCanvas=e}})}}},{key:"_addBufferingProperty",value:function(){if(this.params.isMobile){var e=this.video.buffering||!1;Object.defineProperty(this.video,"buffering",{get:function(){return this._buffering||e},set:function(e){this._buffering=e}})}}},{key:"_addVideoElementMethods",value:function(){this._addRegisterProgressEventsMethod(),this._addRegisterTickingEventsMethod(),this._addDestroyMethod()}},{key:"_addRegisterProgressEventsMethod",value:function(){var e=this;this.video.registerProgressEvents=function(t){e._progressEvents={};for(var i=0;i<t.length;i++){var n="precentage"===t[i].offsetType?t[i].offset:t[i].offset/e.video.duration;e._progressEvents[n]={offset:n,fired:!1}}}}},{key:"_addRegisterTickingEventsMethod",value:function(){var e=this;this.video.registerTickingEvents=function(t){e._ticker=t}}},{key:"_addDestroyMethod",value:function(){var e=this;this.video.destroy=function(){e.video.pause(),e.video.clearVideoSources(),e._cleanVideoSrcProp(),e.canvas&&e.canvas.destroy()}}},{key:"_cleanVideoSrcProp",value:function(){this.video.removeSrc=!0,this.video.src=""}},{key:"_removeCanvasMethods",value:function(){this.video.emitStartAd=this.video.showCanvas=this.video.hideCanvas=void 0}},{key:"_unregisterFromCanvasEvents",value:function(){this.canvas.off("newVidCreated",this._onNewVidCreated),this._onNewVidCreated=void 0}},{key:"_addTimeupdateEvents",value:function(){this.quartiles={q1:!1,q2:!1,q3:!1};var e=this;this.video.addEventListener("timeupdate",(function t(){if(!this._buffering){.75<=this.progressPrecentage&&!e.quartiles.q3?(e.quartiles.q3=!0,this._dispatchEvent("thirdQuartile")):.5<=this.progressPrecentage&&!e.quartiles.q2?(e.quartiles.q2=!0,this._dispatchEvent("midpoint")):.25<=this.progressPrecentage&&!e.quartiles.q1&&(e.quartiles.q1=!0,this._dispatchEvent("firstQuartile"));var i=!0;for(var n in e._progressEvents)e._progressEvents[n].fired||(e._progressEvents[n].offset<=this.progressPrecentage?(e._progressEvents[n].fired=!0,this._dispatchEvent("timeProgress",{pre:this.progressPrecentage,time:this.currentTime})):i=!1);if(e._ticker){var o=Math.floor(this.currentTime);this._currentTimeFloored!==o&&o%e._ticker==0&&(this._currentTimeFloored=o,this._dispatchEvent("ticking",{time:o}))}i&&e.quartiles.q3&&!e._ticker&&this.unsubscribe("timeupdate",t)}}))}},{key:"_loopThroughMediaSources",value:function(){var e=this;this.video.addEventListener("ended",(function(){if(e._isPlayingContent()&&1<e.video.childNodes.length){var t=e.video.removeChild(e.childNodes[0]);e.video.appendChild(t),e.video.load(),e.video.play()}}))}},{key:"_isPlayingContent",value:function(){return this.video.videoState===g}}]),e}();try{if(window.cmTag){var H=window.cmTag.config.ms||{};H["video-element"]=H["video-element"]||{},H["video-element"]["2.2.17"]=U,window.cmTag.set("ms",H)}}catch(e){}try{window.TRC=window.TRC||{},window.TRC["video-element"]=window.TRC["video-element"]||{},window.TRC["video-element"]["2.2.17"]=U}catch(e){}}])},function(e,t,i){"use strict";i.r(t);var n=i(25),o=i(0);i(3),i(5),t.default=n.a.extend({defaults:o.a.extend(!0,{},n.a.prototype.defaults,{additionalCss:{},animation:{onTransitionOpen:"true"},appendType:"beforeend",category:"blankwhiteHD",defaultTagTimeout:40,isMultiSelect:!0,isSelectorFallback:!0,isSoundOnHover:!0,isViewable:!1,loaderImage:"",noaop:5,onOutOfView:"pause",parentPosition:"beforeend",placeholderCss:{},timeBetweenAds:1,unitTitle:"",viewPercent:20,isMobile:!0,preroll:{pubId:198827,pubTagId:1020237},midroll:{pubId:198827,pubTagId:1020237},postroll:{pubId:198827,pubTagId:1020237},secondsBW:1,detach:{onBackToView:"return",width:200},midrollCollapse:{isActive:!0},components:{TimerView:{hasTimer:!0,time:3},OptOut:{hasOptOut:!1},Loading:{isActive:!0,type:"img",imgUrl:"{{urls.base}}/assets/loading2.png"}},player:{settings:{ad_loaded_method:!1,max_ready_vpaid:2,bf_factor:0,mprdct:.015},bfFactor:0}})})},function(e,t,i){"use strict";i.r(t);var n=i(25),o=i(0);i(3),i(5),t.default=n.a.extend({defaults:o.a.extend(!0,{},n.a.prototype.defaults,{additionalCss:{},animation:{onTransitionOpen:"true"},appendType:"beforeend",category:"blankwhiteHD",isMultiSelect:!0,isSelectorFallback:!0,isSoundOnHover:!0,isViewable:!1,loaderImage:"",noaop:5,onOutOfView:"pause",parentPosition:"beforeend",placeholderCss:{},unitTitle:"",viewPercent:20,preroll:{pubId:198827,pubTagId:1020237},midroll:{pubId:198827,pubTagId:1020237},postroll:{pubId:198827,pubTagId:1020237},timeBetweenAds:1,detach:{onBackToView:"return"},midrollCollapse:{isActive:!0},components:{TimerView:{hasTimer:!0},Loading:{isActive:!0,type:"img",imgUrl:"{{urls.base}}/assets/loading2.png"}},player:{settings:{ad_loaded_method:!1,max_ready_vpaid:2,bf_factor:0},bfFactor:0}})})},function(e,t,i){"use strict";i.r(t);var n=i(0),o=i(33),r=i(3),s=i.n(r),a=i(2),l=i.n(a),c=i(4),d=i(6),u=i(58),h=i.n(u),p=i(1),f=i.n(p),m=i(8);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=i(5),S={placeholder:"._cm-floating-components-placeholder",fixedComponentsWrapper:"._cm-fixed-components-wrapper"},A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=w(e);if(t){var o=w(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _(this,i)}}(r);function r(){return y(this,r),o.apply(this,arguments)}return t=r,(i=[{key:"initialize",value:function(e){this.log=new c.a({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.template=h.a,this.container=e.container,this.model.set("containerViewState",a.readyState),this._bindEvents(),this.render()}},{key:"_bindEvents",value:function(){this.listenTo(s.a,"window:orientation:change",this.calcPlaceholder.bind(this)),this.listenTo(s.a,"window:resize:change",this.calcPlaceholder.bind(this)),this.createStateHandlers([{event:"playerState:closed",funcName:"close",isListenOnce:!0},{event:"playerState:error",funcName:"close",isListenOnce:!0},{event:"closeState:closeUnit",funcName:"close",isListenOnce:!0},{event:"change:aspectRatioNum",funcName:"onAspectRatioChange"}])}},{key:"render",value:function(){this.renderTemplate(),this._customize(),this.el.id="_cm-css-reset",this.$el.css({transition:"none"}),this.model.get("placementElement")&&this.model.get("appendType")===f.a.APPEND_TYPE.beforebegin?Object(n.a)(this.container).before(this.el):this.container.append(this.el),this.placeholder=this.ui.placeholder[0],this.$placeholder=Object(n.a)(this.placeholder),this.model.set("containerViewPlaceHolder",this.placeholder),this.model.set("containerViewState",a.containerViewState.rendered),this.calcPlaceholder()}},{key:"onAspectRatioChange",value:function(e,t){this.log.info("onAspectRatioChange",t),this.calcPlaceholder()}},{key:"calcPlaceholder",value:function(e){this._calcPlaceholderSize(),this._calcPlaceholderPosition(e)}},{key:"_calcPlaceholderSize",value:function(){if(this.model.get("videoViewState")!==a.videoViewState.detached){var e=Object(n.a)(this.container).width(),t=this.getVideoHeightByRatio(e);this.model.set("width",e),this.model.set("height",t),this.ui.placeholder.height("".concat(t,"px")),this.$el.height("".concat(t+this.model.get("components.contentCarousel.height"),"px")),this.model.set("videoPlaceholderSize",{height:t,width:e}),this.model.trigger("change:videoPlaceholderSize",{height:t,width:e})}}},{key:"_calcPlaceholderPosition",value:function(e){var t=T.getOffsetWithContainer(this.ui.placeholder,this.model.get("offsetGetterType"),this.model.get("videoContainerSelector")),i=this.model.get("videoPlaceholderPosition");!e&&i&&i.top===t.top&&i.left===t.left||(this.model.set("videoPlaceholderPosition",{top:t.top,left:t.left}),e&&this.model.trigger("change:videoPlaceholderPosition",this.model,this.model.get("videoPlaceholderPosition")))}},{key:"getVideoHeightByRatio",value:function(e){return this.model.isVerticalVideoEnabled(e)?T.getVideoHeightByRatio(e,this.model.get("aspectRatioNum")):T.getVideoHeight(e)}},{key:"hide",value:function(){this.$el.hide()}},{key:"close",value:function(e){!this.model.get("isReplayAd")||e?(this.model.set("closeState",a.closeState.containerViewClosed),this._collapse()):this.model.set("closeState",!1,{silent:!0})}},{key:"_collapse",value:function(){this.log.info("collapsing view"),this._initHeight(),setTimeout(function(){this.hide()}.bind(this),1e3)}},{key:"_initHeight",value:function(){Object(n.a)(this.el).css({height:"0px",width:this.model.get("width")})}},{key:"_customize",value:function(){var e=this.model.get("customization.placeHolder");this.model.get("customization.adTitle"),this.ui.placeholder.css(T.toCssObj(e))}},{key:"_customizeContainer",value:function(){var e=this.model.get("customization.unitContainer");this.$el.css(T.toCssObj(e))}},{key:"componentsPlaceholder",get:function(){return this.ui.placeholder}},{key:"fixedComponentsWrapper",get:function(){return this.ui.fixedComponentsWrapper}},{key:"className",get:function(){return"_cm-single-inline"}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=S},set:function(e){return this.UI=e}}])&&v(t.prototype,i),r}(d.b),P=i(72),E=i.n(P);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var D={wrapper:"._cm-components-wrapper"},x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=V(e);if(t){var o=V(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return R(this,i)}}(r);function r(){return k(this,r),o.apply(this,arguments)}return t=r,(i=[{key:"initialize",value:function(e){this.log=new c.a({unitType:this.model.get("unitType"),className:this.constructor.name,version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.template=E.a,this.containerSelector=this.model.get("videoContainerSelector")||"body",this.container=Object(n.a)(this.containerSelector),this._bindEvents(),this.render()}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"videoPlaceholderPosition",funcName:"_onVideoPlaceholderPositionChange",withBind:!1},{event:"closeState",funcName:"_onClose",isListenOnce:!0}])}},{key:"render",value:function(){this.renderTemplate(),this.el.id="_cm-css-reset",this.container.append(this.el),this._onVideoPlaceholderPositionChange()}},{key:"_onVideoPlaceholderPositionChange",value:function(){this.model.get("videoViewState")!==a.videoViewState.detached&&this.$el.css(this.model.get("videoPlaceholderPosition"))}},{key:"_onClose",value:function(){this.log.info("closing componentWrapperView"),this.hide()}},{key:"hide",value:function(){this.$el.hide()}},{key:"wrapper",get:function(){return this.ui.wrapper}},{key:"className",get:function(){return"_cm-floating-component-modal-wrapper"}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=D},set:function(e){return this.UI=e}}])&&O(t.prototype,i),r}(d.b),N=i(15);function M(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var L,F=i(5),B=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.log=new c.a({unitType:"Util",className:"AnimationUtil",version:this.model.get("version"),isDebug:this.model.get("isDebug")})}var t,i;return t=e,(i=[{key:"expand",value:function(e){e.$el.height()>=e.height?this.log.info("No expand needed"):this.aniamteHeight(e)}},{key:"collapse",value:function(e){e.$el.height()<=e.height?this.log.info("No collapse needed"):this.aniamteHeight(e)}},{key:"aniamteHeight",value:function(e){this.model.set("isAnimationRunning",!0);var t={transition:"height "+e.timeMS+"ms",height:e.height};requestAnimationFrame((function(){e.$el.css(t)})),this.oneAnimationEnd(e.$el,e.cb,e.timeMS)}},{key:"aniamteOpacity",value:function(e){this.model.set("isAnimationRunning",!0);var t={transition:"opacity "+e.timeMS+"ms",opacity:e.opacity};requestAnimationFrame((function(){e.$el.css(t)})),this.oneAnimationEnd(e.$el,e.cb,e.timeMS)}},{key:"attach",value:function(e){if(e.$el){var t={top:e.target.top,left:e.target.left};if(e.isAnimated){t.width=this.model.get("videoPlaceholderSize.width")+"px",t.height=this.model.get("videoPlaceholderSize.height")+"px";var i=e.$el.offset(),o={position:"absolute",top:i.top+"px",left:i.left+"px",width:i.width+"px",height:i.height+"px"};requestAnimationFrame((function(){e.$el.css(o),F.flushCss(e.$el[0])})),t.transition="all "+e.timeMS+"ms ease",t=n.a.extend(t,e.additionalCss),requestAnimationFrame(function(){e.$el.css(t)}.bind(this))}else{var r={position:"absolute",top:"auto",bottom:"auto",left:"auto",right:"auto"};t=n.a.extend(r,t),t=n.a.extend(r,e.additionalCss),e.$el.css(r),requestAnimationFrame((function(){F.flushCss(e.$el[0])}))}this.oneAnimationEnd(e.$el,e.cb,e.timeMS)}else this.log.warning("Called attach without an element!")}},{key:"detach",value:function(e){if(e.isAmp)this.detachSliderAmp(e);else{var t={position:"fixed",top:"auto",bottom:"auto",left:"auto",right:"auto"};if(e.isSlideIn)t[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",t[e.sliderOptions.position.vertical]=e.sliderOptions.position.verticalOffset+"px",t.height=this.model.get("detachToSlider.height")+"px",e.isSlideVertically?t.height=0:t.width=0;else{var i=n.a.extend({},e.$el[0].getBoundingClientRect());i.right=window.innerWidth-i.left-i.width,i.bottom=window.innerHeight-i.bottom,t[e.sliderOptions.position.horizontal]=i[e.sliderOptions.position.horizontal]+"px",t[e.sliderOptions.position.vertical]=i[e.sliderOptions.position.vertical]+"px"}var o={transition:"all "+e.timeMS+"ms ease"};o[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",o[e.sliderOptions.position.vertical]=e.sliderOptions.position.verticalOffset+"px",o.width=this.model.get("detachToSlider.width")+"px",o.height=this.model.get("detachToSlider.height")+"px",0!==e.timeMS?(e.$el.css(t),requestAnimationFrame((function(){e.$el.css(t),F.flushCss(e.$el[0])})),requestAnimationFrame(function(){e.$el.css(o)}.bind(this))):(e.$el.css(t),e.$el.css(o)),this.oneAnimationEnd(e.$el,e.cb,e.timeMS+1)}}},{key:"detachSliderAmp",value:function(e){var t={position:"absolute",top:"auto",bottom:"auto",left:"auto",right:"auto"};e.isSlideIn?(t[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",t.top=this._getSliderPositionVerticalAmp(e.sliderOptions),t.height=this.model.get("detachToSlider.height")+"px",e.isSlideVertically?t.height=0:t.width=0):(t[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",t.top=this._getSliderPositionVerticalAmp(e.sliderOptions));var i={position:"absolute",top:"auto",bottom:"auto",left:"auto",right:"auto",transition:"all  ".concat(e.sliderOptions.detachAnimationTime," ").concat(e.sliderOptions.animationStyle)};i[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",i.top=this._getSliderPositionVerticalAmp(e.sliderOptions),i.width=this.model.get("detachToSlider.width")+"px",i.height=this.model.get("detachToSlider.height")+"px",e.isSlideIn&&e.$el.css(t),requestAnimationFrame(function(){e.$el.css(i)}.bind(this)),setTimeout(function(){this.correctSliderDetachPosition({$el:e.$el,sliderOptions:e.sliderOptions,isSlideVertically:e.isStickyCardActive})}.bind(this),e.sliderOptions.animationTime+10),this.oneAnimationEnd(e.$el,e.cb,e.timeMS+1)}},{key:"detachAmpSticky",value:function(e){TRC&&TRC.dispatch&&TRC.dispatch("videoSliderOn"),e.timeMS=150;var t={transition:"top "+e.timeMS+"ms ease-in-out",position:"absolute"};t[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",t[e.sliderOptions.position.vertical]=e.sliderOptions.position.verticalOffset+"px",t.width=this.model.get("detachToSlider.width")+"px",t.height=this.model.get("detachToSlider.height")+"px",e.$el.css(t),this.oneAnimationEnd(e.$el,e.cb,e.timeMS+1)}},{key:"correctSliderDetachPosition",value:function(e){TRC&&TRC.dispatch&&TRC.dispatch("videoSliderOn");var t=e.sliderOptions.amp.correctionAnimationTime,i={transition:"top "+t+"ms ease-in-out",position:"absolute"};i.top=this._getSliderPositionVerticalAmp(e.sliderOptions),e.$el.css(i),this.oneAnimationEnd(e.$el,e.cb,t+1)}},{key:"slideOut",value:function(e){var t={transition:"all "+e.timeMS+"ms linear"};e.isVerticalSlideOut?(t[e.sliderOptions.position.horizontal]=e.sliderOptions.position.horizontalOffset+"px",t[e.sliderOptions.position.vertical]="-"+(e.sliderOptions.height+parseFloat(e.sliderOptions.position.verticalOffset))+"px"):(t[e.sliderOptions.position.horizontal]="-"+(e.sliderOptions.width+parseFloat(e.sliderOptions.position.horizontalOffset))+"px",t[e.sliderOptions.position.vertical]=e.sliderOptions.position.verticalOffset+"px"),requestAnimationFrame(function(){e.$el.css(t)}.bind(this)),this.oneAnimationEnd(e.$el,e.cb,e.timeMS)}},{key:"oneAnimationEnd",value:function(e,t,i){setTimeout(function(){this.model.set("isAnimationRunning",!1),e.css("transition","none"),t&&t()}.bind(this),i)}},{key:"PrefixedEvent",value:function(e,t,i,n){i=i.toLowerCase(),F.each(["webkit","moz","MS","o",""],(function(o){e[t](o+i,n)}))}},{key:"_getSliderPositionVerticalAmp",value:function(e){var t=0,i=this.model.get("ampPageTopLimit")||0,n=this.model.get("ampPageBottomLimit")||0;return"bottom"===e.position.vertical?(t=n-e.height-e.position.verticalOffset)<e.height+e.position.verticalOffset&&(t=e.height+e.position.verticalOffset):t=i+e.position.verticalOffset,"".concat(t,"px")}},{key:"updateModel",value:function(e){this.model=e}}])&&M(t.prototype,i),e}();function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $=i(5),q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=z(e);if(t){var o=z(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return W(this,i)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this)).model=e.model,t.log=new c.a({unitType:t.model.get("unitType"),className:t.constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.components={},t.container=e.container,t.componentsConfig={},t.baseOptions={model:t.model,container:t.container},t.animationUtil=function(e){return L||(L=new B(e)),L.updateModel(e),L}(t.model),t}return t=o,(i=[{key:"_bindEvents",value:function(){}},{key:"_initComponents",value:function(){var e=this._getActiveComponentsInitialVisibility();this._loadActiveComponents(e),this.model.set("componentVisibility",e)}},{key:"_loadActiveComponents",value:function(e){for(var t in e){var i={componentsVisibilityListener:"componentVisibility.".concat(t)},n=$.extend(this.componentsConfig[t].options,i);this.components[t]=this._loadComponent(this.componentsConfig[t].module,n),this.componentsConfig[t].afterLoad&&this.componentsConfig[t].afterLoad()}}},{key:"_getActiveComponentsInitialVisibility",value:function(){var e={};for(var t in this.componentsConfig)this.componentsConfig[t].isActive&&(e[t]=this.componentsConfig[t].isVisibleOnLoad);return e}},{key:"_showActiveComponents",value:function(){for(var e in this.componentsConfig)this.componentsConfig[e].isActive&&this.model.set("componentVisibility.".concat(e),this.componentsConfig[e].isVisibleOnLoad)}},{key:"_hideActiveComponents",value:function(){for(var e in this.componentsConfig)this.componentsConfig[e].isActive&&this.model.set("componentVisibility.".concat(e),!1)}},{key:"_loadComponent",value:function(e,t){if(e)return new e(t);this.log.error("can't load component - component is undefined")}},{key:"detach",value:function(e,t){this.currentAnimation=f.a.ANIMATION_TYPE.detaching;var i=t?0:this.model.get("animation.detach");this.animationUtil.detach({$el:e,timeMS:i,sliderOptions:this.detachToSlider,isSlideIn:this.isFirstDetach,cb:this.postDetach.bind(this)}),e.css(this.model.get("additionalCss"))}},{key:"postDetach",value:function(){this.currentAnimation===f.a.ANIMATION_TYPE.detaching&&(this.currentAnimation=f.a.ANIMATION_TYPE.none)}},{key:"attach",value:function(e,t,i){var n=this.model.get("animation.attach"),o=!i&&this.model.get("detachToSlider").animation;this.currentAnimation=f.a.ANIMATION_TYPE.attaching,this.animationUtil.attach({$el:e,target:t,isAnimated:o,timeMS:n,additionalCss:this.model.get("additionalCss"),cb:this.postAttach.bind(this)})}},{key:"postAttach",value:function(){this.currentAnimation===f.a.ANIMATION_TYPE.attaching&&(this.currentAnimation=f.a.ANIMATION_TYPE.none)}},{key:"slideOut",value:function(e,t,i){var n=this.model.get("animation.slideOut");this.animationUtil.slideOut({$el:e,timeMS:n,sliderOptions:this.detachToSlider,isVerticalSlideOut:t,cb:i})}}])&&U(t.prototype,i),o}(d.a),G=i(16),Y=i.n(G),Q=i(18);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z(e,t,i){return(Z="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=te(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(i):o.value}})(e,t,i||e)}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ie=i(5),ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=te(e);if(t){var o=te(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ee(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e)).template=Y.a,t.container=e.container||"body",t.componentsVisibilityListener=e.componentsVisibilityListener,t.componentsVisibilityListener&&t._setComponentsVisibilityListener(),t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"resize",withBind:!1},{event:"componentViewState:rendered",funcName:"render",isListenOnce:!0},{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"adState:completed",funcName:"onAdComplete"}]),this._setVolumeEvents()}},{key:"render",value:function(){this.renderTemplate(),this._customize(),this.ui.video[0].id=this.videoAdId,this.$el=Object(n.a)(this.el),Object(n.a)(this.container).append(this.$el),this.resize(),this.model.set("videoViewContainer",this.el),this.model.set("targetId",this.videoAdId),this.model.set("videoViewState",a.videoViewState.rendered),ie.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoInitToRender".concat(this.model.get("perfUnitType")),f.a.TRC_PERFORMANCE_ACTIONS.STOP)}},{key:"checkEligible",value:function(){this.isEligibleToPlay()?(this.activeAd||this.getReadyAd(),this.activeAd&&this._canPlayAd()&&this.playAd()):this.activeAd&&this.activeAd.pause()}},{key:"_canPlayAd",value:function(){return this.model.get(this.componentsVisibilityListener)&&!this.model.get("isExternalComponentBlockingAdFromPlay")}},{key:"onAdComplete",value:function(){this.activeAd=void 0,this.model.get("isMultiAd")||this.model.set("closeState",a.closeState.terminate)}},{key:"close",value:function(){this.hide(),Q.a.prototype.close.call(this)}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:this.model.get("width"),height:this.model.get("height")};this.log.info("resize sizeObj: ",e),this.$el.css(e),this.activeAd&&this.activeAd.vpaidWrapper&&this.activeAd.resize(e),this.checkEligible()}},{key:"_setComponentsVisibilityListener",value:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()}},{key:"_onComponentsVisibilityChange",value:function(){this.model.get(this.componentsVisibilityListener)?(this.resize(),this.show()):this.hide(),this.checkEligible()}},{key:"_isInTab",value:function(){return!(!this.model.get("isIgnoreTabInIframe")||this.model.get("frameType")===f.a.FRAME_TYPE.plainPage)||this.model.get("isInTab")}},{key:"isEligibleToPlay",value:function(){return(this.model.get("isEligibleToPlay")||this.model.get("videoViewState")===a.videoViewState.detached)&&this._isInTab()}},{key:"playAd",value:function(){Z(te(r.prototype),"playAd",this).call(this),this._handleVolume()}}])&&X(t.prototype,i),r}(Q.a),oe=i(30),re=(i(107),i(7)),se=i.n(re);function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e){return function(e){if(Array.isArray(e))return ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ce(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ce(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function de(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function he(e,t){return!t||"object"!==ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=pe(e);if(t){var o=pe(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return he(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e)).log=new c.a({unitType:t.model.get("unitType"),className:t.constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.currentTrackIndex=0,t._loadVideoElementService(),t.componentsVisibilityListener=e.componentsVisibilityListener,t.componentsVisibilityListener&&t._setComponentsVisibilityListener(),t}return t=r,(i=[{key:"_loadVideoElementService",value:function(){var e=this.model.get("microServices.videoElement.version");se.a.serviceLoader.get("video-element",e,this._onVideoElementLoaded.bind(this),this._onVideoElementError.bind(this))}},{key:"_onVideoElementLoaded",value:function(e){this.video=new e(this._getVideoElementOptions()),this.log.info("Video Element Loaded",this.video),this.render()}},{key:"_onVideoElementError",value:function(){this.log.error("Error while loading videoElement from service loader")}},{key:"render",value:function(){this.el.id="_cm-css-reset",this._customize(),this.initVideo(),this._addVideoControls(),this.initLoadingBackground(),this.bindEvents(),this.resize(),this.listenTo(s.a,"window:resize:change",this._onWindowResize.bind(this))}},{key:"initVideo",value:function(){this._setVideoElementAttributes(),this._bindVideoElementsEvents(),this.$el.append(this.video)}},{key:"_updateVideoSrc",value:function(){var e=[];this.video.innerHTML="",this.playList.forEach((function(t){e.push({url:t.url,originalType:t.type})}));var t=e.slice(this.currentTrackIndex),i=e.slice(0,this.currentTrackIndex);e=[].concat(le(t),le(i)),this.video.appendVideoSources(e),this.log.info("appended video sources:",e)}},{key:"_setVideoElementAttributes",value:function(){this.video.muted=!0,this.video.setAttribute("muted",""),this.video.setAttribute("playsinline",""),this.video.setAttribute("preload","auto"),this.video.style.cursor="pointer"}},{key:"_bindVideoElementsEvents",value:function(){this.video.addEventListener("ended",this.onEnd.bind(this)),this.video.addEventListener("loadeddata",this.onLoaded.bind(this)),this._bindVideoClickEvent()}},{key:"_bindVideoClickEvent",value:function(){this.model.get("contentClickUrl")&&(this.video.onclick=this.contentClickThru.bind(this))}},{key:"bindEvents",value:function(){this.createStateHandlers([{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"mute:true",funcName:"mute"},{event:"mute:false",funcName:"unMute"},{event:"content.playClicked:true",funcName:"play"},{event:"content.pauseClicked:true",funcName:"pause"},{event:"player.playlist",funcName:"_updatePlaylist",isListenOnce:!0},{event:"playlistItemClicked",funcName:"_onPlaylistItemClicked"}])}},{key:"onEnd",value:function(){}},{key:"onLoaded",value:function(){for(var e=this.model.get("player.playlist"),t=0;t<e.length;t++)-1!=this.video.currentSrc.indexOf(e[t].url)?(e[t].selected=!0,this.currentTrackIndex=e[t].id):e[t].selected=!1;this.model.set("currentTrackIndex",this.currentTrackIndex)}},{key:"bindRenderShowEvents",value:function(){}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:this.model.get("width"),height:this.model.get("height")};this.log.info("resize content",{width:this.model.get("width"),height:this.model.get("height")}),Object(n.a)(this.video).css(e),this.el.style.width="".concat(e.width,"px"),this.el.style.hight="".concat(e.width,"px"),this.video.resize&&this.video.resize(e.width,e.height),this.checkEligible()}},{key:"_onWindowResize",value:function(){this.resize()}},{key:"_updatePlaylist",value:function(){this.playList=this.model.get("player.playlist"),this._updateVideoSrc()}},{key:"_setComponentsVisibilityListener",value:function(){this.listenTo(this.model,"change:".concat(this.componentsVisibilityListener),this._onComponentsVisibilityChange.bind(this)),this.model.get(this.componentsVisibilityListener)||this.hide()}},{key:"_onComponentsVisibilityChange",value:function(){this.model.get(this.componentsVisibilityListener)?(this.resize(),this.show()):this.hide()}},{key:"show",value:function(){this.isTerminated||(this.log.info("Content video show"),this.$el.css({display:"block"}),this.isHidden=!1,this.checkEligible())}},{key:"checkEligible",value:function(){this.isEligibleToPlay()?(this.video.readyState!==f.a.VIDEO_READY_STATE.HAVE_ENOUGH_DATA&&this.video.load(),this.play()):this.pause()}},{key:"_getVideoElementOptions",value:function(){return{isMobile:this.model.get("isMobile"),isMultiVpaidUnit:!1,userAgent:this.model.get("wurfl"),canvas:{dataSaverServerSide:this.model.get("player.settings.dataSaver"),disableWebGl:!0,parent:this.el,repeat:!1}}}},{key:"_onPlaylistItemClicked",value:function(){"none"!=this.model.get("playlistItemClicked")&&(this.pause(),this.currentTrackIndex=this.model.get("playlistItemClicked"),this._updateVideoSrc(),this.video.load(),this.checkEligible(),this.model.set("playlistItemClicked","none"))}}])&&de(t.prototype,i),r}(oe.a),me=i(5),ge={getComponentsConfig:function(){return{videoView:{isActive:!0,isPrefetch:!0,isVisibleOnLoad:!1,module:ne,options:this.baseFloatingComponentOptions},contentVideoView:{isActive:!0,isPrefetch:!0,isVisibleOnLoad:!1,adChoiceView:!1,module:fe,options:this.baseFloatingComponentOptions},closeButtonView:{isActive:this.model.get("components.CloseButtonView.hasCloseButton"),isPrefetch:!0,isVisibleOnLoad:!1,module:m.b,options:this.baseFloatingComponentOptions,afterLoad:this._renderCloseButton.bind(this)},adChoiceView:{isActive:this.model.get("components.adChoice.isActive"),isPrefetch:!0,module:m.a,isVisibleOnLoad:!1,options:me.extend(me.clone(this.baseFloatingComponentOptions),{type:f.a.AD_CHOICE_TYPE.VIDEO_AD})},volumeButtonView:{isActive:this.model.get("components.volume.isActive"),isPrefetch:!0,isVisibleOnLoad:!0,module:m.i,options:this.baseFloatingComponentOptions},contentCarouselView:{isActive:this.model.get("components.contentCarousel.isActive"),isVisibleOnLoad:!1,isPrefetch:!0,module:m.c,options:this.baseFixedComponentOptions}}},getOverlayComponentsConfig:function(){return{videoView:{optOutView:!0,brandLogoView:!0,volumeButtonView:!0,closeButtonView:!0,adChoiceView:!0},contentVideoView:{}}}};function ye(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ve=i(5),be=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.model=t,this.log=new c.a({unitType:"Util",className:"DeatchUtil",version:this.model.get("version"),isDebug:this.model.get("isDebug")})}var t,i;return t=e,(i=[{key:"setSliderSize",value:function(){if(this.detachToSlider=this.model.get("detachToSlider"),this.model.get("stickyCard.isActive")){var e=this.model.get("width"),t=this.model.get("height"),i=this.getStickyPosition();return this.detachToSlider.position.horizontalOffset=i.left,this.detachToSlider.position.verticalOffset=i.top,this.detachToSlider.position.horizontal="left",this.detachToSlider.position.vertical="top",this.model.set("detachToSlider.width",e),void this.model.set("detachToSlider.height",t)}this.originalSliderWidth&&(this.detachToSlider.width=this.originalSliderWidth,this.originalSliderWidth=void 0),this.originalSliderHeight&&(this.detachToSlider.height=this.originalSliderHeight,this.originalSliderHeight=void 0),this.originalSliderHeight=this.detachToSlider.height;var n=this.model.get("width"),o=this.detachToSlider.liquidSize.isActive?this.calcLiquidWidth():this.detachToSlider.width;(n>o||this.detachToSlider.liquidSize.isDisableWidthLimit)&&(n=o);var r=ve.getVideoHeightByRatio(n,this.model.get("aspectRatioNum")<=1?1.77:this.model.get("aspectRatioNum"));this.model.set("detachToSlider.width",n),this.model.set("detachToSlider.height",r)}},{key:"getStickyPosition",value:function(){var e=Object(n.a)(this.model.get("containerViewPlaceHolder")),t=e.length?e.offset().left:0,i=this.model.get("stickyCard.offset.top")||0,o=t+(this.model.get("stickyCard.offset.left")||0);return{top:"".concat(i),left:"".concat(o)}}},{key:"setSliderSizeVertical",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=ve.getVideoHeight(this.model.get("width")),t=this.detachToSlider.liquidSize.isActive?this.calcLiquidHeight():this.detachToSlider.height;e>t&&(e=t);var i=ve.getVideoWidthByRatio(e,this.model.get("aspectRatioNum"));this.model.set("detachToSlider.width",i),this.model.set("detachToSlider.height",e)}},{key:"calcLiquidWidth",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=this.detachToSlider.liquidSize.minWidth,t=this.detachToSlider.liquidSize.maxWidth,i=window.innerWidth*(this.detachToSlider.liquidSize.widthPercent/100);return t&&i>t&&(i=t),i<e&&(i=e),i}},{key:"calcLiquidHeight",value:function(){this.detachToSlider=this.model.get("detachToSlider");var e=this.detachToSlider.liquidSize.maxHeight,t=window.innerHeight*(this.detachToSlider.liquidSize.heightPercent/100);return e&&t>e&&(t=e),t}},{key:"setStickParams",value:function(){var e=this.model.get("stickyCard.navBarSelector"),t=document.querySelector(e),i=this.model.get("stickyCard.offset.top");if(t){var n=t.offsetHeight||0;this.model.set("stickyCard.offset.top",i+n)}}}])&&ye(t.prototype,i),e}(),_e=function(){var e;return function(t){return e||(e=new be(t)),e}}();function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?Pe(e):t}function Pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ce=i(5),ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(o,e);var t,i,n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=Ee(e);if(t){var o=Ee(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ae(this,i)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=n.call(this,e)).log=new c.a({unitType:t.model.get("unitType"),className:t.constructor.name,version:t.model.get("version"),isDebug:t.model.get("isDebug")}),t.containerView=e.containerView,t.floatingComponentsPlaceholder=e.floatingComponentWrapper,t.fixedComponentWrapper=t.containerView.fixedComponentsWrapper,t._setBaseComponentOptions(),t.componentsConfig=ge.getComponentsConfig.bind(Pe(t))(),t.detachUtil=new _e(t.model),t._initComponents(),t._bindEvents(),t._onStart(),t.currentTrackIndex=void 0,t}return t=o,(i=[{key:"_setBaseComponentOptions",value:function(){this.baseFloatingComponentOptions={model:this.model,container:this.floatingComponentsPlaceholder},this.baseFixedComponentOptions={model:this.model,container:this.fixedComponentWrapper}}},{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"hasReadyAd:true",funcName:"_onHasReadyAd"},{event:"adState:completed",funcName:"_onAdComplete"},{event:"player.playlist",funcName:"_onContentLoaded",isListenOnce:!0},{event:"isEligibleToPlay",funcName:"_onEligibilityChange"},{event:"swappedAdHasEnded:true",funcName:"onSwappedAdHasEnded"},{event:"closeState",funcName:"terminate",isListenOnce:!0}]),this.currentTrackIndexTimeInterval=setInterval(function(){this.currentTrackIndex!==this.model.get("currentTrackIndex")&&(this.onPlayListPlay(),this.currentTrackIndex=this.model.get("currentTrackIndex"))}.bind(this),500)}},{key:"_onStart",value:function(){this.minTimeUntilFirstAdTimer=setTimeout(this._onMinTimeUntilFirstAdPassed.bind(this),1e3*this.model.get("timeBeforeFirstAd")),this._renderVideoView()}},{key:"_onContentLoaded",value:function(){this._updateComponentsVisibility({contentVideoView:!0,contentCarouselView:!0}),this.onPlayerPlayList(),this.components.contentCarouselView.unBlockView()}},{key:"_onAdComplete",value:function(){this._updateComponentsVisibility({contentVideoView:!0,contentCarouselView:!0}),this.components.contentCarouselView.unBlockView(),this.model.set("minTimeBetweenAdsPassed",!1),this.minTimeBetweenAds=setTimeout(this._onMinTimeBetweenAds.bind(this),1e3*this.model.get("timeBetweenAds"))}},{key:"_onMinTimeUntilFirstAdPassed",value:function(){this.model.set("minTimeUntilFirstAdPassed",!0),this.model.get("hasReadyAd")&&this._onHasReadyAd()}},{key:"_onMinTimeBetweenAds",value:function(){this.model.set("minTimeBetweenAdsPassed",!0),this.model.get("hasReadyAd")&&this._onHasReadyAd()}},{key:"_onHasReadyAd",value:function(){this._canPlayAd()&&(this.hadPlay=!0,this.model.set("minTimeBetweenAdsPassed",!1),this._updateComponentsVisibility({videoView:!0,contentCarouselView:!0}),this.components.contentCarouselView.blockView())}},{key:"_canPlayAd",value:function(){return this.model.get("minTimeUntilFirstAdPassed")&&!this.hadPlay||this.model.get("minTimeBetweenAdsPassed")}},{key:"_onEligibilityChange",value:function(){this._isDetach()?this.handleDetach():this._isAttach()&&this.handleAttach()}},{key:"_updateComponentsVisibility",value:function(e){var t=Ce.mapObject(this.model.get("componentVisibility"),(function(){return!1}));Ce.extend(t,e),this._setOverlayComponents(e,t),this.model.set("componentVisibility",t)}},{key:"_setOverlayComponents",value:function(e,t){for(var i in e)e[i]&&Ce.extend(t,this._getOverlayComponents(i))}},{key:"_renderCloseButton",value:function(){this.components.closeButtonView.render()}},{key:"_renderVideoView",value:function(){this.components.videoView.render()}},{key:"_isDetach",value:function(){return this.detachToSlider=this.model.get("detachToSlider"),!this.model.get("isEligibleToPlay")&&!!this.detachToSlider.isDetachToSlider&&!!this.model.get("isInTab")&&(this.floatingComponentsPlaceholder[0].getBoundingClientRect().top>0?this.model.get("detachToSlider.isDetachAbove"):this.model.get("detachToSlider.isDetachBelow"))}},{key:"_isAttach",value:function(){return!!this.model.get("isEligibleToPlay")&&this.model.get("videoViewState")===l.a.videoViewState.detached}},{key:"handleDetach",value:function(e){this.log.info("Detaching"),this.detachUtil.setSliderSize(),this.detach(this.floatingComponentsPlaceholder,e);var t={width:this.model.get("detachToSlider.width"),height:this.model.get("detachToSlider.height")};for(var i in this.model.set("width",t.width),this.model.set("height",t.height),this.model.set("videoViewState",l.a.videoViewState.detached),this.components)Ce.isFunction(this.components[i].resize)&&this.components[i].resize(t);s.a.once("window:resize:change",this._onWindowResize.bind(this))}},{key:"handleAttach",value:function(e){var t=this.model.get("videoPlaceholderSize");for(var i in this.log.info("Attaching"),this.attach(this.floatingComponentsPlaceholder,{top:0,left:0},e),this.model.set("width",t.width),this.model.set("height",t.height),this.components)Ce.isFunction(this.components[i].resize)&&this.components[i].resize(t);this.model.set("videoViewState",l.a.videoViewState.attached),this.containerView.calcPlaceholder(!0)}},{key:"_onWindowResize",value:function(){this.model.get("videoViewState")===l.a.videoViewState.detached&&(this.handleDetach(!0),this.model.trigger("videoViewState",l.a.videoViewState.detached))}},{key:"postAttach",value:function(){this.currentAnimation===f.a.ANIMATION_TYPE.attaching&&this.floatingComponentsPlaceholder.css({height:"unset",width:"unset"})}},{key:"_getOverlayComponents",value:function(e){var t={};for(var i in ge.getOverlayComponentsConfig()[e])this.components[i]&&(t[i]=!0);return t}},{key:"_getActiveComponentsInitialVisibility",value:function(){var e={};for(var t in this.componentsConfig)this.componentsConfig[t].isActive&&this.componentsConfig[t].isPrefetch&&(e[t]=this.componentsConfig[t].isVisibleOnLoad);return e}},{key:"_isLoadComponentForDisplayFiller",value:function(e){var t=this.model.get("displayFiller")||{};return(this.model.get("isShowOnAd")||"")===e||Ce.values(t).indexOf(e)>-1}},{key:"onPlayerPlayList",value:function(){this.components.contentCarouselView.render()}},{key:"onPlayListPlay",value:function(){this.components.contentCarouselView.updatePlaylistItem()}},{key:"terminate",value:function(){this.log.info("terminate");var e=this.model.get("componentVisibility");for(var t in e)e[t]=!1;this.model.set("componentVisibility",e)}}])&&Te(t.prototype,i),o}(q),Oe=i(9);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i(5);var Ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=xe(e);if(t){var o=xe(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return De(this,i)}}(r);function r(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e))._bindEvents();var i=t.model.get("parentSelector");return t._initInline(Object(n.a)(i)),t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"videoViewState:".concat(l.a.videoViewState.rendered),funcName:"_initServices",isListenOnce:!0}])}},{key:"_initInline",value:function(e){this.model.set("subUnitType",f.a.SUB_UNIT_TYPE.INLINE_SINGLE_SELECTOR),this.componentWrapperView=new x({model:this.model}),this.containerView=new A({model:this.model,container:e}),this.eligibilityService=new Oe.d(this.model,this.containerView.placeholder),this._initComponentManager()}},{key:"_initComponentManager",value:function(){this.componentManager=new ke({model:this.model,containerView:this.containerView,floatingComponentWrapper:this.componentWrapperView.wrapper,globalModel:this.globalModel})}},{key:"_initServices",value:function(){this.windowEventManager=Object(N.a)(),this.adService=new Oe.a(this.model),this.seerService=new Oe.l(this.model),this.playerLoader=new Oe.k(this.model),this.playerService=new Oe.j(this.model),this.pixelsService=new Oe.i(this.model)}}])&&Re(t.prototype,i),r}(o.a);t.default=Ne},function(e,t,i){"use strict";i.r(t);var n=i(0),o=i(8),r=i(3),s=i.n(r),a=i(3),l=i(5),c=(i(10),i(22)),d=i(1),u=a.View.extend({className:"_cm-inline",inViewCount:0,isLostEligibilityFired:!1,initialize:function(e){this.appendType=d.APPEND_TYPE[this.model.get("appendType")],this.placementElement=e.placementElement,this.template=c,this.el.id="_cm-video-unit",this.$el.append(this.template),this.model.get("animation.onTransitionOpen")||(this.$el[0].className=this.$el[0].className+" _cm-inline-no-transition"),this.$adTitle=this.$el.find("._cm-ad-title"),this.$adTitle.append(this.model.get("unitTitle")),this.$placeHolder=this.$el.find("._cm-inline-video"),this.placeHolders=[],this._bindEvents(),this._getContainer()},render:function(e){this.placeHolders=[];var t=document.createElement("div");switch(t.classList.add("_cm-div"),t.id="_cm-css-reset",this.appendType){case d.APPEND_TYPE.beforebegin:Object(n.a)(e).before(t);break;case d.APPEND_TYPE.beforeend:Object(n.a)(e).append(this.$el)}this.placeHolders.push(t)},_renderMulti:function(e){for(var t=e.sort((function(e,t){return t.offsetTop-e.offsetTop})),i=0;i<t.length;i++)if(!t[i].getAttribute("data-tracked")){t[i].setAttribute("data-tracked","true");var n=document.createElement("div");switch(n.classList.add("_cm-div"),n.id="_cm-css-reset",n.setAttribute("data-tracked","true"),this.placeHolders.push(n),this.appendType){case d.APPEND_TYPE.afterbegin:t[i].insertBefore(n,t[i].firstChild);break;case d.APPEND_TYPE.beforeend:t[i].appendChild(n)}}},_bindEvents:function(){this.listenTo(this.model,"change:isUnitViewable",this._onViewablityChange),this.listenTo(this.model,"change:state",this._onStateChange,this),this.model.get("isUseEligibilityByPub")&&this._bindPubEligibilityEvents()},_onViewablityChange:function(){},_customiseElements:function(){var e=this.model.get("customization.unitContainer"),t=this.model.get("customization.placeHolder"),i=this.model.get("customization.adTitle");Object(n.a)(this.inViewDiv).css(l.toCssObj(e)),this.$placeHolder.css(l.toCssObj(t)),this.$adTitle.css(l.toCssObj(i))},_collapse:function(){if(this._done=!0,this.$el[0].classList.remove("_cm-inline-no-transition"),this.log.info("collapsing view",this.inViewDiv),this.inViewDiv){var e=Object(n.a)(this.inViewDiv);this.$el.css({height:0}),l.oneAnimationEnd(e,e.hide.bind(e))}else Object(n.a)("._cm-div").css("height",0);this.$el.css({height:0})},_getContainer:function(){var e=this.model.get("parentSelector");e?this._findContainer(e):this._finedPlacementContainer()},_finedPlacementContainer:function(){if(l.parseBool(this.model.get("isSelectorFallback"))){var e=this.placementElement;if(!e){var t="_cm_videoUnit_placeHolder"+this.model.get("redId");e=document.getElementById(t)}if(this._isValidPlacementElement(e)){for(;!e.parentNode.offsetWidth||e.parentNode.offsetWidth<100;)e=e.parentNode;this.appendType=d.APPEND_TYPE.beforebegin,this.render(e),this._start(),this._onWindowPositionChange()}}else this.log.info("Unit will not be displayed.")},_isInHead:function(e){for(;e!==document.body&&e!==document.head;)e=e.parentNode;return e===document.head},_findContainer:function(e){if(!this.isExpanded){var t=Object(n.a)(e.toString());if((t=l.getValidSelectorElements(t))&&t.length>0?(t=this._removeCmDiv(t),this._renderMulti(t),this._start(),this._onWindowPositionChange()):(this.log.error("can not find sutable parent selector ("+e.toString()+") in body (will try to place ad next to the creative)"),this._finedPlacementContainer()),this.model.get("rescan.isActive")){var i=this.model.get("rescan.intervalSeconds");this.scanerTimer=setTimeout(this._findContainer.bind(this,e),1e3*i)}}},_removeCmDiv:function(e){return l.filter(e,(function(e){return"_cm-css-reset"!==e.id&&!e.getAttribute("data-tracked")}))},_start:function(){this.isStarted||(this.isStarted=!0,this.log.info("start",this.placeHolders),this._createPlayer(),this._setSize(),this._onWindowPositionChange(),this._fetchViewability())},_createPlayer:function(){},_fetchViewability:function(){var e=this;window.addEventListener("scroll",(function(){setTimeout(e._onWindowPositionChange.bind(e),0)}))},_onWindowPositionChange:function(){this.inViewDiv=this._getInViewDiv(),this.inViewDiv?this.model.set("isUnitViewable",!0):this.model.set("isUnitViewable",!1)},_getInViewDiv:function(){for(var e=0;e<this.placeHolders.length;e++)if(this._isViewable(this.placeHolders[e]))return this.placeHolders[e]},_isViewable:function(e){if(this.model.get("isUseEligibilityByPub"))return this.model.get("isEligibleByPub");var t=Object(n.a)(window),i={top:t.scrollTop(),left:t.scrollLeft()};i.right=i.left+t.width(),i.bottom=i.top+t.height();var o=this.model.get("height"),r=this.model.get("width");if(!r||!o)return!1;var s=Object(n.a)(e).offset();if(s.right=s.left+r,s.bottom=s.top+o,i.right<s.left||i.left>s.right||i.bottom<s.top||i.top>s.bottom)return!1;var a=Math.min(1,(s.bottom-i.top)/o),c=Math.min(1,(i.bottom-s.top)/o),d=Math.min(1,(s.right-i.left)/r)*Math.min(1,(i.right-s.left)/r)*100>=this.model.get("viewPercent")&&a*c*100>=this.model.get("viewPercent"),u=!0;return this.model.get("isCheckLayerVisible")&&(u=l.isLayerVisible(e)),d&&u},_midPageVisible:function(e,t){return e.top>=0&&e.left>=0&&e.bottom<=t.height&&e.right<=t.width&&this._getVisiblePercent(e,t)>=this.model.get("viewPercent")},_bottomPageVisible:function(e,t){return e.top>=t.height-10&&t.scrollY+t.height>=t.scrollHeight-10},_topPageVisible:function(e,t){return!!this.isExpanded&&100*e.bottom/this.model.get("height")>=this.model.get("viewPercent")},_setSize:function(){var e=l.reduce(this.placeHolders,(function(e,t){return t.offsetWidth>e?t.offsetWidth:e}),0);this.model.set({width:e,height:l.getVideoHeight(e)})},_getViewport:function(){return{height:window.innerHeight||window.document.documentElement.clientHeight,width:window.innerWidth||window.document.documentElement.clientWidth,scrollY:window.scrollY||window.pageYOffset,scrollX:window.scrollX||window.pageXOffset,scrollHeight:document.body.scrollHeight,scrollWidth:document.body.scrollWidth}},_getVisiblePercent:function(e,t){return 100*(t.height-e.top)/this.model.get("height")},_logTransition:function(){this.log.info("transition done")},showCloseButton:function(){this.log.info("showing close button"),Object(n.a)(this.ui.closeButton).show()},_isValidPlacementElement:function(e){var t;return e||(t="cant find placementElement - something went very wrong"),e&&this._isInHead(e)&&(t="the creative was placed in HEAD element - cant open video here"),!t||(this.log.error(t),!1)},_onStateChange:function(e,t){switch(t){case e.STATE.GOT_AD:this._onGotAd();break;case e.STATE.PLAYING:this._onPlaying();break;case e.STATE.STOPPED_BY_USER:this._collapse();break;case e.STATE.AD_STOPPED:this._onAdStopped();break;case e.STATE.DONE:this._collapse()}},_onGotAd:function(){},_onAdStopped:function(){},_expend:function(){this.inViewDiv.appendChild(this.el),this._customiseElements(),this.resize(),this.log.info("expending view"),l.firePixel(this.model.getImpressionPixel(),"impression pixel (the ad is expanding)");var e=this.model.get("height")+this.$adTitle.height();this.inViewDiv.style.height="auto",this.model.get("animation.onTransitionOpen")?this.$el.css("height",e):this.$el.css("height","auto"),this.isExpanded=!0,setTimeout(window.scrollBy.bind(window,0,1),1e3)},_onPlaying:function(){this._expend(),this.placeHolders=[this.inViewDiv]},resize:function(){if(!this._done&&this.inViewDiv){var e=this.$placeHolder.width(),t=this.model.get("maxWidth");t&&(e=Math.min(e,t));var i=l.getVideoHeight(e);this.model.set({width:e,height:i}),l.skipTransitionCss(Object(n.a)(this.inViewDiv),{height:"100%"}),l.skipTransitionCss(this.$placeHolder,{height:i+"px"}),this.$adTitle.css({width:e,margin:"auto"})}},_bindPubEligibilityEvents:function(){var e=this;window.document.addEventListener("adsnative.mrc50.view:in",(function(){e.log.info("isEligibleByPub = true"),e.placeHolders&&e.placeHolders[0]&&(e.inViewDiv=e.placeHolders[0],e.model.set("isEligibleByPub",!0),e.model.set("isUnitViewable",!0))})),window.document.addEventListener("adsnative.mrc50.view:out",(function(){e.log.info("isEligibleByPub = false"),e.model.set("isEligibleByPub",!1),e.model.set("isUnitViewable",!1)}))}}),h=i(1),p=i.n(h),f=i(4),m=i(20);function g(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=i(5),v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.urlParams=t.urlParams,this.maxWFRetries=t.wfRetries,this.wfRetries=0,this.isFirePiggies=t.isFirePiggies,this.secondsBW=t.secondsBW,this.log=new f.a({className:"Waterfall Manager"}),this.wfUrl=t.wfUrl,this.wfUrl.startsWith("//")||(this.wfUrl="//"+this.wfUrl),this.isRon=y.rollNumbers(t.ronPercent)}var t,i;return t=e,(i=[{key:"updateUrlParams",value:function(e){this.urlParams=n.a.extend(!0,{},this.urlParams,e)}},{key:"callWaterfall",value:function(e,t){this.successCallback=e,this.errorCallback=t;var i=this.wfUrl;this.wfRetries++;var o={cb:(new Date).getTime(),height:this.urlParams.height,oid:this.urlParams.originId,pubid:this.urlParams.pubId,tagid:this.urlParams.tagId,width:this.urlParams.width,noaop:this.urlParams.noaop,crid:this.urlParams.crid,sortOrderType:0,mindur:1,maxdur:60,minbr:1,maxbr:512,proto:"2,3,5,6",st:0,mimes:Object.keys(p.a.MIME_TYPES).toString(),dtagid:this.urlParams.dtagid,dpubid:this.urlParams.dpubid,viewable:this.urlParams.isViewable};this.isRon&&(o.noaop=1,o.sortOrderType=2),this.urlParams.cirf&&(o.cirf=encodeURIComponent(decodeURIComponent(this.urlParams.cirf))),i=y.addParametersToUrl(i,o,!0),i+="callback=&",n.a.ajax({type:"GET",url:i,success:this.onWaterfallSuccess.bind(this),error:this.recallWF.bind(this)})}},{key:"recallWF",value:function(){this.wfRetries>=this.maxWFRetries?this.errorCallback():window.setTimeout(this.callWaterfall.bind(this,this.successCallback,this.errorCallback),1e3*this.secondsBW)}},{key:"onWaterfallSuccess",value:function(e,t,i){if(!i)return this.log.error("The request is empty!"),void this.recallWF();var n=new Function("try { return "+i.responseText+";} catch(e){return false}")();n=this.handleWaterfallObject(n),this.successCallback(n)}},{key:"handleWaterfallObject",value:function(e){var t=/http(?:s:|:)([^'"]*)/g;return this.isFirePiggies&&this._firePiggies(e.pixel_piggies),y.each(e.tags,(function(e,i,n){e.id=Date.now()+Math.floor(1e3*Math.random()),e.seqNum=i+1,e.dast=e.pixel?this._getDastFromPixel(e.pixel):"",e.isRon=this.isRon;var o=t.exec(e.pixel);o&&o.length>1&&(e.pixel=o[1])}),this),e}},{key:"_firePiggies",value:function(e){y.each(e,(function(e){y.fireIframePixel(e.url,"Piggie")}))}},{key:"replaceMacros",value:function(e,t){var i=y.extend({},{ua:encodeURIComponent(navigator.userAgent),cb:Date.now(),keywords:""},t),n=(new Date).getTime();return e=this._replaceMacro(/%%referrer%%/gi,i.referrer,e),e=this._replaceMacro(/%%domain%%/gi,i.domain,e),e=this._replaceMacro(/%%video-url%%/gi,i.videoUrl,e),e=this._replaceMacro(/%%page-url%%/gi,i.pageUrl,e),e=this._replaceMacro(/%%player-width%%/gi,i.playerWidth,e),e=this._replaceMacro(/%%player-height%%/gi,i.playerHeight,e),e=this._replaceMacro(/%%timestamp%%/gi,Math.floor(n/1e3),e),e=this._replaceMacro(/%%vidlength%%/gi,i.videoLength,e),e=this._replaceMacro(/%%keywords%%/gi,i.keywords,e),e=this._replaceMacro(/%%description%%/gi,i.description,e),e=this._replaceMacro(/%%vertical%%/gi,i.vertical,e),e=this._replaceMacro(/%%title%%/gi,i.title,e),e=this._replaceMacro(/%%cirf%%/gi,i.cirf,e),e=this._replaceMacro(/%%cb%%/gi,i.cb,e),e=this._replaceMacro(/%%ip%%/gi,i.ip,e),e=this._replaceMacro(/%%UA%%/gi,i.ua,e),e=this._replaceMacro(/%%country%%/gi,i.country,e),e=this._replaceMacro(/%%latitude%%/gi,i.lat,e),(e=this._replaceMacro(/%%longitude%%/gi,i.long,e)).replace(/%%[^%]*%%/gi,"")}},{key:"_replaceMacro",value:function(e,t,i){return void 0===t&&(t=""),i.replace(e,t)}},{key:"_getDastFromPixel",value:function(e){var t=e.replace(/\?\?+/g,"?").replace(/&&+/g,"&").split(/\?(.+)?/gi,2);if(2!=t.length)return"";var i=t[1].split(/\?|&/gi);for(var n in i)if(i[n]){var o=i[n].split(/=(.+)?/gi,2);if(2==o.length&&"dast"==o[0])return o[1]}return""}}])&&g(t.prototype,i),e}();function b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _=i(5),w=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.log=new f.a({className:"AniView Player"}),this.aniViewId="aniViewPlayer",this.viewport=_.viewport,this.options=t,this.model=this.options.model,this.isMultiAd=_.parseBool(this.model.get("isMultiAd")),!document.getElementById(this.aniViewId)){this.isFirst=!0;var i=this.model.get("player.urls.wfRequest");this.waterfall=new v({wfUrl:i,wfRetries:this.model.get("retriesLWF"),secondsBW:this.model.get("secondsLWF"),isFirePiggies:this.model.get("player.settings.fire_piggies"),ronPercent:this.model.get("ronPercent"),urlParams:{cirf:this.model.get("referrer"),height:this.options.height,originId:this.model.get("originId"),pubId:this.model.get("pubId"),tagId:this.model.get("pubTagId"),width:this.options.width,noaop:this.model.get("noaop"),dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),crid:this.model.get("creativeId"),isViewable:this.model.get("isPlayerViewable")}}),this._generateAVInit()}}var t,i;return t=e,(i=[{key:"_generateAVInit",value:function(){if(this._avPlaylist=[],this.isMultiAd){var e=this.model.get("player.playlist");if(0==e.length)return void this.model.listenToOnce(this.model,"change:player.playlist",this._generateAVInit.bind(this));_.each(e,this._generateAVPlaylist,this)}var t=this.model.get("player.urls.oppsRequest");this.oppManager=new m.a(t,{"auc-dast":this.model.get("cmDast"),pv:200,vpd:this.model.get("pubId"),vptd:this.model.get("pubTagId"),pt:_.crc32(this.model.get("abTest")||999)});var i={publisherId:"57a0ab940757bb8c528b4587",channelId:"57a0abaf0757bb3d2b8b45a9",width:this.model.get("width"),height:this.model.get("height"),HD:!0,autoPlay:!0,ref1:this.model.get("referrer"),loop:!0,Preroll:1,midRollTime:this.model.get("timeBetweenAds"),soundButton:!0,pauseButton:!0,closeButton:!1,logo:!1,waterfall:this._waterfallFunc.bind(this),position:this.options.targetId,contentUrl:"",vastRetry:this.model.get("vastRetry"),timeout:this.model.get("defaultTagTimeout"),loopVideo:this.model.get("components.Repeat.isActive")};this._avPlaylist&&this._avPlaylist.length>0&&(i.contentUrl=this._avPlaylist[0].url),this.log.info("AniView config",i);var n;n="https:"===window.location.protocol?"https://aniview.hs.llnwd.net/d1/script/5/aniview.js":"http://data1.ani-view.com/script/5/aniview.js",this._downloadPlayer(n,i)}},{key:"_waterfallFunc",value:function(e){if(this.model.has("demandConfig.waterfall")){var t=this.waterfall.handleWaterfallObject(this.model.get("demandConfig.waterfall"));this._handleWfResponce("preroll",e,t)}else this.waterfall.updateUrlParams({isViewable:this.model.get("isPlayerViewable")}),this.waterfall.callWaterfall(this._handleWfResponce.bind(this,"preroll",e),this._waterfallError.bind(this))}},{key:"_waterfallError",value:function(){this.log.error("There was an error with the waterfall!"),_.firePixel(this.model.getPixel("pixels.networkError"),"WF Network Error")}},{key:"_handleWfResponce",value:function(e,t,i){if(_.isEmpty(i.tags))return this.log.warning("The waterfall is empty"),void this.waterfall.recallWF();this.wf||(this.wf={}),this.wf.preroll=i,this.waterfall.handleWaterfallObject(this.wf.preroll),t(this._waterfallAdapter(this.wf),"c7N60dfV90")}},{key:"_waterfallAdapter",value:function(e){var t={data:{}};t.data.tags=[];var i=this;return _.each(e.preroll.tags,(function(e){e.vpaidLog=_.createVpaidLog({version:200,model:i.model},_.extend({},e));var n={asid:e.id,priority:1,price:e.price};if(e.url)i._AVTagAdapter(e),n.type="vast",n.url=e.url;else{n.type="vastxml",n.url="http://";try{n.vastxml=decodeURIComponent(e.vast)}catch(t){n.vastxml=e.vast}}t.data.tags.push(n)})),this._createEventEnum(),t.data.onEvent=this._onEvent.bind(this),t}},{key:"_AVTagAdapter",value:function(e){var t={cirf:encodeURIComponent(this.model.get("cirf")),country:this.model.get("country"),domain:this.model.get("domain"),ip:this.model.get("ip"),playerHeight:Number(this.options.height),playerWidth:Number(this.options.width),referrer:encodeURIComponent(this.model.get("referrer")),vertical:this.model.get("vertical"),videoLength:"",description:"",title:"",videoUrl:"",pageUrl:this.model.get("referrer"),ua:""};if(this._avPlaylist&&this._avPlaylist.length>0){var i=this._avPlaylist[0];t.videoLength=i.vidlength,t.videoUrl=encodeURIComponent(i.fullPath),t.description=i.title,t.title=i.title}e.url=this.waterfall.replaceMacros(e.url,t),e.adCancelTimeout=1e3*Number(this.model.get("defaultTagTimeout"))}},{key:"_createEventEnum",value:function(){this.eventEnum={request:function(e){this._onAdRequest(e),this._pushEventToVpaidLog(e,"fetchVast")},bid:function(e,t){this._pushEventToVpaidLog(e,"event_adWonBid",{media:t.media,mediaType:t.type})},impression:function(e,t){this._onAdImpression(e),this._pushEventToVpaidLog(e,"event_AdImpression",{tabVis:!document.hidden,video:t.video})},firstQuartile:function(e){this._fireQuartileOpp("AdVideoFirstQuartile"),this._pushEventToVpaidLog(e,"event_AdVideoFirstQuartile",{tabVis:!document.hidden})},midPoint:function(e){this._fireQuartileOpp("AdVideoMidpoint"),this._pushEventToVpaidLog(e,"event_AdVideoMidpoint",{tabVis:!document.hidden})},thirdQuartile:function(e){this._fireQuartileOpp("AdVideoThirdQuartile"),this._pushEventToVpaidLog(e,"event_AdVideoThirdQuartile",{tabVis:!document.hidden})},complete:function(e){this._fireQuartileOpp("AdVideoComplete"),this._pushEventToVpaidLog(e,"event_AdVideoComplete",{tabVis:!document.hidden}),this._onAdEnded()},vpaidGeneralError:function(e,t,i){this._reportError(e,"vpaidGeneralError",i,t)},vpaidLoadError:function(e,t,i){this._reportError(e,"vpaidLoadError",i,t)},vpaidLoadTimeout:function(e,t,i){this._reportError(e,"vpaidLoadTimeout",i,t)},vpaidInitAdError:function(e,t,i){this._reportError(e,"vpaidInitAdError",i,t)},vpaidInitAdTimeout:function(e,t,i){this._reportError(e,"vpaidInitAdTimeout",i,t)},vpaidStartAdError:function(e,t,i){this._reportError(e,"vpaidStartAdError",i,t)},vpaidStartAdTimeout:function(e,t,i){this._reportError(e,"vpaidStartAdTimeout",i,t)},vpaidPlayError:function(e,t,i){this._reportError(e,"vpaidPlayError",i,t)},click:function(e,t,i){}}}},{key:"_onEvent",value:function(e,t,i){this.eventEnum[e]&&this.eventEnum[e].call(this,parseInt(t),i)}},{key:"_generateAVPlaylist",value:function(e){var t=_.extend({},e);t.url=e.fullPath||e.url,t.id=e.filename,t.categories=this.model.get("category"),this._avPlaylist.push(t)}},{key:"_downloadPlayer",value:function(e,t){var i=document.createElement("script");i.src=e,i.onload=function(){this.player=new aniviewPlayer;var e=this;this.player.onPlay=function(t,i,n){e._preventPropagation(),e.isFirst&&e.options.onFirstPlay&&(e.isFirst=!1,e._onFirstPlay()),e._onAdPlaying()},this.player.onReady=function(t,i,n){e._pushEventToVpaidLog(n,"event_AdLoaded",{tabVis:!document.hidden})},this.player.onPause=function(){e._pushEventToVpaidLog(e.activeTag.id,"event_AdPaused"),e._onAdPaused()},this.player.onResume=function(){e._pushEventToVpaidLog(e.activeTag.id,"event_AdPlaying"),e._onAdPlaying()},this.player.onClick=function(){_.firePixel(this.model.getPixel("pixels.clickthrough"),"Click Through")},this.player.play(t),this.model.on("change:isPlayerViewable",this.changeViewability,this)}.bind(this),document.getElementsByTagName("head")[0].appendChild(i)}},{key:"_fireOpp",value:function(e){this.activeTag?this.oppManager.send({rs:this.activeTag.id,st:p.a.ROLL_TYPE[this.activeTag.rollType],os:this.activeTag.seqNum,rst:e,d:Date.now()-this.activeTag.requestTime,dast:this.activeTag.dast,impid:this.activeTag.tryId,vmt:Number(this.activeTag.isRon)}):this.log.info("There is no active unit! Cannot fire opp.")}},{key:"_fireQuartileOpp",value:function(e,t){if(this.log.debug("on"+e,t),!this.activeTag){if(!t)return void this.log.warning("on"+e+" tag is undefined");this.log.info("Quartile "+e+" without active tag"),this._createActiveTag(t)}this._fireOpp(this.oppManager.pixelType[e])}},{key:"_createActiveTag",value:function(e){if(!e)return this.activeTag=null,!1;var t=this._getTagById(e);return this.activeTag=t,this.activeTag.tryId=Date.now(),!0}},{key:"_getTagById",value:function(e){var t=_.find(this.wf.preroll.tags,(function(t){return t.id===e}));return _.extend({},t)}},{key:"_onAdImpression",value:function(e){if(this.log.debug("onAdImpression",e),!this.activeTag){if(!e)return void this.log.warning("onAdImpression Tag is undefined");this.log.info("onAdImpression without active tag"),this._createActiveTag(e)}window.clearTimeout(this.activeTag.tagTimeoutTimer),_.firePixel(this.activeTag.pixel,"Tag Pixel"),this._fireOpp(this.oppManager.pixelType.tagImpression),this._resetViewabilityTimer(),this.options.onAdImpression()}},{key:"pause",value:function(){this.player&&(this.isPaused=!0,this.player.pause())}},{key:"resume",value:function(){this.player&&(this.isPaused=!1,this.player.resume())}},{key:"close",value:function(){this.player&&(this.playerClosed=!0,this.player.contentReadyToPlay=!1,this.player.close(),this._fireOpp(this.oppManager.pixelType.playerClosed),this._closeAllVpaids(),this.activeTag=null)}},{key:"resize",value:function(e,t){if(this.player){var i=Object(n.a)("#"+this.options.targetId);i.width(e),i.height(t);var o=-(e-32),r=Object(n.a)("#videoContent"),s=Object(n.a)("#videoAd"),a=Object(n.a)("#playerDiv");a.width(e),a.height(t),s.width(e),s.height(t),r.width(e),r.height(t),i.find("#aniVideoCanvas").width(e),i.find("#aniVideoCanvas").height(t),Object(n.a)("#bottomPlayer").width(e),Object(n.a)("#soundButton").css({right:o})}}},{key:"mute",value:function(){this.player.mute()}},{key:"unMute",value:function(){this.player.unmute()}},{key:"setFdData",value:function(e){}},{key:"_onAdRequest",value:function(e){this.log.debug("onAdRequest",e),e?(this._createActiveTag(e),this.activeTag.requestTime=Date.now(),this._fireOpp(this.oppManager.pixelType.tagStarted),!this.activeTag.tagTimeoutTimer&&this.activeTag.adCancelTimeout&&(this.activeTag.tagTimeoutTimer=window.setTimeout(this._onAdLoadTimeout.bind(this),this.activeTag.adCancelTimeout))):this.log.warning("onAdRequest Tag is undefined")}},{key:"_onAdLoadTimeout",value:function(){this.log.debug("onAdLoadTimeout"),this._fireOpp(this.oppManager.pixelType.tagTimeout),this.activeTag=null}},{key:"_onAdPaused",value:function(){this.log.debug("onAdPaused"),this._stopViewabilityTimer()}},{key:"_onAdPlaying",value:function(){this.log.debug("onAdPlaying"),this._resetViewabilityTimer()}},{key:"_onAdEnded",value:function(){this.log.debug("onAdEnded"),this.options.onAdEnded(),this._stopViewabilityTimer(),this._closeAllVpaids(),this.activeTag=null}},{key:"_onFirstPlay",value:function(){this.options.onFirstPlay&&this.options.onFirstPlay()}},{key:"changeViewability",value:function(e,t){t?this._resetViewabilityTimer():this._stopViewabilityTimer()}},{key:"_stopViewabilityTimer",value:function(){this.viewabilityTimer&&(window.clearTimeout(this.viewabilityTimer),this.viewabilityTimer=null)}},{key:"_resetViewabilityTimer",value:function(){if(this._stopViewabilityTimer(),this.activeTag&&this.model.get("isPlayerViewable")&&!this.activeTag.isViewed){var e=this.model.get("traceViewabilitySeconds");this.viewabilityTimer=window.setTimeout(this._onViewability.bind(this),1e3*e)}}},{key:"_onViewability",value:function(){this.activeTag.isViewed=!0,this._fireOpp(this.oppManager.pixelType.viewability)}},{key:"_onAdError",value:function(e){if(this.log.debug("onAdError",e),!this.activeTag){if(!e)return void this.log.warning("onAdError Tag is undefined");this.log.info("onAdError without active tag"),this._createActiveTag(e)}window.clearTimeout(this.activeTag.tagTimeoutTimer),this._fireOpp(this.oppManager.pixelType.tagError),this.options.onAdError(),this.activeTag=null}},{key:"_preventPropagation",value:function(){Object(n.a)(this.player.link).click((function(){return!1}))}},{key:"_closeAllVpaids",value:function(){var e=this;_.each(this.wf.preroll.tags,(function(t){e._pushEventToVpaidLog(t.id,"adStopped"),t.vpaidLog.saveToDb()}))}},{key:"_reportError",value:function(e,t,i,n){var o={tabVis:!document.hidden};i&&(o.params=i),n&&(o.errorDetails=n),this._pushEventToVpaidLog(e,t,o);var r=this._getTagById(e);this._onAdError(r),r&&r.vpaidLog&&r.vpaidLog.saveToDb()}},{key:"_pushEventToVpaidLog",value:function(e,t,i){var n=this._getTagById(e);n&&n.vpaidLog&&n.vpaidLog.push(t,i)}}])&&b(t.prototype,i),e}(),T=i(7),S=i.n(T),A=i(2),P=i.n(A),E=i(32);function C(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var k=i(5),O=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.model=this.options.model||{},this.log=new f.a({unitType:"PlayerAPI",className:"DPlayer",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.timers={},this.contentIndex=0,this.targetElem=Object(n.a)("#"+this.options.targetId.toString())[0],!this.model.get("vForce.isSupported")&&this.model.get("vForce.isActive")&&this.model.set("vForce.isActive",!1),this.isMuted="on"!==this.model.get("volume"),this.volume="off"!==this.model.get("volume")?40:0,this.dependencies=[];var i=t.model.get("player.urls.playerLocation");i&&(this.dependencies=[i+"/OvaMediaPlayer.js"]),this.oppManager=new m.a(this.model.get("player.urls.oppsRequest"),{"auc-dast":this.model.get("cmDast"),pt:k.crc32(this.model.get("abTest")||999)}),this.model.get("canStartPlayer")?this._initPlayer():this.model.on("change:canStartPlayer",this._initPlayer.bind(this))}var t,i;return t=e,(i=[{key:"_initPlayer",value:function(){this._fireCMPpixel(),window.OvaMediaPlayer?this._setPlayer():k.loadJsArr(this.dependencies,this._setPlayer.bind(this))}},{key:"_setPlayer",value:function(){if(this._validatePlayerSize()){if(this._setGeneralPlayingUnitState(!1),this.playlist=this.model.get("player.playlist"),this.playlist&&k.isEmpty(this.playlist))return void this.model.listenToOnce(this.model,"change:player.playlist",this._setPlayer.bind(this));var e=this.playlist[this.contentIndex];this.player=new OvaMediaPlayer({abTest:this.model.get("abTest"),ad_controls:this.model.get("player.hasAdControls"),aspect_ratio:this.model.get("aspectRatio"),auc_dast:this.model.get("cmDast"),autostart:this.model.get("autoPlay"),base_url:this.model.get("urls.base"),bf_factor:this.model.get("player.bfFactor"),bug_feature:this.model.get("player.hasBFeature"),cfr:this.model.get("cfr"),cipid:this.model.get("cipid"),cirf:decodeURIComponent(this.model.get("referrer")),creativeId:this.model.get("creativeId"),controls:this.model.get("player.hasControls"),country:this.model.get("country"),debug:this.model.get("isDebug")?["*"]:[],default_ad_parameters:this.model.get("defaultAdParameters"),default_ad_timeout:this.model.get("adMaxPlaySeconds"),default_b2b:this.model.get("player.b2b"),fire99:this.model.get("player.isFire99"),ga_factor:this.model.get("gaFactor"),ga_frame_src:this.model.get("gaFrameSrc"),image:this.model.get("loaderImage"),interrupt_loading:this.model.get("interruptLoading"),ip:this.model.get("ip"),isViewable:this.model.get("isPlayerViewable"),keywords:this.model.get("adTitle"),min_vpaid_run_time:this.model.get("player.minVpaidRunTime"),no_debug_report:this.model.get("noDebugReport"),oid:this.model.get("originId"),opps_base_path:this.model.get("player.urls.oppsBasePath"),page_url:decodeURIComponent(this.model.get("referrer")),referrer:decodeURIComponent(this.model.get("referrer")),repeat:this.model.get("repeat"),ron_percent:this.model.get("ronPercent"),schedule_auto:this.model.get("timeBetweenAds"),tags:this.model.get("tags"),time_between_waterfall:this.model.get("secondsBW"),use_flash_bypass:this.model.get("player.isBypassFlash"),use_flash_player:this.model.get("player.isFlashPlayer"),version:this.model.get("adTitle"),vertical:this.model.get("vertical"),wf_base_path:this.model.get("player.urls.wfBasePath"),wf_url:this.model.get("player.urls.wfRequest"),opps_url:this.model.get("player.urls.oppsRequest"),height:""+parseInt(this.model.get("height")),width:""+parseInt(this.model.get("width")),dplayerSettings:this.model.get("player.settings"),loadrsrc:!0,preset:this.model.get("preset"),isDFP:this.model.get("iframeData.inDFP"),can_opt_out:!1,description:e.title,domain:window.location.hostname,mute:this.isMuted,title:e.title,volume:this.volume,target_id:this.options.targetId.toString(),schedule:this.options.scheduleArr,dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),isMobile:this.model.get("isMobile"),queue_size:this.model.get("player.settings.queueSize"),max_ready_vpaid:this.model.get("player.settings.maxReadyVpaid"),adto:this.model.get("player.settings.adto"),vakll:this.model.get("player.settings.vakll"),mintimwf:this.model.get("player.settings.mintimwf"),agressiveLevel:this.model.get("preset.level"),mPre:this.model.get("mPre"),red_id:this.model.get("redId"),vimpFireEvent:this.model.get("vimpFireEvent"),vForce:this.model.get("vForce.isActive"),get_ad_timeout_seconds:this.model.get("vForce.getAdTimeoutSeconds"),wf_manual:this.model.get("wfManual"),wf_dynmc_ps:this.model.get("wfDynamicPause"),run_wf_when_empty:this.model.get("runWfWhenEmpty"),rndmt:this.model.get("rndmt"),unit_name:this.model.get("unitName"),unit_loader_version:this.model.get("version"),unit_main_version:this.model.get("unitVersion"),mprdct:this.model.get("player.settings.mprdct"),gdprApplies:this.model.get("gdprApplies"),cdb:this.model.get("consentDaisyBit"),pixelsUrl:this.model.get("pixels.url"),files:[e],onPlayerClose:this._onPlayerClose.bind(this),onPlayerError:this._onPlayerError.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerStop:this._onPlayerStop.bind(this)}),this.playerQueueSeeker=new E.a(this.model),this.playerQueueSeeker.registerToPlayerQueueStatusChange({instance:this,type:void 0,typeValue:void 0,status:"startAd",cb:this.isFirstAdLoaded.bind(this),isListenOnce:!0}),this.player.on("queueStatus",this.playerQueueSeeker.updateAdsList.bind(this.playerQueueSeeker)),S.a.player=this.player,this.model.get("supportTool")||this.model.get("supportTool.isOpen")||this.model.set("supportTool",{isOpen:!1}),this.model.listenTo(this.model,"change:supportTool.isOpen",this._supportToolStateChange.bind(this)),this._alignPlayer(),this._registerListeners()}}},{key:"_validatePlayerSize",value:function(){var e=this.model.get("width"),t=this.model.get("height"),i=!0;return k.isWidthValid(e)?k.isHeightValid(t)||(t=this.model.get("dimensions.minHeight")||k.getVideoHeight(e),this.model.set("height",t),this.model.set("playerHeightLost",!0)):(i=!1,this.model.set("playerWidthLost",!0)),i}},{key:"_onAdImpression",value:function(e){if(e.hadImpression){this.activeVpaidWrapper=e,this.model.get("components.Repeat.isActive")&&this.activeVpaidWrapper.dontDie&&this.activeVpaidWrapper.dontDie(),this.hasImpression=!0,this._stopTimer("midrollCollapse");var t={lineItemId:this.model.get("lineItemId"),placement:this.model.get("placement"),redId:this.model.get("redId")};this.hadImpression||(s.a.trigger("filledImpression",t),this.hadImpression=!0),this.model.get("isSendCPM")&&(t.cpm=e.tag.vpaidWrapperData&&e.tag.vpaidWrapperData.vastPrice?e.tag.vpaidWrapperData.vastPrice:e.tag.price),s.a.trigger("onImpression",t),this.log.debug("onAdImpression",e),window.clearTimeout(this._playerTimeout||0),e.isBf||(this.activeTag=k.filterObject(e.tag,["sequenceId","rollType","waterfallTagId","created","dast","cpmFloor","pubId","tagId","dp","isRon"]),this._updateLastActiveTag(),this._resetViewabilityTimer()),this.options.onAdImpression(e.tag)}}},{key:"_onStop",value:function(e){e&&e.hadImpression&&!e.isBf&&(this.log.debug("onStop",e),this.hasImpression&&(this.hasImpression=!1,this.options.onAdStopped()),this.activeTag&&this.options.onAdStopped(),this.activeTag=null,this._stopTimer("viewability"),this._resetMidrollCollapseTimer(),this._setAdPlayingWithAdChoice(!1))}},{key:"_onVideoComplete",value:function(){this.options.onAdVideoComplete&&this.options.onAdVideoComplete(),this._setAdPlayingWithAdChoice(!1)}},{key:"_onPlayerReady",value:function(){this.log.info("onPlayerReady"),this._initCloseTimers(),this.options.onPlayerReady()}},{key:"_onPlayerStop",value:function(){this.options.onPlayerStop&&this.options.onPlayerStop(),this._stopTimer("viewability")}},{key:"_onPlayerError",value:function(){this.options.onPlayerError&&this.options.onPlayerError(),this._stopTimer("viewability")}},{key:"_initCloseTimers",value:function(){var e=this.model.get("secondsToClose");e&&!this._playerTimeout&&(this.log.info("set secondsToClose",e),this._playerTimeout=window.setTimeout(this._onPlayerTimeout.bind(this),1e3*e));var t=this.model.get("secondsToCloseGlobal");t&&(this._secondsToCloseGlobalTimeout=window.setTimeout(this._onPlayerClose.bind(this),1e3*t));var i=this.model.get("playerEndSeconds");i&&(this._playerEndSecondsTimeout=window.setTimeout(this._onPlayerEndSeconds.bind(this),1e3*i)),this.model.get("secondsToPassback")&&(this.passBackTimer=window.setTimeout(this._triggerPassback.bind(this,"passback timer"),1e3*this.model.get("secondsToPassback")))}},{key:"_supportToolStateChange",value:function(e,t){t?(this.pause(),S.a.supportTool=S.a.supportTool||{},S.a.supportTool.dp=this.activeTag?this.activeTag.dp:void 0,this._stopTimer("midrollCollapse"),window.clearTimeout(this._playerTimeout),window.clearTimeout(this._secondsToCloseGlobalTimeout),window.clearTimeout(this._playerEndSecondsTimeout)):(S.a.supportTool.dp=void 0,this._initCloseTimers(),this._resetMidrollCollapseTimer(),this.resume())}},{key:"_resetViewabilityTimer",value:function(){if(this._stopTimer("viewability"),this.activeTag&&this.model.get("isPlayerViewable")&&!this.activeTag.isViewed){var e=this.model.get("traceViewabilitySeconds");this.timers.viewability=window.setTimeout(this._onViewability.bind(this),1e3*e)}}},{key:"_resetMidrollCollapseTimer",value:function(){if(this._stopTimer("midrollCollapse"),this.model.get("midrollCollapse.isActive")&&!this.activeTag&&this.model.get("isUnitViewable")){var e=this.model.get("midrollCollapse.time");this.timers.midrollCollapse=window.setTimeout(this._onPlayerClose.bind(this),1e3*e)}}},{key:"_stopTimer",value:function(e){window.clearTimeout(this.timers[e]),this.timers[e]=null}},{key:"_onViewability",value:function(){this.activeTag.isViewed=!0,this.log.info("Fire viewability opps",this.activeTag),this.oppManager.send(this._getOppParams(30)),this.model.get("isViewavility100Slider")&&this.oppManager.send(this._getOppParams(63))}},{key:"_onPlayerEndSeconds",value:function(){s.a.trigger("player:end")}},{key:"_onPlayerTimeout",value:function(){this.log.info("onPlayerTimeout"),this.player._pausePlayer(),k.firePixel(this.model.getPixel("pixels.timeout"),"Player got no impressions")}},{key:"_onPlayerClose",value:function(){this._onStop(),this._setGeneralPlayingUnitState(!1),this.options.onPlayerClose&&this.options.onPlayerClose(),this._stopTimer("viewability")}},{key:"_onInView",value:function(){this._resetViewabilityTimer(),this._resetMidrollCollapseTimer()}},{key:"_onOutOfView",value:function(){this._stopTimer("viewability"),this._stopTimer("midrollCollapse")}},{key:"_setGeneralPlayingUnitState",value:function(e){this.model.set("generalPlayingUnitState",null),this.model.set("generalPlayingUnitState",e)}},{key:"_adPaused",value:function(e){this._setGeneralPlayingUnitState(!1),this.model.get("supportTool.isOpen")&&e.dontDie()}},{key:"_adPlaying",value:function(e){this._setGeneralPlayingUnitState(!0)}},{key:"_registerListeners",value:function(){this.player.on&&(this.player.on("AdVideoComplete",this._onStop.bind(this)),this.player.on("AdVideoComplete",this._onVideoComplete.bind(this)),this.player.on("AdStopped",this._onStop.bind(this)),this.player.on("AdVideoEnd",this._onStop.bind(this)),this.player.on("AdImpression",this._onAdImpression.bind(this)),this.player.on("AdPaused",this._adPaused.bind(this)),this.player.on("AdPlaying",this._adPlaying.bind(this)),this.player.on("AdError",this.options.onAdError),this.player.on("AdClickThru",this._onAdClickThru.bind(this)),this.player.on("contentChanged",this._onContentChanged.bind(this)),this.player.on("UserInteractionPauseState",this._onPausedChanged.bind(this)),this.player.on("emptyFirstWaterfall",this._triggerPassback.bind(this,"empty first waterfall"))),this.model.on("change:state",this._onPlaying.bind(this)),this.model.on("change:isPlayerViewable",this.changeViewability,this)}},{key:"_onPlaying",value:function(e,t){e.STATE.PLAYING==t&&(this._updateAdChoiceVisibility(),this._setGeneralPlayingUnitState(!0))}},{key:"_onPausedChanged",value:function(e){this._setGeneralPlayingUnitState(!e)}},{key:"_onContentChanged",value:function(){this.log.important("OnContentChanged, current content:",this.playlist[this.contentIndex]),!this.model.get("repeat")&&this.model.get("isPlaylist")&&(this.contentIndex++,this.playlist.length<=this.contentIndex&&(this.contentIndex=0),this.playVideo({fileData:this.playlist[this.contentIndex],imageUrl:this.model.get("loaderImage"),autoplay:this.model.get("autoPlay")})),(this.model.get("repeat")||this.model.get("isPlaylist"))&&s.a.trigger("change:player:content",this.playlist[this.contentIndex])}},{key:"_onAdClickThru",value:function(){this.lastActiveTag.sequenceId===this.activeTag.sequenceId&&this.lastActiveTag.clickCounter>1||this.oppManager.send(this._getOppParams(33)),this.lastActiveTag.clickCounter++}},{key:"_getOppParams",value:function(e){var t=k.extend({},this._getBaseOppParams());return t.rst=e,t}},{key:"_getBaseOppParams",value:function(){return{rs:this.activeTag.sequenceId,st:p.a.ROLL_TYPE[this.activeTag.rollType],sts:this.player.repeatCount,os:Number(this.activeTag.waterfallTagId)+1,d:(new Date).getTime()-this.activeTag.created,dast:this.activeTag.dast,vpd:this.activeTag.pubId,vptd:this.activeTag.tagId,pv:this.player.get("player_version"),dp:k.crc32(this.activeTag.dp),vmt:Number(this.activeTag.isRon)||0,abt:this.model.get("abTest"),agl:this.model.get("preset.level")?this.model.get("preset.level"):1}}},{key:"_setAdPlayingWithAdChoice",value:function(e){this.model.set("adPlayingWithAdChoice",e)}},{key:"_updateAdChoiceVisibility",value:function(){this.activeVpaidWrapper&&this.activeVpaidWrapper.hasAdChoices?this._setAdPlayingWithAdChoice(!0):this._setAdPlayingWithAdChoice(!1)}},{key:"_updateLastActiveTag",value:function(){this.lastActiveTag={},this.lastActiveTag.sequenceId=this.activeTag.sequenceId,this.lastActiveTag.clickCounter=1}},{key:"_fireCMPpixel",value:function(){this.model.get("hasCMPonPage")?k.firePixel(this.model.getPixel("pixels.hasCMPonPage"),"GDPR - Has CMP on page"):k.firePixel(this.model.getPixel("pixels.noCMPonPage"),"GDPR - No CMP on page")}},{key:"_alignPlayer",value:function(){if(this.player.store.get("dataSaver")){var e=this.model.get("playerTextAlign"),t=this.player.store.get("forcecnvsmpg");(e||t)&&this.targetElem&&Object(n.a)(this.targetElem).css({"text-align":"left"})}}},{key:"_triggerPassback",value:function(e){var t=this.model.get("isApiPassbackExist");!this.model.get("isFirstAdLoaded")&&t&&(this.log.info("Triggering passback due to "+e),s.a.trigger("global:passback",{isApiPassbackExist:t}),this.model.set("closeState",P.a.closeState.terminate),this.model.set("state",this.model.STATE.DONE))}},{key:"isFirstAdLoaded",value:function(){this.model.set("isFirstAdLoaded",!0)}},{key:"pause",value:function(){this.player&&(this.player.pause(),this._setGeneralPlayingUnitState(!1),this.player.ova.pauseAd(),this._stopTimer("viewability"))}},{key:"resume",value:function(){this.player&&(this.player.play(),this._setGeneralPlayingUnitState(!0),this.player.ova.resumeAd(),this._resetViewabilityTimer())}},{key:"close",value:function(){this.player&&(this._setGeneralPlayingUnitState(!1),this.player.closeCleanPlayer(),this.player=null)}},{key:"resize",value:function(e,t){this.player&&(this.player.resize(e,t),this.player.ova.resizeAd(e,t))}},{key:"playVideo",value:function(e){this.contentIndex=this.playlist.findIndex((function(t){return t.id===e.fileData.id})),this.player.setVideoFile([e.fileData],e.imageUrl,e.autoplay)}},{key:"mute",value:function(e){if(this.unMuteTimer)return clearTimeout(this.unMuteTimer),void(this.unMuteTimer=!1);this.isMuted&&!e||(this.isMuted=!0,this.player&&(this.volume=this.player.volume(),this.player.volume(0),this.player.mute(),this.player.ova.setAdVolume(0),this.player.ova.muteAd()))}},{key:"unMute",value:function(){this.unMuteTimer||!this.model.get("isThrottleUnMute")?(this.unMuteTimer=!1,this.isMuted&&(this.isMuted=!1,this.player&&(this.player.volume(this.volume),this.player.unMute(),this.player.ova.setAdVolume(this.volume),this.player.ova.unmuteAd()))):this.unMuteTimer=window.setTimeout(this.unMute.bind(this),100)}},{key:"changeViewability",value:function(e,t){this.player&&this.player.set&&(this.log.info("Player isViewable",t),this.player.set("isViewable",t)),t?this._onInView():this._onOutOfView()}},{key:"getCurrentContent",value:function(){return!!this.playlist&&this.playlist[this.contentIndex]}},{key:"setFdData",value:function(e){this.player&&this.player.set&&e&&this.player.set("fdScore",e)}},{key:"replay",value:function(){return this.activeVpaidWrapper&&"mp4"===this.activeVpaidWrapper.type&&(this.hasImpression=!0,this.activeVpaidWrapper.restartAd()),this.activeVpaidWrapper.type}},{key:"getAd",value:function(e){if(this.player&&this.player.getAd)return this.log.info("GetAd was called",e),this.player.getAd(e)}},{key:"setVolume",value:function(e){this.volume=e}}])&&C(t.prototype,i),e}();function I(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i(10);var R=i(5),V=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.log=new f.a({className:"StreamRail Player"}),this.streamRailId="streamrail-jssdk",this.options=t,this.model=this.options.model,this.isMultiAd=R.parseBool(this.model.get("isMultiAd")),!document.getElementById(this.streamRailId)){var i=this.model.get("player.urls.wfRequest");if(this.waterfall=new v({wfUrl:i,wfRetries:this.model.get("retriesLWF"),secondsBW:this.model.get("secondsLWF"),isFirePiggies:this.model.get("player.settings.fire_piggies"),ronPercent:this.model.get("ronPercent"),urlParams:{cirf:this.model.get("referrer"),height:this.options.height,originId:this.model.get("originId"),pubId:this.model.get("pubId"),tagId:this.model.get("pubTagId"),width:this.options.width,noaop:this.model.get("noaop"),dtagid:this.model.get("dtagid"),dpubid:this.model.get("dpubid"),crid:this.model.get("creativeId"),isViewable:this.model.get("isPlayerViewable")}}),this.model.has("demandConfig.waterfall")){var n=this.waterfall.handleWaterfallObject(this.model.get("demandConfig.waterfall"));this._handleWfResponce("preroll",n)}else this.waterfall.callWaterfall(this._handleWfResponce.bind(this,"preroll"),this._waterfallError.bind(this))}}var t,i;return t=e,(i=[{key:"_waterfallError",value:function(){this.log.error("There was an error with the waterfall!"),R.firePixel(this.model.getPixel("pixels.networkError"),"WF Network Error")}},{key:"_handleWfResponce",value:function(e,t){this.wf||(this.wf={}),this.wf.preroll=t,this._generateSRInit()}},{key:"_generateSRInit",value:function(){if(!this.wf.preroll||!this.wf.preroll.tags||R.isEmpty(this.wf.preroll.tags))return this.log.warning("The waterfall is empty"),void this.waterfall.recallWF();if(this._srPlaylist=[],this.isMultiAd){var e=this.model.get("player.playlist");if(0==e.length)return void this.model.listenToOnce(this.model,"change:player.playlist",this._generateSRInit.bind(this));R.each(e,this._SRPlaylistAdapter,this)}var t=this.model.get("player.urls.oppsRequest");this.oppManager=new m.a(t,{"auc-dast":this.model.get("cmDast"),pv:100,vpd:this.model.get("pubId"),vptd:this.model.get("pubTagId"),pt:R.crc32(this.model.get("abTest")||999)}),R.each(this.wf.preroll.tags,this._SRTagAdapter,this),window.srAsyncInit=this._srInit.bind(this),this._createSRPlayer()}},{key:"_SRPlaylistAdapter",value:function(e){var t=R.extend({},e);t.id=e.filename,t.categories=this.model.get("category"),this._srPlaylist.push(t)}},{key:"_SRTagAdapter",value:function(e){var t={cirf:encodeURIComponent(this.model.get("cirf")),country:this.model.get("country"),domain:this.model.get("domain"),ip:this.model.get("ip"),playerHeight:Number(this.options.height),playerWidth:Number(this.options.width),referrer:encodeURIComponent(this.model.get("referrer")),vertical:this.model.get("vertical"),videoLength:"",description:"",title:"",videoUrl:"",pageUrl:this.model.get("referrer"),ua:"[DEV_UA]"};if(this._srPlaylist&&this._srPlaylist.length>0){var i=this._srPlaylist[0];t.videoLength=i.vidlength,t.videoUrl=encodeURIComponent(i.fullPath),t.description=i.title,t.title=i.title}if(e.macros&&(t=R.extend(t,{ip:"[CLIENT_IP]",playerHeight:"[HEIGHT]",playerWidth:"[WIDTH]"})),e.url)e.url=this.waterfall.replaceMacros(e.url,t);else try{e.url=decodeURIComponent(e.vast)}catch(t){e.url=e.vast}e.adCancelTimeout=1e3*Number(this.model.get("defaultTagTimeout"))}},{key:"_srInit",value:function(){var e={partnerID:"fd925f23-e608-4807-9a9e-ebe550860bc3",ads:{schedule:[],skip:{enabled:!1,seconds:5,btnText:"Continue"}},adRequestThrottle:1e3*Number(this.model.get("secondsBW")),autoplay:R.parseBool(this.model.get("autoPlay")),bgColor:"black",contentAutoplay:R.parseBool(this.model.get("autoPlay")),height:this.options.height,hideContentBeforePreRoll:R.parseBool(this.model.get("isShowOnAd")),loop:R.parseBool(this.model.get("repeat")),muted:"on"!==this.model.get("volume"),mobileSpriteTimeout:1e3*this.model.get("mobileSpriteTimeoutSeconds"),scaleMode:"original",width:this.options.width};this.isMultiAd?(e.playlist=this._srPlaylist,e.breakingAds={enabled:!0,hideContentControls:!R.parseBool(this.model.get("player.hasControls")),minTimeBetweenAds:1e3*Number(this.model.get("timeBetweenAds")),on:"AdImpression"},e.ads.schedule=[{position:"pre-roll",server:{tags:this.wf.preroll.tags}}]):e.ads.schedule=[{position:"pre-roll",server:{tags:this.wf.preroll.tags}}],this.log.info("SR Options",e),this.player=SR(this.options.targetId,e),this._bindEvents()}},{key:"_bindEvents",value:function(){this.player.on("AdVideoFirstQuartile",this._fireQuartileOpp.bind(this,"AdVideoFirstQuartile")),this.player.on("AdVideoMidpoint",this._fireQuartileOpp.bind(this,"AdVideoMidpoint")),this.player.on("AdVideoThirdQuartile",this._fireQuartileOpp.bind(this,"AdVideoThirdQuartile")),this.player.on("AdVideoComplete",this._fireQuartileOpp.bind(this,"AdVideoComplete")),this.player.on("AdImpression",this._onAdImpression.bind(this)),this.player.on("AdVideoComplete",this._onAdEnded.bind(this)),this.player.on("AdError",this._onAdError.bind(this)),this.player.on("AdRequest",this._onAdRequest.bind(this)),this.player.on("AdPaused",this._onAdPaused.bind(this)),this.player.on("AdPlaying",this._onAdPlaying.bind(this)),this.player.on("AdClickThru",this._onAdClickThru.bind(this)),this.player.on("firstplay",this._onFirstPlay.bind(this)),this.model.on("change:isPlayerViewable",this.changeViewability,this)}},{key:"_onAdClickThru",value:function(){R.firePixel(this.model.getPixel("pixels.clickthrough"),"Click Through")}},{key:"_onAdRequest",value:function(e){this.log.debug("onAdRequest",e),e?(this._createActiveTag(e),this.activeTag.requestTime=Date.now(),this._fireOpp(this.oppManager.pixelType.tagStarted),!this.activeTag.tagTimeoutTimer&&this.activeTag.adCancelTimeout&&(this.activeTag.tagTimeoutTimer=window.setTimeout(this._onAdLoadTimeout.bind(this),this.activeTag.adCancelTimeout))):this.log.warning("onAdRequest Tag is undefined")}},{key:"_onAdLoadTimeout",value:function(){this.log.debug("onAdLoadTimeout"),this._fireOpp(this.oppManager.pixelType.tagTimeout),this.activeTag=null}},{key:"_onAdError",value:function(e){if(this.log.debug("onAdError",e),!this.activeTag){if(!e)return void this.log.warning("onAdError Tag is undefined");this.log.info("onAdError without active tag"),this._createActiveTag(e)}window.clearTimeout(this.activeTag.tagTimeoutTimer),this._fireOpp(this.oppManager.pixelType.tagError),this.options.onAdError(),this.activeTag=null}},{key:"_onAdImpression",value:function(e){if(this.log.debug("onAdImpression",e),!this.activeTag){if(!e)return void this.log.warning("onAdImpression Tag is undefined");this.log.info("onAdImpression without active tag"),this._createActiveTag(e)}window.clearTimeout(this.activeTag.tagTimeoutTimer),R.firePixel(this.activeTag.pixel,"Tag Pixel"),this._fireOpp(this.oppManager.pixelType.tagImpression),this._resetViewabilityTimer(),this.options.onAdImpression()}},{key:"_stopViewabilityTimer",value:function(){this.viewabilityTimer&&(window.clearTimeout(this.viewabilityTimer),this.viewabilityTimer=null)}},{key:"_resetViewabilityTimer",value:function(){if(this._stopViewabilityTimer(),this.activeTag&&this.model.get("isPlayerViewable")&&!this.activeTag.isViewed){var e=this.model.get("traceViewabilitySeconds");this.viewabilityTimer=window.setTimeout(this._onViewability.bind(this),1e3*e)}}},{key:"_onViewability",value:function(){this.activeTag.isViewed=!0,this._fireOpp(this.oppManager.pixelType.viewability)}},{key:"_onAdPaused",value:function(){this.log.debug("onAdPaused"),this._stopViewabilityTimer()}},{key:"_onAdPlaying",value:function(){this.log.debug("onAdPlaying"),this.isPaused?this.pause():this._resetViewabilityTimer()}},{key:"_onAdEnded",value:function(){this.log.debug("onAdEnded"),this.options.onAdEnded(),this._stopViewabilityTimer(),this.activeTag=null}},{key:"_fireQuartileOpp",value:function(e,t){if(this.log.debug("on"+e,t),!this.activeTag){if(!t)return void this.log.warning("on"+e+" tag is undefined");this.log.info("Quartile "+e+" without active tag"),this._createActiveTag(t)}this._fireOpp(this.oppManager.pixelType[e])}},{key:"_onFirstPlay",value:function(){this.options.onFirstPlay&&this.options.onFirstPlay()}},{key:"_createActiveTag",value:function(e){if(!e)return this.activeTag=null,!1;var t=this._getRollType(e.analytics.adPosition),i=this._getTagById(e.analytics.adsourceid,t);return this.activeTag=i,this.activeTag.rollType=t,this.activeTag.tryId=Date.now(),!0}},{key:"_getRollType",value:function(e){return e.replace("-","")}},{key:"_getTagById",value:function(e,t){if(this.wf[t]){var i=R.find(this.wf[t].tags,(function(t){return String(t.id)===e}));return R.extend({},i)}}},{key:"_createSRPlayer",value:function(){var e=document.getElementById(this.options.targetId),t=document.createElement("script");t.id=this.streamRailId,this.model.get("srSrc")?t.src=this.model.get("srSrc"):R.parseBool(this.model.get("srOldVersion"))?t.src="https://sdk.streamrail.com/test/player/89afe692a142c57fff97a01259e030e6c15e5cf6/sr.ads.js":t.src="https://sdk.streamrail.com/player/sr.ads.js",e.appendChild(t)}},{key:"_fireOpp",value:function(e){this.activeTag?this.oppManager.send({rs:1,st:p.a.ROLL_TYPE[this.activeTag.rollType],os:this.activeTag.seqNum,rst:e,d:Date.now()-this.activeTag.requestTime,dast:this.activeTag.dast,impid:this.activeTag.tryId,vmt:Number(this.activeTag.isRon)}):this.log.info("There is no active unit! Cannot fire opp.")}},{key:"pause",value:function(){this.player&&(this.isPaused=!0,this.player.pause())}},{key:"resume",value:function(){this.player&&(this.isPaused=!1,this.player.play())}},{key:"close",value:function(){this.player&&(this.player.off(),this.player.dispose(),this._fireOpp(this.oppManager.pixelType.playerClosed),this.activeTag=null)}},{key:"resize",value:function(e,t){if(this.player){var i=document.getElementById(this.options.targetId);Object(n.a)(i).css({width:e,height:t}),this.player._resize()}}},{key:"mute",value:function(){this.player.muted(!0)}},{key:"unMute",value:function(){this.player.muted(!1)}},{key:"changeViewability",value:function(e,t){t?this._resetViewabilityTimer():this._stopViewabilityTimer()}},{key:"setFdData",value:function(e){}}])&&I(t.prototype,i),e}(),D=i(16),x=i.n(D),N=i(15),M=i(3),L=i(5),F=(i(10),M.View.extend({videoAdId:L.now().toString().trim(),_initVjs:function(){if(L.parseBool(this.model.get("isMobile")))switch(this.model.get("mobilePlayer")){case"AV":this._initAV();break;case"DP":this._initDP();break;case"SR":default:this._initSR()}else this._initDP()},_initSR:function(){this.player=new V({model:this.model,isInstream:!1,targetId:this.videoAdId,width:this.model.get("width"),height:this.model.get("height"),onAdImpression:this._onAdImpression.bind(this),onAdEnded:this._onAdStopped.bind(this),onAdError:this._onAdError.bind(this)})},_initAV:function(){this.player=new w({model:this.model,isViewable:1,isInstream:!0,targetId:this.videoAdId,width:this.model.get("width"),height:this.model.get("height"),onAdImpression:this._onAdImpression.bind(this),onAdError:this._onAdError.bind(this),onAdEnded:this._onAdStopped.bind(this)})},_initDP:function(){var e=function(){},t=this._onAdVideoComplete||e,i=this._onPlayerClose||e;this.player=new O({model:this.model,isViewable:1,targetId:this.videoAdId,onAdImpression:this._onAdImpression.bind(this),onAdStopped:this._onAdStopped.bind(this),onAdError:this._onAdError.bind(this),onAdVideoComplete:t.bind(this),onPlayerClose:i.bind(this),onPlayerReady:this._onPlayerReady.bind(this),onPlayerError:this._onPlayerError.bind(this),scheduleArr:this.model.getScheduleArr()})}})),B=i(5),j=F.extend({initialize:function(e){this.$el.addClass("_cm-detach-pre"),this.container=this.model.get("playerContainer"),this.placeHolderView=e.placeHolderView,this._detachHorizontal=this.model.get("detach.position.horizontal"),this._detachVertical=this.model.get("detach.position.vertical"),this._detachWidth=parseInt(this.model.get("detach.width")),this._detachHeight=B.getVideoHeight(this._detachWidth),this.model.get("isSoundOnHover")&&!this.model.get("isMobile")&&(this.events.mouseenter="unMute",this.events.mouseleave="mute"),this._bindEvents(),this._setComponents()},render:function(){this.$el.append(x.a),this.$el.css({height:0,width:this.model.get("width")}),this.$("._cm-video-ad")[0].id=this.videoAdId,Object(n.a)(this.container).append(this.$el),this._setViewabilityListeners(),this._initVjs()},_setComponents:function(){this.model.get("components.TimerView.hasTimer")&&(this.timerView=new o.h({model:this.model,container:this.el,isHide:!0})),this.model.get("components.OptOut.hasOptOut")&&(this.optOutView=new o.f({model:this.model,container:this.el})),this.model.get("components.Loading.isActive")&&(this.loadingView=new o.e({model:this.model,container:this.el}))},_bindEvents:function(){this.windowEventManager=Object(N.a)(),this.listenTo(s.a,"window:tab:change",this._onTabEvent),this.listenToOnce(this.model,"change:height",this.render),this.listenTo(this.model,"change:state",this._onStateChange)},_onTabEvent:function(e){e===p.a.TAB_STATE.tabOut&&this.mute()},_onPlayerReady:function(){this.log.info("onVjsReady")},_onAdImpression:function(){this.log.info("onAdImpression (got ad - pausing ad)"),B.firePixel(this.model.getPixel("pixels.addImpresion"),"addImpresion (the player got an ad)"),this.player.pause(),this.model.set("state",this.model.STATE.GOT_AD),this.loadingView&&this.loadingView.hide()},_onAdVideoComplete:function(){},_onAdError:function(){this.log.error("onAdError")},_onAdStopped:function(){this.loadingView&&this.loadingView.show()},_onPlayerError:function(){this.log.error("onPlayerError")},_onOptOutStop:function(){this._stopAd(),this.placeHolderView._collapse()},_stopAd:function(){this._hide(),this.player.close()},_hide:function(){var e=this;this.isDetached?(this.$el.css(this._getSlideOutStyle()),this.isDetached=!1,setTimeout((function(){return e.$el.hide()}),1e3)):this.$el.hide()},_detach:function(){"detach"===this.model.get("onOutOfView")&&(this.isDetached=!0,this.$el.addClass("_cm-os-slider-unit"),this.$el.addClass("_cm-slider-"+this._detachHorizontal),this.$el.addClass("_cm-slider-"+this._detachVertical),this.$el.css({width:this._detachWidth+"px",height:this._detachHeight+"px",transition:"none"}),this.player.resize(this._detachWidth,this._detachHeight)),"pause"===this.model.get("onOutOfView")&&this.player.pause()},_onPlaying:function(){this._playing=!0,this.timerView&&this.timerView.startTimer(),this.player.resume(),this._attach(!0)},_attach:function(e){if(e){var t=this.model.get("additionalCss");B.isObject(t)&&!B.isEmpty(t)&&this.$el.css(t);var i=this.model.get("placeholderCss");B.isObject(i)&&!B.isEmpty(i)&&Object(n.a)(this.placeHolderView.inViewDiv).css(i),this.isDetached=!1;var o=this._getFirstAttachStyle();this.$el.css(o),this.player.resize(this.model.get("width"),this.model.get("height")),this.listenTo(s.a,"window:orientation:change",this._recalculatePosition.bind(this)),this.listenTo(s.a,"window:resize:change",this._recalculatePosition.bind(this))}else switch(this.model.get("onOutOfView")){case"detach":this.isDetached=!1,this.$el.removeClass("_cm-os-slider-unit"),this.$el.removeClass("_cm-slider-"+this._sliderHorizontal),this.$el.removeClass("_cm-slider-"+this._sliderVertical),this._recalculatePosition(),this.player.resize(this.model.get("width"),this.model.get("height"));break;case"pause":this.player.resume()}},_getFirstAttachStyle:function(){var e={top:this._getTopOf()+"px",left:this._getLeftOf()+"px",display:"block",position:"absolute",height:this.model.get("height")+"px",width:this.model.get("width")+"px",transition:"height 1s"};return this.model.get("animation.onTransitionOpen")||(e.transition="height 0s"),e},_recalculatePosition:function(e){(e||this.placeHolderView.inViewDiv)&&(this.placeHolderView.resize(),B.skipTransitionCss(this.$el,{top:this._getTopOf()+"px",left:this._getLeftOf()+"px",height:this.model.get("height")+"px",width:this.model.get("width")+"px"}),this.player.resize(this.model.get("width"),this.model.get("height")))},_getTopOf:function(e){return e=e||this.placeHolderView.$placeHolder[0],this._isMarginSet()?window.pageYOffset+e.getBoundingClientRect().top:this.model.get("isUseOldGetTop")?Object(n.a)(e).offset().top:B.getTopOfEl(e)},_getLeftOf:function(e){return e=e||e||this.placeHolderView.$placeHolder[0],window.pageXOffset+e.getBoundingClientRect().left},_getSlideOutStyle:function(){var e={transition:this._detachHorizontal+" 1s !important"};return e[this._detachHorizontal]=-1*this._detachWidth+"px !important",e},_onStateChange:function(e,t){switch(t){case e.STATE.PLAYING:this._onPlaying();break;case e.STATE.STOPPED_BY_USER:case e.STATE.DONE:this._stopAd();break;case e.STATE.DETACHED:this._detach();break;case e.STATE.ATTACHED:this._attach()}},unMute:function(){this.player.unMute()},mute:function(){this.player.mute()},_onTimerFinish:function(){"closeButton"===this.model.get("components.TimerView.countdownAction")&&(this.closeButtonView=new o.b({model:this.model,container:this.el}),this.closeButtonView.render())},_setViewabilityListeners:function(){this.listenTo(s.a,"window:tab:change",this.checkViewability.bind(this,!0)),this.listenTo(s.a,"window:scroll:change",this.checkViewability.bind(this,!1)),this.checkViewability(!1)},checkViewability:function(e,t){if(this._playing)if(e&&t===p.a.TAB_STATE.tabOut)this.model.set("isPlayerViewable",!1);else{var i=this.$el.width(),n=B.getVideoHeight(i);this.model.set("isPlayerViewable",B.isViewable(this.el,i,n,50))}else this.model.set("isPlayerViewable",!0)},_isMarginSet:function(){var e=this.model.get("additionalCss");if(e)return Object.keys(e).filter((function(e){return e.indexOf("margin")>-1})).length}}),U=i(5),H=j.extend({className:"_cm-os-player",id:"_cm-css-reset",ui:{videoAd:"._cm-video-ad"},events:{"cm:timer:finish":"_onTimerFinish","cm:optout:submit":"_onOptOutStop"},initialize:function(e){this.log=new f.a({unitType:"InlineMultiSelect",className:"InStreamAdView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),j.prototype.initialize.call(this,e)},_bindEvents:function(){j.prototype._bindEvents.call(this),this.listenTo(s.a,"player:end",this._stopAd),this.listenTo(s.a,"cm:fd:data",this._onFdData)},_onPlayerClose:function(){this.model.set("state",this.model.STATE.DONE)},_onAdStopped:function(){j.prototype._onAdStopped.call(this),this.log.info("ad stopped")},_onPlaying:function(){this._playing?this.player.resume():(this.isFire99||(U.firePixel(this.model.getImpressionPixel(),"impression pixel (the ad is expanding)"),this.isFire99=!0),j.prototype._onPlaying.call(this))},_attach:function(e){if(e){var t=this.model.get("additionalCss");U.isObject(t)&&!U.isEmpty(t)&&this.$el.css(t);var i=this.model.get("placeholderCss");U.isObject(i)&&!U.isEmpty(i)&&Object(n.a)(this.placeHolderView.inViewDiv).css(i),this.isDetached=!1;var o=this._getFirstAttachStyle();this.$el.css(o),this.player.resize(this.model.get("width"),this.model.get("height")),this.listenTo(s.a,"window:orientation:change",this._recalculatePosition.bind(this)),this.listenTo(s.a,"window:resize:change",this._recalculatePosition.bind(this)),this.listenTo(s.a,"window:scroll:change",this._recalculatePosition.bind(this))}else switch(this.model.get("onOutOfView")){case"detach":this.isDetached=!1,this.$el.removeClass("_cm-os-slider-unit"),this.$el.removeClass("_cm-slider-"+this._sliderHorizontal),this.$el.removeClass("_cm-slider-"+this._sliderVertical),this._recalculatePosition(),this.player.resize(this.model.get("width"),this.model.get("height"));break;case"pause":this.player.resume()}j.prototype._attach.call(this,e)},_onFdData:function(e){this.player.setFdData(e)}}),W=(i(22),i(5));t.default=u.extend({className:"_cm-inline",ui:{videoDiv:"._cm-inline-video"},inViewCount:0,isLostEligibilityFired:!1,initialize:function(e){this.log=new f.a({unitType:"InlineInStreamMultiSelect",className:"PlaceHolderView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),u.prototype.initialize.call(this,e)},_bindEvents:function(){u.prototype._bindEvents.call(this),this.listenTo(s.a,"player:end",this._smartCollapse.bind(this))},_onViewablityChange:function(e,t){if(t){if(this.log.info("placeholder is in view"),this._done)return void this._collapse();this.inViewCount++,1===this.inViewCount&&W.firePixel(this.model.getPixel("pixels.eligible"),"inView (placeholder is viewable for the first time)"),e.get("state")===e.STATE.GOT_AD&&e.set("state",e.STATE.PLAYING),this._detached&&(this._detached=!1,this.inStreamAdView._attach())}else this.inViewCount>=1&&!this.isLostEligibilityFired&&!this._playing&&(W.firePixel(this.model.getPixel("pixels.lostEligibility"),"Lost eligibility (placeholder is not viewable for the first time)"),this.isLostEligibilityFired=!0),this._playing&&!this._detached&&(this._detached=!0,this.inStreamAdView._detach())},_smartCollapse:function(){this.log.important("Smart Collapse"),this._done=!0,this.inViewDiv&&this._collapse()},_createPlayer:function(){this.inStreamAdView=new H({model:this.model,placeHolderView:this})},_fetchViewability:function(){u.prototype._fetchViewability.call(this),this.listenTo(s.a,"window:orientation:change",this._onWindowPositionChange.bind(this)),this.listenTo(s.a,"window:resize:change",this._onWindowPositionChange.bind(this))},_onGotAd:function(){(this.model.get("isUnitViewable")||this._detached)&&this.model.set("state",this.model.STATE.PLAYING)},_onPlaying:function(){W.firePixel(this.model.getPixel("pixels.conversion"),"conversion (the ad is expanding)"),this._playing||(u.prototype._onPlaying.call(this),this._playing=!0)}})},function(e,t,i){"use strict";i.r(t);var n=i(36),o=i.n(n),r=(i(75),i(0)),s=i(15),a=i(12),l=(i(1),i(4));function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.syncUrl=t.get("sync"),this.syncUrl&&(this.log=new l.a({unitType:t.get("unitType"),className:this.constructor.name,version:t.get("version"),isDebug:t.get("isDebug")}),this.timePredict=new a.s({model:t,onPredict:this._syncCookies.bind(this),predictKey:"cookieSync",modelKey:"predictors.time.cookieSync"}),this._syncCookies())}var t,i;return t=e,(i=[{key:"_syncCookies",value:function(){var e=this;this.log.info("Cookie sync request",this.syncUrl);var t=document.createElement("iframe");t.style.display="none",t.src=this.syncUrl,t.onerror=function(){e._stopSync()},document.body.appendChild(t)}},{key:"_stopSync",value:function(){this.log.info("Stopping cookie sync"),this.timePredict.stop()}}])&&c(t.prototype,i),e}(),u=i(9),h=i(57),p=i.n(h),f=i(34),m=i(3),g=i(5),y=(i(10),i(94)),v=m.View.extend({className:"_cm-panel",id:"_cm-css-reset",events:{"click ._cm-close-button":"_onCloseButtonClick","click ._cm-panel-submit":"_onSubmitButtonClick"},container:Object(r.a)("body"),ui:{},initialize:function(e){this.render(),this.ui.name=this.$("._cm-panel-name"),this.ui.email=this.$("._cm-panel-email"),this.ui.details=this.$("._cm-panel-details"),this.ui.success=this.$("._cm-panel-notifications-success"),this.ui.error=this.$("._cm-panel-notifications-error"),this.ui.sending=this.$("._cm-panel-notifications-sending"),this.ui.btnSend=this.$("._cm-panel-submit"),this._hideText(),this._bindEvents()},render:function(){this.$el.append(y),this.container.append(this.el)},_bindEvents:function(){this.listenTo(this.model,"save:success",this._onSaveSuccess)},_onCloseButtonClick:function(){this.$el.hide(),m.trigger("supportTool:event","close")},_onSubmitButtonClick:function(){this._validateForm()&&(this.ui.btnSend[0].disabled=!0,this.model.set({name:this.ui.name.val(),email:this.ui.email.val(),details:this.ui.details.val()}),this.ui.sending.show(),this.model.save())},_validateForm:function(){return this.ui.email.val()&&g.isValidEmail(this.ui.email.val())?(this.ui.email.removeClass("_cm-panel-error"),!0):(this.ui.email.addClass("_cm-panel-error"),!1)},_onSaveSuccess:function(){this._hideText(),this.ui.success.show()},_hideText:function(){this.ui.success.hide(),this.ui.sending.hide(),this.ui.error.hide()}}),b=i(3),_=i(5),w=b.DeepModel.extend({initialize:function(e){var t=r.a.extend(!0,{},e.creativeData),i=r.a.extend(!0,{},e.unitModel);delete t.iframeData,delete t.placementElement,delete i.iframeData,delete i.placementElement,this.set("creativeData",JSON.stringify(t)),this.set("unitModel",JSON.stringify(i)),this.set({userAgent:window.navigator.userAgent,date:new Date,url:window.location.href}),this.set("vpaidLogs",JSON.stringify(e.vpaidLogs)),e.dp&&this.set("demandPartner",e.dp)},save:function(){_.sendMail(this.attributes,this._onSaveSuccess.bind(this),this._onSaveError.bind(this))},_onSaveSuccess:function(){this.trigger("save:success")},_onSaveError:function(){this.trigger("save:error")}}),T=i(14),S=window.define;window.define=null;var A=i(5),P=(i(73),i(74),i(3));window.define=S;var E=i(1),C=i(76),k=i(77),O=i(7),I=i(78);window.startCMTagMain=function(e,t){var n,a,l,c=!1;I.beforeCMTag(e);var h={INLINE:function(){},INLINE_INSTREAM:function(){if(function(e){var t=!1;return e["vForce.isActive"]?t=A.parseBool(e["vForce.isActive"]):e.vForce&&e.vForce.isActive&&(t=e.vForce.isActive),t}(e)){e.unitName="INLINE_INSTREAM_VFORCE";var t=e.isMobile?i(95).default:i(96).default;g(e.instream&&e.instream.isActive?i(110).default:i(113).default,l=b(t,e),void 0,!1)}else{e.unitName="INLINE_INSTREAM_OLD";var n=e.isMobile?i(108).default:i(109).default;g(i(111).default,l=b(n,e),e.placementElement,!1)}},SLIDER_OUTSTREAM:function(){},SLIDER_INSTREAM:function(){},"300X600":function(){},EXPANDABLE:function(){},WIDGET_ITEM:function(){},FEED_MANAGER:function(){},MSN_WIDGET:function(){},RECO_REEL_WIDGET:function(){},CUSTOM:function(){}},m={unit:void 0,model:void 0,placement:void 0,isUnitPlay:!1};function g(t,i,n,o){A.parseBool(e.isWaitForStartEvent)?(m.unit=t,m.model=i,m.placement=n,m.isUnitPlay=o,i.fireUnitDelayedPixel(),window.TRC=window.TRC||{},window.TRCImpl=window.TRCImpl||{},window.TRC.videoFunctions={},window.TRC.videoFunctions.startEvent=function(){c||(m.model.fireUnitLoadAfterDelayPixel(),y(m.unit,m.model,m.placement,m.isUnitPlay),c=!0)}):y(t,i,n,o)}function y(e,i,n,o){var r=new e({model:i,placementElement:n});o&&(t.play=r.play.bind(r))}function b(i,n){A.trcPerformanceMeasurement(n.trcPerformanceMeasurementEnabled,"videoCreateUnitModel".concat(n.perfUnitType),E.TRC_PERFORMANCE_ACTIONS.START);var o=new P.DeepModel;o.set(n),t&&t._settings&&(cmTag&&cmTag.logger&&cmTag.logger.info("settings by FPP",t._settings),o.set(t._settings)),function(e){if(e.onPassback)e.isApiPassbackExist=!0;else{if(TRC&&TRC._taboolaClone)for(var t=0;t<TRC._taboolaClone.length;t++)if("video.passback"==TRC._taboolaClone[t].listenTo)return void(e.isApiPassbackExist=!0);e.isApiPassbackExist=!1}}(o.attributes),new k(o.attributes);var r=new i(o.attributes);return A.parseBool(e.isUseCMP)?new u.f(r):r.set("canStartPlayer",!0),function(e){if(!0===e.get("isOppsulaEnabled")){var t={version:e.get("microServices.oppsula.version"),model:e},i=new u.h(t);O.oppsula=i}}(r),function(e){O.serviceLoader.get("video-autoplay-detector",e.get("microServices.autoplayDetector.version"),(function(t){O.autoPlayDetector=new t(e.handleAutoPlayData.bind(e),{isMobile:e.get("isMobile"),timeout:1e3*e.get("autoplayDetectorTimeoutSec")})}))}(r),A.trcPerformanceMeasurement(n.trcPerformanceMeasurementEnabled,"videoCreateUnitModel".concat(n.perfUnitType),E.TRC_PERFORMANCE_ACTIONS.STOP),r}function _(t){"open"===t?(l.set("supportTool",{isOpen:!0}),function(){if(!n&&"OMNI_TAG"!==e.unitType){var t,i=O.player&&O.player.getVpaidLogs?O.player.getVpaidLogs():void 0;l.set("supportTool",{isOpen:!0}),O&&O.supportTool&&O.supportTool.dp&&(t=O.supportTool.dp);var o={creativeData:e,vpaidLogs:A.stripObject(A.arrayToObj(i),[],!0,!0,!0)};o.unitModel=A.stripObject(l.attributes,[],!0,!0,!0),t&&(o.dp=t),a=new w(o),n=new v({model:a})}}()):(l.set("supportTool",{isOpen:!1}),n.remove(),n=null,a=null)}function S(){window.TRC=window.TRC||{},P.$=r.a,A.templateSettings={interpolate:/\{\{(.+?)\}\}/g},cmTag.logger||(cmTag.logger=new f.a(e)),e.documentReadyState=document.readyState,cmTag&&cmTag.logger&&cmTag.logger.info("init",e),cmTag.utils=A,cmTag.$=r.a,t&&(t._events&&(t._events.forEach((function(e){P.on(e.name,e.cb)})),t.on=function(e,t){P.on(e,t)}),t.trigger=function(e,t){P.trigger(e,t)}),cmTag.config||(cmTag.config=e);var i=window;A.isInFriendlyIframe(cmTag.config.iframeData)&&(i=A.getTopWindow()),e.isHideIframe&&A.hideDFPIframe(e.iframeData),!0!==e.hasSupportTool&&"true"!==e.hasSupportTool||P.on("supportTool:event",_),cmTag.config.scrollSelector?(new s.a(i,cmTag.config.scrollSelector),new T.a(e,i,cmTag.config.scrollSelector)):(new s.a(i),new T.a(e,i)),function(){var e=new P.DeepModel;e.set({microServices:O.microServices}),e.set(cmTag.config);var t=e.get("microServices");o.a.init(t),O.serviceLoader=o.a,function(e){O.serviceLoader.get("PMS",e.PMS.version,R.bind(this),R.bind(this,p.a))}(t)}()}function R(t){cmTag&&cmTag.logger&&cmTag.logger.info("PMS Loaded");var i=new t;O.pms=i,function(){var t;if(e.perfUnitType=(t=e.unitType.replace(/_/g,"").toLowerCase(),"".concat(t.charAt(0).toUpperCase()).concat(t.substring(1))),A.trcPerformanceMeasurement(e.trcPerformanceMeasurementEnabled,"videoInitToRender".concat(e.perfUnitType),E.TRC_PERFORMANCE_ACTIONS.START),e.unitName=e.unitType,e.urlPrefix){var i=e.urlPrefix.split("/");e.unitVersion=i[i.length-2],e.unitVersion=e.unitVersion.replace(/_/g,"")}else e.unitVersion=e.version.replace(/_/g,"");h[e.unitType](),l.get("multiUnitManager.isActive")&&C.addUnit(l.get("redId"),l),l.get("cookieMatchActive")&&new d(l)}(),cmTag.units=cmTag.units||{},cmTag.units[A.now()]=e}A.parseBool(e.isStartUnitOnWindowLoaded)?("complete"===document.readyState&&S(),document.onreadystatechange=function(){"complete"===document.readyState&&setTimeout(S,0)}):Object(r.a)("document").ready(S)},t.default=window.cmTag},function(e,t,i){"use strict";i.r(t);var n=i(0),o=i(33),r=i(3),s=i.n(r),a=i(2),l=i(4),c=i(6),d=i(22),u=i.n(d),h=i(1),p=i.n(h),f=i(8);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=i(5),T={title:"._cm-ad-title",placeholder:"._cm-inline-video"},S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=_(e);if(t){var o=_(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return b(this,i)}}(r);function r(){return g(this,r),o.apply(this,arguments)}return t=r,(i=[{key:"initialize",value:function(e){this.log=new l.a({unitType:this.model.get("unitType"),className:"SingleInlineContainerView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.template=u.a,this.container=e.container,this.isExpanded=!1,this.model.set("containerViewState",a.readyState),this._bindEvents(),this.render()}},{key:"_bindEvents",value:function(){this.listenTo(s.a,"window:orientation:change",this._calcPlaceholderSize.bind(this,!1)),this.listenTo(s.a,"window:resize:change",this._calcPlaceholderSize.bind(this,!1)),this.createStateHandlers([{event:"adState:playing",funcName:"_expend",isListenOnce:!0},{event:"playerState:closed",funcName:"close",isListenOnce:!0},{event:"playerState:error",funcName:"close",isListenOnce:!0},{event:"closeState:closeUnit",funcName:"close",isListenOnce:!0},{event:"aspectRatioNum",funcName:"onAspectRatioChange"},{event:"playerState:restarted",funcName:"_onPlayerStateReady"}])}},{key:"render",value:function(){this.renderTemplate(),this._customize(),this._addAdChoice(),this.el.id="_cm-css-reset",this.model.get("placementElement")&&this.model.get("appendType")===p.a.APPEND_TYPE.beforebegin?Object(n.a)(this.container).before(this.el):this.container.append(this.el),this.placeholder=this.ui.placeholder[0],this.$placeholder=Object(n.a)(this.placeholder),this.model.set("containerViewPlaceHolder",this.placeholder),this.model.set("containerViewState",a.containerViewState.rendered),this._initHeight()}},{key:"_expend",value:function(){this.log.info("expending view"),this._customizeContainer(),this._calcPlaceholderSize(!0);var e=this.ui.placeholder.width(),t=this.getVideoHeightByRatio(e)+this.ui.title.height();this.model.get("animation.onTransitionOpen")||this.$el.addClass("none-transition"),w.oneAnimationEnd(this.$el,this._onExpandEnd.bind(this)),this.$el.css({height:t}),this.isExpanded=!0,setTimeout(window.scrollBy.bind(window,0,1),1e3),this.model.set("width",e),this.model.set("height",t),this.model.set("videoPlaceholderSize",{height:t,width:e}),this.model.trigger("change:videoPlaceholderSize",{height:t,width:e})}},{key:"_onExpandEnd",value:function(){this.model.set("isExpandEnded",!0)}},{key:"_collapse",value:function(){this.log.info("collapsing view"),this._initHeight(),setTimeout(function(){this.hide()}.bind(this),1e3)}},{key:"onAspectRatioChange",value:function(e,t){this.log.info("onAspectRatioChange",t),this._calcPlaceholderSize()}},{key:"_calcPlaceholderSize",value:function(e){if(this.isExpanded||e){var t=Object(n.a)(this.container).width(),i=this.getVideoHeightByRatio(t);this.model.set("width",t),this.model.set("height",i),this._resizeOnTransitionAnimation(),this.$el.css({height:i+this.ui.title.height(),width:t}),this.model.set("videoPlaceholderSize",{height:i,width:t}),this.model.trigger("change:videoPlaceholderSize",{height:i,width:t})}}},{key:"getVideoHeightByRatio",value:function(e){return this.model.isVerticalVideoEnabled(e)?w.getVideoHeightByRatio(e,this.model.get("aspectRatioNum")):w.getVideoHeight(e)}},{key:"_resizeOnTransitionAnimation",value:function(){this.model.get("animation.onTransitionOpen")&&this.isExpanded&&(this.$el.addClass("none-transition"),setTimeout(function(){this.$el.removeClass("none-transition")}.bind(this),1e3))}},{key:"hide",value:function(){this.$el.hide()}},{key:"close",value:function(e){!this.model.get("isReplayAd")||e?(this.model.set("closeState",a.closeState.containerViewClosed),this._collapse(),this.isExpanded=!1):this.model.set("closeState",!1,{silent:!0})}},{key:"_initHeight",value:function(){Object(n.a)(this.el).css({height:"0px",width:this.model.get("width")})}},{key:"_customize",value:function(){var e=this.model.get("customization.placeHolder"),t=this.model.get("customization.adTitle");this.ui.title.append(this.model.get("unitTitle")),this.$el.height("auto"),this.ui.title.css(w.toCssObj(t)),this.ui.placeholder.css(w.toCssObj(e))}},{key:"_customizeContainer",value:function(){var e=this.model.get("customization.unitContainer");this.$el.css(w.toCssObj(e))}},{key:"_addAdChoice",value:function(){this.model.get("components.adChoice.isActive")&&this.model.get("components.adChoice.title.isActive")&&(this.adChoice=new f.a({model:this.model,container:this.ui.title,type:p.a.AD_CHOICE_TYPE.TITLE}))}},{key:"className",get:function(){return"_cm-single-inline"}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=T},set:function(e){return this.UI=e}}])&&y(t.prototype,i),r}(c.b),A=i(19);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=i(5),V={title:"._cm-ad-title",placeholder:"._cm-inline-video"},D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=I(e);if(t){var o=I(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return O(this,i)}}(r);function r(){return E(this,r),o.apply(this,arguments)}return t=r,(i=[{key:"initialize",value:function(e){this.log=new l.a({unitType:this.model.get("unitType"),className:"MultiInlineContainerView",version:this.model.get("version"),isDebug:this.model.get("isDebug")}),this.log.info("Init MultiInlineContainerView"),this.template=u.a,this.isExpanded=!1,this.appendType=p.a.APPEND_TYPE[this.model.get("appendType")],this.model.set("containerViewState",a.readyState),this._bindEvents(),this._backwardCapability()}},{key:"_bindEvents",value:function(){this.listenTo(s.a,"window:orientation:change",this._calcRepositionAndResize.bind(this)),this.listenTo(s.a,"window:resize:change",this._calcRepositionAndResize.bind(this)),this.createStateHandlers([{event:"eligiblePlaceholder",funcName:"render",isListenOnce:!0},{event:"adState:playing",funcName:"_expend",isListenOnce:!0},{event:"playerState:error",funcName:"close",isListenOnce:!0},{event:"closeState:closeUnit",funcName:"close",isListenOnce:!0},{event:"aspectRatioNum",funcName:"onAspectRatioChange"}])}},{key:"render",value:function(){this.$el.css("background","transparent"),this.renderTemplate(),this._addAdChoice(),this.el.id="_cm-css-reset",this.container=this.model.get("eligiblePlaceholder"),Object(n.a)(this.container).after(this.el),this.model.set("containerViewPlaceHolder",this.ui.placeholder[0]),this._addNativeAd(this.container),this._initHeight(),this._calcRepositionAndResize()}},{key:"_expend",value:function(){this.log.info("Expending Multi selector Inline Container View"),this.model.get("animation.onTransitionOpen")||this.$el.addClass("none-transition"),this._customize(),this._calcPlaceholderPosition(),this.model.set("containerViewState",a.containerViewState.rendered),this._calcPlaceholderSize(),this.isExpanded=!0,this.model.set("isExpanded",!0)}},{key:"close",value:function(e){!this.model.get("isReplayAd")||e?(this.model.set("closeState",a.closeState.containerViewClosed),this._collapse(),this.isExpanded=!1,this.nativeAdView&&this.nativeAdView.hide()):this.model.set("closeState",!1,{silent:!0})}},{key:"_collapse",value:function(){this.log.info("Collapsing inline container view"),this.model.get("animation.onTransitionClose")&&this.isExpanded?(this.$el.removeClass("none-transition"),setTimeout(function(){this.$el.hide()}.bind(this),1e3)):(this.$el.addClass("none-transition"),this.$el.hide()),this._initHeight(),this.ui.title.hide()}},{key:"_initHeight",value:function(){this.$el.css({height:"0px",width:this.model.get("width")})}},{key:"_calcRepositionAndResize",value:function(){this.isExpanded&&(this._calcPlaceholderSize(),this._calcPlaceholderPosition())}},{key:"onAspectRatioChange",value:function(e,t){this.log.info("onAspectRatioChange",t),this._calcRepositionAndResize()}},{key:"_calcPlaceholderSize",value:function(){var e=Object(n.a)(this.container).width(),t=this.getVideoHeightByRatio(e);this.model.set("width",e),this.model.set("height",t),this.$el.css({height:t+this.ui.title.height(),width:e}),this.isExpanded&&this._removeAnimationClass(),this.model.set("videoPlaceholderSize",{height:t,width:e}),this.model.trigger("change:videoPlaceholderSize",this.model,{height:t,width:e})}},{key:"getVideoHeightByRatio",value:function(e){return this.model.isVerticalVideoEnabled(e)?R.getVideoHeightByRatio(e,this.model.get("aspectRatioNum")):R.getVideoHeight(e)}},{key:"_calcPlaceholderPosition",value:function(){var e=R.getOffset(this.ui.placeholder,this.model.get("offsetGetterType"));this.model.set("videoPlaceholderPosition",{top:e.top,left:e.left}),this.model.trigger("change:videoPlaceholderPosition",this.model,{top:e.top,left:e.left})}},{key:"_removeAnimationClass",value:function(){this.model.get("animation.onTransitionOpen")&&this.isExpanded&&(this.$el.addClass("none-transition"),setTimeout(function(){this.$el.removeClass("none-transition")}.bind(this),1e3))}},{key:"_backwardCapability",value:function(){(this.model.get("animation.onTransitionOpen")||this.model.get("animation.onTransitionClose"))&&this.model.set("openingEffect",6)}},{key:"hide",value:function(){this.$el.hide()}},{key:"_customize",value:function(){var e=this.model.get("customization"),t=this.model.get("unitTitle");t&&this.ui.title.append(t),R.isEmpty(e.placeholder)&&R.isEmpty(e.unitContainer)&&R.isEmpty(e.adTitle)||(this.$el.css(R.toCssObj(e.unitContainer)),this.ui.title.css(R.toCssObj(e.adTitle)),this.ui.placeholder.css(R.toCssObj(e.placeholder)))}},{key:"_addAdChoice",value:function(){this.model.get("components.adChoice.isActive")&&this.model.get("components.adChoice.title.isActive")&&(this.adChoice=new f.a({model:this.model,container:this.ui.title,type:p.a.AD_CHOICE_TYPE.TITLE}))}},{key:"_addNativeAd",value:function(e){var t=e.parentElement;this.model.get("components.nativeAd.isActive")&&t&&(this.nativeAdView=new A.a({model:this.model,globalModel:this.model,container:t,additionalCss:"_cm-native-ad-inline"}))}},{key:"className",get:function(){return"_cm-single-inline"}},{key:"ui",get:function(){return this.UI?this.UI:this.UI=V},set:function(e){return this.UI=e}}])&&C(t.prototype,i),r}(c.b),x=i(16),N=i.n(x),M=i(18);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function B(e,t,i){return(B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=H(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(i):o.value}})(e,t,i||e)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var W=i(5),z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=H(e);if(t){var o=H(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return U(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e)).$el.addClass("_cm-video"),t.template=N.a,t.container=e.container||"body",t.isFirstAttach=!0,t.render(),t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"_resize",withBind:!1},{event:"videoPlaceholderPosition",funcName:"_rePosition",withBind:!1},{event:"containerViewState:rendered",funcName:"attach"},{event:"adState:repeating",funcName:"playAd"},{event:"adState:completed",funcName:"_onAdComplete"},{event:"repeatState:clicked",funcName:"_onLoadingClick"},{event:"loadingViewState:clicked",funcName:"_onLoadingClick"},{event:"learnMoreWasClicked",funcName:"_onLearnMoreClick"},{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"eligiblePlaceholder",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"videoViewState:detached",funcName:"checkEligible"},{event:"hasReadyAd:true",funcName:"checkEligible"}]),this._setVolumeEvents()}},{key:"render",value:function(){this.renderTemplate(),this._customize(),this.ui.video[0].id=this.videoAdId,this.$el.css({width:this.model.get("width")}),Object(n.a)(this.container).append(this.el),this.model.set("videoViewContainer",this.ui.video[0]),this.model.set("targetId",this.videoAdId),this.model.set("videoViewState",a.videoViewState.rendered),this._addDisclosureText(),W.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoInitToRender".concat(this.model.get("perfUnitType")),h.TRC_PERFORMANCE_ACTIONS.STOP)}},{key:"attach",value:function(){if(this.log.info("attaching to placeholder"),this._rePosition(this.model,this.model.get("videoPlaceholderPosition")),this._resize(this.model,this.model.get("videoPlaceholderSize")),this.isFirstAttach){W.oneAnimationEnd(this.$el,function(){s.a.trigger("renderAnimation:completed"),this.$el.removeClass("animated"),this.$el.removeClass("slideInTop"),this.$el.removeClass("flip"),this.$el.removeClass("slideInLeft"),this.$el.removeClass("fadeIn"),this.$el.removeClass("zoomIn"),this.model.get("animation.onTransitionClose")?this.$el.addClass("inlineSlideTop"):this.$el.removeClass("inlineSlideTop")}.bind(this));var e=this.model.get("openingEffect");0===e||(1===e?(this.$el.addClass("slideInTop"),this.$el.addClass("animated")):2===e?(this.$el.addClass("flip"),this.$el.addClass("animated")):3===e?(this.$el.addClass("slideInLeft"),this.$el.addClass("animated")):4===e?(this.$el.addClass("fadeIn"),this.$el.addClass("animated")):5===e?(this.$el.addClass("zoomIn"),this.$el.addClass("animated")):6===e&&this.model.get("animation.onTransitionOpen")&&this.$el.addClass("inlineSlideTop")),this.isFirstAttach=!1}this.model.set("videoViewState",a.videoViewState.attached)}},{key:"playAd",value:function(){B(H(r.prototype),"playAd",this).call(this),this._resize(this.model,this.model.get("videoPlaceholderSize"))}},{key:"_onAdComplete",value:function(){this.setRepeatingAd(),this.activeAd=void 0,this.model.get("isMultiAd")||this.repeatingAd?(this.isViewed=!1,this.isViewed100=!1,this.model.get("isReplayAd")||this.checkEligible()):this.model.set("closeState",a.closeState.terminate)}},{key:"detach",value:function(){}},{key:"hide",value:function(){this.$el.css("height","0px")}},{key:"close",value:function(){this.hide(),M.a.prototype.close.call(this)}},{key:"_resize",value:function(e,t){t&&((this.model.get("animation.onTransitionOpen")||6===this.model.get("openingEffect"))&&this.model.get("isExpanded")&&(this.$el.addClass("none-transition"),setTimeout(function(){this.$el.removeClass("none-transition")}.bind(this),1e3)),this.ui.video.css(t),this.$el.css(t),this.activeAd&&this.activeAd.resize(t))}},{key:"isEligibleToPlay",value:function(){return!("pause"===this.model.get("onOutOfView")&&!this.model.get("isInTab"))&&this.model.get("isEligibleToPlay")&&this.model.get("eligiblePlaceholder")}}])&&F(t.prototype,i),r}(M.a);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e,t,i){return(G="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=K(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(i):o.value}})(e,t,i||e)}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var X=i(5),Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=K(e);if(t){var o=K(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Q(this,i)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e)).template=N.a,t.container=e.container||"body",t}return t=r,(i=[{key:"_bindEvents",value:function(){this.createStateHandlers([{event:"videoPlaceholderSize",funcName:"_resize",withBind:!1},{event:"containerViewState:rendered",funcName:"render",isListenOnce:!0},{event:"isEligibleToPlay",funcName:"checkEligible"},{event:"isInTab",funcName:"checkEligible"},{event:"hasReadyAd:true",funcName:"checkEligible"},{event:"adState:completed",funcName:"_onAdComplete"},{event:"adState:repeating",funcName:"playAd"},{event:"loadingViewState:clicked",funcName:"_onLoadingClick"},{event:"repeatState:clicked",funcName:"_onLoadingClick"},{event:"learnMoreWasClicked",funcName:"_onLearnMoreClick"}]),this._setVolumeEvents()}},{key:"render",value:function(){var e=this.model.get("containerViewPlaceHolder");this.renderTemplate(),this._customize(),this.ui.video[0].id=this.videoAdId,this.$el=Object(n.a)(this.el),Object(n.a)(e).append(this.$el),this.model.set("width",this.$el.width()),this.model.set("height",X.getVideoHeight(this.$el.width())),this._resize({width:this.model.get("width"),height:this.model.get("height")}),this.model.set("videoViewState",a.videoViewState.rendered),this.model.set("videoViewContainer",this.el),this.model.set("targetId",this.videoAdId),X.trcPerformanceMeasurement(this.model.get("trcPerformanceMeasurementEnabled"),"videoInitToRender".concat(this.model.get("perfUnitTypes")),h.TRC_PERFORMANCE_ACTIONS.STOP)}},{key:"playAd",value:function(){G(K(r.prototype),"playAd",this).call(this),this._resize(this.model.get("videoPlaceholderSize"))}},{key:"_onAdComplete",value:function(){this.setRepeatingAd(),this.activeAd=void 0,this.model.get("isMultiAd")||this.repeatingAd?this.model.get("isReplayAd")||this.checkEligible():this.model.set("closeState",a.closeState.terminate)}},{key:"detach",value:function(){}},{key:"close",value:function(){this.hide(),M.a.prototype.close.call(this)}},{key:"_resize",value:function(e){Object(n.a)(this.ui.video[0]).css(e),this.activeAd&&this.activeAd.resize(e)}}])&&q(t.prototype,i),r}(M.a),J=i(15),ee=i(9);function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e,t){return!t||"object"!==te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function re(e){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se=i(5),ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(r,e);var t,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=re(e);if(t){var o=re(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return oe(this,i)}}(r);function r(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var i=(t=o.call(this,e)).model.get("parentSelector");return t._initInline(i),t}return t=r,(i=[{key:"_initInline",value:function(e){if(e){var t=this._getValidSelectors(e.toString());if(se.isEmpty(t)&&(t=this._getPlacementSelector(),this.log.info("Looking for placement element",t)),se.isEmpty(t))return this.log.error("No valid selectors found! Wait if rescan is active or choose other selector.",t),void this._startRescanIfActive();this.createStateHandlers([{event:"playerState:ready",funcName:"_onPlayerStateReady",isListenOnce:!0}]),this.isSingleSelector=1===t.length,this.isSingleSelector?this._startSingleSelector(t):(this.createStateHandlers([{event:"isEligibleToPlay",funcName:"_onEligiblePlaceHolderForMultiSelector",isListenOnce:!0}]),this._startMultiSelector(t))}else{var i=this._getPlacementSelector();if(this.log.info("Looking for placement element",i),se.isEmpty(i))return void this.log.error("No valid selectors found! Choose other selector.",i);this.createStateHandlers([{event:"playerState:ready",funcName:"_onPlayerStateReady",isListenOnce:!0}]),this._startSingleSelector(i)}}},{key:"_getPlacementSelector",value:function(){if(this.model.get("isUsePlacementElement")){var e=this.model.get("placementElement");if(e&&e instanceof HTMLElement)return this.model.set("appendType",p.a.APPEND_TYPE.beforebegin),[e];var t="_cm_videoUnit_placeHolder"+this.model.get("redId"),i=document.getElementById(t);if(this._isValidPlacementElement(i)){for(;!i.parentNode.offsetWidth||i.parentNode.offsetWidth<100;)i=i.parentNode;return[i.parentNode]}return[]}return[]}},{key:"_startRescanIfActive",value:function(){if(this.model.get("rescan.isActive")){var e=this.model.get("rescan.intervalSeconds");this.scanerInerval=setInterval(function(){this.log.info("Rescanning DOM for selectors");var e=this.model.get("parentSelector"),t=Object(n.a)(e.toString());se.isEmpty(t)||(this.log.info("Stopping rescan."),clearInterval(this.scanerInerval),this._initInline(e))}.bind(this),1e3*e)}}},{key:"_getValidSelectors",value:function(e){var t=Object(n.a)(e.toString());return se.getValidSelectorElements(t)}},{key:"_onEligiblePlaceHolderForMultiSelector",value:function(){this.containerView=new D({model:this.model})}},{key:"_startMultiSelector",value:function(e){this.log.info("Starting Inline Multi Selector"),this.log.info("Found parentSelector ",e),this.model.set("subUnitType",p.a.SUB_UNIT_TYPE.INLINE_MULTI_SELECTOR),this._initWidth(e),this.windowEventManager=Object(J.a)(),this._initKebana(),this.adService=new ee.a(this.model,this.kibana),this.seerService=new ee.l(this.model),this.pixelsService=new ee.i(this.model),this.eligibilityService=new ee.d(this.model,e),this.playerLoader=new ee.k(this.model),this.videoView=new z({model:this.model}),this.playerService=new ee.j(this.model),this._setComponents(this.videoView.el)}},{key:"_startSingleSelector",value:function(e){this.log.info("Starting Inline Single Selector"),this.model.set("subUnitType",p.a.SUB_UNIT_TYPE.INLINE_SINGLE_SELECTOR);var t=Object(n.a)(e[0]);this.log.info("Found parentSelector ",t),this.windowEventManager=Object(J.a)(),this._initKebana(),this.adService=new ee.a(this.model,this.kibana),this.seerService=new ee.l(this.model),this.pixelsService=new ee.i(this.model),this.eligibilityService=new ee.d(this.model,t),this.playerLoader=new ee.k(this.model),this.videoView=new Z({model:this.model}),this.containerView=new S({model:this.model,container:t}),this.playerService=new ee.j(this.model),this._addNativeAd(t),this._setComponents(this.containerView.el)}},{key:"_setComponents",value:function(e){var t={model:this.model,container:e};this.loadingView=new f.e(t),this.repeatView=new f.g(t),this.repeatView.addAdditionalCss("_cm-inline-repeat"),this._addCloseButton(),this._addOptOutButton(),this._addAdChoice(),this._addVolumeButton()}},{key:"_addCloseButton",value:function(){!0===se.parseBool(this.model.get("closeButton.hasCloseButton"))&&(this.closeButtonView=new f.b({model:this.model,container:this.model.get("videoViewContainer")}),this.closeButtonView.render())}},{key:"_addOptOutButton",value:function(){se.parseBool(this.model.get("components.OptOut.hasOptOut"))&&(this.optOutView=new f.f({model:this.model,container:this.model.get("videoViewContainer")}))}},{key:"_addAdChoice",value:function(){this.model.get("components.adChoice.isActive")&&(this.adChoice=new f.a({model:this.model,container:this.model.get("videoViewContainer"),type:p.a.AD_CHOICE_TYPE.VIDEO_AD}))}},{key:"_addVolumeButton",value:function(){this.model.get("components.volume.isActive")&&(this.volume=new f.i({model:this.model,container:this.model.get("videoViewContainer")}))}},{key:"_initWidth",value:function(e){this.model.get("width")||this.model.set("width",parseInt(getComputedStyle(e[0]).width))}},{key:"_isValidPlacementElement",value:function(e){var t;return e||(t="Cant find placementElement - something went very wrong."),e&&this._isInHead(e)&&(t="The creative was placed in HEAD element - can't open video here."),!t||(this.log.error(t),!1)}},{key:"_isInHead",value:function(e){for(;e!==document.body&&e!==document.head;)e=e.parentNode;return e===document.head}},{key:"_initKebana",value:function(){this.shouldReport=se.isFactor(this.model.get("gaFactor")),this.shouldReport&&this.model.get("isReportToKibana")&&(this.model.set("gaFactor",1),this.kibana=new ee.g({model:this.model}))}},{key:"_addNativeAd",value:function(e){this.model.get("components.nativeAd.isActive")&&(this.nativeAdView=new A.a({model:this.model,globalModel:this.model,container:e,additionalCss:"_cm-native-ad-inline"}))}}])&&ie(t.prototype,i),r}(o.a);t.default=ae}]);}catch(ex){if(window.location.href.lastIndexOf('cm_isDebug=true')!=-1 || window.location.href.lastIndexOf('cm_isDebug=1')!=-1 ){console.log(e);}}