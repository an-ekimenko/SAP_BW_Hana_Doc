<!DOCTYPE html>
<html id="arve" class="slb" lang="ru-RU"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<script type="text/javascript" src="ABAP%20Managed%20Database%20Procedures_files/profile.js" async="" defer="defer"></script>
		<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="http://abap-blog.ru/xmlrpc.php">
	
	<title>ABAP Blog | ABAP Managed Database Procedures (AMDP)</title>

<!-- All in One SEO Pack 2.4.5.1 by Michael Torbert of Semper Fi Web Design[449,513] -->
<meta name="keywords" content="amdp,native sql,Работа с БД">

<link rel="canonical" href="http://abap-blog.ru/database-work/abap-managed-database-procedures-amdp/">
			<script type="text/javascript">
				window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
				ga('create', 'UA-47423267-1', 'auto');
				// Plugins
				
				ga('send', 'pageview');
			</script>
			<script async="" src="ABAP%20Managed%20Database%20Procedures_files/analytics.js"></script>
			<!-- /all in one seo pack -->
<link rel="dns-prefetch" href="http://fonts.googleapis.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="ABAP Blog » Лента" href="http://abap-blog.ru/feed/">
<link rel="alternate" type="application/rss+xml" title="ABAP Blog » Лента комментариев" href="http://abap-blog.ru/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="ABAP Blog » Лента комментариев к «ABAP Managed Database Procedures (AMDP)»" href="http://abap-blog.ru/database-work/abap-managed-database-procedures-amdp/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/abap-blog.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.4"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="ABAP%20Managed%20Database%20Procedures_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="ABAP%20Managed%20Database%20Procedures_files/crayon.css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-copy-css" href="ABAP%20Managed%20Database%20Procedures_files/classic-copy.css" media="all">
<link rel="stylesheet" id="crayon-font-consolas-css" href="ABAP%20Managed%20Database%20Procedures_files/consolas.css" media="all">
<link rel="stylesheet" id="disqus_rcw-css" href="ABAP%20Managed%20Database%20Procedures_files/disqus_rcw.css" media="all">
<link rel="stylesheet" id="flat-fonts-css" href="ABAP%20Managed%20Database%20Procedures_files/css.css" media="all">
<link rel="stylesheet" id="flat-theme-css" href="ABAP%20Managed%20Database%20Procedures_files/flat.css" media="all">
<link rel="stylesheet" id="flat-style-css" href="ABAP%20Managed%20Database%20Procedures_files/style_003.css" media="all">
<link rel="stylesheet" id="slb_core-css" href="ABAP%20Managed%20Database%20Procedures_files/app.css" media="all">
<script src="ABAP%20Managed%20Database%20Procedures_files/jquery.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/abap-blog.ru\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="ABAP%20Managed%20Database%20Procedures_files/crayon.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/image-captcha.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/rss-slider-on-post.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/flat.js"></script>
<!--[if lt IE 9]>
<script src='http://abap-blog.ru/wp-content/themes/flat/assets/js/html5shiv.min.js?ver=3.7.2'></script>
<![endif]-->
<link rel="https://api.w.org/" href="http://abap-blog.ru/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://abap-blog.ru/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://abap-blog.ru/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="ABAP CDS (Core Data Services)" href="http://abap-blog.ru/slovar/abap-cds-core-data-services/">
<link rel="next" title="ABAP 7.51" href="http://abap-blog.ru/osnovy-abap/abap-7-51/">
<meta name="generator" content="WordPress 4.9.4">
<link rel="shortlink" href="http://abap-blog.ru/?p=3050">
<link rel="alternate" type="application/json+oembed" href="http://abap-blog.ru/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fabap-blog.ru%2Fdatabase-work%2Fabap-managed-database-procedures-amdp%2F">
<link rel="alternate" type="text/xml+oembed" href="http://abap-blog.ru/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fabap-blog.ru%2Fdatabase-work%2Fabap-managed-database-procedures-amdp%2F&amp;format=xml">

<!-- WP Youtube Player 1.7 by unijimpe -->
<style type="text/css">#page:before, .sidebar-offcanvas, #secondary { background-color: #272727; }@media (max-width: 1199px) { #page &gt; .container { background-color: #272727; } }body { background-size: initial; }</style><style type="text/css">#masthead .site-title {font-family:Lobster}body {font-family:Roboto}h1,h2,h3,h4,h5,h6 {font-family:Roboto Slab}#masthead .site-description, .hentry .entry-meta {font-family:Roboto Condensed}</style><style type="text/css" media="screen">body{position:relative}#dynamic-to-top{display:none;overflow:hidden;width:auto;z-index:90;position:fixed;bottom:20px;right:20px;top:auto;left:auto;font-family:sans-serif;font-size:1em;color:#fff;text-decoration:none;padding:17px 16px;border:1px solid #000;background:#272727;-webkit-background-origin:border;-moz-background-origin:border;-icab-background-origin:border;-khtml-background-origin:border;-o-background-origin:border;background-origin:border;-webkit-background-clip:padding-box;-moz-background-clip:padding-box;-icab-background-clip:padding-box;-khtml-background-clip:padding-box;-o-background-clip:padding-box;background-clip:padding-box;-webkit-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-ms-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-moz-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-o-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-khtml-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-icab-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-webkit-border-radius:30px;-moz-border-radius:30px;-icab-border-radius:30px;-khtml-border-radius:30px;border-radius:30px}#dynamic-to-top:hover{background:#4e9c9c;background:#272727 -webkit-gradient( linear, 0% 0%, 0% 100%, from( rgba( 255, 255, 255, .2 ) ), to( rgba( 0, 0, 0, 0 ) ) );background:#272727 -webkit-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#272727 -khtml-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#272727 -moz-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#272727 -o-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#272727 -ms-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#272727 -icab-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#272727 linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );cursor:pointer}#dynamic-to-top:active{background:#272727;background:#272727 -webkit-gradient( linear, 0% 0%, 0% 100%, from( rgba( 0, 0, 0, .3 ) ), to( rgba( 0, 0, 0, 0 ) ) );background:#272727 -webkit-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#272727 -moz-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#272727 -khtml-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#272727 -o-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#272727 -ms-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#272727 -icab-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#272727 linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) )}#dynamic-to-top,#dynamic-to-top:active,#dynamic-to-top:focus,#dynamic-to-top:hover{outline:none}#dynamic-to-top span{display:block;overflow:hidden;width:14px;height:12px;background:url( http://abap-blog.ru/wp-content/plugins/dynamic-to-top/css/images/up.png )no-repeat center center}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-image: url("http://abap-blog.ru/wp-content/uploads/2014/10/escheresque_ste.png"); background-position: left top; background-size: auto; background-repeat: repeat; background-attachment: scroll; }
</style>
<meta data-pso-pv="1.2.1" data-pso-pt="singlePost" data-pso-th="0dfa7446cffd9b7cc45c776a57ffc289"><script async="" src="ABAP%20Managed%20Database%20Procedures_files/adsbygoogle.js"></script><script pagespeed_no_defer="" data-pso-version="20170403_083938">window.dynamicgoogletags={config:[]};dynamicgoogletags.config=["ca-pub-1967928460448755",[[]],[[[],[],[]]],"WordPressSinglePost","8406335420",null,0.01,null,[null,1209600000],0.01,0,null,null,"http://abap-blog.ru"];(function(){var h=this,aa=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b},p=function(a){return"number"==typeof a},ba=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}},r=function(a,b){function c(){}c.prototype=b.prototype;a.Ra=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Ta=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,
d)}};var ca=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},da=function(a,b){return a<b?-1:a>b?1:0},ea=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};var fa=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e="string"==typeof a?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};var ga=function(a){ga[" "](a);return a};ga[" "]=function(){};var ia=function(a,b){var c=ha;Object.prototype.hasOwnProperty.call(c,a)||(c[a]=b(a))};var t;a:{var ja=h.navigator;if(ja){var ka=ja.userAgent;if(ka){t=ka;break a}}t=""}var v=function(a){return-1!=t.indexOf(a)};var la=v("Opera"),w=v("Trident")||v("MSIE"),ma=v("Edge"),na=v("Gecko")&&!(-1!=t.toLowerCase().indexOf("webkit")&&!v("Edge"))&&!(v("Trident")||v("MSIE"))&&!v("Edge"),oa=-1!=t.toLowerCase().indexOf("webkit")&&!v("Edge"),pa=function(){var a=h.document;return a?a.documentMode:void 0},qa;
a:{var ra="",sa=function(){var a=t;if(na)return/rv\:([^\);]+)(\)|;)/.exec(a);if(ma)return/Edge\/([\d\.]+)/.exec(a);if(w)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(oa)return/WebKit\/(\S+)/.exec(a);if(la)return/(?:Version)[ \/]?(\S+)/.exec(a)}();sa&&(ra=sa?sa[1]:"");if(w){var ta=pa();if(null!=ta&&ta>parseFloat(ra)){qa=String(ta);break a}}qa=ra}
var ua=qa,ha={},va=function(a){ia(a,function(){for(var b=0,c=ca(String(ua)).split("."),d=ca(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"";do{g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];k=/(\d*)(\D*)(.*)/.exec(k)||["","","",""];if(0==g[0].length&&0==k[0].length)break;b=da(0==g[1].length?0:parseInt(g[1],10),0==k[1].length?0:parseInt(k[1],10))||da(0==g[2].length,0==k[2].length)||da(g[2],k[2]);g=g[3];k=k[3]}while(0==b)}return 0<=b})},wa;var xa=h.document;
wa=xa&&w?pa()||("CSS1Compat"==xa.compatMode?parseInt(ua,10):5):void 0;var x=function(){},ya="function"==typeof Uint8Array,z=function(a,b,c){a.a=null;b||(b=[]);a.Va=void 0;a.M=-1;a.l=b;a:{if(a.l.length){b=a.l.length-1;var d=a.l[b];if(d&&"object"==typeof d&&"array"!=aa(d)&&!(ya&&d instanceof Uint8Array)){a.R=b-a.M;a.G=d;break a}}a.R=Number.MAX_VALUE}a.Ua={};if(c)for(b=0;b<c.length;b++)d=c[b],d<a.R?(d+=a.M,a.l[d]=a.l[d]||y):a.G[d]=a.G[d]||y},y=[],A=function(a,b){if(b<a.R){b+=a.M;var c=a.l[b];return c===y?a.l[b]=[]:c}c=a.G[b];return c===y?a.G[b]=[]:c},Aa=function(a){a=
A(za,a);return null==a?a:+a},B=function(a,b,c){b<a.R?a.l[b+a.M]=c:a.G[b]=c},C=function(a,b,c){a.a||(a.a={});if(!a.a[c]){var d=A(a,c);d&&(a.a[c]=new b(d))}return a.a[c]},D=function(a,b,c){a.a||(a.a={});if(!a.a[c]){for(var d=A(a,c),e=[],f=0;f<d.length;f++)e[f]=new b(d[f]);a.a[c]=e}b=a.a[c];b==y&&(b=a.a[c]=[]);return b},Ba=function(a,b,c){a.a||(a.a={});c=c||[];for(var d=[],e=0;e<c.length;e++)d[e]=E(c[e]);a.a[b]=c;B(a,b,d)},Ca=function(a){if(a.a)for(var b in a.a){var c=a.a[b];if("array"==aa(c))for(var d=
0;d<c.length;d++)c[d]&&E(c[d]);else c&&E(c)}},E=function(a){Ca(a);return a.l};x.prototype.toString=function(){Ca(this);return this.l.toString()};var Da=function(a){var b;if("array"==aa(a)){for(var c=Array(a.length),d=0;d<a.length;d++)null!=(b=a[d])&&(c[d]="object"==typeof b?Da(b):b);return c}if(ya&&a instanceof Uint8Array)return new Uint8Array(a);c={};for(d in a)null!=(b=a[d])&&(c[d]="object"==typeof b?Da(b):b);return c};var Ea=function(a,b){this.events=[];this.Ga=b||h;var c=null;b&&(b.google_js_reporting_queue=b.google_js_reporting_queue||[],this.events=b.google_js_reporting_queue,c=b.google_measure_js_timing);this.ia=null!=c?c:Math.random()<a};Ea.prototype.disable=function(){fa(this.events,this.ya,this);this.events.length=0;this.ia=!1};Ea.prototype.ya=function(a){var b=this.Ga.performance;a&&b&&b.clearMarks&&(b.clearMarks("goog_"+a.uniqueId+"_start"),b.clearMarks("goog_"+a.uniqueId+"_end"))};var Fa=function(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});h.addEventListener("test",null,b)}catch(c){}return a}();var Ha=function(){var a=Ga;try{var b;if(b=!!a&&null!=a.location.href)a:{try{ga(a.foo);b=!0;break a}catch(c){}b=!1}return b}catch(c){return!1}},Ia=function(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.call(void 0,a[c],c,a)};var Ja=function(a,b,c,d,e){this.la=c||4E3;this.H=a||"&";this.wa=b||",$";this.T=void 0!==d?d:"trn";this.Sa=e||null;this.va=!1;this.V={};this.Ja=0;this.L=[]},Ma=function(a,b,c,d){b=b+"//"+c+d;var e=Ka(a)-d.length-0;if(0>e)return"";a.L.sort(function(a,b){return a-b});d=null;c="";for(var f=0;f<a.L.length;f++)for(var g=a.L[f],k=a.V[g],m=0;m<k.length;m++){if(!e){d=null==d?g:d;break}var l=La(k[m],a.H,a.wa);if(l){l=c+l;if(e>=l.length){e-=l.length;b+=l;c=a.H;break}else a.va&&(c=e,l[c-1]==a.H&&--c,b+=l.substr(0,
c),c=a.H,e=0);d=null==d?g:d}}f="";a.T&&null!=d&&(f=c+a.T+"="+(a.Sa||d));return b+f+""},Ka=function(a){if(!a.T)return a.la;var b=1,c;for(c in a.V)b=c.length>b?c.length:b;return a.la-a.T.length-b-a.H.length-1},La=function(a,b,c,d,e){var f=[];Ia(a,function(a,k){(a=Na(a,b,c,d,e))&&f.push(k+"="+a)});return f.join(b)},Na=function(a,b,c,d,e){if(null==a)return"";b=b||"&";c=c||",$";"string"==typeof c&&(c=c.split(""));if(a instanceof Array){if(d=d||0,d<c.length){for(var f=[],g=0;g<a.length;g++)f.push(Na(a[g],
b,c,d+1,e));return f.join(c[d])}}else if("object"==typeof a)return e=e||0,2>e?encodeURIComponent(La(a,b,c,d,e+1)):"...";return encodeURIComponent(String(a))};var Ra=function(a,b,c,d){var e=Pa;if((c?e.Pa:Math.random())<(d||e.za))try{var f;b instanceof Ja?f=b:(f=new Ja,Ia(b,function(a,b){var c=f,d=c.Ja++,e={};e[b]=a;a=[e];c.L.push(d);c.V[d]=a}));var g=Ma(f,e.Ma,e.Ba,e.La+a+"&");g&&Qa(g)}catch(k){}},Qa=function(a){h.google_image_requests||(h.google_image_requests=[]);var b=h.document.createElement("img");b.src=a;h.google_image_requests.push(b)};var Sa;if(!(Sa=!na&&!w)){var Ta;if(Ta=w)Ta=9<=Number(wa);Sa=Ta}Sa||na&&va("1.9.1");w&&va("9");var F=function(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d};F.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};var Ua=document,Va=window;var Wa=!!window.google_async_iframe_id,Ga=Wa&&window.parent||window;var Pa,G;if(Wa&&!Ha()){var Xa="."+Ua.domain;try{for(;2<Xa.split(".").length&&!Ha();)Ua.domain=Xa=Xa.substr(Xa.indexOf(".")+1),Ga=window.parent}catch(a){}Ha()||(Ga=window)}G=Ga;var Ya=new Ea(1,G);Pa=new function(){this.Ma="http:"===Va.location.protocol?"http:":"https:";this.Ba="pagead2.googlesyndication.com";this.La="/pagead/gen_204?id=";this.za=.01;this.Pa=Math.random()};
if("complete"==G.document.readyState)G.google_measure_js_timing||Ya.disable();else if(Ya.ia){var Za=function(){G.google_measure_js_timing||Ya.disable()};G.addEventListener?G.addEventListener("load",Za,Fa?void 0:!1):G.attachEvent&&G.attachEvent("onload",Za)};var H=function(a){this.na={};this.na.c=a;this.o=[];this.u=null;this.v=[];this.ea=0};H.prototype.g=function(a){for(var b=0;b<this.o.length;b++)if(this.o[b]==a)return this;this.o.push(a);return this};var $a=function(a,b){a.u=a.u?a.u:b;return a};H.prototype.C=function(a){for(var b=0;b<this.v.length;b++)if(this.v[b]==a)return this;this.v.push(a);return this};
H.prototype.getData=function(a){var b=this.na,c={},d;for(d in b)c[d]=b[d];0<this.ea&&(c.t=this.ea);c.err=this.o.join();c.warn=this.v.join();if(this.u){c.excp_n=this.u.name;c.excp_m=this.u.message&&this.u.message.substring(0,512);if(b=this.u.stack){d=this.u.stack;try{-1==d.indexOf("")&&(d="\n"+d);for(var e;d!=e;)e=d,d=d.replace(/((https?:\/..*\/)[^\/:]*:\d+(?:.|\n)*)\2/,"$1");b=d.replace(/\n */g,"\n")}catch(f){b=""}}c.excp_s=b}c.w=0<a.innerWidth?a.innerWidth:null;c.h=0<a.innerHeight?a.innerHeight:
null;return c};var bb=function(a,b){ab(a,a.Ea,a.X,b)},ab=function(a,b,c,d){var e=d.u;d=d.getData(a.K);a.Ha?(d.type=b,a.K.console.log(d),e&&a.K.console.error(e)):0<c&&(d.r=c,Ra(b,d,"jserror"!=b,c))};var I=function(a){return a.dynamicgoogletags=a.dynamicgoogletags||{}};var J=function(a){z(this,a,cb)};r(J,x);var cb=[4];J.prototype.getId=function(){return A(this,3)};var K=function(a){z(this,a,null)};r(K,x);var db=function(a){z(this,a,null)};r(db,x);var L=function(a){return C(a,J,1)},fb=function(a){z(this,a,eb)};r(fb,x);var eb=[1];fb.prototype.i=function(){return D(this,db,1)};fb.prototype.pa=function(a){Ba(this,1,a)};var M=function(a){z(this,a,gb)};r(M,x);var gb=[2];M.prototype.ka=function(){return A(this,3)};M.prototype.qa=function(a){B(this,3,a)};var hb=function(a){z(this,a,null)};r(hb,x);var N=function(a){z(this,a,ib)};r(N,x);var ib=[1,2,3];N.prototype.i=function(){return D(this,db,2)};
N.prototype.pa=function(a){Ba(this,2,a)};var O=function(a){z(this,a,jb)};r(O,x);var jb=[3];O.prototype.A=function(){return A(this,1)};O.prototype.D=function(){return C(this,fb,2)};O.prototype.O=function(){return A(this,4)};O.prototype.ka=function(){return A(this,5)};O.prototype.qa=function(a){B(this,5,a)};O.prototype.N=function(){return C(this,kb,9)};var kb=function(a){z(this,a,null)};r(kb,x);var lb=function(a){this.m=a;this.sa=[]};lb.prototype.f=function(){return 0<D(this.m,N,3).length?D(this.m,N,3)[0]:null};var mb=function(a){var b=["adsbygoogle-placeholder"];a=a.className?a.className.split(/\s+/):[];for(var c={},d=0;d<a.length;++d)c[a[d]]=!0;for(d=0;d<b.length;++d)if(!c[b[d]])return!1;return!0};var nb=function(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=ea(d.Wa);a[e]=d.value}},qb=function(a,b){var c=ob;b.setAttribute("data-adsbygoogle-status","reserved");b={element:b};(c=c&&c.Na)&&(b.params=c);pb(a).push(b)},pb=function(a){return a.adsbygoogle=a.adsbygoogle||[]};var rb=function(a,b){if(!a)return!1;a=b.getComputedStyle?b.getComputedStyle(a,null):a.currentStyle;if(!a)return!1;a=a.cssFloat||a.styleFloat;return"left"==a||"right"==a},sb=function(a){for(a=a.previousSibling;a&&1!=a.nodeType;)a=a.previousSibling;return a?a:null},tb=function(a){return!!a.nextSibling||!!a.parentNode&&tb(a.parentNode)};var ub=function(a,b){var c=a.length;if(null!=c)for(var d=0;d<c;d++)b.call(void 0,a[d],d)};var vb=function(a,b,c,d){this.ma=a;this.$=b;this.aa=c;this.P=d};vb.prototype.query=function(a){var b=[];try{b=a.querySelectorAll(this.ma)}catch(f){}if(!b.length)return[];a=b;b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];a=c}else a=[];a=wb(this,a);p(this.$)&&(b=this.$,0>b&&(b+=a.length),a=0<=b&&b<a.length?[a[b]]:[]);if(p(this.aa)){b=[];for(c=0;c<a.length;c++){var d=xb(a[c]),e=this.aa;0>e&&(e+=d.length);0<=e&&e<d.length&&b.push(d[e])}a=b}return a};
vb.prototype.toString=function(){return JSON.stringify({nativeQuery:this.ma,occurrenceIndex:this.$,paragraphIndex:this.aa,ignoreMode:this.P})};
var wb=function(a,b){if(null==a.P)return b;switch(a.P){case 1:return b.slice(1);case 2:return b.slice(0,b.length-1);case 3:return b.slice(1,b.length-1);case 0:return b;default:throw Error("Unknown ignore mode: "+a.P);}},xb=function(a){var b=[];ub(a.getElementsByTagName("p"),function(a){100<=yb(a)&&b.push(a)});return b},yb=function(a){if(3==a.nodeType)return a.length;if(1!=a.nodeType||"SCRIPT"==a.tagName)return 0;var b=0;ub(a.childNodes,function(a){b+=yb(a)});return b},zb=function(a){return 0==a.length||
isNaN(a[0])?a:"\\"+(30+parseInt(a[0],10))+" "+a.substring(1)};var Ab=function(a,b){var c=0,d=A(a,6);if(void 0!==d)switch(d){case 0:c=1;break;case 1:c=2;break;case 2:c=3}var d=null,e=A(a,7);if(A(a,1)||a.getId()||0<A(a,4).length){var f=a.getId(),g=A(a,1),e=A(a,4),d=A(a,2);a=A(a,5);var k="";g&&(k+=g);f&&(k+="#"+zb(f));if(e)for(f=0;f<e.length;f++)k+="."+zb(e[f]);d=(e=k)?new vb(e,d,a,c):null}else e&&(d=new vb(e,A(a,2),A(a,5),c));return d?d.query(b):[]},Bb=function(a,b){if(a==b)return!0;if(!a||!b||A(a,1)!=A(b,1)||A(a,2)!=A(b,2)||a.getId()!=b.getId()||A(a,7)!=A(b,
7)||A(a,5)!=A(b,5)||A(a,6)!=A(b,6))return!1;a=A(a,4);b=A(b,4);if(a||b)if(a&&b&&a.length==b.length)for(var c=0;c<a.length;c++){if(a[c]!=b[c])return!1}else return!1;return!0};var Cb=function(a){a=a.document;return("CSS1Compat"==a.compatMode?a.documentElement:a.body)||{}},Db=function(a){return void 0===a.pageYOffset?(a.document.documentElement||a.document.body.parentNode||a.document.body).scrollTop:a.pageYOffset};var Eb=function(a,b){b=L(b);if(!b)return null;a=Ab(b,a);return 0<a.length?a[0]:null},Gb=function(a,b){b=Fb(a,b,!0);return p(b)&&!(b<=Cb(a).clientHeight)},Hb=function(a,b){return a.body?b-a.body.getBoundingClientRect().top:b},Fb=function(a,b,c){if(!c||!p(A(b,8))){var d=Eb(a.document,b);if(d){var e=null!=C(b,K,2)?A(C(b,K,2),3):void 0;c=a.document.createElement("div");c.className="googlepublisherpluginad";var f=c.style;f.textAlign="center";f.width="100%";f.height="0px";f.clear=e?"both":"none";Ib(c,d,
A(b,3));d=c.getBoundingClientRect().top+Db(a);c.parentNode.removeChild(c);B(b,8,d)}}b=A(b,8);return p(b)?b-Db(a):null},Jb={0:0,1:1,2:2,3:3},Kb={0:"auto",1:"horizontal",2:"vertical",3:"rectangle"},Lb=function(a,b){a.sort(function(a,d){a=Fb(b,a,!0);a=p(a)?a:Number.POSITIVE_INFINITY;d=Fb(b,d,!0);d=p(d)?d:Number.POSITIVE_INFINITY;return a-d})},Ib=function(a,b,c){switch(Jb[c]){case 0:b.parentNode&&b.parentNode.insertBefore(a,b);break;case 3:if(c=b.parentNode){var d=b.nextSibling;if(d&&d.parentNode!=c)for(;d&&
8==d.nodeType;)d=d.nextSibling;c.insertBefore(a,d)}break;case 1:b.insertBefore(a,b.firstChild);break;case 2:b.appendChild(a)}if(1!=b.nodeType?0:"INS"==b.tagName&&mb(b))b.style.display="block"};var ob=new function(){this.ha="googlepublisherpluginad";this.Na={google_tag_origin:"pso"}},P=function(a){this.b=a;this.j=[];this.da=0;this.o=[];this.v=[];this.Y=null;this.oa=!1},Mb=function(a,b){a=C(a.f(),J,4);if(!(a&&b&&A(b,1)==A(a,1)&&b.getId()==a.getId()&&p(A(b,2))&&p(A(b,5))))return!1;a=A(a,4);b=A(b,4);if(a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(b[c]!=a[c])return!1;return!0},Nb=function(a){var b=p(void 0)?void 0:20,c=a.f(),d=c.i(),e=C(c,J,4);if(!(a.oa||0>=b)&&e&&0!=Ab(e,a.b.document).length){a.oa=
!0;for(var c=[],f=0;f<d.length;++f){var g=d[f],k=L(g);if(Mb(a,k)){var m=A(k,2),k=A(k,5);null!=m&&null!=k&&0<=m&&0<=k&&(!c[m]||A(L(c[m]),5)<k)&&(c[m]=g)}}k=0;d=Ab(e,a.b.document);for(m=0;m<c.length&&k<b;++m){var e=k,f=a,l=d[m],g=c[m],k=b-k,u=f.f().i(),q=0;if(l&&g){l=xb(l).length;switch(A(L(g),6)){case 0:case 1:--l;break;case 2:l-=2}for(var n=A(L(g),5)+1;n<l&&q<k;++n){var Oa=new g.constructor(Da(E(g))),Hc=L(Oa);B(Hc,5,n);u.push(Oa);q++}}q&&f.f().pa(u);k=e+q}}};
P.prototype.g=function(a){for(var b=0;b<this.o.length;++b)if(this.o[b]==a)return;this.o.push(a)};P.prototype.C=function(a){for(var b=0;b<this.v.length;++b)if(this.v[b]==a)return;this.v.push(a)};
var Ob=function(a,b,c){var d=Jb[A(b,3)],e=Eb(a.b.document,b);if(e){var f=L(b)?A(L(b),2):void 0,g;a:{g=a.b;if(null!=f)switch(d){case 0:g=rb(sb(e),g);break a;case 3:g=rb(e,g);break a;case 2:f=e.lastChild;g=rb(f?1==f.nodeType?f:sb(f):null,g);break a}g=!1}if(!g&&(c||2!=d||tb(e))&&(c=1==d||2==d?e:e.parentNode,!c||(1!=c.nodeType?0:"INS"==c.tagName&&mb(c))||!(0>=c.offsetWidth)))a:if(A(b,7))a.C(8);else{b:if(A(b,5))c=A(b,5);else{if(c=Q(a).f())if(c=A(c,3),a.da<c.length){c=c[a.da++];break b}a.g(4);c=null}if(null!=
c){B(b,7,!0);d=[];(g=a.O())&&d.push(g);g=Q(a).sa;for(f=0;f<g.length;++f)d.push(g[f]);p(A(b,9))&&d.push("pso-lv-"+A(b,9));var k=a.b.document;g=a.A();var f=A(b,6),f=null!=f?Kb[f]:f,m=C(b,K,2),l={};m&&(l.ra=A(m,1),l.ga=A(m,2),l.xa=!!A(m,3));var m=c,u=ob,q=k.createElement("div"),n=q.style;n.textAlign="center";n.width="100%";n.height="auto";n.clear=l.xa?"both":"none";l.Ka&&nb(n,l.Ka);k=k.createElement("ins");n=k.style;n.display="block";n.margin="auto";n.backgroundColor="transparent";l.ra&&(n.marginTop=
l.ra);l.ga&&(n.marginBottom=l.ga);l.ta&&nb(n,l.ta);q.appendChild(k);k.setAttribute("data-ad-format",f?f:"auto");if(f=u&&u.ha)q.className=f;k.className="adsbygoogle";k.setAttribute("data-ad-client",g);m&&k.setAttribute("data-ad-slot",m);d.length&&k.setAttribute("data-ad-channel",d.join("+"));Ib(q,e,A(b,3));try{qb(a.b,k)}catch(Oa){A(b,5)!=c&&a.da--;B(b,7,!1);a.C(6);q&&q.parentNode&&q.parentNode.removeChild(q);break a}a.j.push(q)}}}},Pb=function(a,b){for(var c=Number.POSITIVE_INFINITY,d=0;d<a.j.length;++d)var e=
a.j[d].getBoundingClientRect().top,f=a.j[d].getBoundingClientRect().bottom,c=Math.min(c,b<e?e-b:f<b?b-f:0);return c},Q=function(a){a=I(a.b).ps||null;if(!a)throw Error("No placementState");return a},Qb=function(a,b){var c=Q(a).m;if(!c||!c.A())return a.g(5),!1;c=D(c,N,3)[0];return c?A(c,3).length<b?(a.g(4),a.g(5),!1):!0:(a.g(5),!1)};P.prototype.A=function(){return Q(this).m.A()||""};P.prototype.O=function(){return Q(this).m.O()||void 0};P.prototype.D=function(){return Q(this).m.D()||new fb};
P.prototype.f=function(){var a=Q(this).f();if(!a)throw Error("No mConfig");return a};var Rb=function(a){a=A(a.f(),6);return null!=a&&0<a};var Sb=function(){this.I=this.J=this.ba=null};var R=function(a){P.call(this,a)};r(R,P);R.prototype.apply=function(a){var b;(b=Q(this).m)&&b.A()&&b.D()?b=!0:(this.g(5),b=!1);if(b){b=this.D().i();for(var c=0;c<b.length;c++){var d=b[c];A(d,7)||Ob(this,d,a)}}};R.prototype.B=function(){return(0==this.D().i().length||0<this.j.length)&&0==this.o.length};var Tb=function(a){P.call(this,a);if(Qb(this,0)){a=this.D().i();for(var b=this.f().i(),c=0;c<a.length;c++){var d=a[c],e;a:{e=d;var f=b;if(e&&L(e))for(var g=0;g<f.length;g++){var k=f[g];if(A(e,3)==A(k,3)&&Bb(L(e),L(k))){e=k;break a}}e=null}e&&C(e,K,2)&&(e=C(e,K,2),d.a||(d.a={}),f=e?E(e):e,d.a[2]=e,B(d,2,f))}}};r(Tb,R);var Vb=function(a,b){var c=void 0===b.pageXOffset?(b.document.documentElement||b.document.body.parentNode||b.document.body).scrollLeft:b.pageXOffset,d=Db(b);if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),Ub(a)?new F(a.top+d,a.right+c,a.bottom+d,a.left+c):new F(0,0,0,0);b=b.document.createRange();b.selectNodeContents(a);return b.collapsed?new F(0,0,0,0):b.getBoundingClientRect?(a=b.getBoundingClientRect(),Ub(a)?new F(a.top+d,a.right+c,a.bottom+d,a.left+c):new F(0,0,0,0)):new F(0,0,0,
0)},Ub=function(a){return!!a&&p(a.top)&&!isNaN(a.top)&&p(a.right)&&!isNaN(a.right)&&p(a.bottom)&&!isNaN(a.bottom)&&p(a.left)&&!isNaN(a.left)};var $b=function(a){this.K=a;this.Fa=Wb(a);this.ua=S("ins.adsbygoogle",a);this.fa=Xb(a);this.Oa=S("[__lsu_res=reserved]",a);this.U=[];a=Yb(this);for(var b=0;b<a.length;b++)this.U.push(new Zb(a[b]))},Wb=function(a){var b=a.googletag;if(!b||"function"!=typeof b.pubads)return S("div[id^=div-gpt-ad]",a);var c=[];try{for(var d=b.pubads().getSlots(),b=0;b<d.length;b++){var e=d[b].getSlotElementId(),f=a.document.getElementById(e);null!=f&&c.push(f)}}catch(g){Ra("ladd_evt",{ok:0,err:g.toString()},!0,.1)}return c},
Xb=function(a){return S("iframe[id^=aswift_],iframe[id^=google_ads_frame]",a)},S=function(a,b){return Array.prototype.slice.call(b.document.querySelectorAll(a))},Yb=function(a){return[].concat(a.Fa,a.ua,a.fa,a.Oa)},Zb=function(a){this.Ca=a;this.W=null};var T=function(a){P.call(this,a)};r(T,P);T.prototype.apply=function(){};T.prototype.B=function(){var a;if(Rb(this)){a=this.b;var b=Wb(a);a=0<[].concat(b,S("ins.adsbygoogle",a),Xb(a),S("[__lsu_res=reserved]",a)).length}else a=!0;return a};var ac=function(a){P.call(this,a);this.F=null};r(ac,P);
ac.prototype.apply=function(a){if(a&&Qb(this,2)){Nb(this);a=Cb(this.b).clientHeight||640;null==this.F&&(this.F=new $b(this.b));var b=this.F.fa.length;if(!(5<=b)){var b=Math.min(2,5-b),c=this.f().i();Lb(c,this.b);for(var d=0;d<c.length&&this.j.length<b;++d){var e=c[d];if(Gb(this.b,e)){var f=Fb(this.b,e,!0);if(void 0!==f){var g;a:{g=this.F;for(var k=a,m=f,l=0;l<g.U.length;l++){var u=m,q=k,n;n=g.U[l];n.W||(n.W=Vb(n.Ca,g.K));n=n.W;if(n.top-q<u&&u<n.bottom+q){g=!0;break a}}g=!1}g||Pb(this,f)<a||Ob(this,
e,!0)}}}0==this.j.length&&this.C(1)}}};ac.prototype.B=function(){return Rb(this)?0<Yb(this.F).length:!0};var bc=function(a){P.call(this,a);this.Z=!1};r(bc,T);
bc.prototype.apply=function(a){if(a&&!this.Z){var b;a:{var c=this.b.document;b=c.body;if(a&&b){a=this.A();var d=ob,e=c.createElement("div");e.style.display="block";if(d=d&&d.ha)e.className=d;c=c.createElement("ins");c.className="adsbygoogle";c.setAttribute("data-ad-client",a);c.setAttribute("data-reactive-ad-format","1");c.style.display="none";e.appendChild(c);Ib(e,b,2);try{qb(this.b,c)}catch(f){this.C(6);e&&e.parentNode&&e.parentNode.removeChild(e);b=5;break a}this.j.push(e);b=0}else b=4}this.Z=
0==b}};bc.prototype.B=function(){return this.Z&&T.prototype.B.call(this)};var cc=function(a){P.call(this,a);a=Cb(a).clientHeight;this.Aa=.1*a;this.Ia=.75*a};r(cc,P);
cc.prototype.apply=function(a){if(Qb(this,3)&&!this.B()){Nb(this);var b=this.f().i();Lb(b,this.b);var c;c=this.Aa;var d;d=document;d=d.querySelectorAll?d.querySelectorAll("header,#header,#masthead,.header,.site-header"):[];for(var e=d.length,f=0<e?d[0]:null,g=1;g<e;g++)d[g].getBoundingClientRect().top<f.getBoundingClientRect().top&&(f=d[g]);(d=f)&&(d=d.getBoundingClientRect())&&d.top!=d.bottom&&d.left!=d.right&&(c=Math.min(c,Hb(document,d.bottom)));for(d=0;d<b.length&&3>this.j.length;d++){e=b[d];
var f=c,g=this.b.document,k=Fb(this.b,e,!1);!p(k)||Hb(g,k)<f?f=!1:(f=Pb(this,k),f=this.Ia<f);f&&(f=Gb(this.b,e),g=A(e,6)||0,f&&0==g&&B(e,6,3),!f&&a||Ob(this,e,a))}}};cc.prototype.B=function(){return 3==this.j.length};var U={};U[16]=R;U[17]=R;U[19]=T;U[29]=ac;U[33]=T;U[30]=bc;U[28]=cc;U[34]=cc;U[32]=Tb;U[1]=R;U[8]=T;U[11]=R;var dc=[19,29,33,30,16,32,17,34],ec=[16,19,33,30,17,1,6,8,11];var fc=function(a,b){a=a.google_ad_modifications=a.google_ad_modifications||{};(a.ad_channels=a.ad_channels||[]).push(b)};var gc=function(a){return 0>a||99<a?null:10>a?"0"+a:""+a};var hc=function(a,b){a=a.google_ad_modifications=a.google_ad_modifications||{};a=a.loeids=a.loeids||[];for(var c=0;c<b.length;c++)a.push(b[c])};var ic=function(a,b,c){this.ja=a;this.Da=c?c:new kb};ic.prototype.N=function(){return this.Da||new kb};var jc=function(a){if(!p(a))return!1;for(var b=0;b<dc.length;++b)if(a==dc[b])return!1;return!0},oc=function(){var a=V,b=kc,c=lc,d=b.f();if(!d)return mc(16);var e=null,f;a:{var g=D(d,M,1);for(f=0;f<g.length;++f){for(var k=!0,m=0;m<ec.length;++m)A(g[f],4)==ec[m]&&(k=!1);if(k){g=[];0==d.i().length&&g.push("PsoInvalidVariant");0==A(d,3).length&&g.push("PsoNoAdSlotCodes");f=g;break a}}f=[]}g=c.ja;if(0==f.length)a:{e=D(d,M,1);if(p(g))for(f=0;f<e.length;f++)if(k=e[f],U[A(k,4)])for(var m=D(k,hb,2),l=0;l<
m.length;l++){var u=m[l],q=A(u,1),u=A(u,2);if(p(q)&&p(u)&&g>=q&&g<=u){e=k;break a}}e=null}else for(k=0;k<f.length;++k)b.sa.push(f[k]);if(!e){f=D(d,M,1);e={};for(k=0;k<f.length;k++)e[A(f[k],4)]=!0;f=null;e[19]||e[8]?f=19:e[16]||e[1]?f=16:0<d.i().length&&0<A(d,3).length&&e[34]&&(f=34);null!=f?(e=new M,B(e,6,3),B(e,4,f),16!=f&&19!=f&&e.qa("pso-ama-fallback")):e=null}(f=!e)||(!p(g)||800>g?f=!1:820>g?(hc(a,["26835111"]),f=!0):(840>g&&hc(a,["26835112"]),f=!1));if(f)return mc(16);(g=e.ka())&&fc(a,g);g=!0;
A(c.N(),2)&&(Date.now?Date.now():+new Date)<A(c.N(),2)||(fc(a,"pso-ama-exd"),g=!1);A(b.m,11)&&(fc(a,"pso-ama-stl-tmp"),g=!1);g&&fc(a,"pso-ama-elig");2==A(e,6)&&(b=A(e,1),null!=b&&hc(a,[""+b]));if(g&&(2==A(e,6)||1==A(e,6))){d=D(d,M,1);if(null===c.ja)c=[];else{b={};c=[];for(g=0;g<d.length;g++)f=nc(d[g]),null==f||b[f]||(b[f]=!0,c.push(f));b=nc(e);if(null!=b){d=[];b=gc(b);g=!1;if(b)for(f=0;f<c.length;f++)k=gc(c[f]),b==k&&(g=!0),k&&d.push("950"+b+k);g||(d=[]);c=d}else c=[]}hc(a,c)}a=new Sb;a.ba=A(e,5);
a.J=A(e,4);return a},mc=function(a){var b=new Sb;b.J=a;return b},pc=function(a){a=a.google_ad_modifications=a.google_ad_modifications||{};a.remove_ads_by_default=!0;a.ad_whitelist=[{ad_tag_origin:"pso"}];a.ad_blacklist=[];a.space_collapsing="slot"},nc=function(a){var b;switch(A(a,6)){case 1:b=A(a,4);break;case 2:b=A(a,7)}return null!=b?b:null};var qc=function(a){this.document=a};var W=function(a){H.call(this,a)};r(W,H);W.prototype.getData=function(a){var b=W.Ra.getData.call(this,a),c;a:{c=(new qc(a.document)).document.getElementsByTagName("script");for(var d=0;d<c.length;++d)if(c[d].hasAttribute("data-pso-version")){c=c[d].getAttribute("data-pso-version");break a}c=null}b.sv=c;if(d=I(a).ps||null){c=d.m;var d=d.f(),e=b.wpc;b.wpc=null!=e?e:c.A();b.su=A(c,14);b.tn=c.O();b.ev=d&&A(d,5)}if(a=I(a).ss||null)b.s=a.J,b.st=a.ba;return b};var rc=null,sc=!1,vc=function(a){var b=tc,c=uc;b.addEventListener?(a&&b.addEventListener("DOMContentLoaded",a,!1),c&&b.addEventListener("load",c,!1)):b.attachEvent&&c&&b.attachEvent("onload",c)},xc=function(a){p(rc)&&a.clearInterval&&(a.clearInterval(rc),rc=null);sc||wc(a,!1);wc(a,!0)},yc=function(a,b){try{xc(b);var c=I(b).ss||null;if(c&&c.I){var d=c.I,e=d.B(),f=d.o,g=d.v,k=d.Y,m=d.j.length;e||0!=m||f.push(6);for(var l=new W(m),c=0;c<g.length;c++)l.C(g[c]);if(e&&0==f.length&&null===k)ab(a,a.Qa,a.ca,
l);else{for(e=0;e<f.length;e++)l.g(f[e]);bb(a,$a(l,k))}}else bb(a,(new W(0)).g(2))}catch(u){bb(a,$a((new W(0)).g(1),u))}I(b).loaded=!0},wc=function(a,b){b||(sc=!0);if((a=I(a).ss||null)&&a.I){a=a.I;try{a.apply(b)}catch(c){a.g(1),null===a.Y&&(a.Y=c)}}},zc=function(){wc(window,!1)};var X=new function(a){this.Qa="pso_success";this.Ea="pso_failure";this.X=this.ca=.01;this.Ha=!1;this.K=a}(window);
try{var V=window,za,Ac=I(V).config;za=Ac?new O(Ac):null;if(!za)throw Error("No config");var Bc=Aa(10),Cc=Aa(7);X.ca=null!=Bc?Bc:X.ca;X.X=null!=Cc?Cc:X.X;var kc=new lb(za),Dc=kc;I(V).ps=Dc;var Y,lc;if(v("iPad")||v("Android")&&!v("Mobile")||v("Silk")||!(v("iPod")||v("iPhone")||v("Android")||v("IEMobile")))Y=mc(16);else{var Ec,Fc=/^#([^=]*)=(\d+)$/.exec(V.location.hash);if((Ec=Fc&&3==Fc.length&&"pso_strategy"==Fc[1]?+Fc[2]:null)&&U[Ec]){Y=mc(Ec);var Gc=V;jc(Ec)&&pc(Gc)}else{var Ic=V,Jc=kc.m.N(),Z;try{var Kc=
parseInt(Ic.localStorage.getItem("PSO_EXP0"),10);Z=isNaN(Kc)?null:Kc}catch(a){Z=null}if(null==Z){Z=Math.floor(1024*Math.random());var Lc=Z;try{Ic.localStorage.setItem("PSO_EXP0",Lc.toString())}catch(a){}}lc=new ic(Z,0,Jc);Y=oc()}if(1==Y.ba){var Mc=V;jc(Y.J)&&pc(Mc)}}if(!Y)throw Error("No strategyState created!");var Nc=Y;I(V).ss=Nc;var Oc=V,Pc=Y,Qc=Pc.J;if(p(Qc)){var Rc=U[Qc];Qc&&Rc&&(Pc.I=new Rc(Oc))}var tc=V,uc=ba(yc,X,tc),Sc=ba(xc,tc);switch(tc.document.readyState){case "complete":uc();break;case "interactive":Sc();
vc();break;default:var Tc=tc,Uc=pb(Tc);Uc.loaded||(Uc.onload=zc);rc=Tc.setInterval(zc,10);vc(Sc)}}catch(a){bb(X,$a(new W(0),a))};})();
</script>	<script async="" type="text/javascript" src="ABAP%20Managed%20Database%20Procedures_files/count.js"></script><script type="text/javascript" async="" src="ABAP%20Managed%20Database%20Procedures_files/embed.js"></script><link rel="prefetch" as="style" href="ABAP%20Managed%20Database%20Procedures_files/a_data/lounge.css"><link rel="prefetch" as="script" href="ABAP%20Managed%20Database%20Procedures_files/a_data/common.js"><link rel="prefetch" as="script" href="ABAP%20Managed%20Database%20Procedures_files/a_data/lounge.js"><link rel="prefetch" as="script" href="ABAP%20Managed%20Database%20Procedures_files/a_data/config.js"><link rel="stylesheet" type="text/css" href="ABAP%20Managed%20Database%20Procedures_files/style.css"><link rel="stylesheet" type="text/css" href="ABAP%20Managed%20Database%20Procedures_files/css_002.css"><link rel="stylesheet" type="text/css" href="ABAP%20Managed%20Database%20Procedures_files/style_002.css"><script src="ABAP%20Managed%20Database%20Procedures_files/count-data.js"></script><link rel="preload" href="ABAP%20Managed%20Database%20Procedures_files/integrator.js" as="script"><script type="text/javascript" src="ABAP%20Managed%20Database%20Procedures_files/integrator.js"></script><script src="ABAP%20Managed%20Database%20Procedures_files/alfalfa.js" async="" charset="UTF-8"></script></head>

<body class="post-template-default single single-post postid-3050 single-format-standard custom-background" itemscope="" itemtype="http://schema.org/WebPage">
<div id="page">
	<div class="container">
		<div class="row row-offcanvas row-offcanvas-left">
			<div id="secondary" class="col-lg-3">
								<header id="masthead" class="site-header" role="banner">
										<div class="hgroup">
						<h1 class="site-title display-title"><a href="http://abap-blog.ru/" title="ABAP Blog" rel="home"><span itemprop="name">ABAP Blog</span></a></h1><h2 itemprop="description" class="site-description">Блог ABAP разработчика</h2>					</div>
					<button type="button" class="btn btn-link hidden-lg toggle-sidebar" data-toggle="offcanvas" aria-label="Sidebar"><i class="fa fa-gear"></i></button>
					<button type="button" class="btn btn-link hidden-lg toggle-navigation" aria-label="Navigation Menu"><i class="fa fa-bars"></i></button>
					<nav id="site-navigation" class="navigation main-navigation" role="navigation">
						<ul id="menu-glavnoe-menyu" class="nav-menu"><li id="menu-item-2313" class="fa fa-home menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-has-children menu-item-2313"><a href="http://abap-blog.ru/">Главная</a>
<i class="fa fa-caret-right"></i><ul class="sub-menu" style="display: none;">
	<li id="menu-item-2363" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2363"><a href="http://abap-blog.ru/category/osnovy-abap/">Основы ABAP</a></li>
	<li id="menu-item-2370" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2370"><a href="http://abap-blog.ru/category/slovar/">ABAP Словарь</a></li>
	<li id="menu-item-2364" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2364"><a href="http://abap-blog.ru/category/sap-dynpro/">SAP Dynpro</a></li>
	<li id="menu-item-2906" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2906"><a href="http://abap-blog.ru/category/oop/">ООП и ООД</a></li>
	<li id="menu-item-2367" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2367"><a href="http://abap-blog.ru/category/files/">Работа с файлами</a></li>
	<li id="menu-item-2366" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-2366"><a href="http://abap-blog.ru/category/database-work/">Работа с БД</a></li>
	<li id="menu-item-2368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-2368"><a href="http://abap-blog.ru/category/network/">Сетевые технологии</a>
	<i class="fa fa-caret-right"></i><ul class="sub-menu">
		<li id="menu-item-2907" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2907"><a href="http://abap-blog.ru/category/network/web-dynpro/">Web Dynpro</a></li>
	</ul>
</li>
	<li id="menu-item-2369" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2369"><a href="http://abap-blog.ru/category/enhancements/">Расширения</a></li>
	<li id="menu-item-2365" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2365"><a href="http://abap-blog.ru/category/others/">Прочее</a></li>
</ul>
</li>
<li id="menu-item-2316" class="fa fa-info-circle menu-item menu-item-type-post_type menu-item-object-page menu-item-2316"><a href="http://abap-blog.ru/about/">Немного о себе</a></li>
</ul>					</nav>
									</header>
				
				<div class="sidebar-offcanvas">
					<div id="main-sidebar" class="widget-area" role="complementary">
											<aside id="endo_wrc_widget-2" class="widget widget_endo_wrc_widget">
						<h3 class="widget-title">Цитаты</h3>
<p>Чистый код прост и прямолинеен. Чистый код читается, как хорошо 
написанная проза. Чистый код никогда не затемняет намерения 
проектировщика; он полон четких абстракций и простых линий передачи 
управления.</p>
<p><strong>Г. Буч</strong></p>
					</aside>
					<aside id="linkcat-2" class="widget widget_links">
						<h3 class="widget-title">Ссылки</h3>

	<ul class="xoxo blogroll">
<li><a href="https://help.sap.com/http.svc/rc/abapdocu_752_index_htm/7.52/en-US/index.htm" title="Последняя версия справки по ABAP">ABAP Help</a></li>
<li><a href="http://help.sap.com/">SAP Help Portal</a></li>
<li><a href="http://scn.sap.com/community/abap" target="_blank">SDN ABAP</a></li>

	</ul>
					</aside>

					<aside id="disqus_recent_comments-2" class="widget disqus_recent_comments_widget_wrapper">
<aside id="disqus_rcw_title" class="widget">						<h3 class="widget-title">Комментарии</h3>
<ul class="disqus_rcw_comments_list" style="margin-left:0px">
					<li class="disqus_rcw_single">
						<div class="disqus_rcw_author_wrapper">
							<img class="disqus_rcw_avatar_html5" src="ABAP%20Managed%20Database%20Procedures_files/avatar92_002.jpg" alt="Сидорочкин Михаил">
							<a href="https://disqus.com/by/Astrafox/">
								<span class="disqus_rcw_author">Сидорочкин Михаил</span>
							</a>
						</div>
						<div class="disqus_rcw_clear"></div>
						<div class="disqus_rcw_content_wrapper">
							<a class="disqus_rcw_thread_title" href="http://abap-blog.ru/database-work/koncepciya-blokirovok-v-sap/">Концепция блокировок в SAP</a>
							<br>
							<a class="disqus_rcw_message" href="http://abap-blog.ru/database-work/koncepciya-blokirovok-v-sap/#comment-3626322461">Добрый день! По существующей, время установки можно узнать через ФМ ENQUEUE_READ.</a>
						</div>
						<time datetime="11/21/2017" class="disqus_rcw_post_time_html5">11/21/2017</time>
					</li>
					<li class="disqus_rcw_single">
						<div class="disqus_rcw_author_wrapper">
							<img class="disqus_rcw_avatar_html5" src="ABAP%20Managed%20Database%20Procedures_files/avatar92_002.jpg" alt="Сидорочкин Михаил">
							<a href="https://disqus.com/by/Astrafox/">
								<span class="disqus_rcw_author">Сидорочкин Михаил</span>
							</a>
						</div>
						<div class="disqus_rcw_clear"></div>
						<div class="disqus_rcw_content_wrapper">
							<a class="disqus_rcw_thread_title" href="http://abap-blog.ru/osnovy-abap/abstraktnyj-klass-ili-interfejs-chto-i-kogda-ispolzovat/">Абстрактный класс или интерфейс, что и когда использовать</a>
							<br>
							<a class="disqus_rcw_message" href="http://abap-blog.ru/osnovy-abap/abstraktnyj-klass-ili-interfejs-chto-i-kogda-ispolzovat/#comment-3626319420">Подразумевалось его ;)</a>
						</div>
						<time datetime="11/21/2017" class="disqus_rcw_post_time_html5">11/21/2017</time>
					</li>
					<li class="disqus_rcw_single">
						<div class="disqus_rcw_author_wrapper">
							<img class="disqus_rcw_avatar_html5" src="ABAP%20Managed%20Database%20Procedures_files/noavatar92.png" alt="Alberd">
							<a href="">
								<span class="disqus_rcw_author">Alberd</span>
							</a>
						</div>
						<div class="disqus_rcw_clear"></div>
						<div class="disqus_rcw_content_wrapper">
							<a class="disqus_rcw_thread_title" href="http://abap-blog.ru/osnovy-abap/abstraktnyj-klass-ili-interfejs-chto-i-kogda-ispolzovat/">Абстрактный класс или интерфейс, что и когда использовать</a>
							<br>
							<a class="disqus_rcw_message" href="http://abap-blog.ru/osnovy-abap/abstraktnyj-klass-ili-interfejs-chto-i-kogda-ispolzovat/#comment-3626132911">"т.к. некоторое го поведение" - подразумевалось слово "готовое"? :)</a>
						</div>
						<time datetime="11/21/2017" class="disqus_rcw_post_time_html5">11/21/2017</time>
					</li>
					<li class="disqus_rcw_single">
						<div class="disqus_rcw_author_wrapper">
							<img class="disqus_rcw_avatar_html5" src="ABAP%20Managed%20Database%20Procedures_files/avatar92_002.jpg" alt="Сидорочкин Михаил">
							<a href="https://disqus.com/by/Astrafox/">
								<span class="disqus_rcw_author">Сидорочкин Михаил</span>
							</a>
						</div>
						<div class="disqus_rcw_clear"></div>
						<div class="disqus_rcw_content_wrapper">
							<a class="disqus_rcw_thread_title" href="http://abap-blog.ru/others/avtomaticheskoe-dopolnenie-uglovyx-skobok/">Автоматическое дополнение угловых скобок</a>
							<br>
							<a class="disqus_rcw_message" href="http://abap-blog.ru/others/avtomaticheskoe-dopolnenie-uglovyx-skobok/#comment-3607722061">SE38 - в нижнем правом углу, в редакторе.</a>
						</div>
						<time datetime="11/9/2017" class="disqus_rcw_post_time_html5">11/9/2017</time>
					</li>
					<li class="disqus_rcw_single">
						<div class="disqus_rcw_author_wrapper">
							<img class="disqus_rcw_avatar_html5" src="ABAP%20Managed%20Database%20Procedures_files/avatar92.jpg" alt="Dmitriy Vedmid">
							<a href="https://disqus.com/by/dmitriyvedmid/">
								<span class="disqus_rcw_author">Dmitriy Vedmid</span>
							</a>
						</div>
						<div class="disqus_rcw_clear"></div>
						<div class="disqus_rcw_content_wrapper">
							<a class="disqus_rcw_thread_title" href="http://abap-blog.ru/others/avtomaticheskoe-dopolnenie-uglovyx-skobok/">Автоматическое дополнение угловых скобок</a>
							<br>
							<a class="disqus_rcw_message" href="http://abap-blog.ru/others/avtomaticheskoe-dopolnenie-uglovyx-skobok/#comment-3607714351">где находится этот экран настройки(Options)?</a>
						</div>
						<time datetime="11/9/2017" class="disqus_rcw_post_time_html5">11/9/2017</time>
					</li></ul></aside>					</aside>
											</div>
				</div>
			</div>

						<div id="primary" class="content-area col-lg-9" itemprop="mainContentOfPage">
							<div id="content" class="site-content" role="main" itemscope="" itemtype="http://schema.org/Article">
			<article id="post-3050" class="post-3050 post type-post status-publish format-standard hentry category-database-work tag-amdp tag-native-sql">
	<header class="entry-header">
		<h1 class="entry-title" itemprop="name">ABAP Managed Database Procedures (AMDP)</h1>
							<div class="entry-meta"><span class="entry-date"><a href="http://abap-blog.ru/database-work/abap-managed-database-procedures-amdp/" rel="bookmark"><time class="entry-date published" datetime="2016-06-03T00:03:15+00:00" itemprop="datepublished">03.06.2016</time></a></span> от <span class="author vcard" itemscope="" itemprop="author" itemtype="http://schema.org/Person"><a class="url fn n" href="http://abap-blog.ru/author/admin/" rel="author" itemprop="url"><span itemprop="name">Astrafox</span></a></span><span class="sep">·</span><span class="comments-link"><a href="http://abap-blog.ru/database-work/abap-managed-database-procedures-amdp/#disqus_thread" itemprop="discussionUrl" data-disqus-identifier="3050 http://abap-blog.ru/?p=3050">4 комментариев</a></span></div>
			</header>
		
	
	<div class="entry-content" itemprop="articleBody">
				<p><a href="http://abap-blog.ru/wp-content/uploads/2016/06/sqlcode1.jpg" data-slb-active="1" data-slb-asset="1389196525" data-slb-internal="0" data-slb-group="3050"><img class=" wp-image-3079 alignleft" src="ABAP%20Managed%20Database%20Procedures_files/sqlcode1.jpg" alt="sqlcode[1]" srcset="http://abap-blog.ru/wp-content/uploads/2016/06/sqlcode1.jpg 400w, http://abap-blog.ru/wp-content/uploads/2016/06/sqlcode1-300x225.jpg 300w" sizes="(max-width: 365px) 100vw, 365px" width="365" height="274"></a>Все
 больше в настоящее время SAP систем переходят на новую платформу (СУБД)
 – HANA (High-Performance Analytic Appliance), в основе которой лежит 
технология вычислений in-memory с использованием принципа поколоночного 
хранения данных.&nbsp;Вместе с новой платформой, появляются так же и 
новые возможности для обработки больших объемов данных и более 
высокопроизводительных вычислений.</p>
<p>Для ускорения ABAP решений на базе HANA, 
используется&nbsp;перенос&nbsp;вычислений с уровня сервера приложений 
(AS ABAP) на сервер СУБД (Code-to-Data). Данную задачу можно решить 
несколькими способами, одним из которых является&nbsp;использование 
Native SQL и AMDP как средства его вызова.</p>
<p>В контексте ABAP разработки, под Native SQL понимается язык&nbsp;SQL 
запросов поддерживаемый текущей или дополнительной СУБД сервера 
приложений.</p>
<p>В данной статье будут рассмотрены основные моменты использования AMDP.</p>
<p><span id="more-3050"></span></p>
<p>SAP <a href="http://help.sap.com/abapdocu_750/en/abendatabase_access_guidl.htm">рекомендует </a>использовать Native SQL в ABAP только тогда, когда задачу оптимизации не решить стандартными средствами <a href="http://scn.sap.com/community/abap/hana/blog/2014/09/26/code-push-down-for-hana-from-abap-starts-with-open-sql">OpenSQL</a>,
 в частности AMDP следует использовать только если будут задействованы 
какие-то специфичные для HANA вещи или объем данных слишком велик чтобы 
переносить его между СУБД и сервером приложений.</p>
<p>Вызывать Native SQL в ABAP напрямую можно несколькими методами, среди которых:</p>
<ul>
<li><a href="http://abap-blog.ru/database-work/adbc-abap-database-connectivity/">ADBC </a>классы,</li>
<li><a href="http://help.sap.com/abapdocu_750/en/abennativesql.htm">EXEC SQL</a> (без возможности использования динамики),</li>
<li>AMDP.</li>
</ul>
<p>Косвенно через:</p>
<ul>
<li><a href="http://help.sap.com/abapdocu_750/en/abensql_script.htm">External Procedures </a>(proxies).
 Рекомендуется использовать только если невозможно тоже самое сделать 
через AMDP (например, когда HANA подключена как дополнительная СУБД),</li>
<li><a href="http://help.sap.com/abapdocu_750/en/abenexternal_views.htm">External views</a>&nbsp;(если
 учесть что view будет к calculation view на базе SQL Script), так же не
 рекомендуется к использованию если возможно тоже самое реализовать 
через <a href="http://abap-blog.ru/slovar/abap-cds-core-data-services/">ABAP CDS</a> или AMDP.</li>
</ul>
<p>Наиболее удобным и современным способом вызова Native SQL является использование AMDP, преимущества заключаются в следующем:</p>
<ul>
<li>Проверка синтаксиса и подсветка команд,</li>
<li>Стандартное для ABAP объектов управление жизненным циклом (В отличие
 от внешних процедур и ракурсов, &nbsp;где необходимо использовать HANA 
артефакты для переноса объекта между системами),</li>
<li>Автодополнение и навигация к используемым объектам,</li>
<li>Простой вызов из ABAP.</li>
</ul>
<p>Технически AMDP это обёртка над <a href="https://ru.wikipedia.org/wiki/%D0%A5%D1%80%D0%B0%D0%BD%D0%B8%D0%BC%D0%B0%D1%8F_%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D0%B4%D1%83%D1%80%D0%B0">хранимыми процедурами</a>
 в СУБД. Обёртка заворачивает Native SQL код в методы ABAP класса (AMDP 
методы), которые Вы можете использовать в своих программах как обычные 
методы обычных классов. Во время первого доступа к такому методу, на 
сервере БД будет создана&nbsp;хранимая процедура, которая создаётся в 
основной схеме для сервера приложений&nbsp;с именем SAPSid, где Sid – 
идентификатор системы. Доступ из хранимой процедуры можно получить к 
объектам БД текущей схемы (SAPSid) и объектам других схем, явно указав 
их имена.</p>
<p>В настоящее время AMDP поддерживается только для HANA, однако&nbsp;в 
будущем планируется поддержка других СУБД. Проверить поддержку&nbsp;AMDP
 можно через класс CL_ABAP_DBFEATURES и его метод CALL_AMDP_METHOD (ABAP
 7.5).</p>
<p>Под Native SQL&nbsp;в HANA подразумеваются языки&nbsp;SQL Script и L, однако L доступен только для разработчиков SAP.</p>
<h2>AMDP классы</h2>
<p>&nbsp;</p>
<p>Как и большинство новых объектов разработки, AMDP классы доступны для
 редактирования только из ADT (ABAP Development Tools for Eclipse). 
Создаётся AMDP класс таким же образом, как и обычные глобальные классы, 
единственным отличаем, является реализация&nbsp;классом специального 
интерфейса <strong>— IF_AMDP_MARKER_HDB</strong>. Данный интерфейс 
является своего рода меткой для системы, чтобы она понимала, что в 
методах этого класса может быть встроен вызов AMDP. Кроме AMDP методов 
такой класс может содержать и обычные методы.</p>
<h2>AMDP методы</h2>
<p>&nbsp;</p>
<p>Метод AMDP может быть как статическим, так и методом инстанции с 
любой видимостью. По своему описанию в заголовке&nbsp;класса он ничем не
 отличается от обычных методов. Понять, что это AMDP метод можно только 
заглянув в исходный код.</p>
<p>На AMDP метод накладываются определенные ограничения.</p>
<p>Ограничения в интерфейсе:</p>
<ul>
<li>Нельзя использовать обобщенные типы (TYPE DATA, TYPE CSEQUENCE и 
др.), доступны только элементарные типы данных и табличные, компоненты 
которых являются элементарными.</li>
<li>Нельзя использовать для описания типа устаревшие словарные типы — DF16_SCL и DF34_SCL.</li>
<li>Параметры всегда должны переноситься по значению, перенос по ссылке недоступен.</li>
<li>RETURNING параметры запрещены.</li>
<li>Только входные параметры могут быть помечены как необязательные и 
для всех необязательных параметров необходимо, чтобы было задано 
начальное значение.</li>
<li>Параметры с типами f, decfloat16, decfloat34, string, и xstring не 
могут быть со значением по умолчанию, а значит, они не могут быть 
необязательными.</li>
<li>Имена параметров:
<ul>
<li>Не могут начинаться с префикса «%_».</li>
<li>Нельзя использовать параметры с именами: endmethod и client.</li>
</ul>
</li>
<li>Если используется параметр с именем connection, он обязательно 
должен иметь тип —&nbsp;DBCON_NAME, используется он когда AMDP 
вызывается через <a href="http://help.sap.com/abapdocu_750/en/abenamdp_db_connections.htm">сервисное подключение</a>, в таком случае его адрес необходимо будет передать через&nbsp;параметр.</li>
<li>При описании исключений можно использовать только заранее <a href="http://help.sap.com/abapdocu_740/en/abenamdp_exceptions.htm">определенные</a> классы исключений. Классические исключения недоступны.</li>
<li>CHANGING параметры не могут иметь тип string или xstring.</li>
<li>Длина параметров с типом C или N не может превышать 5000 символов.</li>
</ul>
<p>Ограничения в рамках реализации:</p>
<ul>
<li>Нельзя использовать DDL синтаксис.</li>
<li>Локальные временные объекты БД не могут быть доступны из метода.</li>
<li>Запрещено использование rollback или commit. Транзакции должны быть обработаны в рамках ABAP программ.</li>
<li>Доступ на запись к словарным таблицам, для которых активна буферизация — запрещен.</li>
<li>AMDP методы не могут содержать внутри себя неявных расширений.</li>
<li>AMDP метод не может быть пустым.</li>
<li>Конструктор нельзя реализовать как AMDP метод.</li>
</ul>
<p>В ABAP 7.4. можно реализовать только метод AMDP процедуры, в 7.5 
добавилась так же возможность создания метода AMDP функции. AMDP функции
 можно использовать для получения данных в других AMDP процедурах и 
функциях, в ABAP CDS и даже в OpenSQL. Для функций параметр RETURNING 
является обязательным. В статье реализация функций не рассматривается, 
подробнее о функциях смотрите в <a href="http://help.sap.com/abapdocu_750/en/abenamdp_function_methods.htm#@@ITOC@@ABENAMDP_FUNCTION_METHODS_2">документации</a>.</p>
<p>Для AMDP методов, как и для обычных методов доступна поддержка 
наследования, пример использования можно посмотреть в программе — 
demo_amdp_polymorphism. Таким образом, можно сделать разные реализации и
 в зависимости от поддержки AMDP, вызывать либо их, либо обычные методы с
 OpenSQL.</p>
<p>Так как&nbsp;AMDP это Native SQL, поддержка клиента&nbsp;(манданта) 
должна быть реализована вручную, как правило клиент предаётся внутрь 
AMDP как параметр. Другим способом является возможность использования 
специальной функции&nbsp;– <a href="http://help.sap.com/abapdocu_750/en/abenamdp_client_handling.htm">SESSION_CONTEXT</a>, использовать которую следует, только если ваша AMDP процедура вызывается из ABAP.</p>
<p>Как уже говорилось выше, понять, что это AMDP метод можно только по 
исходному коду. Меткой для системы в таком случае служит дополнение BY 
DATABASE PROCEDURE у выражения – METHOD.</p>
<p>Синтаксис этого дополнения следующий:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ab33cfeb8ee0638905972" class="crayon-syntax crayon-theme-classic-copy crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin: 12px auto; float: none; font-size: 13px !important; line-height: 17px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 13px !important; height: 19.5px !important; line-height: 19.5px !important; margin-top: -20px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 13px !important; line-height: 17px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">METHOD meth BY DATABASE PROCEDURE 
            FOR db 
            LANGUAGE db_lang 
            [OPTIONS db_options] 
            [USING   db_entities]. 
  ... 
ENDMETHOD.</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5ab33cfeb8ee0638905972-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ee0638905972-2">2</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ee0638905972-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ee0638905972-4">4</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ee0638905972-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ee0638905972-6">6</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ee0638905972-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ab33cfeb8ee0638905972-1"><span class="crayon-st">METHOD</span><span class="crayon-h"> </span>meth<span class="crayon-h"> </span><span class="crayon-r">BY</span><span class="crayon-h"> </span><span class="crayon-r">DATABASE</span><span class="crayon-h"> </span>PROCEDURE<span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ee0638905972-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">FOR</span><span class="crayon-h"> </span>db<span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5ab33cfeb8ee0638905972-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">LANGUAGE</span><span class="crayon-h"> </span>db<span class="crayon-sy">_</span>lang<span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ee0638905972-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">[</span><span class="crayon-r">OPTIONS</span><span class="crayon-h"> </span>db<span class="crayon-sy">_</span>options<span class="crayon-o">]</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5ab33cfeb8ee0638905972-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">[</span><span class="crayon-r">USING</span><span class="crayon-h">&nbsp;&nbsp; </span>db<span class="crayon-sy">_</span>entities<span class="crayon-o">]</span><span class="crayon-o">.</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ee0638905972-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5ab33cfeb8ee0638905972-7"><span class="crayon-st">ENDMETHOD</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0031 seconds] -->
<p>Дополнение FOR определяет, для какой СУБД создана текущая AMDP 
процедура. В настоящее время доступно только определение для HANA:</p>
<table>
<tbody>
<tr>
<td><strong>db</strong></td>
<td><strong>СУБД</strong></td>
<td><strong>Интерфейс</strong></td>
</tr>
<tr>
<td>HDB</td>
<td>SAP HANA</td>
<td>IF_AMDP_MARKER_HDB</td>
</tr>
</tbody>
</table>
<p>В будущем, возможно, появится поддержка других СУБД, тогда можно 
будет использовать несколько маркеров (интерфейсов), чтобы реализовывать
 методы для разных СУБД.</p>
<p>Дополнение LANGUAGE определяет то, на каком языке будет реализация AMDP процедуры. Доступны следующие варианты:</p>
<table>
<tbody>
<tr>
<td><strong>db</strong></td>
<td><strong>db_lang</strong></td>
<td><strong>Язык</strong></td>
<td><strong>Комментарий</strong></td>
</tr>
<tr>
<td>HDB</td>
<td>SQLSCRIPT</td>
<td>SQLScript</td>
<td>Доступно для всех</td>
</tr>
<tr>
<td>HDB</td>
<td>LLANG</td>
<td>L</td>
<td>Доступно только внутри SAP</td>
</tr>
</tbody>
</table>
<p>Дополнение OPTIONS описывает специфичные для СУБД параметры обработки AMDP. Доступные следующие варианты:</p>
<table>
<tbody>
<tr>
<td><strong>db</strong></td>
<td><strong>option</strong></td>
<td><strong>Значение</strong></td>
</tr>
<tr>
<td>HDB</td>
<td>READ-ONLY</td>
<td>В рамках AMDP нельзя будет изменять значения таблиц.</td>
</tr>
<tr>
<td>HDB</td>
<td>SUPPRESS SYNTAX ERRORS</td>
<td>Для внутреннего использования SAP.</td>
</tr>
</tbody>
</table>
<p>Основным по значимости дополнением является дополнение USING. В 
рамках него указывается, какие объекты СУБД будут обработаны в текущей 
реализации AMDP. Указание объектов необходимо прежде всего для того, 
чтобы система могла выполнить соответствующие проверки синтаксиса.</p>
<p>Необходимо указывать следующие объекты:</p>
<ul>
<li>Все таблицы и ракурсы из ABAP словаря.</li>
<li>Все процедуры (или функции ABAP 7.5) AMDP, даже если они из одного класса.</li>
</ul>
<p>Все остальные объекты (не управляемые из ABAP) не могут 
присутствовать в дополнении USING. Указанные в USING объекты должны 
присутствовать в текущей схеме БД и могут использоваться без её 
указания. Объекты из других схем должны использоваться с указанием 
полного имени, в том числе имени схемы, исключением являются объекты из 
текущей схемы с префиксом — /1BCAMDP/.</p>
<p>Объекты из USING должны обязательно быть использованы в реализации AMDP процедуры.</p>
<p>Пример вызова одной AMDP процедуры из другой:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ab33cfeb8ef5791707599" class="crayon-syntax crayon-theme-classic-copy crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin: 12px auto; float: none; font-size: 13px !important; line-height: 17px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 13px !important; height: 19.5px !important; line-height: 19.5px !important; margin-top: -20px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 13px !important; line-height: 17px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">METHOD increase_price BY DATABASE PROCEDURE 
                      FOR HDB LANGUAGE SQLSCRIPT 
                      USING cl_demo_amdp_call_amdp=&gt;increase_price_amdp. 
  call "CL_DEMO_AMDP_CALL_AMDP=&gt;INCREASE_PRICE_AMDP"( 
    CLNT =&gt; :CLNT, INCPRICE =&gt; :INCPRICE ); 
ENDMETHOD.

METHOD increase_price_amdp BY DATABASE PROCEDURE 
                           FOR HDB LANGUAGE SQLSCRIPT 
                           USING sflight. 
  update sflight set price = price + incprice 
               where mandt = clnt; 
ENDMETHOD.</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5ab33cfeb8ef5791707599-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ef5791707599-2">2</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ef5791707599-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ef5791707599-4">4</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ef5791707599-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ef5791707599-6">6</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ef5791707599-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ef5791707599-8">8</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ef5791707599-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ef5791707599-10">10</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ef5791707599-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8ef5791707599-12">12</div><div class="crayon-num" data-line="crayon-5ab33cfeb8ef5791707599-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ab33cfeb8ef5791707599-1"><span class="crayon-st">METHOD</span><span class="crayon-h"> </span>increase<span class="crayon-sy">_</span>price<span class="crayon-h"> </span><span class="crayon-r">BY</span><span class="crayon-h"> </span><span class="crayon-r">DATABASE</span><span class="crayon-h"> </span>PROCEDURE<span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ef5791707599-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">FOR</span><span class="crayon-h"> </span>HDB<span class="crayon-h"> </span><span class="crayon-r">LANGUAGE</span><span class="crayon-h"> </span>SQLSCRIPT<span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5ab33cfeb8ef5791707599-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">USING</span><span class="crayon-h"> </span>cl<span class="crayon-sy">_</span>demo<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>call<span class="crayon-sy">_</span>amdp<span class="crayon-o">=</span><span class="crayon-o">&gt;</span>increase<span class="crayon-sy">_</span>price<span class="crayon-sy">_</span>amdp<span class="crayon-o">.</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ef5791707599-4"><span class="crayon-h">&nbsp;&nbsp;</span>call<span class="crayon-h"> </span><span class="crayon-c">"CL_DEMO_AMDP_CALL_AMDP=&gt;INCREASE_PRICE_AMDP"( </span></div><div class="crayon-line" id="crayon-5ab33cfeb8ef5791707599-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>CLNT<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">:</span>CLNT<span class="crayon-sy">,</span><span class="crayon-h"> </span>INCPRICE<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">:</span>INCPRICE<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ef5791707599-6"><span class="crayon-st">ENDMETHOD</span><span class="crayon-o">.</span></div><div class="crayon-line" id="crayon-5ab33cfeb8ef5791707599-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ef5791707599-8"><span class="crayon-st">METHOD</span><span class="crayon-h"> </span>increase<span class="crayon-sy">_</span>price<span class="crayon-sy">_</span>amdp<span class="crayon-h"> </span><span class="crayon-r">BY</span><span class="crayon-h"> </span><span class="crayon-r">DATABASE</span><span class="crayon-h"> </span>PROCEDURE<span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5ab33cfeb8ef5791707599-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-r">FOR</span><span class="crayon-h"> </span>HDB<span class="crayon-h"> </span><span class="crayon-r">LANGUAGE</span><span class="crayon-h"> </span>SQLSCRIPT<span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ef5791707599-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-r">USING</span><span class="crayon-h"> </span>sflight<span class="crayon-o">.</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5ab33cfeb8ef5791707599-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">update</span><span class="crayon-h"> </span>sflight<span class="crayon-h"> </span>set<span class="crayon-h"> </span>price<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span>price<span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span>incprice<span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8ef5791707599-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-r">where</span><span class="crayon-h"> </span>mandt<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span>clnt<span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5ab33cfeb8ef5791707599-13"><span class="crayon-st">ENDMETHOD</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0061 seconds] -->
<p>Как видно из примера, в процедуре через дополнение USING была описана используемая в реализации другая AMDP процедура.</p>
<p>Из-за ограничений HANA, рекурсивные и циклические вызовы в AMDP процедур запрещены.</p>
<h2>AMDP BADI</h2>
<p>&nbsp;</p>
<p>AMDP классы могут быть использованы в расширениях через специальные 
AMDP BAdi, с определенными ограничениями в сравнении с обычными BAdi.</p>
<p>Ограничения в определении и реализации:</p>
<ul>
<li>Нельзя использовать фильтры</li>
<li>Fallback класс должен быть всегда определен (Реализация BAdi по умолчанию).</li>
<li>Каждый метод BAdi должен быть реализован через AMDP процедуру.</li>
</ul>
<p>Вызываются такие AMDP BAdi так же как и стандартные Kernel BAdi через GET BADI, CALL BADI.</p>
<p>В следующем видео подробно с примерами разобрано использование AMDP BAdi:</p>
<div class="arve-wrapper aligncenter" data-mode="normal" data-provider="youtube" id="arve-5F6ELUmavzM" style="max-width:960px;" itemscope="" itemtype="http://schema.org/VideoObject"><div class="arve-embed-container" style="padding-bottom:56.250000%"><iframe allowfullscreen="" class="arve-iframe fitvidsignore" scrolling="no" src="ABAP%20Managed%20Database%20Procedures_files/5F6ELUmavzM.htm" sandbox="allow-scripts allow-same-origin allow-presentation allow-popups" frameborder="0"></iframe></div></div>
<h2>Отладка AMDP</h2>
<p>&nbsp;</p>
<p>Для отладки AMDP в ABAP 7.4. необходимо сделать предварительные настройки:</p>
<ul>
<li>Настроить внешнюю отладку и поставить точку останова в HANA Studio,</li>
<li>Выдать соответствующие полномочия пользователю в HANA, под которым будет выполнена отладка.</li>
</ul>
<p>После чего можно использовать Procedure Debugger в HANA Studio, вызвав процедуру из ABAP.</p>
<p>В ABAP 7.5. отладку процедур можно выполнять прямо в <a href="http://scn.sap.com/community/abap/eclipse/blog/2015/10/22/how-to-debug-abap-managed-database-procedures-using-adt--basics">ADT без HANA Studio</a>,&nbsp;используя новый для этой версии инструмент ADT —&nbsp;AMDP Debugger.</p>
<p>На тему отладки AMDP процедур в ABAP 7.4 на SCN есть хорошая <a href="http://scn.sap.com/docs/DOC-51790">статья</a>.</p>
<p>Так же доступно видео с полным разбором:</p>
<div class="arve-wrapper aligncenter" data-mode="normal" data-provider="youtube" id="arve-5OEuyls5ME" style="max-width:960px;" itemscope="" itemtype="http://schema.org/VideoObject"><div class="arve-embed-container" style="padding-bottom:56.250000%"><iframe allowfullscreen="" class="arve-iframe fitvidsignore" scrolling="no" src="ABAP%20Managed%20Database%20Procedures_files/5OEuyl_s5ME.htm" sandbox="allow-scripts allow-same-origin allow-presentation allow-popups" frameborder="0"></iframe></div></div>
<h2>SQL Script</h2>
<p>&nbsp;</p>
<p>Синтаксис языка SQL Script описан в&nbsp; соответствующей <a href="http://help.sap.com/hana/sap_hana_sql_script_reference_en.pdf">документации</a>
 (обратите внимание на версию HANA в документе). &nbsp;В AMDP могут быть
 использованы CE_* функции которые работают с любыми типами View 
(CE_COLUMN_TABLE не будет работать, так как эта функция работает только с
 column store). Однако по заявлениям некоторых представителей SAP, 
данные функции отживают свое и возможно скоро будут считаться 
устаревшими.</p>
<p>Пример использования CE_UNION_ALL:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5ab33cfeb8eff618163917" class="crayon-syntax crayon-theme-classic-copy crayon-font-consolas crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin: 12px auto; float: none; font-size: 13px !important; line-height: 17px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 13px !important; height: 19.5px !important; line-height: 19.5px !important; margin-top: -20px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://abap-blog.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 13px !important; line-height: 17px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">CLASS zcl_amdp_test_case1 DEFINITION
  PUBLIC
  FINAL
  CREATE PUBLIC .
  PUBLIC SECTION.
    INTERFACES: if_amdp_marker_hdb.
    CLASS-METHODS:
      amdp_get_aa EXPORTING VALUE(et_aa) TYPE SPFLI_TAB RAISING cx_amdp_error,
      amdp_get_ua EXPORTING VALUE(et_ua) TYPE SPFLI_TAB RAISING cx_amdp_error,
      amdp_get_all EXPORTING VALUE(et_all) TYPE spfli_tab RAISING cx_amdp_error.
  PROTECTED SECTION.
  PRIVATE SECTION.
ENDCLASS.

CLASS zcl_amdp_test_case1 IMPLEMENTATION.
  METHOD amdp_get_aa BY DATABASE PROCEDURE FOR HDB LANGUAGE SQLSCRIPT
                            USING spfli.
    et_aa = SELECT * FROM spfli WHERE carrid = 'AA';
  ENDMETHOD.

  METHOD amdp_get_ua BY DATABASE PROCEDURE FOR HDB LANGUAGE SQLSCRIPT
                            USING spfli.
    et_ua = SELECT * FROM spfli WHERE carrid = 'UA';
  ENDMETHOD.

  METHOD amdp_get_all BY DATABASE PROCEDURE
                      FOR HDB LANGUAGE SQLSCRIPT
                      USING zcl_amdp_test_case1=&gt;amdp_get_aa
                            zcl_amdp_test_case1=&gt;amdp_get_ua.
    call "ZCL_AMDP_TEST_CASE1=&gt;AMDP_GET_AA"(
      ET_AA =&gt; :lt_aa );
    call "ZCL_AMDP_TEST_CASE1=&gt;AMDP_GET_UA"(
      ET_UA =&gt; :lt_ua );
    et_all = CE_UNION_ALL(:lt_aa, :lt_ua );
  ENDMETHOD.
ENDCLASS.</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 17px !important;"><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-2">2</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-4">4</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-6">6</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-8">8</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-10">10</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-12">12</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-14">14</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-16">16</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-18">18</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-20">20</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-22">22</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-24">24</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-26">26</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-28">28</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-30">30</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-32">32</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-34">34</div><div class="crayon-num" data-line="crayon-5ab33cfeb8eff618163917-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5ab33cfeb8eff618163917-36">36</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 17px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-1"><span class="crayon-st">CLASS</span><span class="crayon-h"> </span>zcl<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>test<span class="crayon-sy">_</span>case1<span class="crayon-h"> </span><span class="crayon-r">DEFINITION</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">PUBLIC</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">FINAL</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">CREATE PUBLIC</span><span class="crayon-h"> </span><span class="crayon-o">.</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">PUBLIC</span><span class="crayon-h"> </span>SECTION<span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTERFACES</span><span class="crayon-o">:</span><span class="crayon-h"> </span>if<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>marker<span class="crayon-sy">_</span>hdb<span class="crayon-o">.</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">CLASS-METHODS</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>amdp<span class="crayon-sy">_</span>get<span class="crayon-sy">_</span>aa<span class="crayon-h"> </span><span class="crayon-r">EXPORTING</span><span class="crayon-h"> </span><span class="crayon-r">VALUE</span><span class="crayon-o">(</span>et<span class="crayon-sy">_</span>aa<span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-r">TYPE</span><span class="crayon-h"> </span>SPFLI<span class="crayon-sy">_</span>TAB<span class="crayon-h"> </span><span class="crayon-r">RAISING</span><span class="crayon-h"> </span>cx<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>error<span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>amdp<span class="crayon-sy">_</span>get<span class="crayon-sy">_</span>ua<span class="crayon-h"> </span><span class="crayon-r">EXPORTING</span><span class="crayon-h"> </span><span class="crayon-r">VALUE</span><span class="crayon-o">(</span>et<span class="crayon-sy">_</span>ua<span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-r">TYPE</span><span class="crayon-h"> </span>SPFLI<span class="crayon-sy">_</span>TAB<span class="crayon-h"> </span><span class="crayon-r">RAISING</span><span class="crayon-h"> </span>cx<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>error<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>amdp<span class="crayon-sy">_</span>get<span class="crayon-sy">_</span>all<span class="crayon-h"> </span><span class="crayon-r">EXPORTING</span><span class="crayon-h"> </span><span class="crayon-r">VALUE</span><span class="crayon-o">(</span>et<span class="crayon-sy">_</span>all<span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-r">TYPE</span><span class="crayon-h"> </span>spfli<span class="crayon-sy">_</span>tab<span class="crayon-h"> </span><span class="crayon-r">RAISING</span><span class="crayon-h"> </span>cx<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>error<span class="crayon-o">.</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">PROTECTED SECTION</span><span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">PRIVATE SECTION</span><span class="crayon-o">.</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-13"><span class="crayon-st">ENDCLASS</span><span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-14">&nbsp;</div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-15"><span class="crayon-st">CLASS</span><span class="crayon-h"> </span>zcl<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>test<span class="crayon-sy">_</span>case1<span class="crayon-h"> </span><span class="crayon-r">IMPLEMENTATION</span><span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">METHOD</span><span class="crayon-h"> </span>amdp<span class="crayon-sy">_</span>get<span class="crayon-sy">_</span>aa<span class="crayon-h"> </span><span class="crayon-r">BY</span><span class="crayon-h"> </span><span class="crayon-r">DATABASE</span><span class="crayon-h"> </span>PROCEDURE<span class="crayon-h"> </span><span class="crayon-r">FOR</span><span class="crayon-h"> </span>HDB<span class="crayon-h"> </span><span class="crayon-r">LANGUAGE</span><span class="crayon-h"> </span>SQLSCRIPT</div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">USING</span><span class="crayon-h"> </span>spfli<span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>et<span class="crayon-sy">_</span>aa<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">SELECT</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-r">FROM</span><span class="crayon-h"> </span>spfli<span class="crayon-h"> </span><span class="crayon-r">WHERE</span><span class="crayon-h"> </span>carrid<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'AA'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">ENDMETHOD</span><span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-20">&nbsp;</div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">METHOD</span><span class="crayon-h"> </span>amdp<span class="crayon-sy">_</span>get<span class="crayon-sy">_</span>ua<span class="crayon-h"> </span><span class="crayon-r">BY</span><span class="crayon-h"> </span><span class="crayon-r">DATABASE</span><span class="crayon-h"> </span>PROCEDURE<span class="crayon-h"> </span><span class="crayon-r">FOR</span><span class="crayon-h"> </span>HDB<span class="crayon-h"> </span><span class="crayon-r">LANGUAGE</span><span class="crayon-h"> </span>SQLSCRIPT</div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">USING</span><span class="crayon-h"> </span>spfli<span class="crayon-o">.</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>et<span class="crayon-sy">_</span>ua<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">SELECT</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-r">FROM</span><span class="crayon-h"> </span>spfli<span class="crayon-h"> </span><span class="crayon-r">WHERE</span><span class="crayon-h"> </span>carrid<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'UA'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">ENDMETHOD</span><span class="crayon-o">.</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">METHOD</span><span class="crayon-h"> </span>amdp<span class="crayon-sy">_</span>get<span class="crayon-sy">_</span>all<span class="crayon-h"> </span><span class="crayon-r">BY</span><span class="crayon-h"> </span><span class="crayon-r">DATABASE</span><span class="crayon-h"> </span>PROCEDURE</div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">FOR</span><span class="crayon-h"> </span>HDB<span class="crayon-h"> </span><span class="crayon-r">LANGUAGE</span><span class="crayon-h"> </span>SQLSCRIPT</div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">USING</span><span class="crayon-h"> </span>zcl<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>test<span class="crayon-sy">_</span>case1<span class="crayon-o">=</span><span class="crayon-o">&gt;</span>amdp<span class="crayon-sy">_</span>get<span class="crayon-sy">_</span>aa</div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>zcl<span class="crayon-sy">_</span>amdp<span class="crayon-sy">_</span>test<span class="crayon-sy">_</span>case1<span class="crayon-o">=</span><span class="crayon-o">&gt;</span>amdp<span class="crayon-sy">_</span>get<span class="crayon-sy">_</span>ua<span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span class="crayon-h"> </span><span class="crayon-c">"ZCL_AMDP_TEST_CASE1=&gt;AMDP_GET_AA"(</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ET<span class="crayon-sy">_</span>AA<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">:</span>lt<span class="crayon-sy">_</span>aa<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>call<span class="crayon-h"> </span><span class="crayon-c">"ZCL_AMDP_TEST_CASE1=&gt;AMDP_GET_UA"(</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ET<span class="crayon-sy">_</span>UA<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">:</span>lt<span class="crayon-sy">_</span>ua<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>et<span class="crayon-sy">_</span>all<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CE_UNION_ALL</span><span class="crayon-o">(</span><span class="crayon-o">:</span>lt<span class="crayon-sy">_</span>aa<span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span>lt<span class="crayon-sy">_</span>ua<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5ab33cfeb8eff618163917-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">ENDMETHOD</span><span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5ab33cfeb8eff618163917-36"><span class="crayon-st">ENDCLASS</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0155 seconds] -->
<p>Одной из типичных проблем, с которыми сталкивается разработчик при 
использовании AMDP – передача RANGE с экрана выбора. Решается задача 
путём формирования WHERE условия с помощью класса — CL_SHDB_SELTAB и его
 применения к выбранным данным через SQL Script функцию APPLY_FILTER, 
пример можно посмотреть в <a href="http://scn.sap.com/community/abap/hana/blog/2015/03/30/handling-of-select-options-parameters-within-amdp">статье</a> на SCN.</p>
<p>Если данного класса нет в Вашей системе, он может быть установлен <a href="https://websmp130.sap-ag.de/sap(bD1ydSZjPTAwMQ==)/bc/bsp/sno/ui_entry/entry.htm?param=69765F6D6F64653D3030312669765F7361706E6F7465735F6E756D6265723D3231323436373226">нотой</a>.</p>
<p>При обработке данных получаемых из ABAP система сопоставляет типы ABAP и HANA по следующим правилам:</p>
<table>
<tbody>
<tr>
<td><strong>ABAP Тип</strong></td>
<td><strong>HANA Тип</strong></td>
<td><strong>Комментарий</strong></td>
</tr>
<tr>
<td><strong>b</strong></td>
<td>SMALLINT</td>
<td>—</td>
</tr>
<tr>
<td><strong>s</strong></td>
<td>SMALLINT</td>
<td>—</td>
</tr>
<tr>
<td><strong>i</strong></td>
<td>INTEGER</td>
<td>—</td>
</tr>
<tr>
<td><strong>p</strong>, длинна&nbsp;<strong>leng</strong>&nbsp;с&nbsp;<strong>dec</strong>&nbsp;знаками после запятой</td>
<td>DECIMAL, длинна &nbsp;<strong>2 </strong><strong>leng</strong><strong>-1</strong>&nbsp;c&nbsp;<strong>dec</strong>&nbsp;знаками после запятой</td>
<td>—</td>
</tr>
<tr>
<td><strong>decfloat16</strong></td>
<td>VARBINARY, длинна 8</td>
<td>Вычисления как с числовыми типами система произвести не сможет</td>
</tr>
<tr>
<td><strong>decfloat34</strong></td>
<td>VARBINARY, длинна 16</td>
<td>Вычисления как с числовыми типами система произвести не сможет</td>
</tr>
<tr>
<td><strong>f</strong></td>
<td>DOUBLE</td>
<td>—</td>
</tr>
<tr>
<td><strong>c, </strong>длинна <strong>len</strong></td>
<td>NVARCHAR, длинна &nbsp;len</td>
<td>—</td>
</tr>
<tr>
<td><strong>string</strong></td>
<td>NCLOB</td>
<td>Не разрешено для CHANGING параметров AMDP</td>
</tr>
<tr>
<td><strong>n, </strong>длинна <strong>len</strong></td>
<td>NVARCHAR, длинна len</td>
<td>Для использования в арифметических выражениях следует использование преобразование типа к числовому типу HANA</td>
</tr>
<tr>
<td><strong>d</strong></td>
<td>NVARCHAR, длинна 8</td>
<td>Для использования в расчётах с датой необходимо преобразование к типу даты в HANA</td>
</tr>
<tr>
<td><strong>t</strong></td>
<td>NVARCHAR, длинна 6</td>
<td>Для использования в расчётах с временем необходимо преобразование к типу времени в HANA</td>
</tr>
<tr>
<td><strong>x, </strong>длинна <strong>len</strong></td>
<td>VARBINARY, длинна len</td>
<td>—</td>
</tr>
<tr>
<td><strong>xstring</strong></td>
<td>BLOB</td>
<td>Не разрешено для CHANGING параметров AMDP</td>
</tr>
</tbody>
</table>
<p>Типы ABAP словаря сопоставляются так же как и <a href="http://help.sap.com/abapdocu_750/en/abenddic_builtin_types.htm">сопоставимые с ними ABAP типы</a>, за исключением:</p>
<table>
<tbody>
<tr>
<td width="199">DF16_DEC, длинна <strong>leng</strong>&nbsp;с&nbsp;<strong>dec</strong>&nbsp;знаками после запятой</td>
<td width="210">DECIMAL, длинна <strong>2</strong><strong>len</strong><strong>-1</strong>&nbsp;с&nbsp;<strong>dec</strong>&nbsp;знаками после запятой</td>
<td>Тип в HANA имеет меньший диапазон значений, чем в ABAP</td>
</tr>
<tr>
<td width="199">DF34_DEC, длинна <strong>leng</strong>&nbsp;с&nbsp;<strong>dec</strong>&nbsp;знаками после запятой</td>
<td width="210">DECIMAL, длинна <strong>2</strong><strong>len</strong><strong>-1</strong>&nbsp;с&nbsp;<strong>dec</strong>&nbsp;знаками после запятой</td>
<td>Тип в HANA имеет меньший диапазон значений, чем в ABAP</td>
</tr>
<tr>
<td width="199">DF16_SCL</td>
<td width="210">—</td>
<td>Устарело, не поддерживается</td>
</tr>
<tr>
<td width="199">DF34_SCL</td>
<td width="210">—</td>
<td>Устарело, не поддерживается</td>
</tr>
<tr>
<td width="199">SSTRING, длинна <strong>len</strong></td>
<td width="210">NVARCHAR, длинна <strong>len</strong></td>
<td>—</td>
</tr>
</tbody>
</table>
<h2>Источники</h2>
<ul>
<li><a href="http://help.sap.com/hana/sap_hana_sql_script_reference_en.pdf">SQL Script Reference</a>,</li>
<li><a href="https://training.sap.com/shop/course/ha400-abap-programming-for-sap-hana-classroom-008-g-en/">HA400</a>,</li>
<li><a href="http://help.sap.com/abapdocu_750/en/abenamdp.htm">ABAP Help</a>.</li>
</ul>
							</div>
		<div class="tags-links"><a href="http://abap-blog.ru/tag/amdp/" rel="tag">AMDP</a> <a href="http://abap-blog.ru/tag/native-sql/" rel="tag">Native SQL</a></div></article>
	
	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Навигация по записям</h2>
		<div class="nav-links"><div class="nav-previous"><a href="http://abap-blog.ru/slovar/abap-cds-core-data-services/" rel="prev"><span class="meta-nav" aria-hidden="true">Назад</span> <span class="screen-reader-text">Предыдущая запись:</span> <span class="post-title">ABAP CDS (Core Data Services)</span></a></div><div class="nav-next"><a href="http://abap-blog.ru/osnovy-abap/abap-7-51/" rel="next"><span class="meta-nav" aria-hidden="true">Далее</span> <span class="screen-reader-text">Следующая запись:</span> <span class="post-title">ABAP 7.51</span></a></div></div>
	</nav>
<div id="disqus_thread"><iframe id="dsq-app7523" name="dsq-app7523" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 1px !important; min-width: 100% !important; border: medium none !important; overflow: hidden !important; height: 1080px !important;" src="ABAP%20Managed%20Database%20Procedures_files/a.htm" horizontalscrolling="no" verticalscrolling="no" width="100%" frameborder="0"></iframe></div>
			</div>
											<footer class="site-info" itemscope="" itemtype="http://schema.org/WPFooter">
										ABAP-Blog.ru / 2012 – 2017.
				</footer>
														</div>
					</div>
	</div>
</div>
<link rel="stylesheet" id="advanced-responsive-video-embedder-css" href="ABAP%20Managed%20Database%20Procedures_files/arve.css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var countVars = {"disqusShortname":"abapblogru"};
/* ]]> */
</script>
<script src="ABAP%20Managed%20Database%20Procedures_files/comment_count.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.15"},"disqusIdentifier":"3050 http:\/\/abap-blog.ru\/?p=3050","disqusShortname":"abapblogru","disqusTitle":"ABAP Managed Database Procedures (AMDP)","disqusUrl":"http:\/\/abap-blog.ru\/database-work\/abap-managed-database-procedures-amdp\/","postId":"3050"};
/* ]]> */
</script>
<script src="ABAP%20Managed%20Database%20Procedures_files/comment_embed.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/comment-reply.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/jquery_002.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var mv_dynamic_to_top = {"text":"0","version":"0","min":"200","speed":"1000","easing":"easeInOutExpo","margin":"20"};
/* ]]> */
</script>
<script src="ABAP%20Managed%20Database%20Procedures_files/dynamic.js"></script><a href="#" id="dynamic-to-top" style="display: block;"><span>&nbsp;</span></a>
<script src="ABAP%20Managed%20Database%20Procedures_files/wp-embed.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/arve.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/lib.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/lib_002.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/client.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/client_002.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/tag.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/tag_002.js"></script>
<script src="ABAP%20Managed%20Database%20Procedures_files/handler.js"></script>
<script type="text/javascript" id="slb_footer">/* <![CDATA[ */if ( !!window.jQuery ) {(function($){$(document).ready(function(){if ( !!window.SLB && SLB.has_child('View.init') ) { SLB.View.init({"ui_autofit":true,"ui_animate":true,"slideshow_autostart":false,"slideshow_duration":"6","group_loop":true,"ui_overlay_opacity":"0.8","ui_title_default":false,"theme_default":"slb_default","ui_labels":{"loading":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430","close":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","nav_next":"\u0412\u043f\u0435\u0440\u0435\u0434","nav_prev":"\u041d\u0430\u0437\u0430\u0434","slideshow_start":"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0430\u0439\u0434\u0448\u043e\u0443","slideshow_stop":"\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0430\u0439\u0434\u0448\u043e\u0443","group_status":"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 %current%  \u0438\u0437 %total%"}}); }
if ( !!window.SLB && SLB.has_child('View.assets') ) { {$.extend(SLB.View.assets, {"1389196525":{"id":3079,"type":"image","source":"http:\/\/abap-blog.ru\/wp-content\/uploads\/2016\/06\/sqlcode1.jpg","internal":true,"sizes":{"thumbnail":{"file":"sqlcode1-150x150.jpg","width":150,"height":150,"mime-type":"image\/jpeg"},"medium":{"file":"sqlcode1-300x225.jpg","width":300,"height":225,"mime-type":"image\/jpeg"},"original":{"file":"2016\/06\/sqlcode1.jpg","width":400,"height":300}},"image_meta":{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0","keywords":[]},"description":"","title":"sqlcode[1]","caption":""}});} }
/* THM */
if ( !!window.SLB && SLB.has_child('View.extend_theme') ) { SLB.View.extend_theme('slb_baseline',{"name":"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043b\u0438\u043d\u0438\u044f","parent":"","styles":[{"handle":"base","uri":"http:\/\/abap-blog.ru\/wp-content\/plugins\/simple-lightbox\/themes\/baseline\/css\/style.css","deps":[]}],"layout_raw":"<div class=\"slb_container\"><div class=\"slb_content\">{{item.content}}<div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><div class=\"slb_controls\"><span class=\"slb_close\">{{ui.close}}<\/span><span class=\"slb_slideshow\">{{ui.slideshow_control}}<\/span><\/div><div class=\"slb_loading\">{{ui.loading}}<\/div><\/div><div class=\"slb_details\"><div class=\"inner\"><div class=\"slb_data\"><div class=\"slb_data_content\"><span class=\"slb_data_title\">{{item.title}}<\/span><span class=\"slb_group_status\">{{ui.group_status}}<\/span><div class=\"slb_data_desc\">{{item.description}}<\/div><\/div><\/div><div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><\/div><\/div><\/div>"}); }if ( !!window.SLB && SLB.has_child('View.extend_theme') ) { SLB.View.extend_theme('slb_default',{"name":"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e (\u0441\u0432\u0435\u0442\u043b\u044b\u0439)","parent":"slb_baseline","styles":[{"handle":"font","uri":"http:\/\/fonts.googleapis.com\/css?family=Yanone+Kaffeesatz","deps":[]},{"handle":"base","uri":"http:\/\/abap-blog.ru\/wp-content\/plugins\/simple-lightbox\/themes\/default\/css\/style.css","deps":[]}]}); }})})(jQuery);}/* ]]> */</script>
<script type="text/javascript" id="slb_context">/* <![CDATA[ */if ( !!window.jQuery ) {(function($){$(document).ready(function(){if ( !!window.SLB ) { {$.extend(SLB, {"context":["public","user_guest"]});} }})})(jQuery);}/* ]]> */</script>

<iframe style="display: none;"></iframe></body></html>
<!-- WP Super Cache is installed but broken. The constant WPCACHEHOME must be set in the file wp-config.php and point at the WP Super Cache plugin directory. -->